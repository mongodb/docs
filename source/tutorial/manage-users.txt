============
|mms| Access
============

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. index:: users

To access |a-mms| organization or the project within that organization,
|a-mms| user must be a member of that organization. Depending on the
user's :ref:`role in the organization <organization-roles>`, the |mms|
user may also need to be a member of the project to access a project.

|A-mms| user can be a member of multiple projects and multiple
organizations. If |a-mms| user is a member of a project, the user's
access to the project is determined their
:ref:`role in the project <project-roles>`.

Within an organization, you can group users into teams. Users can
belong to multiple teams. Teams can be assigned to multiple projects.
The team's :ref:`project role <project-roles>` sets the team members'
access to the project.

.. note::

   |mms| users are separate from :doc:`MongoDB users
   </tutorial/manage-mongodb-users>`.

Add Users to |mms|
------------------

.. cond:: cloud

   You must invite users to |mms| projects and organizations. The
   following procedures result in an email invitation being sent to the
   users you want to add. The users must accept your invitation to join
   a project or an organization.

   Users can create accounts using:

   - The |mms|
     `account registration page <https://cloud.mongodb.com/user/register>`_
     or
   - `jira.mongodb.org <http://jira.mongodb.org/>`_.

   .. note::

      If you create an account in |jira| or make any changes to that
      account from *within* |jira|, it can take up to 30 minutes for
      that change to propagate to |mms|. During this window you cannot
      add the user to a project in |mms|. Also, passwords changed in
      |jira| are subject to the same propagation delay for |mms|
      accounts.

.. cond:: onprem

   .. admonition:: Invitations Can Be Disabled
      :class: note

      When configuring your |mms| installation, you can disable
      :setting:`Invitation Only Mode`. This allows users to create
      accounts at the |mms| account registration page.

   Unless you have disabled invitation mode, you must invite users to
   |mms| projects and organizations. The following procedures result in
   an email invitation being sent to the users you want to add. The
   users must accept your invitation to join a project or organization.

- To invite a new user to a project, see :ref:`add-users-to-project`.
- To invite a new user to an organization, see 
  :ref:`add-users-to-org`. 

Manage User Access to an Organization
-------------------------------------

.. admonition:: Required Permissions
   :class: note

   To perform any of the following actions, you must have the
   :authrole:`Organization Owner` role.

.. _add-users:
.. _add-users-to-org:

Add Users to an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/steps/add-user-org.rst

View Active Users and Pending Invitations in an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To view users in an organization:

1. From the :guilabel:`Context` menu, select your desired organization.
#. Click :guilabel:`Access`.
#. Click :guilabel:`Users`.

This page lists:

- Users who are members of your |mms| organization.
- Pending users who have not accepted to the invitation to join the 
  organization or project within the organization.

To cancel an invitation, click :icon:`trash-alt` to the right of the
pending user.

Edit User's Role in an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To edit roles through |mms| for the organization:

1. Click :guilabel:`Access`.

#. Click :guilabel:`Users`.

#. For the organization user to modify, click :guilabel:`Edit Role`.

#. Select the :ref:`new role or roles <organization-roles>` for the
   user from the menu.

#. Click on the checkmark to save.

Remove Users from an Organization 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. note::

   You cannot remove the last :authrole:`Organization Owner` from an
   organization.

.. include:: /includes/steps/remove-user-org.rst

.. _manage-teams:

Manage Team Access to an Organization
-------------------------------------

In an organization, you can group its users into teams to facilitate
adding and granting roles to multiple users to projects. You assign
project access at the team level. All users in the team share the same
project access.

Organization users can belong to multiple teams.

.. admonition:: Required Permissions
   :class: note

   To perform any of the following actions, you must have the
   :authrole:`Organization Owner` role.

.. _create-team:

Create a Team
~~~~~~~~~~~~~

.. note::

   There is an upper limit of 250 teams per organization.

.. include:: /includes/steps/create-team.rst

.. _edit-team-members:

Manage Team Members
~~~~~~~~~~~~~~~~~~~

.. include:: /includes/steps/manage-team.rst

.. _rename-team:

Rename a Team
~~~~~~~~~~~~~

.. include:: /includes/steps/rename-team.rst

.. _delete-team:

Delete a Team
~~~~~~~~~~~~~

.. include:: /includes/steps/delete-team.rst

.. _about-org-api-keys:

Manage Application Access to an Organization
--------------------------------------------

To grant applications access to an organization using only the
:doc:`API </reference/api>`, you can create an |api| Key for that 
application.

|api| Keys consist of two parts: a Public Key and a Private Key. These
serve the same function as a username and User API Key when making
|api| requests to |mms|.

|api| Keys cannot be used to log into |mms| through the user interface.
You need to grant roles to |api| Keys as you would Users to make sure
the |api| Keys can call |api| endpoints without errors. |api| Keys
belong to one organization, but can be granted access to any project in
that organization.

.. admonition:: Required Permissions
   :class: note

   To perform any of the following actions, you must have the
   :authrole:`Organization Owner` role.

.. _create-org-api-key:

Create an |api| Key in an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the organization that you
   want to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys`.

#. Select :guilabel:`Create API Key` from the :guilabel:`Manage`
   button menu.

#. From the :guilabel:`API Key Information` step of the
   :guilabel:`Add API Key` page, enter a description for the new |api|
   Key in the :guilabel:`Description` box.

#. Select the :ref:`new role or roles <organization-roles>` for the
   |api| Key from the :guilabel:`Organization Permissions` menu.

#. Click :guilabel:`Next`.

#. From the :guilabel:`Private Key & Whitelist` step of the
   :guilabel:`Add API Key` page, click :guilabel:`Add Whitelist Entry`.

#. Enter an |ipv4| address from which you want |mms| to accept |api|
   requests for this |api| Key.

   You can also click :guilabel:`Use Current IP Address` if the host
   you are using to access |mms| also will make |api| requests using
   this |api| Key.

#. Click :guilabel:`Save`.

.. admonition:: Copy the Private Key Before Leaving this Page
   :class: warning

   The :guilabel:`Private Key` is only shown once: *on this page*.
   Click the :guilabel:`Copy` button to add the Private Key to the
   clipboard. Save and secure this Private Key as you would any other
   password.

.. _view-org-api-key:

View the Details of an |api| Key in an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the organization that you
   want to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. From the ellipsis menu to the right of the |api| Key, click
   :guilabel:`View Details`. 

The :guilabel:`<Public Key> API Key Details` modal displays:

- The obfuscated :guilabel:`Private Key`
- The date the Key was last used
- The date the Key was created
- The |ipv4| addresses on which the key is whitelisted
- The projects to which the Key has been granted access

.. _change-org-api-key-roles:

Change an |api| Key in an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

You can change the roles, description, or whitelist of an |api| Key in 
an Organization.

1. From the :guilabel:`Context` menu, select the organization that you
   want to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. From the ellipsis menu to the right of the |api| Key you want to
   change, click :guilabel:`Edit`.

#. From the :guilabel:`API Key Information` step of the
   :guilabel:`Add API Key` page, you can change the description of  
   the |api| Key in the :guilabel:`Description` box.

#. You can change existing or add new :ref:`roles <organization-roles>`
   to the |api| Key from the :guilabel:`Organization Permissions` menu.

#. Click :guilabel:`Next`.

#. From the :guilabel:`Private Key & Whitelist` step of the
   :guilabel:`Add API Key` page, you can add or remove an |ipaddr| 
   address to the whitelist.

   - To add an |ipaddr| address from which you want |mms| to accept
     |api| requests for this |api| Key, click
     :guilabel:`Add Whitelist Entry` and type an |ipv4| address.

     You can also click :guilabel:`Use Current IP Address` if the host
     you are using to access |mms| also will make |api| requests using
     this |api| Key.

   - To remove a whitelisted |ipaddr| address, click :icon:`trash-alt`
     to the right of the whitelisted |ipaddr| address.

#. Click :guilabel:`Save`.

.. _delete-org-api-key:

Delete an |api| Key from an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the organization that you
   want to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. Click :icon:`trash-alt` to the right of the |api| Key that you want 
   to delete.

#. Click :guilabel:`Delete` to confirm that you want to delete this
   |api| Key or :guilabel:`Cancel` to leave the key in the
   Organization.

   Removing an |api| Key from an Organization also removes that key
   from any projects to which the key was granted access.

.. _manage-project-access:

Manage Access to a Project
--------------------------

.. admonition:: Required Permissions
   :class: note

   To perform any of the following actions, you must have either the
   :authrole:`Project Owner` or :authrole:`Project User Admin` role.

View Who Can Access a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To view which users, teams, or |api| Keys can access a project:

1. From the :guilabel:`Context` menu, select the project that you want
   to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`Users`, :guilabel:`Teams`, or
   :guilabel:`API Keys` to see the appropriate access.

Each tab lists the project's users, teams, or |api| Keys along with
their project roles and actions you can take on that user, team, or
|api| Key.

View Active Users and Pending Invitations to Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The :guilabel:`Users` tab also lists any outstanding invitations to
users to join the project and any requests from users who want to join
the project. A user can request to join a project when they first
register for |mms|.

Individual users are ordered by status. They appear in the following
sequence:

1. Users currently in your project.
#. Users with pending invitations to join your project.
#. Users requesting to join your project.

A user can request to join a project when first registering for
|service|.

|service| displays the :guilabel:`Name` of
users who have not accepted their invitation as
:guilabel:`Pending User` and their role as *--invite sent--*.

To cancel an invitation, click :icon:`trash-alt` to the right of the
user's name.

.. _add-users-to-project:

Add Users or Teams to a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. note::

   There is an upper limit of 250 users per team.

.. include:: /includes/steps/add-user.rst

.. cond:: cloud

   If the |mms| finds a connected |jira| account, |mms| adds the user
   to the |jira| group associated to the |mms| project and
   organization.

.. note::

   If the added user does not belong to the project's organization, 
   |mms| adds the user to the organization.

Remove Users or Teams from a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/steps/remove-user.rst

.. index:: users; roles

.. _assign-roles-to-users:

Edit a User's or Team's Role in a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/extracts/manage-users-assign-roles.rst

To edit roles through |mms|, for the project:

1. From the :guilabel:`Context` menu, select the project in which you
   want to change user, team, or |api| Key roles.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`Users` or :guilabel:`Teams` to see the
   appropriate item.

#. Click :guilabel:`Edit Role` to the right of the user or team.

#. Click the appropriate checkboxes to assign
   :doc:`roles </reference/user-roles>`.

#. Click :guilabel:`Save`.

.. include:: /includes/extracts/manage-users-ldap.rst

.. _about-project-api-keys:

Manage Application Access to a Project
--------------------------------------

.. admonition:: Required Permissions
   :class: note

   To perform any of the following actions, you must have either the
   :authrole:`Project User Admin` role.

.. _create-project-api-key:

Create an |api| Key for a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the project that you want
   to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys`.

#. Select :guilabel:`Create API Key` from the :guilabel:`Manage`
   button menu.

#. From the :guilabel:`API Key Information` step of the
   :guilabel:`Add API Key` page, enter a description for the new |api|
   Key in the :guilabel:`Description` box.

#. Select the :ref:`new role or roles <project-roles>` for the
   |api| Key from the :guilabel:`Group Permissions` menu.

#. Click :guilabel:`Next`.

#. From the :guilabel:`Private Key & Whitelist` step of the
   :guilabel:`Add API Key` page, click :guilabel:`Add Whitelist Entry`.

#. Enter an |ipv4| address from which you want |mms| to accept |api|
   requests for this |api| Key.

   You can also click :guilabel:`Use Current IP Address` if the host
   you are using to access |mms| also will make |api| requests using
   this |api| Key.

#. Click :guilabel:`Save`.

.. admonition:: Copy the Private Key Before Leaving this Page
   :class: warning

   The :guilabel:`Private Key` is only shown once: *on this page*.
   Click the :guilabel:`Copy` button to add the Private Key to the
   clipboard. Save and secure this Private Key as you would any other
   password.

.. _view-project-api-key:

View the Details of an |api| Key in a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the project that you want
   to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. From the ellipsis menu to the right of the |api| Key, click
   :guilabel:`View Details`. 

The :guilabel:`<Public Key> API Key Details` modal displays the
obfuscated :guilabel:`Private Key`, the date the key was last used, the
date it was created, and the |ipv4| addresses on which the key is
whitelisted.

.. _change-project-api-key-roles:

Change an |api| Key's Roles in a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the project that you want
   to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. From the ellipsis menu to the right of the |api| Key, click
   :guilabel:`Edit Permissions`.

#. Select the :ref:`new role or roles <project-roles>` for the
   |api| Key from the menu.

#. Click on the checkmark to save.

.. _delete-project-api-key:

Delete an |api| Key from a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the project that you want
   to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. Click :icon:`trash-alt` to the right of the |api| Key.
