===================================
Restore a Replica Set from a Backup
===================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Overview
--------

When you restore a replica set from backup, |mms| provides you with a
restore file for the selected restore point. For an overview of the
restore process, please see :doc:`/core/restore-overview`.

Considerations
--------------

.. include:: /includes/considerations-restore-bindata-change.rst

Prerequisites
-------------

Oplog Size
++++++++++

To seed each replica set member, you will use the
:file:`seedSecondary.sh` or :file:`seedSecondary.bat` script included
in the backup restore file. When you run the script, you will provide
the replica set's oplog size, in gigabytes.

.. seealso::
   See the **Check the Size of the Oplog** section of the 
   :manual:`Troubleshoot Replica Sets </tutorial/troubleshoot-replica-sets>` 
   if you do not have the size.

Client Requests During Restoration
++++++++++++++++++++++++++++++++++

.. include:: /includes/considerations-restore-in-isolation.rst

Secure Copy (``SCP``) Delivery
++++++++++++++++++++++++++++++

.. include:: /includes/note-scp-key-pair-requirement.rst

.. include:: /includes/note-windows-scp-issue.rst

Procedures
----------

To have |mms| automatically restore the backup, perform the
:ref:`select the snapshot <select-snapshot-replica-set>` procedure.

To restore the backup manually, perform all the following procedures
sequentially. If you restore to existing hardware, use a different data
directory than used previously.

.. seealso::
   See :manual:`Restore a Replica Set from a Backup </tutorial/restore-replica-set-from-backup>` 
   for alternative approaches to restoring replica sets.

.. _select-snapshot-replica-set:

Select the Snapshot
+++++++++++++++++++

.. include:: /includes/steps/download-snapshot-replica-set.rst

Restore the Primary
+++++++++++++++++++

You must have a copy of the snapshot on the server that provides the
primary. Use this procedure only for manual restores.

.. include:: /includes/steps/restore-primary.rst

Restore Each Secondary
++++++++++++++++++++++

After you have restored the primary you can restore all
secondaries. You must have a copy of the snapshot on all servers that
provide the secondaries. Use this procedure only for manual restores.

.. include:: /includes/steps/restore-secondary.rst
