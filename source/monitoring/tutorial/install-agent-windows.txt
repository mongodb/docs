=======================================
Install the Monitoring Agent on Windows
=======================================

Overview
--------

Installing the MMS monitoring agent on Windows requires a number of Python
packages and extensions including C extensions, as well as PowerShell.

Prerequisites
-------------

Requirements
~~~~~~~~~~~~

.. include:: /includes/monitoring-install-reqs-windows.rst

If you do not have a 2.x-series Python installation on your system, install the
latest version of Python 2.7.x. If your system supports 64-bit executable, use
the 64-bit version.

Ensure that you install the correct PyMongo build for your Python installation
both in terms of version number (e.g .2.6, 2.7, etc.) and system architecture
(e.g. 32 or 64-bit.)

Credentials
~~~~~~~~~~~

.. include:: /includes/install-saas-registration.rst

If you have not downloaded the Monitoring agent already, you can click the
"Settings" link immediately after you sign into MMS, select "Settings" and then
click on "MMS Agent" to download an agent specifically configured for your
account.

Considerations
--------------

The Monitoring agent distribution download includes a ``WINDOWS.txt`` file with
instructions for using the agent on Windows platforms. Before you can use the
agent on Windows platforms, you must ensure your system meets the system
requirements.

System Resources
~~~~~~~~~~~~~~~~

The Monitoring agent does have some resource requirements and should run on
separate systems to avoid impacting ``mongod`` and ``mongos`` performance. To
monitor five or fewer nodes, you can safely deploy on an AWS "micro instance."
Similarly, if you are only monitoring a small number of databases, you may be
able to deploy the agent on the system running the ``mongos`` process. Running
PyMongo with the native extensions, which requires ``gcc``, provides significant
performance improvements.

Permissions
~~~~~~~~~~~

Installing the monitoring agent on Windows requires the appropriate permissions
to enable unsigned script execution with PowerShell. As described below,
permissions must be set at the HKEY_LOCAL_MACHINE level or HKEY_CURRENT_USER
level. In some cases, your system administrator may have used Group Policy to
block unsigned PowerShell scripts; contact your administrator if the
``Set-ExecutionPolicy`` commands below generate errors.

Procedure
---------

.. include:: /includes/steps/monitoring-install-windows.rst

Next Steps
----------

.. include:: /includes/monitoring-install-next-steps.rst

Also, consider reading the `PyMongo documentation
<http://api.mongodb.org/python/current/installation.html>`_.
