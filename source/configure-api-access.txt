==============================
Configure |service| API Access
==============================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

To access the |service| |api|, generate an
:ref:`API key <atlas-prog-api-key>` for your organization.

.. admonition:: Personal API Key Deprecation
   :class: important

   |service| has deprecated :ref:`Personal API Keys <atlas-personal-api-key>`.
   You cannot create new Personal |api| Keys, but existing Personal
   |api| Keys continue to function.

.. admonition:: Programmatic API Keys can't use the |mms| Console
   :class: note

   Organization |api| keys aren't associated with user credentials and
   can't log in to the |service| user interface.

Prerequisite
------------

.. _configure-access-to-whitelisted-ops:
.. _whitelist-for-api-operations:

Enable API Whitelisting for Your Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

For |service| users with a non-empty |api| whitelist, all |api|
access must originate from a whitelisted |ipv4| address. Ensure your
configured whitelist entries provide appropriate coverage for all
clients which require |api| access. An empty |api| whitelist grants
access to all |api| endpoints except those that explicitly require
whitelisting.

You can configure |service| to require |api| whitelisting at the
organization level. When this setting is enabled, all |api| calls
within that organization must originate from an entry on each
respective |service| userâ€™s |api| whitelist. For organizations that
require |api| whitelisting, |service| users cannot access any |api|
operations until they define at least one |api| whitelist entry.

To require an |api| whitelist for an Organization:

.. include:: /includes/steps/require-ip-access-list.rst

For a description of the |service| |api|'s principles and conventions,
see the :doc:`/api`.

.. _atlas-prog-api-key:

Programmatic API Keys
---------------------

To grant programmatic access to an organization or project using only
the :doc:`API </api>`, create an |api| key.

|api| keys have two parts: a Public Key and a Private Key. You can't
use an |api| key to log into |service| through the user interface.

All |api| keys belong to the organization, but can be given access to
a project.

To create and manage |api| keys, use the :guilabel:`Access Manager`.

When you create a new |api| key, |service| grants key the following
permissions:

.. list-table::
   :widths: 40 60
   :stub-columns: 1

   * - Organization
     - :atlasrole:`Organization Member`
   * - Project
     -
       - :atlasrole:`Project Read Only`
       - :atlasrole:`Organization Member`

You can add more permissions to the new |api| key when you create it.

To add the new |api| key created in an organization,
:ref:`invite the API key to the project <invite-org-app-api-keys>`.

.. _about-org-app-api-keys:

Manage Programmatic Access to an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. admonition:: Required Permissions
   :class: note

   To perform any of the following actions, you must have the
   :authrole:`Organization Owner` role.

.. _create-org-app-api-key:

Create an API Key in an Organization
````````````````````````````````````

.. include:: /includes/steps/app-api-key-create-in-org.rst

.. _view-org-app-api-key:

View the Details of an API Key in an Organization
`````````````````````````````````````````````````

.. include:: /includes/steps/app-api-key-view-details-in-org.rst

.. _change-org-app-api-key-roles:

Change an API Key in an Organization
````````````````````````````````````

You can change the roles, description, or whitelist of an |api| Key in
an Organization.

.. include:: /includes/steps/app-api-key-change-in-org.rst

.. _delete-org-app-api-key:

Delete an API Key from an Organization
``````````````````````````````````````

.. include:: /includes/steps/app-api-key-delete-from-org.rst

.. _about-project-app-api-keys:

Manage Programmatic Access to a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. admonition:: Required Permissions
   :class: note

   To perform any of the following actions, you must have the
   :authrole:`Project Owner` role.

.. _create-project-app-api-key:

Create an API Key for a Project
```````````````````````````````

.. include:: /includes/steps/app-api-key-create-in-project.rst

.. _invite-org-app-api-keys:

Invite an Organization API Key to a Project
```````````````````````````````````````````

.. include:: /includes/steps/app-api-key-invite-to-project.rst

.. _view-project-app-api-key:

View the Details of an API Key in a Project
```````````````````````````````````````````

.. include:: /includes/steps/app-api-key-view-details-in-project.rst

.. _change-project-app-api-key-roles:

Change an API Key's Permissions in a Project
````````````````````````````````````````````

.. include:: /includes/steps/app-api-key-change-roles-in-project.rst

.. _change-project-app-api-edit-whitelist:

Edit an |api| Key's Whitelist
`````````````````````````````

.. admonition:: Required Permissions
   :class: note

   To edit a project |api| key's whitelist, you must have the
   :authrole:`Organization Owner` permission.

.. include:: /includes/steps/app-api-key-edit-whitelist-in-project.rst

.. _delete-project-app-api-key:

Delete an API Key from a Project
````````````````````````````````

.. include:: /includes/steps/app-api-key-delete-from-project.rst

.. _atlas-personal-api-key:

Personal API Keys (Deprecated)
------------------------------

.. include:: /includes/fact-personal-apikeys-deprecated-ui.rst

You can no longer create Personal |api| Keys. You can manage any
Personal |api| Keys that you have currently.

To manage any existing personal |api| keys:

.. include:: /includes/steps/view-personal-api-keys.rst

When accessing |service| through the |api|, you have the same level of
access as you do through the |service| interface. Your |service|
permissions apply to both the interface and the |api|.

Limit API Operations to Whitelisted IPv4 Addresses
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To access whitelisted |api| operations:

- Configure your :ref:`API whitelist <whitelist-for-api-operations>`
  with the |ipv4| addresses from which you will issue the whitelisted
  commands.

- Grant your |api| key the :authrole:`Organization Owner` permission to
  issue whitelisted commands.

Address-based whitelists protect |api| operations. Only client requests
that originate from a whitelisted |ipv4| address are permitted to
perform the operations.

Users have their own whitelists and own |api| keys. When you issue an
|api| call, you must use an |api| key from your user account and must
issue the command from an address on your user account's whitelist. You
cannot use your key to issue a whitelisted |api| request from an
address on another user's whitelist, unless, of course, you've added
that address to your own whitelist.

On the :doc:`resources </reference/api-resources>` pages in this guide,
whitelisted operations are marked as such.

.. _add-personal-api-key-whitelist:

Add an IPv4 Address to the API Whitelist
````````````````````````````````````````

.. include:: /includes/steps/add-personal-api-key-whitelist.rst

.. _delete-personal-api-key-whitelist:

Delete an IPv4 Address from the API Whitelist
`````````````````````````````````````````````

.. include:: /includes/steps/delete-personal-api-key-whitelist.rst
