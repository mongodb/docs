================
Create a Cluster
================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

MongoDB deployments, or "clusters" in |service|, can be either a
:term:`replica set` or a :term:`sharded cluster`.

.. include:: /includes/fact-free-tier-paid-tier.rst

For a complete list of Free Tier limitations, see :ref:`atlas-free-tier`.

.. include:: /includes/extracts/fact-vpc-per-group.rst

Create a Cluster
----------------

To create a cluster, go to the :guilabel:`Clusters` view and click the
:guilabel:`Add New Cluster` or :guilabel:`Build a New Cluster` button.
Configure your cluster as described in the steps below. As
you build your cluster, |service| displays the associated costs.

If no MongoDB user exists for your |service| :ref:`group
<create-group>`, you will also create your first MongoDB user.

You must save the admin user and password or you will lose admin access
to your MongoDB databases until you reset the password. If you choose
to have |service| generate the admin password, save the password when
it is displayed since |service| displays it only once.

.. include:: /includes/steps/add-new-cluster.rst

.. _atlas-free-tier:

|service| M0 (Free Tier) Limitations
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The following table lists the configuration limitations of Free Tier clusters:

.. list-table::
   :widths: 20 80
   :header-rows: 1

   * - Configuration Option
     - Limitation

   * - AWS Region
     - |service| deploys Free Tier clusters in ``us-east-1 (N. Virginia)``.
       This does not affect other clusters in the |service| group.

   * - MongoDB Version
     - Version is set to ``MongoDB 3.4 with Wired Tiger`` and cannot
       be modified.

   * - Instance Size
     - You must select the ``M0`` instance size to deploy a Free Tier cluster.

   * - Instance Memory
     - You cannot configure memory for a Free Tier cluster.

   * - Instance Storage
     - Storage is set to ``512 MB`` and cannot be modified.

   * - Replication Factor
     - Replication Factor is set to ``3 Nodes`` and cannot be modified.

   * - Do You Want A Sharded Cluster
     - You cannot deploy a Free Tier cluster as a Sharded Cluster.

   * - Do You Want To Enable Backup
     - You cannot enable backups.

The following table lists the operational limitations of |service| Free Tier
clusters:

.. list-table::
   :widths: 20 80

   * - :manual:`Aggregation </aggregation>` 
     - |service| Free Tier clusters do not support the
       ``allowDiskUse`` option for the
       :manual:`aggregation command </reference/aggregate>` 
       or its 
       :manual:`helper method </reference/method/db.collection.aggregate>`.

   * - Throughput
     - Maximum of 100 operations per second.

   * - Connections
     - Maximum of 100 connections.

   * - Network bandwidth
     - Restricted to 1GB per week in and 1GB per week out. |service| throttles
       traffic to 1KB/s after reaching either bandwidth limit.

   * - Javascript
     - Free Tier clusters do not support server side javascript. For example,
       :manual:`$where </reference/operator/query/$where>` and
       :manual:`map-reduce </core/map-reduce>` are not supported.

   * - Migrating to a Paid Cluster
     - The |service| UI does not provide an automated feature for migrating 
       Free Tier data to a paid cluster.

       For a tutorial on manually migrating Free Tier data to a paid cluster,
       see :doc:`/tutorial/transition-free-tier-to-paid`.

   * - Data Explorer
     - :doc:`/data-explorer` is not available for a Free Tier cluster.

   * - API Access
     - You cannot modify or configure a Free Tier cluster using the
       :doc:`/reference/api/clusters` API endpoint.

   * - Number of Free Tier clusters
     - You can deploy at most *one* Free Tier cluster per |service| group.

   * - Database Commands
     - Certain database commands are unsupported or behavior differently
       in a Free Tier cluster. See :doc:`Command Limitations in Free 
       Tier Clusters </unsupported-commands>` for more information.
 
       Please contact |service| support for any questions or comments related
       to restricted commands.

   * - |service| Monitoring
     - The :guilabel:`Metrics` view of a Free Tier cluster only displays the
       following metrics:

       - Connections
       - Logical Size
       - Network
       - Opscounter

       For more information on these metrics, see
       :ref:`Real Time Metrics <real-time-metrics-status-tab>`.

   * - Database Names
     - Free Tier clusters limit the name of a database, including the db
       prefix, to 63 bytes.

   * - Database and Collections
     - Maximum of 100 databases and 500 collections total.

   * - Cluster Persistance
     - |service| may terminate idle Free Tier clusters as per the
       Terms of Service.

   * - VPC Peering
     - Free Tier clusters do not support :ref:`VPC peering <security-vpc>`.

Terminate a Cluster
-------------------

To terminate an |service| cluster, do the following:

1. Click :guilabel:`Clusters`.

#. For the cluster you wish to terminate, click on the :guilabel:`...` in the 
   top-right corner.

#. Click :guilabel:`Terminate`.

|service| executes the terminate operation after completing any in-progress
deployment changes.

|service| bills for the hours that the cluster was active. See :doc:`/billing`
for more information on |service| billing.

.. warning::

   Terminating a cluster also deletes any backup snapshots for that cluster.
   See :ref:`retention-policy`.


Next Steps
----------

To continue setting up the cluster, see:

- :doc:`Set up security </setup-cluster-security>`.

- :doc:`Connect to the cluster </connect-to-cluster>`.

To change the cluster configuration after deployment, see
:doc:`scale-cluster`.

.. [#version]

   .. include:: /includes/note-enterprise-not-supported.rst

.. include:: /includes/footnote-databearing.rst
