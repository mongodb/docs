===================
Mongo.setReadPref()
===================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Definition
----------

.. method:: Mongo.setReadPref(mode, tagSet)

   Call the :method:`~Mongo.setReadPref()` method on a :method:`Mongo
   <db.getMongo()>` connection object to control how the client will
   route all queries to members of the replica set.


   .. list-table::
      :header-rows: 1
      :widths: 20 20 80
   
      * - Parameter
   
        - Type
   
        - Description
   
      * - ``mode``
   
        - string
   
        - .. _mongo-setReadPref-mode:

          One of the following :term:`read preference` modes:
          :readmode:`primary`, :readmode:`primaryPreferred`,
          :readmode:`secondary`, :readmode:`secondaryPreferred`, or
          :readmode:`nearest`.
          
          
   
      * - ``tagSet``
   
        - array
   
        - Optional. A tag set used to specify custom read preference modes. For details, see :ref:`replica-set-read-preference-tag-sets`.
          
          
   


Examples
--------

.. _allow-reads-from-secondaries:

Specify Read Preference Mode
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The following operation sets the read preference :ref:`mode
<mongo-setReadPref-mode>` to target the read to a secondary member.
This implicitly allows reads from secondaries.

.. code-block:: javascript

   db.getMongo().setReadPref('secondary')

Specify Read Preference Tag Set
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To set a read preference that uses a tag set, specify an array of tag
sets as the second argument to :method:`Mongo.setReadPref()`, as in the
following:

.. code-block:: javascript

   db.getMongo().setReadPref('primaryPreferred', [ { "dc": "east" } ] )

You can specify multiple tag sets, in order of preference, as in the
following:

.. code-block:: javascript

   db.getMongo().setReadPref('secondaryPreferred',
                             [ { "dc": "east", "use": "production" },
                               { "dc": "east", "use": "reporting" },
                               { "dc": "east" },
                               {}
                             ] )

If the replica set cannot satisfy the first tag set, the client will
attempt to use the second read preference. Each tag set can contain zero
or more field/value tag pairs, with an "empty" document acting as a
wildcard which matches a replica set member with any tag set or no tag
set.

.. note::

   You must call :method:`Mongo.setReadPref()` on the connection object
   before retrieving documents using that connection to use that read
   preference.
