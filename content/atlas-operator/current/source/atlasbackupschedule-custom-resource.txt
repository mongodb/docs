.. _atlasbackupschedule-custom-resource:

=======================================
``AtlasBackupSchedule`` Custom Resource
=======================================

.. meta::
   :description: Configure a backup schedule for your AtlasDeployment using the AtlasBackupSchedule custom resource with the Atlas Kubernetes Operator.

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

The ``AtlasBackupSchedule`` custom resource configures a backup
schedule that you can apply to your 
:ref:`atlasdeployment-custom-resource`. When you
create the ``AtlasBackupSchedule`` custom 
resource, |ak8so| tries to create or update a backup schedule.

.. include:: /includes/fact-ak8so-crds.rst

|ak8so| does one of the following actions using the |service| 
:oas-bump-atlas-op:`Cloud Backup Schedule API Resource 
<updategroupclusterbackupschedule>`:
   
- Creates a new backup schedule.
- Updates an existing backup schedule.

If you remove the ``AtlasBackupSchedule`` resource from your |k8s| 
{+cluster+}, |service| stops creating backups for your {+cluster+}.

.. note:: 

   You must do all of the following to back up a {+cluster+}:

   1. Create a :ref:`backup policy <atlasbackuppolicy-custom-resource>`
   #. Create a backup schedule and set the 
      :ref:`spec.policy.name <atlasbackupschedule-spec-policy>` field to the name of the configured
      backup policy.
   #. Set the :ref:`spec.backupRef.name <atlasdeployment-spec-backupref>` field in the
      :ref:`atlasdeployment-custom-resource` to the name of the 
      configured backup schedule.

   To learn more, see :ref:`ak8so-backup`.

You can specify one backup schedule per {+cluster+}, but you can use
the same backup schedule for multiple {+clusters+}.

Example
-------

The following example shows an ``AtlasBackupSchedule`` custom resource
configured to take snapshots at 10:10 UTC and restore up to two days:

.. code-block::

   apiVersion: atlas.mongodb.com/v1
   kind: AtlasBackupSchedule
   metadata:
     name: atlas-default-backupschedule
   spec:
     autoExportEnabled: true
     copySettings:
     - cloudProvider: AWS
       frequencies:
       - HOURLY
       regionName: US_EAST_1
       shouldCopyOplogs: true
     referenceHourOfDay: 10
     referenceMinuteOfHour: 10
     restoreWindowDays: 2
     policy:
       name: atlas-default-backuppolicy
       namespace: mongodb-atlas-system

Parameters
----------

.. include:: /includes/manual-crds/atlas-backup-schedule.rst