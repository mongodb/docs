=======
profile
=======

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Definition
----------

.. dbcommand:: profile

   Enables, disables, or configures the
   :doc:`/tutorial/manage-the-database-profiler`.
   The profiler captures and records data on the performance of write
   operations, cursors, and database commands on a running
   :binary:`~bin.mongod` instance.

   The profiler is off by default.

   .. include:: /includes/warning-profiler-performance.rst

   The :dbcommand:`profile` command has the following syntax:

   .. code-block:: javascript

      {
        profile: <level>,
        slowms: <threshold>,
        sampleRate: <rate>
      }

   .. _slowms-threshold-option:


   .. list-table::
      :header-rows: 1
      :widths: 20 20 80
   
      * - Field
   
        - Type
   
        - Description
   
      * - ``profile``
   
        - int
   
        - Default: 0
          
          | Specifies which operations should be profiled.
          | The following profiler levels are available:
          
          .. list-table::
             :header-rows: 1
             :widths: 25 75
             
             * - Level
               - Description
          
             * - ``-1``
               - Returns the current profiler level, but does not change it.
          
             * - ``0``
               - Turns the profiler off so that it does not
                 collect any data.
                 This is the default profiler level.
          
             * - ``1``
               - Sets the profiler to collect data for operations that take
                 longer than the value of ``slowms``.
          
             * - ``2``
               - Sets the profiler to collect data for all operations.
          
          
   
      * - ``slowms``
   
        - int
   
        - Optional. Default: 100
          
          .. include:: /includes/dbcommand-slowms-definition.rst
          
          .. note::
             This argument affects the same setting as the configuration option
             :setting:`~operationProfiling.slowOpThresholdMs`.
          
          
   
      * - ``sampleRate``
   
        - double
   
        - Optional. Default: 1.0
          
          | The fraction of *slow* operations that should be profiled.
          | ``sampleRate`` accepts values between 0 and 1, inclusive.
          
          .. note::
          
             This argument affects the same setting as the configuration option
             :setting:`~operationProfiling.slowOpSampleRate` and does not
             affect the :ref:`slow oplog entry log messages on secondaries
             (available starting in version 3.6.11 for MongoDB 3.6 deployments)
             <slow-oplog>`.
          
          .. versionadded:: 3.6
          
          
   


The :method:`db.getProfilingStatus()` and
:method:`db.setProfilingLevel()` :doc:`shell methods
</reference/method>` provide wrappers around the :dbcommand:`profile`
command.

Behavior
--------

The :dbcommand:`profile` command obtains a write lock on the affected
database while enabling or disabling the profiler. This is typically a
short operation. The lock blocks other operations until the
:dbcommand:`profile` command has completed.

.. seealso::
   :ref:`Database Profiling <database-profiling>`.
