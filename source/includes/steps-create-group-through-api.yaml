title: Use the API to create a group.
stepnum: 1
ref: create-group-via-api
pre: |
  Use the Public API to send a :doc:`groups </reference/api/groups>`
  document to create the new group. Issue the following command, replacing
  ``<user@example.net>`` with your user credentials,
  ``<public_api_key>`` with your :term:`Public API key`,
  ``<app-example.net>`` with the |mms| URL, and
  ``<group_name>`` with the name of the new group:
action:
  language: none
  code: |
    curl -u "<user@example.net>:<public_api_key>" -H "Content-Type: application/json" "http://<app-example.net>/api/public/v1.0/groups" --digest -i -X POST --data '
    {
       "name": "<group_name>"
    }'
post: |
  The API returns a document that includes the group's ``agentApiKey`` and ``id``.
---
title: "Record the values of ``agentApiKey`` and ``id`` in the returned document."
stepnum: 2
ref: record-api-and-id
content: |
  Record these values for use in this procedure and in other procedures in
  this tutorial.
---
title: Use the API to create a user in the new group.
stepnum: 3
ref: create-user-via-api
pre: |
  Use the ``/users`` endpoint to add a user to the new group. 
  
  The body
  of the request should contain a :doc:`users </reference/api/users>`
  document with the user's information. Set the user's
  ``roles.roleName`` to ``GROUP_OWNER``, and the user's
  ``roles.groupId`` set to the new group's' ``id``.
action:
  language: none
  code: |
    curl -u "<user@example.net>:<public_api_key>" -H "Content-Type: application/json" "http://<app-example.net>/api/public/v1.0/users" --digest -i -X POST --data '
    {
       "username": "<new_user@example.com>",
       "emailAddress": "<new_user@example.com>",
       "firstName": "<First>",
       "lastName": "<Last>",
       "password": "<password>",
       "roles": [{
         "groupId": "<group_id>",
         "roleName": "GROUP_OWNER"
       }]
    }'
---
title: "If you used a global owner user to create the group, you can remove that user from the group. (Optional)"
stepnum: 4
ref: remove-global-owner
edition:
  - onprem
pre: |
  The user you use to create the group is automatically added to the group. 
  If you used a :ref:`global owner <global-owner-role>` user, you can remove the
  user from the group without losing the ability to make changes to the
  group in the future. As long as you have the group's ``agentApiKey`` and
  ``id``, you have full access to the group when logged in as the global
  owner.
action:
  - pre: |
      ``GET`` the global owner's ID. Issue the following command to
      request the group's users. Replace the credentials, :term:`Public API key`,
      URL, and group ID, with the relevant values:
    language: none
    code: |
      curl -u "<user@example.net>:<public_api_key>" "http://<app-example.net>/api/public/v1.0/groups/<group_id>/users" --digest -i
  - pre: |
      The API returns a document that lists all the group's users.
      Locate the user with ``roles.roleName`` set to ``GLOBAL_OWNER``.
      Copy the user's ``id`` value, and issue the following to remove the
      user from the group, replacing ``<user_id>``
      with the user's ``id`` value:
    language: none
    code: |
      curl -u "<user@example.net>:<public_api_key>" "http://<app-example.net>/api/public/v1.0/groups/<group_id>/users/<user_id>" --digest -i -X DELETE
  - pre: |
      Upon successful removal of the user, the API returns the HTTP ``200
      OK`` status code to indicate the request has succeeded.
...
