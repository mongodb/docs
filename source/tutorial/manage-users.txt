================
Manage MMS Users
================

.. default-domain:: mongodb

.. index:: users

.. only:: classic or cloud

   You can manage the users that have access to your MMS groups.
   You also can create and manage groups.

.. only:: onprem

   You can manage the users that have access to your |mms| groups, create
   and manage groups, and assign :doc:`roles </reference/user-roles>` to
   users to provide controlled access to the MMS application.

   There is no planned upgrade path from existing MMS user
   authentication to using LDAP. You will need to recreate users,
   groups, and roles manually with your LDAP service, as described in
   the :doc:`/tutorial/configure-for-ldap-authentication` document.

MMS users are separate from :doc:`MongoDB users <manage-mongodb-users>`.

Add MMS Users
-------------

.. include:: /includes/steps/add-user.rst

.. only:: classic or cloud

   If the console finds a connected Jira account, MMS will automatically
   add the user to your Jira group and the MMS console.

   Users can also create accounts using the `account registration page
   <https://mms.mongodb.com/user/register/user>`_, or through Jira at
   `jira.mongodb.org <http://jira.mongodb.org/>`_.

   .. index:: users; propagation

   .. note::

      If you create an account in Jira or make any changes to that
      account from *within* Jira, it can take up to 30 minutes for that
      change to propagate to MMS. During this window you cannot add a
      user to a group in MMS. Also, passwords changed in Jira are subject
      to the same propagation delay for MMS accounts.

.. only:: onprem

   .. note::

      With MongoDB Management Service On Prem, user accounts and groups are
      independent from JIRA. This is in contrast to the `MongoDB Management Service
      <http://mms.mongodb.com>`_, which shares account
      and group information with the `MongoDB JIRA
      <http://jira.mongodb.org/>`_ instance.

   Users can create accounts using the account registration
   page of your MMS installation.

   See :ref:`assign-roles-to-users` for details about roles and privileges, as
   well as adding users and assigning roles with LDAP integration.

View MMS Users
---------------

To view users, click the :guilabel:`Administration` tab and then
:guilabel:`Users` page. The :guilabel:`Users` page lists users who have
access to your MMS group, their roles, their time zones, and other
information. The page also lists any invitations to join the group waiting
for a reply, as well as any requests from users who want to join the group.
A user can request to join a group when first registering for MMS.

View Invitations
----------------

When you invite a user to join a group, MMS then sends an email to the
prospective new user. To view invitations sent but not yet accepted, click
the :guilabel:`Administration` tab and then select the :guilabel:`Users`
page. The page lists any users with pending invitations. To cancel an
invitation, click :guilabel:`CANCEL INVITE`.

View Requests
-------------

Users can request access when they create their MMS account, as on the
registration page.

To view requests, click the :guilabel:`Administration` tab and then select the
:guilabel:`Users` page. The :guilabel:`Users` page lists any pending
requests to join your group. To approve or deny a request, click the
appropriate button.

Remove MMS Users
----------------

.. include:: /includes/steps/remove-user.rst

.. index:: users; groups

Working with Multiple Environments
----------------------------------

.. _manage-groups:

Groups
~~~~~~

If you have multiple MongoDB systems in distinct environments and
cannot monitor all systems with a single agent, you will need to add a
new group. Having a second group makes it possible to run two agents.

You may also use a second group and agent to monitor a different set
of MongoDB instances in the same environment if you want to segregate
the hosts within the MMS console. A user can only view data from the
hosts monitored in a single group at once.

After adding a second group, the MMS interface will have a drop down list
that will allow you to change groups. Selecting a new group will
refresh the current page with the data available from the servers in
this group.

.. _create-group:

Create Group
~~~~~~~~~~~~

Create a group to monitor additional segregated systems or environments for
servers, agents, users, and other resources. For example, your deployment might
have two or more environments separated by firewalls. In this case, you would
need two or more separate MMS groups.

API and shared secret keys are unique to each group. Each group requires its
own agent with the appropriate API and shared secret keys. Within each group,
the agent needs to be able to connect to all hosts it monitors in the group.

.. include:: /includes/steps/add-group.rst

.. _assign-roles-to-users:

Assign Roles to MMS Users
-------------------------

.. only:: classic or cloud

   You can assign :doc:`roles </reference/user-roles>` to MMS users to limit
   the actions they can perform and the data they can view.

.. only:: onprem

   MMS or an LDAP server can assign :doc:`roles </reference/user-roles>`
   to individual users to limit actions
   users can perform, as well as data users see in the application. With LDAP
   integration, follow the steps to setup
   :doc:`/tutorial/configure-for-ldap-authentication` then create LDAP groups
   for each available MMS role.

Initial Creation
~~~~~~~~~~~~~~~~

.. only:: classic or cloud

   Upon successful login, the first user completes a welcome form to create the
   initial MMS group. This form includes assigning roles.

.. only:: onprem

   You can assign roles either through MMS or :ref:`through an LDAP server
   <assign-roles-with-ldap>`.

   Upon successful login, the first user completes a welcome form to create the
   initial MMS group. This form includes assigning roles. For LDAP
   authentication, the welcome form includes the ability to assign LDAP groups
   to the MMS group-level and global roles.

Required Permissions
~~~~~~~~~~~~~~~~~~~~

You must have either the :ref:`User Admin <user-admin-role>` role or
:ref:`Owner <owner-role>` role in a group to assign roles to
users in that group.

.. only:: onprem

   You must have either the :ref:`Global User Admin
   <global-user-admin-role>` role or :ref:`Global Owner
   <global-owner-role>` role to assign roles to any user in any group.

.. index:: users; roles

Assign an MMS Role
~~~~~~~~~~~~~~~~~~

To assign roles inside of |mms|, select the :guilabel:`Administration` tab
and then the :guilabel:`Users` page. Click the user's gear icon and select
:guilabel:`Edit User`. Click the appropriate checkboxes to assign
:doc:`roles </reference/user-roles>`.

.. only:: onprem

   .. _assign-roles-with-ldap:

   Assign MMS Roles with LDAP
   ~~~~~~~~~~~~~~~~~~~~~~~~~~

   .. include:: /includes/fact-configure-ldap-roles.rst
