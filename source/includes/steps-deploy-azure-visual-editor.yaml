level: 4
ref: select-dataset-azure
source: 
  file: steps-adf-deploy-source.yaml
  ref: select-datasets
content: |
  Click :guilabel:`Add Data Sources` to select your data store.
---
title: "Specify your data store."
level: 4
ref: specify-data-store
content: | 
  Choose :guilabel:`Azure` to configure a {+fdi+} for data in {+az-bs+}
  containers. 

  Corresponds to :datalakeconf-azure:`stores.[n].provider` |json| 
  configuration setting.
---
title: "Select an |azure| Service Principal for |service|."
level: 4
ref: select-service-principal-for-service
content: |
  You can select an existing |azure| Service Principal that |service| is  
  authorized for from the Service Principal dropdown or choose 
  :guilabel:`Authorize an Azure Service Principal` to authorize a new
  service principal.  
  
  If you selected an existing service principal that |service| is
  authorized for, proceed to the next step. 
  
  If you are authorizing |service| for an existing service principal or
  are creating a new service principal, complete the following steps
  before proceeding to the next step:
  
  a. Select :guilabel:`Authorize an Azure Service Principal` to
     authorize a new or existing service principal and click
     :guilabel:`Continue`. 

     Use the |azure| Service Principal *AppId* in the :guilabel:`Add
     Atlas to your Azure Service Principal` section to grant |service|
     access through an existing or new |azure| Service Principal. 

  #. Follow the steps in the :guilabel:`PowerShell` or
     :guilabel:`AzureCLI` tab in the {+atlas-ui+} to create a new
     service prinicpal or modify an existing service principal. 

  #. Enter the tenant ID and Service Principal ID in the respective
     fields after completing the steps in the {+atlas-ui+}.

  #. Click :guilabel:`Validate and Finish` to proceed to the next step. 

---
title: "Configure access to your {+az-bs+}."
level: 4
ref: config-azure-bs-access
content: |
  In the :guilabel:`Configure Azure Blob Storage` page, you must
  configure |azure| Storage Account credential delegation and Storage
  Container access. To do these: 

  a. Enter your Storage Account Resource ID in the :guilabel:`Storage
     Account Credential Delegation` field.

     To learn more, see `Get the resource ID for a storage account
     <https://learn.microsoft.com/en-us/azure/storage/common/storage-account-get-info?tabs=portal>`__. 

  #. Copy and run the command from the :guilabel:`Storage Account
     Credential Delegation` step in your |azure| PowerShell 
     to set up the credentials delegation. 

  #. Specify whether the storage container allows :guilabel:`Read only`
     or :guilabel:`Read and write` operations.

     |service| can only query :guilabel:`Read-only` containers; if you 
     wish to query and save query results to your {+az-bs+} container,
     choose :guilabel:`Read and write`.

     .. note:: 

        {+adf+} doesn't support writes to your {+az-bs+} container using
        :ref:`adf-out-stage`. 

  #. Enter your Storage Container name.
  
  #. Copy and run the command shown from the :guilabel:`Storage
     Container Access` step in your |azure| PowerShell to set up blob
     container access. 

  #. Click :guilabel:`Continue`.

---
title: "Define the path structure for your files in the {+az-bs+}
       container and click :guilabel:`Next`."
level: 4
ref: define-data-sources
content: | 
  
  a. Enter the storage path to your {+az-bs+} container.

     For example: 

     .. code-block:: sh
     
        https://<storage-account>.blob.core.windows.net/<container>/<file-name>

     To add additional paths to data on your {+az-bs+} container, click 
     :guilabel:`Add Data Source` and enter the path. To learn more about 
     paths, see :ref:`adf-path-syntax`.

     Corresponds to 
     :datalakeconf-azure:`databases.[n].collections.[n].dataSources.[n].path` 
     |json| configuration setting.

  #. **Optional**. Specify the partition fields that {+df+} should use
     when searching the files in the {+az-bs+} container and the field
     value type. 
     
     If omitted, {+df+} does a recursive search for all files from the
     root of the {+az-bs+} container. If you don't select a specific field
     value type, {+df+} adds any value in that path in all queries.

     Corresponds to :datalakeconf-azure:`stores.[n].prefix` and
     :datalakeconf-azure:`databases.[n].collections.[n].dataSources.[n].path`
     |json| configuration settings.

---
level: 4
ref: drag-drop-data-store-azure
inherit:
  file: steps-adf-deploy-source.yaml
  ref: drag-drop-data-store
replacement: 
  data-source: ":guilabel:`Azure Blob Storage`"
  
...

