.. _mongodump:

=============
``mongodump``
=============

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. |tool-binary| replace:: mongodump

.. include:: /includes/admonition-mac-osx-sierra-restriction.rst

Synopsis
--------

:binary:`~bin.mongodump` is a utility for creating a binary export of the
contents of a database. :binary:`~bin.mongodump` can export data from
either :binary:`~bin.mongod` or :binary:`~bin.mongos` instances.

:binary:`~bin.mongodump` can be a part of a :ref:`backup strategy
<backup-with-mongodump>` with :binary:`~bin.mongorestore` for partial
backups based on a query, syncing from production to staging or
development environments, or changing the storage engine of a
standalone. However, the use of :binary:`~bin.mongodump` and
:binary:`~bin.mongorestore` as a backup strategy can be problematic for
sharded clusters and replica sets.

For an overview of :binary:`~bin.mongodump` in conjunction with
:binary:`~bin.mongorestore` part of a backup and recovery strategy, see
:doc:`/tutorial/backup-and-restore-tools`.

.. seealso:: :binary:`~bin.mongorestore`,
   :doc:`/tutorial/backup-sharded-cluster-with-database-dumps`
   and :doc:`/core/backups`.

Behavior
--------

Data Exclusion
~~~~~~~~~~~~~~

.. include:: /includes/fact-mongodump-local-database.rst

:binary:`~bin.mongodump` only captures the documents in the database in its
backup data and does not include index data. :binary:`~bin.mongorestore` or
:binary:`~bin.mongod` must then rebuild the indexes after restoring data.

Version Compatibility
~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/warning-mongodump-compatibility-2.2.rst

Read Preference
~~~~~~~~~~~~~~~

.. versionchanged:: 3.0.5

   For a sharded cluster where the shards are replica sets,
   :binary:`~bin.mongodump`, when run against the :binary:`~bin.mongos`
   instance, no longer prefers reads from secondary members.

Overwrite Files
~~~~~~~~~~~~~~~

.. include:: /includes/fact-mongodump-overwrite-files.rst

Data Compression Handling
~~~~~~~~~~~~~~~~~~~~~~~~~

When run against a :binary:`~bin.mongod` instance that uses the
:doc:`WiredTiger </core/wiredtiger>` storage engine,
:binary:`~bin.mongodump` outputs uncompressed data.

Working Set
~~~~~~~~~~~

:binary:`~bin.mongodump` can adversely affect performance of the
:binary:`~bin.mongod`. If your data is larger than system memory, the
:binary:`~bin.mongodump` will push the working set out of memory.

Required Access
---------------

.. include:: /includes/access-mongodump-collections.rst

Options
-------

.. include:: /includes/extracts/fact-3.0-tools-drop-dbpath-support-mongodump.rst

.. binary:: mongodump

.. program:: mongodump

.. include:: /includes/option/option-mongodump-help.rst

.. include:: /includes/option/option-mongodump-verbose.rst

.. include:: /includes/option/option-mongodump-quiet.rst

.. include:: /includes/option/option-mongodump-version.rst

.. include:: /includes/option/option-mongodump-host.rst

.. include:: /includes/option/option-mongodump-port.rst

.. include:: /includes/option/option-mongodump-ipv6.rst

.. include:: /includes/option/option-mongodump-ssl.rst

.. include:: /includes/option/option-mongodump-sslCAFile.rst

.. include:: /includes/option/option-mongodump-sslPEMKeyFile.rst

.. include:: /includes/option/option-mongodump-sslPEMKeyPassword.rst

.. include:: /includes/option/option-mongodump-sslCRLFile.rst

.. include:: /includes/option/option-mongodump-sslAllowInvalidCertificates.rst

.. include:: /includes/option/option-mongodump-sslAllowInvalidHostnames.rst

.. include:: /includes/option/option-mongodump-sslFIPSMode.rst

.. include:: /includes/option/option-mongodump-username.rst

.. include:: /includes/option/option-mongodump-password.rst

.. include:: /includes/option/option-mongodump-authenticationDatabase.rst

.. include:: /includes/option/option-mongodump-authenticationMechanism.rst

.. include:: /includes/option/option-mongodump-gssapiServiceName.rst

.. include:: /includes/option/option-mongodump-gssapiHostName.rst

.. include:: /includes/option/option-mongodump-db.rst

.. include:: /includes/option/option-mongodump-collection.rst

.. include:: /includes/option/option-mongodump-query.rst

.. include:: /includes/option/option-mongodump-forceTableScan.rst

.. include:: /includes/option/option-mongodump-out.rst

.. include:: /includes/option/option-mongodump-repair.rst

.. include:: /includes/option/option-mongodump-oplog.rst

.. include:: /includes/option/option-mongodump-dumpDbUsersAndRoles.rst

.. include:: /includes/option/option-mongodump-excludeCollection.rst

.. include:: /includes/option/option-mongodump-excludeCollectionsWithPrefix.rst

.. _mongodump-behavior:

Use
---

For an overview of :binary:`~bin.mongodump` usage, see
:doc:`/tutorial/backup-and-restore-tools`

For an overview of :binary:`~bin.mongorestore`, which provides the related inverse
functionality, see the :doc:`mongorestore` document.

The following operation creates a dump file that contains only the
collection named ``collection`` in the database named ``test``. In
this case the database is running on the local interface on port
``27017``:

.. code-block:: sh

   mongodump  --db test --collection collection

``mongodump`` a Database Excluding Specified Collections
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The following operation dumps all collections in the ``test`` database
except for ``users`` and ``salaries``:

.. code-block:: sh

   mongodump  --db test --excludeCollection=users --excludeCollection=salaries

``mongodump`` with Access Control
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

In the next example, :binary:`~bin.mongodump` creates a database dump
located at ``/opt/backup/mongodump-2011-10-24``, from a database
running on port ``37017`` on the host ``mongodb1.example.net`` and
authenticating using the username ``user`` and the password
``pass``, as follows:

.. code-block:: sh

   mongodump --host mongodb1.example.net --port 37017 --username user --password pass --out /opt/backup/mongodump-2011-10-24
