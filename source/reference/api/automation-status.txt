=================
Automation Status
=================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. include:: /includes/fact-groups-projects-synonyms.rst

Overview
--------

The Public API provides the ``automationStatus`` endpoint to let you see
whether each MongoDB process is up-to-date with the current
:doc:`automation configuration </reference/cluster-configuration>`. The
endpoint returns the ``goalVersion`` field to report the current version
of the automation configuration and the ``lastGoalVersionAchieved`` fields to
report the versions of the configuration running on each server.

.. include:: /includes/api/base-api-uri.rst

Resource
--------

.. code-block:: http

   GET /groups/GROUP-ID/automationStatus

Request Parameters
------------------

Request Path Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :widths: 20 20 60
   :header-rows: 1
   :stub-columns: 1

   * - Parameter
     - Type
     - Description

   * - GROUP-ID
     - string
     - *(Required.)* The unique identifier for the group.

Request Query Parameters
~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/api/no-query-single-parameters.rst

Request Body Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/api/no-body-parameters.rst

Response
--------

.. list-table::
   :widths: 20 10 80
   :header-rows: 1

   * - Name
     - Type
     - Description
   * - goalVersion
     - number
     - The version of the most recently submitted :ref:`automation
       configuration <automation-configuration-sample-entity>`. If there is a
       :ref:`conflict in submissions of automation configurations
       <concurrent-cluster-config>`, this field lists the winning
       configuration.
   * - processes
     - array
     - The group's deployed MongoDB instances.
   * - processes.hostname
     - string
     - The fully qualified domain name (retrieved by issuing ``hostname -f``)
       of the server on which the MongoDB process and {+aagent+} are
       hosted.
   * - processes.name
     - string
     - The process name as specified in the automation configuration.
   * - processes.lastGoalVersionAchieved
     - number
     - The last version of the automation configuration with which this
       process had deployed as configured. If the ``processes.lastGoalVersionAchieved``
       number is not equal to the ``goalVersion`` number, the process has
       not yet deployed according to the current configuration.
   * - processes.plan
     - array
     - Describes how a process that is not yet up-to-date with the
       configuration will achieve the goal state.

Example Request
---------------

.. only:: cloud

   .. cssclass:: copyable-code
   .. code-block:: sh

     curl --user '{PUBLIC-KEY}:{PRIVATE-KEY}' --digest \
      --header 'Accept: application/json' \
      --include \
      --request GET -i "https://cloud.mongodb.com/api/public/v1.0/groups/{PROJECT-ID}/automationStatus"

.. only:: onprem

   .. cssclass:: copyable-code
   .. code-block:: sh

     curl --user '{PUBLIC-KEY}:{PRIVATE-KEY}' --digest \
      --header 'Accept: application/json' \
      --include \
      --request GET "https://{opsManagerHost}:{port}/api/public/v1.0/groups/{PROJECT-ID}/automationStatus"

Example Response
~~~~~~~~~~~~~~~~

Response Header
+++++++++++++++

.. include:: /includes/api/api-headers/401.rst

.. include:: /includes/api/api-headers/200.rst

Response Body
+++++++++++++

.. code-block:: json

   {
     "processes": [
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_0_0",
         "hostname": "testDeploy-0"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_0_1",
         "hostname": "testDeploy-1"
       },
       {
         "plan": ["Download", "Start", "WaitRsInit"],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_0_2",
         "hostname": "testDeploy-2"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_1_3",
         "hostname": "testDeploy-3"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_1_4",
         "hostname": "testDeploy-4"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_1_5",
         "hostname": "testDeploy-5"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_config_6",
         "hostname": "testDeploy-6"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_config_7",
         "hostname": "testDeploy-7"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_config_8",
         "hostname": "testDeploy-8"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_mongos_9",
         "hostname": "testDeploy-9"
       }
     ],
     "goalVersion": 2
   }
