:orphan:

.. meta::
   :robots: noindex, nosnippet

.. _fts-reindexing-strategy-faq:

================================
FAQ: Upcoming |fts| 2022 Release
================================

What's New in This Release?
---------------------------

The upcoming |fts| release includes optimizations to your index 
storage. Additonally, this release will support the following 
capabilities:

- Statically index arrays of strings as 
  :ref:`bson-data-types-autocomplete` type. 
- Dynamically and statically index :ref:`bson-data-types-number`\s in 
  arrays.
- Dynamically and statically index :ref:`objectId-ref`\s and arrays of 
  :ref:`objectId-ref`\s.
- Dynamically and statically index :ref:`boolean-ref`\s and arrays of 
  :ref:`boolean-ref`\s. 

The preceding list of new capabilities could increase the size of your 
index on disk. Your |fts| query results could differ because |fts| 
might index fields and values that it didn't index before.

- When rolling out these changes, we will rebuild all your |fts| 
  indexes. You might notice an increase in index size on disk, CPU, and 
  disk utilization (|iops|) during reindexing, which could trigger 
  auto-scaling. While your new index builds, your old index will 
  continue to be available to serve your |fts| queries. 
- During reindexing, |fts| will use additional disk space that is  
  comparable to the two largest |fts| indexes on your cluster.

What Should I Do to Prepare for This Release?
---------------------------------------------

You can do the following to prepare for this release:

- :ref:`Set maintenance windows <project-settings>` to control the 
  timeline of this release. If set, the reindexing will start during 
  the specified maintenance window and might continue even after 
  the maintenance window.
- Review all your |fts| indexes to: 

  - Release or provision disk space to accommodate increases in the size 
    of your other indexes. We recommend that you provision disk space 
    equivalent to 125% of the size of your existing |fts| indexes on 
    your cluster. During reindexing, |fts| will use additional 
    disk space that is comparable to the two largest |fts| indexes on 
    your cluster.
  - Delete any unused |fts| indexes to avoid unnecessary 
    reindexing, which saves memory and CPU utilization.

- Evaluate all indexes with :ref:`dynamic mappings 
  <static-dynamic-mappings>`, especially on collections with field 
  values that are an array of numbers, and consider modifying the 
  indexes to use :ref:`static mappings <static-dynamic-mappings>` on 
  only the fields that need to be indexed to prevent :ref:`mapping 
  explosions <index-document-mapping-explosions>`.

  Ensure that you have :ref:`static mappings <static-dynamic-mappings>` 
  enabled for indexes on collections that contain geographical data. 
  GeoJSON format documents might contain arrays of many numerical 
  coordinates; thus, dynamically indexing GeoJSON format documents might 
  reduce indexing throughput and cause indexes to occupy more disk 
  space.
  
- :ref:`Monitor <review-atlas-search-metrics>` the following |fts| 
  metrics: 
  
  - **Search Index Size**, which will increase during index rebuild and 
    decrease after the index builds.
  - **Search Normalized Process CPU**, which will increase during index 
    rebuild and then return to pre-release levels.

If you have any questions or concerns, contact :ref:`support 
<request-support>`.
