.. _ak8so-changelog:

:noprevnext:

=================
|ak8so| Changelog
=================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. note::

   You can find the full list of |ak8so| releases `here
   <https://github.com/mongodb/mongodb-atlas-kubernetes/releases>`_.

.. _ak8so_141:

|ak8so| 1.4.1
-------------

New Features
~~~~~~~~~~~~

- Updates the minimum required `Openshift <https://docs.openshift.com/>`_ version to 4.8.

:ref:`atlasproject-custom-resource`:

- Adds support for 
  :ref:`custom database roles <ak8so-configure-custom-database-roles>` 
  via the :setting:`spec.customRoles` field.

.. _ak8so_140:

|ak8so| 1.4.0
-------------

New Features
~~~~~~~~~~~~

:ref:`atlasproject-custom-resource`:

- Adds support for audit logs. You can enable auditing with the 
  :setting:`spec.auditing.enabled` field. For more information about
  |ak8so| auditing, see :ref:`ak8so-configure-audit-logs`.
- Adds support for project settings via the :setting:`spec.settings` 
  field.
- Adds support for alert configurations via the 
  ``spec.alertConfigurations`` field.

:ref:`atlasdeployment-custom-resource`:

- Adds support for autoscaling of the ``instanceSize`` and 
  ``diskSizeGB`` parameters.

Fixes
~~~~~

- Fixes an issue where adding an IP address with CIDR block ``/32`` to 
  Network Access could leave the IP Access List inactive indefinitely.
- Fixes an issue where creating project integrations that require 
  namespace references could result in errors when the user provides
  a namespace other than the project namespace, or does not provide a
  namespace.

.. _ak8so_130:

|ak8so| 1.3.0
-------------

New Features
~~~~~~~~~~~~

:ref:`atlasproject-custom-resource`:

- Adds support for :ref:`network peering <ak8so-network-peering>` 
  via the :setting:`spec.networkPeers` field. 
- Adds support for :ref:`cloud provider access <ak8so-unified-access>` 
  via the :setting:`spec.cloudProviderAccessRoles` field.
- Adds support for :ref:`encryption at rest <ak8so-ear>` 
  via the :setting:`spec.encryptionAtRest` field.


:ref:`atlasdeployment-custom-resource`:

- Adds a test to ensure that deleting a 
  :k8sdocs:`CRD </tasks/extend-kubernetes/custom-resources/custom-resource-definitions/>`
  does not affect :ref:`atlasdeployment-custom-resource`\s with the 
  ``mongodb.com/atlas-resource-policy: "keep"`` annotation.

Fixes
~~~~~

- Fixes a resource reconciliation issue that occured when
  you delete an :ref:`atlasdeployment-custom-resource` 
  after the API key has expired.
- Fixes an issue where you could change the ``instanceSize`` and 
  ``diskSizeGB`` parameters for deployments with autoscaling enabled. 
  To change the ``instanceSize`` and ``diskSizeGB`` parameters, 
  you must first disable autoscaling.
- Fixes an error message that returns when |ak8so| can't delete a 
  project's backup policy or backup schedule.

.. _ak8so_120:

|ak8so| 1.2.0
-------------

New Features
~~~~~~~~~~~~

- Upgrades Go to 1.18.
- Adds support for Private Endpoints backwards sync to the
  :ref:`AtlasProject Custom Resource <atlasproject-custom-resource>`.

Fixes
~~~~~

- Fixes an issue where the :ref:`AtlasDeployment Custom Resource
  <atlasdeployment-custom-resource>` was not created successfully when
  the instance size for a deployed resource changed from M10 to M40.
- Fixes an issue where creating an :ref:`AtlasDeployment Custom Resource
  <atlasdeployment-custom-resource>` with ``advancedDeploymentSpec`` failed
  with ``autoscaling.diskGBEnabled`` and adds a new ``AdvancedAutoScalingSpec``
  struct to ``AdvancedDeploymentSpecChanges``.
- Fixes an issue where you could decrease ``diskSizeGB`` for deployments
  with autoscaling enabled. To change the ``diskSizeGB`` parameter, you
  must first disable autoscaling.
- Fixes a resource reconciliation issue where the |service| API returns
  an empty object for scheduled backups.

.. _ak8so_110:

|ak8so| 1.1.0
-------------

New Features
~~~~~~~~~~~~

- Adds support for :setting:`maintenance windows 
  <spec.maintenanceWindow>`.

Fixes
~~~~~

- Fixes an issue where private endpoint connection strings were missing
  from |k8s| secrets.
- Fixes an issue where |ak8so| didn't remove conditions for unused
  resources.
- Adds missing private endpoint fields to Pod conditions.

.. _ak8so-100:

|ak8so| 1.0.0
-------------

Breaking Changes
~~~~~~~~~~~~~~~~

- Renames the ``AtlasCluster`` Custom Resource to the 
  :ref:`atlasdeployment-custom-resource`.
- Renames ``spec.clusterSpec`` to :setting:`spec.deploymentSpec`.
- Renames ``spec.advancedClusterSpec`` to 
  :setting:`spec.advancedDeploymentSpec`.

New Features
~~~~~~~~~~~~

- Adds log levels and JSON log output for |ak8so|. To change the 
  log level, you can provide the 
  ``—log-level=debug | info | warn | error | dpanic | panic | fatal`` 
  flag. To change the output format, you can provide the 
  ``—log-encoder=json | console`` flag.

:ref:`atlasproject-custom-resource`:

- Supports :ref:`third-party integrations 
  <ak8so-integrate-third-party>` including 
  :ref:`Prometheus integrations <prometheus-example>`.
- Supports :ref:`GCP private endpoints <ak8so-private-endpoint>`.

:ref:`atlasdeployment-custom-resource`:

- Supports :ref:`{+serverless-instances+} <ak8so-serverless-instance>` 
  via the :setting:`spec.serverlessSpec` field.
- Supports :ref:`scheduled backups <ak8so-backup>` for 
  {+database-deployments+}.
- Supports upgrading ``M0``, ``M2``, and ``M5`` {+clusters+} to 
  ``M10+`` {+clusters+} via the 
  :setting:`spec.deploymentSpec.providerSettings.instanceSizeName` 
  parameter.
- Supports :ref:`advanced options <ak8so-advanced-options>` via the 
  :setting:`spec.processArgs` object.
- Supports omitting the 
  :setting:`spec.deploymentSpec.providerSettings.providerName` field for
  ``M0``, ``M2``, and ``M5`` {+clusters+}.
- Supports omitting the 
  :setting:`spec.serverlessSpec.providerSettings.providerName` field for
  {+serverless-instances+}.

Fixes
~~~~~

- Fixes a bug where you couldn't delete the 
  :ref:`atlasproject-custom-resource` if the credentials secret was 
  deleted.
- Resolves missing epoch timestamps in log messages.
- Fixes a bug with the incorrect user-agent version.
- Fixes an `improper signature verification <https://security.snyk.io/vuln/SNYK-GOLANG-GOLANGORGXCRYPTOSSH-551923>`_ with the 
  ``golang.org/x/crypto/ssh`` module.

.. _ak8so-080:

|ak8so| 0.8.0
-------------

Changes
~~~~~~~

- Upgrades the Controller Runtime to v0.11.0.
- Upgrades Go to 1.17.
- When you :ref:`install a cluster using Helm Charts 
  <ak8so-quick-start-helm-ref>`, Helm doesn't exit until the cluster is 
  ready if you set ``postInstallHook.enabled`` to true.
- |ak8so| :ref:`watches secrets <ak8so-secrets>` only with the label 
  ``atlas.mongodb.com/type=credentials`` to avoid watching unnecessary 
  |k8s-secrets|.
- Supports the
  ``mongodb.com/atlas-reconciliation-policy=skip`` annotation for 
  configuring |ak8so| to skip reconciliations on
  :ref:`specific resources <custom-resources>`.
- Supports :ref:`X.509 authentication <ak8so-x509>`.

Bug Fixes
~~~~~~~~~

- Fixes an issue that logged errors for resource deletion.

``AtlasProject`` Custom Resource
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Changes
+++++++

- |ak8so| no longer marks the :ref:`atlasproject-custom-resource` as 
  ready until the :ref:`project IP access is successfully created 
  <ak8so-access-to-atlas-ref>`.

``AtlasCluster`` Custom Resource
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Changes
+++++++

- Adds the ``spec.advancedClusterSpec`` parameter to the 
  :ref:`AtlasCluster <atlasdeployment-custom-resource>` custom 
  resource. The ``AtlasCluster`` custom 
  resource now has two main configuration options. You must specify 
  either ``spec.clusterSpec`` or ``spec.advancedClusterSpec``. 
  The ``spec.clusterSpec`` parameter uses the
  :oas-atlas-tag:`Atlas Cluster API Resource </Clusters>`. The 
  ``spec.advancedClusterSpec`` parameter uses the
  :oas-atlas-tag:`Atlas Advanced Cluster API Resource </Clusters>`.

  .. note::
   
     To migrate an existing resource to use the ``spec.clusterSpec`` 
     structure, you must move all fields currently under ``spec.*`` to 
     ``spec.clusterSpec.*`` with the exception of ``spec.projectRef``.

*You can find the images in the following location:*
 
`<https://quay.io/repository/mongodb/mongodb-atlas-operator>`_

.. _ak8so-050:

|ak8so| 0.5.0
-------------

This |ak8so| trial release lets you manage |service| projects, 
clusters, and database users with |k8s| specifications.

Changes
~~~~~~~

- Introduces ``Global`` and ``per project`` |service| authentication 
  modes. To learn more, see :ref:`ak8so-access-to-atlas-ref`.
- Supports installing |ak8so| clusterwide (all the |k8s-nss| in the 
  |k8s| cluster) or to its own namespace. To learn more, see 
  :ref:`ak8so-quick-start-ref`.
- Introduces the :ref:`atlasproject-custom-resource`. Use this resource 
  to create |service| projects and configure their 
  :ref:`IP access lists <add-to-access-list>`.
- Introduces the :ref:`AtlasCluster <atlasdeployment-custom-resource>` 
  custom resource. Use this resource to create clusters in an |service| 
  project. 
- Introduces the :ref:`atlasdatabaseuser-custom-resource` for creating 
  database users in an |service| project. 
- Allows you to create or update |k8s-secrets| for each database user 
  and cluster. Applications can use these secrets in |k8s| to connect 
  to |service| clusters.
