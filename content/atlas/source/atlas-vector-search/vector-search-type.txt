.. facet::
   :name: programming_language
   :values: javascript/typescript, python, shell, go, java, csharp

.. _avs-types-vector-search: 

=====================================
How to Index Fields for Vector Search 
=====================================

.. default-domain:: mongodb

.. meta::
   :description: Use the MongoDB Vector Search type to index vector embeddings for vector search using the vectorSearch type.
   :keywords: atlas ui, node.js, code example, atlas api, atlas cli, java sync, go, python, mongodb shell, sample dataset

.. dismissible-skills-card::
   :skill: Vector Search Fundamentals
   :url: https://learn.mongodb.com/skills?openTab=gen%20ai

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. composable-tutorial::
   :options: deployment-type, embedding, interface, language
   :defaults: atlas, byo, driver, python

   .. selected-content::
      :selections: atlas, byo, None, None

      .. include:: /includes/avs/index/introduction.rst
      .. include:: /includes/avs/index/considerations.rst

   .. selected-content::
      :selections: self, byo, None, None

      .. include:: /includes/avs/index/introduction.rst

   .. selected-content::
      :selections: self, auto, None, None

      .. important:: 

         Automated Embeddings is available as a Preview feature. The
         feature and the corresponding documentation might change at any
         time during the Preview period. Do not use this feature in your 
         production environment. To learn more, see `Preview
         Features <https://www.mongodb.com/docs/preview-features/>`__. 

      .. include:: /includes/avs/index/introduction-auto-embed.rst

   .. _avs-types-vector-search-considerations:

   Considerations 
   --------------

   .. selected-content::
      :selections: atlas, byo, None, None

      .. include:: /includes/avs/index/considerations.rst

   .. selected-content::
      :selections: self, byo, None, None

      .. include:: /includes/avs/index/considerations-self-managed.rst

   .. selected-content::
      :selections: self, auto, None, None

      .. include:: /includes/avs/index/considerations-auto-embed.rst

   .. _avs-index-definition:

   Syntax 
   ------

   .. selected-content::
      :selections: atlas, byo, None, None

      The following syntax defines the ``vector`` type:

      .. literalinclude:: /includes/avs/index/syntax.js
         :language: javascript
         :copyable: true 
         :linenos:

   .. selected-content::
      :selections: self, byo, None, None

      The following syntax defines the ``vector`` type:

      .. literalinclude:: /includes/avs/index/syntax.js
         :language: javascript
         :copyable: true 
         :linenos:

   .. selected-content::
      :selections: self, auto, None, None

      The following syntax defines the ``autoEmbed`` type:

      .. literalinclude:: /includes/avs/index/syntax-auto-embed.js
         :language: javascript
         :copyable: true 
         :linenos:

   .. _avs-types-vector-search-options:

   {+avs+} Index Fields
   ----------------------------------

   .. selected-content::
      :selections: atlas, byo, None, None

      The {+avs+} index definition takes the following fields: 

      .. |similarity-functions-link| replace:: :ref:`avs-similarity-functions`
      .. |avs-types-vector-link| replace:: :ref:`avs-types-vector`

      .. include:: /includes/avs/index/list-table-fields.rst

   .. selected-content::
      :selections: self, byo, None, None

      The {+avs+} index definition takes the following fields: 

      .. |similarity-functions-link| replace:: :ref:`mdb-vs-similarity-functions`
      .. |avs-types-vector-link| replace:: :ref:`mdb-vs-types-vector`

      .. include:: /includes/avs/index/list-table-fields.rst

   .. selected-content::
      :selections: self, auto, None, None

      The {+avs+} index definition takes the following fields: 

      .. include:: /includes/avs/index/list-table-fields-auto-embed.rst

   .. selected-content::
      :selections: atlas, byo, None, None

      .. _avs-types-vector:

      About the ``vector`` Type
      ~~~~~~~~~~~~~~~~~~~~~~~~~

      .. include:: /includes/avs/index/about-vector-type.rst

      .. _avs-similarity-functions:

      About the Similarity Functions 
      ``````````````````````````````

      .. include:: /includes/avs/index/about-similarity-functions.rst

   .. selected-content::
      :selections: self, byo, None, None

      .. _mdb-vs-types-vector:

      About the ``vector`` Type
      ~~~~~~~~~~~~~~~~~~~~~~~~~

      .. include:: /includes/avs/index/about-vector-type.rst

      .. _mdb-vs-similarity-functions:

      About the Similarity Functions 
      ``````````````````````````````

      .. include:: /includes/avs/index/about-similarity-functions.rst

   .. selected-content::
      :selections: self, auto, None, None

      .. _avs-types-auto-embed:

      About the ``autoEmbed`` Type
      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      Your index definition's ``autoEmbed`` field must contain only text. When 
      configuring fields for Automated Embedding, the following limitations 
      apply: 

      - You can't configure both ``vector`` and ``autoEmbed`` type fields in 
        the same index definition. {+avs+} throws an exception if you 
        define fields of both types in the same index.
      - You must use the same embedding model for all the ``autoEmbed`` type 
        fields in the same index. {+avs+} throws an exception if you specify 
        multiple models in the same index.
      - After {+avs+} creates the index, you can't edit or delete ``autoEmbed`` 
        type fields in the index.

   .. _avs-types-filter:

   About the ``filter`` Type 
   ~~~~~~~~~~~~~~~~~~~~~~~~~

   .. selected-content::
      :selections: atlas, byo, None, None

      .. include:: /includes/avs/index/about-filter-type.rst

   .. selected-content::
      :selections: self, byo, None, None

      .. include:: /includes/avs/index/about-filter-type.rst

   .. selected-content::
      :selections: self, auto, None, None

      .. include:: /includes/avs/index/about-auto-embed-filter-type.rst

   .. _avs-index-supported-drivers:

   Supported Clients 
   -----------------

   .. selected-content::
      :selections: atlas, byo, None, None

      You can create and manage {+avs+} indexes through the {+atlas-ui+},
      {+mongosh+}, {+atlas-cli+}, {+atlas-admin-api+}, and the following 
      :driver:`MongoDB Drivers </>`:

      .. include:: /includes/avs/list-table-index-supported-drivers-avs.rst

   .. selected-content::
      :selections: self, byo, None, None

      You can create and manage {+avs+} indexes through the {+mongosh+},
      |compass|, and the following :driver:`MongoDB Drivers </>`:

      .. include:: /includes/avs/list-table-index-supported-drivers-avs.rst

   .. selected-content::
      :selections: self, auto, None, None

      You can create and manage {+avs+} indexes through the {+mongosh+},
      |compass|, and the following :driver:`MongoDB Drivers </>`:

      .. include:: /includes/avs/index/list-table-drivers-auto-embed.rst

   .. _avs-create-index:

   Create a {+avs+} Index
   --------------------------------------

   .. selected-content::
      :selections: atlas, byo, None, None   

      You can create a {+avs+} index for all collections that contain vector
      embeddings less than or equal to 8192 dimensions in length for any kind
      of data along with other data on your {+cluster+} through the
      {+atlas-ui+}, {+atlas-admin-api+}, {+atlas-cli+}, {+mongosh+},
      or a supported :driver:`MongoDB Driver </>`.

      .. _avs-create-index-prerequisites:

      Prerequisites
      ~~~~~~~~~~~~~

      To create a {+avs+} index, you must have a cluster with
      the following prerequisites: 

      - MongoDB version ``6.0.11``, ``7.0.2``, or higher
      - A collection for which to create the {+avs+} index 

      .. |command-type| replace:: create
      .. |compatibility-table| replace:: :ref:`avs-index-supported-drivers`
      .. |search-type| replace:: {+avs+}

      .. include:: /includes/search-shared/fact-search-commands-cluster-tier.rst
   
   .. selected-content::
      :selections: self, byo, None, None   

      You can create a {+avs+} index for all collections that contain vector
      embeddings less than or equal to 8192 dimensions in length for any kind
      of data along with other data on your {+cluster+} through {+mongosh+},
      |compass|, or a supported :driver:`MongoDB Driver </>`.

   .. selected-content::
      :selections: self, auto, None, None   

      The following procedure walks through the steps for enabling
      Automated Embedding in your {+avs+} index. If you loaded the 
      ``sample_mflix`` dataset, the example in the procedure
      demonstrates how to enable Automated Embedding for the
      ``fullplot`` field in the ``movies`` collection. 

   .. _avs-create-index-access:

   Required Access
   ~~~~~~~~~~~~~~~

   .. selected-content::
      :selections: atlas, byo, None, None  

      You need the :authrole:`Project Data Access Admin` or higher role to create
      and manage {+avs+} indexes.
      
      .. include:: /includes/avs/index/limitations.rst

   .. selected-content::
      :selections: self, auto, None, None  

      You need :authrole:`readWrite` or higher role to create 
      and manage {+avs+} indexes.

   .. _avs-create-index-procedure:

   Procedure 
   ~~~~~~~~~

   .. selected-content::
      :selections: atlas, byo, atlas-ui, None   

      .. include:: /includes/avs/note-create-avs-index-procedure.rst

      .. include:: /includes/avs/index-examples/steps-avs-create-index-atlas-ui.rst

   .. selected-content::
      :selections: atlas, byo, atlas-admin-api, None

      To create a {+avs+} index for a collection using the
      {+atlas-admin-api+}, send a ``POST`` request to the |fts|
      ``indexes`` endpoint with the required parameters. 
          
      .. literalinclude:: /includes/avs/index-management/create-index/create-index-api.sh 
         :language: shell
         :copyable:
         :linenos:
          
      To learn more about the syntax and parameters for the endpoint, see
      :oas-bump-atlas-op:`Create One {+fts+} Index <creategroupclustersearchindex>`.  
          
      .. example:: 

        .. include:: /includes/avs/tutorial/avs-voyageai-index-description.rst

        .. tabs:: 

           .. tab:: Basic Example
             :tabid: basic

             The following index definition indexes only the vector
             embeddings field for performing vector search.
                      
             .. literalinclude:: /includes/avs/index-management/create-index/basic-example-api.sh 
                :language: shell
                :copyable:
                :linenos:

           .. tab:: Filter Example 
             :tabid: advanced

             This index definition indexes the following fields: 
            
             - A string field (``genres``) and a numeric field (``year``)
               for pre-filtering the data. 
             - The vector embeddings field (``plot_embedding_voyage_3_large``) for
               performing vector search against pre-filtered data.

             .. literalinclude:: /includes/avs/index-management/create-index/filter-example-api.sh 
                :language: shell
                :copyable:
                :linenos:

   .. selected-content::
      :selections: atlas, byo, atlas-cli, None

      To create a {+avs+} index for a collection using the
      {+atlas-cli+} v1.14.3 or later, perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-avs-create-index-acli.rst

   .. selected-content::
      :selections: atlas, byo, mongosh, None

      To create a {+avs+} index for a collection using {+mongosh+}
      v2.1.2 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-mongosh.rst          

      To create a {+avs+} index for a collection using {+mongosh+}
      v2.1.2 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-mongosh.rst

   .. selected-content::
      :selections: atlas, byo, driver, csharp

      To create a {+avs+} index for a collection using the
      :driver:`C# </csharp/current/fundamentals/indexes/#atlas-search-indexes>`
      driver v3.6.0 or later, perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-avs-create-index-csharp.rst

   .. selected-content::
      :selections: atlas, byo, driver, go

      To create a {+avs+} index for a collection using the
      :driver:`MongoDB Go driver </go/current/fundamentals/indexes/>` 
      v2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-go.rst

   .. selected-content::
      :selections: atlas, byo, driver, java-sync

      To create a {+avs+} index for a collection using the
      :driver:`MongoDB Java driver </java/sync/current/fundamentals/indexes/>`
      v5.2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-java.rst

   .. selected-content::
      :selections: atlas, byo, driver, nodejs

      To create a {+avs+} index for a collection using the
      :driver:`MongoDB Node driver </node/current/fundamentals/indexes/>`
      v6.6.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-nodejs.rst

   .. selected-content::
      :selections: atlas, byo, driver, python

      To create {+avs+} indexes for a collection using `PyMongo
      <https://www.mongodb.com/docs/languages/python/pymongo-driver/current/indexes/atlas-search-index/>`__ 
      driver v4.7 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-pymongo.rst        

   .. selected-content::
      :selections: self, byo, mongosh, None

      To create a {+avs+} index for a collection using {+mongosh+}
      v2.1.2 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-mongosh.rst          

      To create a {+avs+} index for a collection using {+mongosh+}
      v2.1.2 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-mongosh.rst

   .. selected-content::
      :selections: self, byo, driver, csharp

      To create a {+avs+} index for a collection using the
      :driver:`C# </csharp/current/fundamentals/indexes/#atlas-search-indexes>`
      driver v3.1.0 or later, perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-avs-create-index-csharp.rst

   .. selected-content::
      :selections: self, byo, driver, go

      To create a {+avs+} index for a collection using the
      :driver:`MongoDB Go driver </go/current/fundamentals/indexes/>` 
      v2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-go.rst

   .. selected-content::
      :selections: self, byo, driver, java-sync

      To create a {+avs+} index for a collection using the
      :driver:`MongoDB Java driver </java/sync/current/fundamentals/indexes/>`
      v5.2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-java.rst

   .. selected-content::
      :selections: self, byo, driver, nodejs

      To create a {+avs+} index for a collection using the
      :driver:`MongoDB Node driver </node/current/fundamentals/indexes/>`
      v6.6.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-nodejs.rst

   .. selected-content::
      :selections: self, byo, driver, python

      To create {+avs+} indexes for a collection using `PyMongo
      <https://www.mongodb.com/docs/languages/python/pymongo-driver/current/indexes/atlas-search-index/>`__ 
      driver v4.7 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-create-index-pymongo.rst

   .. selected-content::
      :selections: self, auto, mongosh, None     

      To create a {+avs+} index for a collection using {+mongosh+},
      perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-create-auto-embed-mongosh.rst

   .. selected-content::
      :selections: self, auto, driver, nodejs

      To create a {+avs+} index for a collection using {+mongosh+},
      perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-create-auto-embed-nodejs.rst

   .. selected-content::
      :selections: self, auto, driver, python 

      To create a {+avs+} index for a collection using {+mongosh+},
      perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-create-auto-embed-py.rst

   .. _avs-view-index:

   View a {+avs+} Index
   ------------------------------------

   .. selected-content::
      :selections: atlas, byo, atlas-ui, None

      You can view {+avs+} indexes for all collections from the
      {+atlas-ui+}, {+atlas-admin-api+}, {+atlas-cli+}, {+mongosh+},
      or a supported :driver:`MongoDB Driver </>`.

   .. _avs-view-index-access:

   Required Access
   ~~~~~~~~~~~~~~~

   You need the :authrole:`Project Search Index Editor` or higher role to view
   {+avs+} indexes. 

   .. selected-content::
      :selections: atlas, byo, None, None

      .. |command-type| replace:: retrieve
      .. |search-type| replace:: {+avs+}

      .. include:: /includes/search-shared/fact-search-commands-cluster-tier.rst

   .. selected-content::
      :selections: self, auto, None, None  

      You need :authrole:`readWrite` or higher role to view {+avs+} indexes.

   .. _avs-view-index-procedure:

   Procedure
   ~~~~~~~~~

   .. selected-content::
      :selections: atlas, byo, atlas-ui, None

      .. include:: /includes/avs/index-examples/steps-avs-view-index-atlas-ui.rst

      The page displays the following details for the indexes on the page: 

      .. list-table:: 
        :stub-columns: 1 
        :widths: 20 80

        * - Name 
          - Label that identifies the index. 

        * - Index Type
          - Label that indicates a |fts| or {+avs+} index. Values
            include:  
        
            - ``search`` for |fts| indexes.
            - ``vectorSearch`` for {+avs+} indexes.

        * - Index Fields
          - List that contains the fields that this index indexes.

        * - Status
          - Current state of the index on the primary node of the
            {+cluster+}. For valid values, see
            :ref:`avs-node-status-ref`. 

        * - Size
          - Size of the index on the primary node.

        * - Documents 
          - Number of indexed documents out of the total number of
            documents in the collection.

        * - Required Memory
          - Approximate amount of memory required to run 
            vector search queries.

        * - Actions 
          - Actions that you can take on the index. You can:
        
            - :ref:`avs-edit-index`
            - :ref:`avs-delete-index`

            You can't run queries in the :guilabel:`Search Tester` UI
            against indexes of the ``vectorSearch`` type. If you click the
            :guilabel:`Query` button, {+avs+} displays a sample
            :pipeline:`$vectorSearch` that you can copy, modify, and run
            in {+atlas-ui+} and using other
            :ref:`supported clients <vectorSearch-agg-pipeline-clients>`. 

   .. selected-content::
      :selections: atlas, byo, atlas-admin-api, None

      To retrieve all the {+avs+} indexes for a collection using the
      {+atlas-admin-api+}, send a ``GET`` request to the |fts|
      ``indexes`` endpoint with the name of the database and collection. 

      .. literalinclude:: /includes/avs/index-management/return-index/get-indexes-api.sh
        :language: shell
        :copyable:
        :linenos:

      To learn more about the syntax and parameters for the endpoint,
      see :oas-bump-atlas-op:`Return All {+fts+} Indexes for One
      Collection <listgroupclustersearchindexes>`.

      To retrieve one {+avs+} index for a collection using the
      {+atlas-admin-api+}, send a ``GET`` request to the |fts|
      ``indexes`` endpoint with either the unique ID or name of the
      index (line 4) to retrieve. 
          
      .. literalinclude:: /includes/avs/index-management/return-index/get-index-api.sh
        :language: shell
        :copyable:
        :linenos:

      To learn more about the syntax and parameters for the endpoint, 
      :oas-bump-atlas-op:`Get One By Name <getgroupclustersearchindexbyname>` and
      :oas-bump-atlas-op:`Get One By ID <getgroupclustersearchindex>`.

   .. selected-content::
      :selections: atlas, byo, atlas-cli, None

      To return {+avs+} indexes for a collection using {+atlas-cli+},
      perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-avs-view-index-acli.rst

   .. selected-content::
      :selections: atlas, byo, mongosh, None

      To view a {+avs+} index for a collection using {+mongosh+},
      perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-mongosh.rst         

   .. selected-content::
      :selections: atlas, byo, driver, csharp

      To view {+avs+} indexes for a collection using
      :driver:`C# </csharp/current/fundamentals/indexes/#list-search-indexes>`
      driver 3.1.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-csharp.rst

   .. selected-content::
      :selections: atlas, byo, driver, go

      To view a {+avs+} index for a collection using 
      :driver:`MongoDB Go driver </go/current/fundamentals/indexes/>` 
      v2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-go.rst

   .. selected-content::
      :selections: atlas, byo, driver, java-sync  

      To view a {+avs+} index for a collection using the
      :driver:`MongoDB Java driver </java/sync/current/fundamentals/indexes/>`
      v5.2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-java.rst

   .. selected-content::
      :selections: atlas, byo, driver, nodejs

      To view a {+avs+} index for a collection using 
      :driver:`MongoDB Node driver </node/current/fundamentals/indexes/>` 
      v6.6.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-nodejs.rst

   .. selected-content::
      :selections: atlas, byo, driver, python

      .. cta-banner::
        :url: https://github.com/mongodb/docs-notebooks/blob/main/manage-indexes/view-indexes.ipynb
        :icon: Code

        Work with a runnable version of this example as a :github:`Python notebook
        <mongodb/docs-notebooks/blob/main/manage-indexes/view-indexes.ipynb>`. 

      To view {+avs+} indexes for a collection using `PyMongo 
      <https://www.mongodb.com/docs/languages/python/pymongo-driver/current/indexes/atlas-search-index/>`__ 
      driver v4.7 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-pymongo.rst

   .. selected-content::
      :selections: self, byo, mongosh, None

      To view a {+avs+} index for a collection using {+mongosh+},
      perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-mongosh.rst

   .. selected-content::
      :selections: self, byo, driver, csharp

      To view {+avs+} indexes for a collection using
      :driver:`C# </csharp/current/fundamentals/indexes/#list-search-indexes>`
      driver 3.1.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-csharp.rst

   .. selected-content::
      :selections: self, byo, driver, go

      To view a {+avs+} index for a collection using 
      :driver:`MongoDB Go driver </go/current/fundamentals/indexes/>` 
      v2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-go.rst

   .. selected-content::
      :selections: self, byo, driver, java-sync  

      To view a {+avs+} index for a collection using the
      :driver:`MongoDB Java driver </java/sync/current/fundamentals/indexes/>`
      v5.2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-java.rst

   .. selected-content::
      :selections: self, byo, driver, nodejs

      To view a {+avs+} index for a collection using 
      :driver:`MongoDB Node driver </node/current/fundamentals/indexes/>` 
      v6.6.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-nodejs.rst

   .. selected-content::
      :selections: self, byo, driver, python

      .. cta-banner::
        :url: https://github.com/mongodb/docs-notebooks/blob/main/manage-indexes/view-indexes.ipynb
        :icon: Code

        Work with a runnable version of this example as a :github:`Python notebook
        <mongodb/docs-notebooks/blob/main/manage-indexes/view-indexes.ipynb>`. 

      To view {+avs+} indexes for a collection using `PyMongo
      <https://www.mongodb.com/docs/languages/python/pymongo-driver/current/indexes/atlas-search-index/>`__ 
      driver v4.7 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-pymongo.rst

   .. selected-content::
      :selections: self, auto, mongosh, None

      To view a {+avs+} index for a collection using {+mongosh+},
      perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-view-index-mongosh.rst

   .. selected-content::
      :selections: self, auto, driver, nodejs

      .. include:: /includes/avs/index-examples/steps-avs-view-index-nodejs.rst

   .. selected-content::
      :selections: self, auto, driver, python

      .. include:: /includes/avs/index-examples/steps-view-auto-embed-py.rst

   .. _avs-edit-index:

   Edit a {+avs+} Index
   -----------------------------------

   .. selected-content::
      :selections: atlas, byo, atlas-ui, None

      You can change the :ref:`index definition <avs-types-vector-search>`
      of an existing {+avs+} index from the {+atlas-ui+}, {+atlas-admin-api+}, 
      {+atlas-cli+}, {+mongosh+}, or a supported :driver:`MongoDB Driver </>`. 
      You can't rename an index or change the index type. If you need to
      change an index name or type, you must create a new index and delete the 
      old one.

      .. important::

      After you edit an index, {+avs+} rebuilds it. 
      While the index rebuilds, you can continue to run vector 
      search queries by using the old index definition. 
      When the index finishes rebuilding, the old index is automatically 
      replaced. This process is similar to |fts| indexes. To learn more,
      see :ref:`index-create-and-update`. 

   Required Access 
   ~~~~~~~~~~~~~~~

   .. selected-content::
      :selections: atlas, byo, None, None  

      You need the :authrole:`Project Data Access Admin` or higher role to
      edit {+avs+} indexes. 

   .. selected-content::
      :selections: self, auto, None, None  

      You need :authrole:`readWrite` or higher role to edit {+avs+} indexes.

   .. _avs-edit-index-procedure:

   Procedure
   ~~~~~~~~~

   .. selected-content::
      :selections: atlas, byo, atlas-ui, None

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-atlas-ui.rst

   .. selected-content::
      :selections: atlas, byo, atlas-admin-api, None

      To edit a {+avs+} index for a collection using the
      {+atlas-admin-api+}, send a ``PATCH`` request to the |fts|
      ``indexes`` endpoint with either the unique ID or name of the
      index (line 4) to edit. 

      .. literalinclude:: /includes/avs/index-management/update-index/edit-index-api.sh 
        :language: shell
        :copyable:
        :linenos:
          
      To learn more about the syntax and parameters for the endpoints, see
      :oas-bump-atlas-op:`Update One By Name <updategroupclustersearchindexbyname>` and
      :oas-bump-atlas-op:`Update One By ID <updategroupclustersearchindex>`.

   .. selected-content::
      :selections: atlas, byo, atlas-cli, None

      To edit a {+avs+} index for a collection using {+atlas-cli+},
      perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-acli.rst 

   .. selected-content::
      :selections: atlas, byo, mongosh, None

      To edit a {+avs+} index for a collection using {+mongosh+},
      perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-mongosh.rst 

   .. selected-content::
      :selections: atlas, byo, driver, csharp

      To update a {+avs+} index for a collection using the
      :driver:`C# </csharp/current/fundamentals/indexes/#update-a-search-index>`
      driver 3.1.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-csharp.rst

   .. selected-content::
      :selections: atlas, byo, driver, go

      To update a {+avs+} index for a collection using the
      :driver:`MongoDB Go driver </go/current/fundamentals/indexes/>`
      v2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-go.rst

   .. selected-content::
      :selections: atlas, byo, driver, java-sync

      To edit a {+avs+} index for a collection using the
      :driver:`MongoDB Java driver </java/sync/current/fundamentals/indexes/>`
      v5.2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-java.rst

   .. selected-content::
      :selections: atlas, byo, driver, nodejs

      To update a {+avs+} index for a collection using the
      :driver:`MongoDB Node driver </node/current/fundamentals/indexes/>` 
      v6.6.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-nodejs.rst

   .. selected-content::
      :selections: atlas, byo, driver, python

      .. cta-banner::
        :url: https://github.com/mongodb/docs-notebooks/blob/main/manage-indexes/edit-indexes.ipynb
        :icon: Code

        Work with a runnable version of this example as a :github:`Python notebook 
        <mongodb/docs-notebooks/blob/main/manage-indexes/edit-indexes.ipynb>`.

      To update a {+avs+} index for a collection using the `PyMongo
      <https://www.mongodb.com/docs/languages/python/pymongo-driver/current/indexes/atlas-search-index/>`__ 
      driver v4.7 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-pymongo.rst

   .. selected-content::
      :selections: self, byo, mongosh, None

      To edit a {+avs+} index for a collection using {+mongosh+},
      perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-mongosh.rst 

   .. selected-content::
      :selections: self, byo, driver, csharp

      To update a {+avs+} index for a collection using the
      :driver:`C# </csharp/current/fundamentals/indexes/#update-a-search-index>`
      driver 3.1.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-csharp.rst

   .. selected-content::
      :selections: self, byo, driver, go

      To update a {+avs+} index for a collection using the
      :driver:`MongoDB Go driver </go/current/fundamentals/indexes/>`
      v2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-go.rst

   .. selected-content::
      :selections: self, byo, driver, java-sync

      To edit a {+avs+} index for a collection using the
      :driver:`MongoDB Java driver </java/sync/current/fundamentals/indexes/>`
      v5.2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-java.rst

   .. selected-content::
      :selections: self, byo, driver, nodejs

      To update a {+avs+} index for a collection using the
      :driver:`MongoDB Node driver </node/current/fundamentals/indexes/>` 
      v6.6.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-nodejs.rst

   .. selected-content::
      :selections: self, byo, driver, python

      .. cta-banner::
        :url: https://github.com/mongodb/docs-notebooks/blob/main/manage-indexes/edit-indexes.ipynb
        :icon: Code

        Work with a runnable version of this example as a :github:`Python notebook
        <mongodb/docs-notebooks/blob/main/manage-indexes/edit-indexes.ipynb>`. 

      To update a {+avs+} index for a collection using the `PyMongo
      <https://www.mongodb.com/docs/languages/python/pymongo-driver/current/indexes/atlas-search-index/>`__ 
      driver v4.7 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-edit-index-pymongo.rst

   .. selected-content::
      :selections: self, auto, mongosh, None

      To view a {+avs+} index for a collection using {+mongosh+},
      perform the following steps:

      .. include:: /includes/avs/index-examples/steps-edit-auto-embed-mongosh.rst

   .. selected-content::
      :selections: self, auto, driver, nodejs

      .. include:: /includes/avs/index-examples/steps-edit-auto-embed-nodejs.rst

   .. selected-content::
      :selections: self, auto, driver, python

      .. include:: /includes/avs/index-examples/steps-edit-auto-embed-py.rst

   .. _avs-delete-index:

   Delete a {+avs+} Index
   --------------------------------------

   .. selected-content::
      :selections: atlas, byo, atlas-ui, None

      You can delete a {+avs+} index at any time from the 
      {+atlas-ui+}, {+atlas-admin-api+}, {+atlas-cli+}, {+mongosh+},
      or a supported :driver:`MongoDB Driver </>`.

   Required Access
   ~~~~~~~~~~~~~~~

   You must have the :authrole:`Project Search Index Editor` or higher role to 
   delete a {+avs+} index.

   .. selected-content::
      :selections: atlas, byo, None, None

      .. |command-type| replace:: delete
      .. |search-type| replace:: {+avs+}

      .. include:: /includes/search-shared/fact-search-commands-cluster-tier.rst

   .. selected-content::
      :selections: self, auto, None, None  

      You need :authrole:`readWrite` or higher role to delete {+avs+} indexes.

   .. _avs-delete-index-procedure:

   Procedure
   ~~~~~~~~~

   .. selected-content::
      :selections: atlas, byo, atlas-ui, None

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-atlas-ui.rst

   .. selected-content::
      :selections: atlas, byo, atlas-admin-api, None

      To delete a {+avs+} index for a collection using the
      {+atlas-admin-api+}, send a ``DELETE`` request to the |fts|
      ``indexes`` endpoint with either the unique ID or the name of the 
      index to delete. 
          
      .. literalinclude:: /includes/avs/index-management/delete-index/delete-index-api.sh
        :language: shell
        :copyable:
        :linenos:

      To learn more about the syntax and parameters for the endpoint, see 
      :oas-bump-atlas-op:`Remove One Search Index By Name <deletegroupclustersearchindexbyname>`
      and :oas-bump-atlas-op:`Remove One Search Index By ID <deletegroupclustersearchindex>`.

   .. selected-content::
      :selections: atlas, byo, atlas-cli, None

      To delete a {+avs+} index for a collection using {+atlas-cli+},
      perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-acli.rst

   .. selected-content::
      :selections: atlas, byo, mongosh, None

      To delete a {+avs+} index for a collection using {+mongosh+},
      perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-mongosh.rst

   .. selected-content::
      :selections: atlas, byo, driver, csharp

      To delete a {+avs+} index for a collection using 
      :driver:`C# </csharp/current/fundamentals/indexes/#drop-a-search-index>`
      driver 3.1.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-csharp.rst

   .. selected-content::
      :selections: atlas, byo, driver, go

      To delete a {+avs+} index for a collection using 
      :driver:`MongoDB Go driver </go/current/fundamentals/indexes/>` 
      v2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-go.rst

   .. selected-content::
      :selections: atlas, byo, driver, java-sync

      To delete a {+avs+} index for a collection using the
      :driver:`MongoDB Java driver </java/sync/current/fundamentals/indexes/>`
      v5.2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-java.rst

   .. selected-content::
      :selections: atlas, byo, driver, nodejs

      To delete a {+avs+} index for a collection using
      :driver:`MongoDB Node driver </node/current/fundamentals/indexes/>`
      v6.6.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-nodejs.rst

   .. selected-content::
      :selections: atlas, byo, driver, python

      .. cta-banner::
        :url: https://github.com/mongodb/docs-notebooks/blob/main/manage-indexes/delete-indexes.ipynb
        :icon: Code

        Work with a runnable version of this example as a :github:`Python notebook
        <mongodb/docs-notebooks/blob/main/manage-indexes/delete-indexes.ipynb>`. 

      To delete a {+avs+} index for a collection using `PyMongo
      <https://www.mongodb.com/docs/languages/python/pymongo-driver/current/indexes/atlas-search-index/>`__ 
      driver v4.7 or later, perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-pymongo.rst        

   .. selected-content::
      :selections: self, byo, mongosh, None

      To delete a {+avs+} index for a collection using {+mongosh+},
      perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-mongosh.rst

   .. selected-content::
      :selections: self, byo, driver, csharp

      To delete a {+avs+} index for a collection using 
      :driver:`C# </csharp/current/fundamentals/indexes/#drop-a-search-index>`
      driver 3.1.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-csharp.rst

   .. selected-content::
      :selections: self, byo, driver, go

      To delete a {+avs+} index for a collection using 
      :driver:`MongoDB Go driver </go/current/fundamentals/indexes/>` 
      v2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-go.rst

   .. selected-content::
      :selections: self, byo, driver, java-sync

      To delete a {+avs+} index for a collection using the
      :driver:`MongoDB Java driver </java/sync/current/fundamentals/indexes/>`
      v5.2.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-java.rst

   .. selected-content::
      :selections: self, byo, driver, nodejs

      To delete a {+avs+} index for a collection using
      :driver:`MongoDB Node driver </node/current/fundamentals/indexes/>`
      v6.6.0 or later, perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-nodejs.rst

   .. selected-content::
      :selections: self, byo, driver, python

      .. cta-banner::
        :url: https://github.com/mongodb/docs-notebooks/blob/main/manage-indexes/delete-indexes.ipynb
        :icon: Code

        Work with a runnable version of this example as a :github:`Python notebook
        <mongodb/docs-notebooks/blob/main/manage-indexes/delete-indexes.ipynb>`. 

      To delete a {+avs+} index for a collection using `PyMongo
      <https://www.mongodb.com/docs/languages/python/pymongo-driver/current/indexes/atlas-search-index/>`__ 
      driver v4.7 or later, perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-pymongo.rst  

   .. selected-content::
      :selections: self, auto, mongosh, None

      To delete a {+avs+} index for a collection using {+mongosh+},
      perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-mongosh.rst

   .. selected-content::
      :selections: self, auto, driver, nodejs

      To delete a {+avs+} index for a collection using
      :driver:`MongoDB Node driver </node/current/fundamentals/indexes/>`, 
      perform the following steps: 

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-nodejs.rst

   .. selected-content::
      :selections: self, auto, driver, python


      To delete a {+avs+} index for a collection using `PyMongo
      <https://www.mongodb.com/docs/languages/python/pymongo-driver/current/indexes/atlas-search-index/>`__ 
      driver, perform the following steps: 

      To delete a {+avs+} index for a collection using {+mongosh+},
      perform the following steps:

      .. include:: /includes/avs/index-examples/steps-avs-delete-index-pymongo.rst 

   .. selected-content::
      :selections: atlas, byo, None, None

      .. _avs-node-status-ref:

      Index Status
      ````````````

      When you create the {+avs+} index, the :guilabel:`Status` column shows 
      the current state of the index on the primary node of the cluster. 
      Click the :guilabel:`View status details` link below the status to view 
      the state of the index on all the nodes of the cluster.

      When the :guilabel:`Status` column reads :guilabel:`Active`, the index
      is ready to use. In other states, queries against the index may return
      incomplete results.

      .. list-table::
         :header-rows: 1
         :widths: 25 75

         * - Status
           - Description

         * - Not Started 
           - |service| has not yet started building the index.

         * - Initial Sync 
           - |service| is building the index or re-building the 
             index after an edit. When the index is in this state:
           
             - For a new index, {+avs+} doesn't serve queries until the 
               index build is complete. 
             - For an existing index, you can continue to use the old index 
               for existing and new queries until the index rebuild 
               is complete.

         * - Active
           - Index is ready to use.

         * - Recovering
           - Replication encountered an error. This state commonly occurs 
             when the current replication point is no longer available on the 
             |mongod| oplog. You can still query the existing index until it 
             updates and its status changes to :guilabel:`Active`. Use the 
             error in the :guilabel:`View status details` modal window to 
             troubleshoot the issue. To learn more, see 
             :ref:`Fix Issues <atlas-search-alerts>`.

         * - Failed 
           - |service| could not build the index. Use the error  
             in the :guilabel:`View status details` modal window to 
             troubleshoot the issue. To learn more, see 
             :ref:`Fix Issues <atlas-search-alerts>`.

         * - Delete in Progress
           - |service| is deleting the index from the cluster nodes.

      While |service| builds the index and after the build completes, the 
      :guilabel:`Documents` column shows the percentage and number of 
      documents indexed. The column also shows the total number of documents 
      in the collection.
