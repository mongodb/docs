.. _convert-serverless-to-dedicated:

============================================================
Convert a {+Serverless-Instance+} to a {+Dedicated-Cluster+}
============================================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

You can manually migrate your data from a {+serverless-instance+} to a
{+dedicated-cluster+}. To migrate your data, you can do one of the
following: 

- Restore data from a scheduled or on-demand {+Cloud-Backup+}. To learn
  more about restoring from a snapshot, see
  :ref:`restore-from-snapshot`. 
- Migrate data using |mongodump| and |mongorestore|. To learn more, see
  the prerequisites and procedure on this page. 

Prerequisites 
-------------

To manually migrate your data from a {+serverless-instance+} to a
{+dedicated-cluster+}, you must have the following: 

- A {+dedicated-cluster+} that runs the same major version of MongoDB as
  the {+serverless-instance+} from which you want to migrate data.
- The following command-line tools:

  - |mongodump| 
  - |mongorestore| 

Migrate Using ``mongodump`` and ``mongorestore``
------------------------------------------------

.. procedure:: 
   :style: normal 

   .. step:: Connect to your {+serverless-instance+} using |mongodump| to retrieve the data to migrate. 

      To connect to your {+serverless-instance+} and retrieve the data,
      do the following in the {+atlas-ui+}:

      a. Navigate to the :guilabel:`Database Deployments` page for your
         project.
      #. Click the :icon-mms:`ellipsis` (ellipsis) for the
         {+serverless-instance+} and select :guilabel:`Command Line
         Tools` from the dropdown. 

         The :guilabel:`Cmd Line Tools` tab displays.
      #. In the :guilabel:`Binary Import and Export Tools` section, copy
         the ``mongodump`` command to create a binary export of the
         contents of a database.

         For example:

         .. code-block:: shell 
            :copyable: false 

            mongodump --uri
            mongodb+srv://{username}:<PASSWORD>@test.jca5k.mongodb.net/<DATABASE> 
            
      To learn more, see :ref:`command-line-tools`.

   .. step:: Run the |mongodump| command in a terminal to retrieve the data. 

      To run the |mongodump| command that you copied, do the
      following in a terminal: 

      a. Paste the ``mongodump`` command that you copied into the terminal.
      
      #. Replace the ``<PASSWORD>`` in the string with the password of
         the user.

      #. Replace the ``<DATABASE>`` in the string with the name of the
         database that you want to migrate to the {+dedicated-cluster+}.

      #. Run the |mongodump| command.

         When you run |mongodump|, the command copies the contents of
         the specified database into the ``dump/`` sub-directory of the 
         current directory. If the ``dump`` directory doesn't already
         exist, the command creates the directory and copies the data
         into that directory.

      #. Repeat these steps for each database that you want to migrate to the
         {+dedicated-cluster+}. 

   .. step:: Connect to your {+dedicated-cluster+} using |mongorestore| to migrate the data to that {+cluster+}.

      To connect to your {+dedicated-cluster+} and migrate the data,
      do the following in the {+atlas-ui+}:

      a. Navigate to the :guilabel:`Database Deployments` page for your
         project.
      #. Click the :icon-mms:`ellipsis` (ellipsis) for the
         {+dedicated-cluster+} and select :guilabel:`Command Line
         Tools` from the dropdown. 

         The :guilabel:`Cmd Line Tools` tab displays.
      #. In the :guilabel:`Binary Import and Export Tools` section, copy
         the ``mongorestore`` command to create a new database or add
         data to an existing database. 

         For example:

         .. code-block:: shell 
            :copyable: false 

            mongorestore --uri
            mongodb+srv://{username}:<PASSWORD>@test.jca5k.mongodb.net
            
      To learn more, see :ref:`command-line-tools`.
            
   .. step:: Run the |mongorestore| command in a terminal to retrieve the data. 

      To run the |mongorestore| command that you copied, do the
      following in a terminal: 

      a. Paste the ``mongorestore`` command that you copied into the terminal.
      
      #. Replace the ``<PASSWORD>`` in the string with the password of
         the user.

      #. Run the |mongorestore| command.

         When you run |mongorestore|, by default, the command copies the
         contents of the ``dump/`` sub-directory of the current
         directory to the {+cluster+}. If you stored the data in a
         different directory, see |mongorestore| syntax for the
         command options to specify a different location. 

      #. (Optional) If you are migrating each database individually,
         repeat these steps for each database that you want to migrate to the 
         {+dedicated-cluster+}.

   .. step:: (Optional) Confirm that you've successfully migrated data to the {+dedicated-cluster+}.

      To confirm that you've successfully migrated your data, do the
      following in the {+atlas-ui+}.

      a. Navigate to the :guilabel:`Database Deployments` page for your
         project.
      #. Do one of the following on the {+dedicated-cluster+} where you
         copied the data:  
       
         - Click :guilabel:`Browse Collections` and visually verify that
           data has been migrated to the {+cluster+}.  

         - Click :guilabel:`Connect` to connect to your {+cluster+} and
           run queries against the data.
