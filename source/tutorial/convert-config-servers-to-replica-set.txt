=======================================
Convert Config Servers to a Replica Set
=======================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Overview
--------

.. admonition:: Feature Availability

   For deployments running MongoDB 3.2.4 or Later

In a sharded cluster, config servers store the metadata for the sharded
cluster. For a sharded cluster to be fully operational, the config
servers must be available and the metadata must be consistent across
the config servers.

Beginning in MongoDB 3.2, :term:`config servers <config server>`, that
run the WiredTiger storage engine, can be deployed as replica sets.
Running config servers as replica sets improves consistency and
increases availability for the config servers.

For new sharded cluster deployments using MongoDB 3.2, |mms| deploys
config servers as a replica set.

For existing sharded cluster deployments that are not running config
servers as replica sets, you can convert the config servers to replica
sets.

You can manage config server replica sets just as you would any other
replica set.

Prerequisites
-------------

- MongoDB 3.2.4 or Later
    To convert the config servers to a replica set, the sharded cluster
    must be running MongoDB 3.2.4 or later versions. To upgrade the
    MongoDB version, see :doc:`/tutorial/change-mongodb-version`.

- Three Config Servers to Convert
    The sharded cluster must be running exactly three config servers to
    convert. After the conversion of the config servers to a replica
    set, you can add additional members to the config server replica
    set.

Procedure
---------

.. note::

   During the conversion of the config servers to a replica set, if the
   config servers use the MMAPv1 :term:`storage engine`, |mms| changes
   the storage engine to WiredTiger. During the storage engine
   conversion, |mms| creates temporary config servers on ephemeral
   ports, and automation eventually deletes these hosts after the
   upgrade. However, if your Monitoring Agent should detect them at any
   point during the conversion, they'll appear as unreachable hosts in
   your deployments list. You can delete them from the list. See
   :doc:`/tutorial/unmanage-deployment`.

.. include:: /includes/steps/convert-config-servers-to-replica-set.rst
