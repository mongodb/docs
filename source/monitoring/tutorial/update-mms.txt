============
Update |mms|
============

.. _upgrade-mms-agent:

Update the Monitoring Agent
---------------------------

Update the Agent on UNIX/Linux
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To update the Monitoring agent on UNIX/Linux systems:

#. Stop the agent processes.

#. Download the latest Monitoring agent from the :guilabel:`Settings` page of the MMS
   console, in the :guilabel:`Monitoring Agent` section.

#. Restart the Monitoring agent.

Update the Agent on Windows
~~~~~~~~~~~~~~~~~~~~~~~~~~~

To update the agent on Windows systems:

#. Download the latest Monitoring agent from the "Settings" page of the MMS
   console in the :guilabel:`Monitoring Agent` section).

#. From a command shell, issue the following:

   .. code-block:: sh

      sc stop MongoMMS
      sc delete MongoMMS

   This should stop and uninstall |monitoring|.

#. Confirm that the service no longer exists. Issue the following
   command:

   .. code-block:: sh

      sc query MongoMMS

   This operation will return a message that resembles the
   following:

   .. code-block:: none

      [SC] EnumQueryServicesStatus:OpenService FAILED 1060:

      The specified service does not exist as an installed service.

#. When you have successfully uninstalled the Monitoring agent, you can use
   ``mongommsinstall.bat`` to reinstall |monitoring|.

#. Restart the agent.

.. only:: hosted

   Upgrade MMS Installation
   ------------------------

   Due to the `company name change <http://www.mongodb.com/press/10gen-announces-company-name-change-mongodb-inc>`_
   the name of the MMS package changed between versions 1.2 and 1.3.
   Therefore, to upgrade the |mms| server to 1.3 from *any* version
   lower to 1.3, use the following procedure:

   #. *Recommended.* Take a full backup of the MMS database before
      beginning the upgrade procedure.

   #. Shut down MMS, using the following command:

      .. code-block:: sh

         /etc/init.d/10gen-mms stop

   #. Download the latest package and proceed with the instructions
      for a fresh install. Do not attempt to use your package manager
      to do an upgrade. See
      :doc:`/monitoring/tutorial/install-monitoring-server` for more
      information.

      When complete, |mms| is installed in the ``/opt/mongodb/mms``
      directory.

   #. Follow all procedures for a new install include configuring the
      options in ``/opt/mongodb/mms/conf/conf-mms.properties``. If you
      used encrypted authentication credentials you will need to
      regenerate these manually.  *Do not copy the credentials from
      your old properties file. Old credentials will not work.*

   #. Start MMS  using the new package name:

      .. code-block:: sh

         sudo /etc/init.d/mongodb-mms start

   #. Update any Monitoring Agent. See :ref:`upgrade-mms-agent` for
      more information.
