.. _tutorial-enable-backup-for-sharded-cluster:

=====================================
Activate Backup for a Sharded Cluster
=====================================

.. default-domain:: mongodb

Overview
--------

You can start, restart, stop, and terminate backups for a :term:`sharded cluster`.
As appropriate, you also can specify which instance to use for the initial
sync, exclude namespaces, authenticate, and change the snapshot schedule
and retention.

.. note::
   The sharded-cluster must be MongoDB version 2.4.3 or later.

Considerations
--------------

.. include:: /includes/considerations-backup-daemon-enable.rst

.. _checkpoint:

Checkpoints
+++++++++++

Checkpoints create restoration points at regular intervals between
snapshots and allow you to restore the cluster to one of those points. The
options for the checkpoint interval are 15, 30, and 60 minutes.

To create a checkpoint, MMS Backup stops the :term:`cluster balancer
<balancer>` and inserts a token into the :term:`oplog` of each
:term:`shard` in the cluster.

Prerequisites
-------------

Before enabling backup, ensure that the following is true for all replica
sets that you back up:

- MMS Monitoring is actively collecting data from your cluster, including
  from at least one :program:`mongos`.

- All the cluster's :term:`config servers <config server>` are
  running, and the balancing round has completed within the last hour.

- There is an active :term:`primary`.

- If you explicitly select a sync target, ensure that the sync target is
  accessible on the network and keeping up with replication.

Procedure
---------

.. include:: /includes/steps/backup-activate-sharded-cluster.rst

Your Backup agent will start polling the specified
instance for this sharded cluster.
