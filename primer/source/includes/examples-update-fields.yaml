collection: "restaurants"
options:
  show_title: False
  show_collection: False
edition:
  - shell
  - python
  - node
  - cpp
ref: collection-example
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-top-level-fields
ref: update-top-level-fields
edition: shell
operation:
    language: javascript
    code: |
      db.restaurants.update(
          { "name" : "Juni" },
          {
            $set: { "cuisine": "American (New)" },
            $currentDate: { "lastModified": true }
          }
      )
post: |
  The update operation returns a :method:`WriteResult` object which
  contains the status of the operation.
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-embedded-field
ref: update-embedded-field
edition: shell
operation:
  language: javascript
  code: |
      db.restaurants.update(
        { "restaurant_id" : "41156888" },
        { $set: { "address.street": "East 31st Street" } }
      )
post: |
   The update operation returns a :method:`WriteResult` object which
   contains the status of the operation.
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-multiple-documents
ref: update-multiple-documents
edition: shell
operation:
    language: javascript
    code: |
      db.restaurants.update(
        { "address.zipcode": "10016", cuisine: "Other" },
        {
          $set: { cuisine: "Category To Be Determined" },
          $currentDate: { "lastModified": true }
        },
        { multi: true}
      )
post: |
  The update operation returns a :method:`WriteResult` object which
  contains the status of the operation.
replacement:
  updateMethod: :method:`~db.collection.update()`
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-top-level-fields
ref: update-top-level-fields
edition: python
operation:
    language: python
    code: |
      result = db.restaurants.update_one(
          {"name": "Juni"},
          {
              "$set": {
                  "cuisine": "American (New)"
              },
              "$currentDate": {"lastModified": True}
          }
      )
post: |
  The operation returns a :py:class:`~pymongo.results.UpdateResult` object that
  reports the count of documents matched and modified.
results: |
  result.matched_count
  1
  result.modified_count
  1
replacement:
  updateMethod: :py:meth:`~pymongo.collection.Collection.update_one`
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-embedded-field
ref: update-embedded-field
edition: python
operation:
    language: python
    code: |
      result = db.restaurants.update_one(
          {"restaurant_id": "41156888"},
          {"$set": {"address.street": "East 31st Street"}}
      )
post: |
  The operation returns a :py:class:`~pymongo.results.UpdateResult` object that
  reports the count of documents matched and modified.
results: |
  result.matched_count
  1
  result.modified_count
  1
replacement:
  updateMethod: :py:meth:`~pymongo.collection.Collection.update_one`
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-multiple-documents
ref: update-multiple-documents
pre: |
  The {{update}} method updates a single document. To update multiple
  documents, use the {{updateMany}} method.

  The following operation updates *all* documents that have
  ``address.zipcode`` field equal to ``"10016"``, setting the ``borough``
  field to ``"Midtown"`` and the ``lastModified`` field to the current
  date.
edition: python
operation:
  language: python
  code: |
      result = db.restaurants.update_many(
          {"address.zipcode": "10016"},
          {
              "$set": {"borough": "Midtown"},
              "$currentDate": {"lastModified": True}
          }
      )
post: |
  The operation returns a :py:class:`~pymongo.results.UpdateResult` object that
  reports the count of documents matched and modified.
results: |
  result.matched_count
  433
  result.modified_count
  433
replacement:
  update: :py:meth:`~pymongo.collection.Collection.update_one`
  updateMany: :py:meth:`~pymongo.collection.Collection.update_many`
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-top-level-fields
ref: update-top-level-fields
edition: node
operation:
  - pre: |
      Define an ``updateRestaurants`` function as follows:
    language: javascript
    code: |
      var updateRestaurants = function(db, callback) {
         db.collection('restaurants').updateOne(
            { "name" : "Juni" },
            {
              $set: { "cuisine": "American (New)" },
              $currentDate: { "lastModified": true }
            }, function(err, results) {
            console.log(results);
            callback();
         });
      };
  - pre: |
      Call the ``updateRestaurants`` function.
    language: javascript
    code: | 
      MongoClient.connect(url, function(err, db) {
        assert.equal(null, err);

        updateRestaurants(db, function() {
            db.close();
        });
      });
post: |
   The {{updateMethod}} returns the number of documents updated. 
replacement:
  updateMethod: "updateOne_"
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-embedded-field
ref: update-embedded-field
edition: node
operation:
  - pre: |
      Define an ``updateRestaurants`` function as follows:
    language: javascript
    code: |
      var updateRestaurants = function(db, callback) {
         db.collection('restaurants').updateOne(
            { "restaurant_id" : "41156888" },
            { $set: { "address.street": "East 31st Street" } },
            function(err, results) {
              console.log(results);
              callback();
         });
      };
  - pre: |
      Call the ``updateRestaurants`` function.
    language: javascript
    code: | 
      MongoClient.connect(url, function(err, db) {
        assert.equal(null, err);

        updateRestaurants(db, function() {
            db.close();
        });
      });
post: |
   The {{updateMethod}} returns the number of documents updated. 
replacement:
  updateMethod: "updateOne_"
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-multiple-documents
ref: update-multiple-documents
edition: node
pre: |
  To update multiple documents, use the {{updateMethod}} method.

  The following operation updates *all* documents that have
  ``address.zipcode`` field equal to ``"10016"`` and ``cuisine`` field
  equal to ``"Other"``, setting the ``cuisine`` field to ``"Category To
  Be Determined"`` and the ``lastModified`` field to the current date.
operation:
  - pre: |
      Define an ``updateRestaurants`` function as follows:
    language: javascript
    code: |
      var updateRestaurants = function(db, callback) {
         db.collection('restaurants').updateMany(
            { "address.zipcode": "10016", cuisine: "Other" },
            {
              $set: { cuisine: "Category To Be Determined" },
              $currentDate: { "lastModified": true }
            }
            ,
            function(err, results) {
              console.log(results);
              callback();
         });
      };
  - pre: |
      Call the ``updateRestaurants`` function.
    language: javascript
    code: | 
      MongoClient.connect(url, function(err, db) {
        assert.equal(null, err);

        updateRestaurants(db, function() {
            db.close();
        });
      });
post: |
   The {{updateMethod}} returns the number of documents updated. 
replacement:
  updateMethod: "updateMany_"
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-top-level-fields
ref: update-top-level-fields
edition: cpp
operation:
  literalinclude: includes/example-cpp-update-top-level-fields.cpp
  language: cpp
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-embedded-field
ref: update-embedded-field
edition: cpp
operation:
  literalinclude: includes/example-cpp-update-embedded-field.cpp
  language: cpp
---
source:
  file: examples-update-fields-base.yaml
  ref: _update-multiple-documents
ref: update-multiple-documents
edition: cpp
operation:
  literalinclude: includes/example-cpp-update-multiple-documents.cpp
  language: cpp
pre: |
  To update multiple documents, use the {{updateMethod}} method.

  The following operation updates *all* documents that have
  ``address.zipcode`` field equal to ``"10016"``, setting the ``borough``
  field to ``"Manhattan"`` and the ``lastModified`` field to the current
  date.
replacement:
  updateMethod: "update_many_"
...
