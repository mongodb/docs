==================
Installing PyMongo
==================

Easy Installation
-----------------

.. start-content

While the C extensions are
not required for MMS, they significantly improve performance. To install
these extensions, make sure you have a C compiler (e.g. ``gcc``)
and Python header files installed on your system. Debian and Ubuntu
users should issue the following command: ::

     sudo apt-get install build-essential python-dev

Red Hat, CentOS, and Fedora Users should issue the following
command: ::

     sudo yum install gcc python-devel

If you have not installed ``pymongo`` issue the
following command to install the latest version: ::

    sudo easy_install pymongo

To upgrade to the latest version of the driver, use the following
command: ::

    sudo easy_install -U pymongo
    
    
For more information concerning PyMongo installation, see `the
PyMongo documentation <http://api.mongodb.org/python/2.0.1/installation.html>`_.

.. end-content    

.. _installing-pymongo-c-extensions:

Installing PyMongo C Extensions
-------------------------------

If you installed PyMongo *with* the C extensions (i.e. on a
system with a C compiler, or using the Windows installer) then you can
disregard this section. Otherwise use the following procedure to
reinstall your agent with C extensions.

1. Install ``gcc``, a C compiler, and the necessary development
   packages:

   Debian and Ubuntu users should issue the following command: ::

        sudo apt-get install build-essential python-dev

   Red Hat, CentOS, and Fedora Users should issue the following
   command: ::

        sudo yum install gcc python-devel

2. Install the ``pip`` utility so that you can uninstall the existing
   instance of PyMongo, by issuing the following command: ::

        sudo easy_install pip

3. Remove the existing copy of PyMongo with the following command: ::

        sudo pip uninstall pymongo

4. Now re-install PyMongo with the following command: ::

        sudo pip install pymongo

After upgrading PyMongo, you will need to restart your MMS agent to
receive the full effect of the improvement.

.. note::

   When you restart your agent there is a 5 minute timeout before the
   agent will begin sending data to MMS again.


.. _building-pymongo-packages-with-c:

Build PyMongo Packages with PyMongo C Extensions
------------------------------------------------

If you are installing PyMongo and the MMS agent on systems that *do not
have* C compilers, you can create a ``.egg`` package of PyMongo with
C extensions to install on your system or systems.

.. note::

   The `packages distributed in PyPI <http://pypi.python.org/pypi/pymongo>`_
   for Windows include C extensions.

First, on a system that has a C-compiler, download the PyMongo
source. Always download the source for the latest version of the
driver, which you can find at the `PyMongo page on PyPi <http://pypi.python.org/pypi/pymongo>`_.

The following example uses version 2.1.1. Issue the following command:
::

     curl http://pypi.python.org/packages/source/p/pymongo/pymongo-2.1.1.tar.gz > pymongo-2.1.1.tar.gz

.. note::

   To install a C-compiler (i.e. ``gcc``) and the necessary
   dependencies, Debian and Ubuntu users should issue the following
   command: ::

        sudo apt-get install build-essential python-dev

   Red Hat, CentOS, and Fedora Users should issue the following
   command: ::

        sudo yum install gcc python-devel

Extract the driver as follows: ::

     tar -zxvf pymongo-2.1.1.tar.gz

Change directories and build the ``.egg`` package with the following
sequence: ::

     cd pymongo-2.1.1
     python setup.py bdist_egg

You can find  ``.egg`` file in the ``dist/`` sub-directory. The file
name will resemble "``pymongo-2.1.1-py2.7-linux-x86_64.egg``" but may
have a different name depending on your platform and the version of
python you use to compile.

.. warning::

   These "binary distributions," will only work on systems that
   resemble the environment on which you built the package. In other
   words, ensure that operating systems and versions of Python and
   architecture (i.e. "32" or "64" bit) match.

Copy this file to the target system and issue the following command to
install the package (with root or "``sudo``" privileges:) ::

     easy_install pymongo-2.1.1-py2.7-linux-x86_64.egg
