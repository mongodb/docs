============
View Metrics
============

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Overview
--------

|mms| provides charts for analyzing the statistics collected by the Monitoring
Agent for your deployment's :program:`mongod` and :program:`mongos` processes.
The agent collects metrics using several MongoDB diagnostic commands, including
:manual:`serverStatus </reference/command/serverStatus>` and :manual:`dbStats
</reference/command/dbStats>`.

|mms| also provides charts for analyzing hardware statistics collected by the
Automation Agents. Hardware metrics are available only for automated
deployments. The Automation Agents collect the metrics for the servers that
run the managed MongoDB processes.

You can view data at different granularities and time periods. Charts default
to the last granularity used.

.. _access-host-statistics:

View Metrics
------------

To view metrics, click :guilabel:`Deployment` and then click the :guilabel:`Metrics`
button for the sharded cluster, replica set, or individual MongoDB process.

To add or remove charts, click either the :guilabel:`Display` or
:guilabel:`Add Chart` drop-down list, depending on which is available. To
display a chart's controls, hover the mouse pointer over the chart. To view
metrics for a different level in the topology of a sharded cluster or replica
set, use the breadcrumb.

For additional information on displayed metrics, see the following on this
page:

- :ref:`metrics-sharded-clusters`

- :ref:`metrics-replica-sets`

- :ref:`metrics-status-tab`

- :ref:`metrics-hardware-tab`

- :ref:`metrics-db-stats-tab`

- :ref:`metrics-chart-controls`

.. _metrics-sharded-clusters:

Sharded Cluster Metrics
~~~~~~~~~~~~~~~~~~~~~~~

When you view metrics for a sharded cluster, you can choose to
display either the :term:`shards <shard>`, :term:`mongos instances <mongos>`, or
:term:`config servers <config server>`. For a shard you can use the buttons
below the chart to select primaries, secondaries, or both. |mms| displays
different processes as different lines.

To sum or average the data, click the :guilabel:`Display Data` drop-down list
and select the desired option. To change charts, click the :guilabel:`Display`
drop-down list.

.. _metrics-replica-sets:

Replica Set Metrics
~~~~~~~~~~~~~~~~~~~

When you view metrics for a replica set, you can limit the display to
particular types of members using the :term:`P <primary>`, :term:`S
<secondary>`, and :term:`A <arbiter>` options.

To add or remove charts, click the :guilabel:`Add Chart` drop-down list or
click the buttons at the bottom of the page. To remove a chart, deselect it.

.. _metrics-status-tab:

Status Tab
~~~~~~~~~~

This tab displays process metrics the Monitoring Agent collects from the
selected :program:`mongod` or :program:`mongos` process. The agent collects
a subset of the output of the MongoDB :manual:`serverStatus
</reference/command/serverStatus>` and :manual:`explain
</reference/command/explain>` commands.

.. _metrics-hardware-tab:

Hardware Tab
~~~~~~~~~~~~

.. important::

   **Munin users:**

   If you run ``munin-node`` on your MongoDB servers and install or upgrade to
   Automation Agent version 2.7.0 or higher on the servers, |mms| displays the
   hardware data collected by the Automation Agent, **not by Munin**. The
   historical hardware data collected by Munin **is not saved**.

   If you run Munin but do not run the Automation Agent, |mms| displays the Munin charts.

The Automation Agent collects the following hardware metrics for your
:program:`mongod` and :program:`mongos` processes:

.. list-table::
   :widths: 35 65
   :header-rows: 1

   * - Chart

     - Data

   * - System CPU

     - The CPU usage of all processes (not just MongoDB processes) on the host
       server. For servers with more than 1 CPU core, this value can exceed
       100%.

   * - Normalized System CPU

     - The CPU usage of all processes (not just MongoDB processes) on the host
       server, scaled to a range of 0-100% by dividing by the number of CPU cores.

   * - Process CPU

     - The CPU usage of the MongoDB process. For servers with more than 1 CPU
       core, this value can exceed 100%.

   * - Normalized Process CPU

     - The CPU usage of the MongoDB process, scaled to a range of 0-100% by
       dividing by the number of CPU cores.

   * - Disk Space Free - <partition>

     - The total bytes of free disk space on the disk partition used by
       MongoDB.

   * - Util % - <partition>

     - The percentage of time during which requests are being issued to
       and serviced by the partition. This includes requests from any process,
       not just MongoDB processes.

   * - Disk IOPS - <partition>

     - The throughput of I/O operations per second for the disk partition used for MongoDB.

   * - Disk Space Percent Free - <partition>

     - The percent of free disk space on the partition used by MongoDB.

   * - Disk Latency - <partition>

     - The latency in milliseconds of the disk partition used by MongoDB.

   * - Disk Space Used - <partition>

     - The total bytes of used disk space on the partition that runs MongoDB.

.. _metrics-db-stats-tab:

DB Stats Tab
~~~~~~~~~~~~

This tab displays database metrics the Monitoring Agent collects through the
MongoDB ``dbStats`` command. The agent collects a subset of ``dbStats``
output. See :manual:`dbStats </reference/command/dbStats>` in the MongoDB
manual.

The agent retrieves database metrics every 20 minutes by default but adjusts
frequency when necessary to reduce the impact on database performance. You can
disable the collection of database statistics by clicking
:guilabel:`Settings`, then :guilabel:`Group Settings`, and then setting
:guilabel:`Collect Database Specific Statistics` to ``No``.

To select which database to display, click the :guilabel:`Select Database`
drop-down list.

.. _metrics-chart-controls:

Chart Controls
~~~~~~~~~~~~~~

When viewing charts, you can do the following:

.. list-table::
   :widths: 35 65
   :header-rows: 1

   * - Task

     - Action

   * - View a chart's description.

     - Click the :guilabel:`i` icon next to the chart name. (Not available for
       cluster-level chart)

   * - Expand a chart.

     - Click the two-way arrow at the top right of the chart.

   * - Zoom in on a period of time.

     - Click and drag the mouse pointer over a portion of the chart. To reset,
       double-click the chart.

       .. note::

          When you zoom, the time selections above the charts automatically
          update to reflect the new period displayed.

   * - View point-in-time statistics.

     - Hover the mouse pointer over a point on the chart.

   * - Move a chart.

     - Click and hold the grabber in the upper left corner of the chart, and
       drag the chart to the new position.

   * - Export the charts.

     - Click the :guilabel:`Export` drop-down list and select the format.

   * - Link to a chart.

     - Click the curved arrow on the chart and select :guilabel:`Chart
       Permalink`.

   * - Email the chart.

     - Click the curved arrow on the chart and select :guilabel:`Email Chart`.
