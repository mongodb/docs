.. index:: database profiling
.. _db-profiling-section:

=================
Profile Databases
=================

.. default-domain:: mongodb

Overview
--------

|monitoring| can collect data from MongoDB's :manual:`profiler
</reference/database-profiler>` to provide statistics about performance
and database operations.

Considerations
--------------

Before enabling profiling, be aware of these issues:

- Profile data can include sensitive information, including the content of
  database queries. Ensure that exposing this data to |monitoring| is consistent
  with your information security practices.

- The profiler can consume resources which may adversely affect MongoDB
  performance. Consider the implications before enabling profiling.

Procedures
----------

Enable Database Profiling
~~~~~~~~~~~~~~~~~~~~~~~~~

To allow |monitoring| to collect profile data for a specific host:

.. include:: /includes/steps/profiling-enable.rst

.. note::

   The Monitoring Agent attempts to minimize its effect on the
   monitored systems. If resource intensive operations, like polling
   profile data, begins to impact the performance of the database,
   |monitoring| will throttle the frequency that it collects data. See
   :ref:`db-stats-warning` for more information about the agent's
   throttling process.

   When enabled, |monitoring| samples profiling data from monitored
   instances: the agent only sends the most recent 20 entries from last
   minute.

With profiling enabled, all configuration changes made in MMS can
take up to 2 minutes to propagate to the agent and another minute before
profiling data appears in the MMS interface.

Display Profiling Levels
~~~~~~~~~~~~~~~~~~~~~~~~

When profiling is on, the :guilabel:`Profile Data` tab displays profiled data.
For more information on profiling, see the :manual:`database profiler
</tutorial/manage-the-database-profiler>` documentation in the MongoDB manual.

.. include:: /includes/steps/profiling-view-data.rst

Delete Profile Data
~~~~~~~~~~~~~~~~~~~

Deleting profile data deletes the Web UI cache of the current profiling data.
You must then disable profiling or drop or clear the source collection, or MMS
will repopulate the profiling data.

If |monitoring| is storing a large amount of profile data for your instance,
the removal process will not be instantaneous.

.. include:: /includes/steps/profiling-delete-data.rst
