title: "*Recommended*. Take a full backup of the |mms| database before beginning the upgrade procedure."
stepnum: 1
ref: full-backup
---
title: "Shut down the Automation Agent."
stepnum: 2
ref: shutdown-agent
content: |
  
  a. Click the :guilabel:`Start` button.

  b. Click :guilabel:`Administrative Tools`.

  c. Click :guilabel:`Services`.

  d. Right-click on the :guilabel:`MMS Automation Agent` and select :guilabel:`Stop`.
---
title: "Download the latest agent."
stepnum: 3
ref: download-agent
pre: |
  From a `Powershell <https://msdn.microsoft.com/en-us/powershell/>`_ prompt, 
  issue the following command:
action:
  language: ps1
  code: |
    $client = new-object System.Net.WebClient
    $client.DownloadFile("https://cloud.mongodb.com/download/agent/automation/mongodb-mms-automation-agent-latest.windows_x86_64.msi","C:\Temp\mongodb-mms-automation-agent-latest.windows_x86_64.msi")
edition:
  - cloud
---
title: "Download the latest agent."
stepnum: 3
ref: download-agent
pre: |

  From a `Powershell <https://msdn.microsoft.com/en-us/powershell/>`_
  prompt, issue the following command, where ``<OpsManagerHost>`` is
  the hostname of your |onprem| installation (for example,
  ``onprem.example.net``):

action:
  language: ps1
  code: |
    $client = new-object System.Net.WebClient
    $client.DownloadFile("https://<OpsManagerHost>:<Port>/download/agent/automation/mongodb-mms-automation-agent-latest.windows_x86_64.msi,"C:\Temp\mongodb-mms-automation-agent-latest.windows_x86_64.msi")
  post: |
    The protocol can be ``http:`` or ``https:`` depending upon whether
    or not you have :doc:`configured SSL connections to Ops Manager
    <tutorial/configure-ssl-connection-to-web-interface>`.
edition:
  - onprem
---
title: "Install the Automation Agent"
stepnum: 4
ref: install-automation-agent
content: |
  a. After the MSI downloads, double-click the 
     ``mongodb-mms-automation-agent-<version>.windows_x86_64.msi``

  b. If a security warning appears, click :guilabel:`Run`.

  c. Verify that the :guilabel:`Destination Folder` installation path and
     :guilabel:`Configuration/Log Folder` paths are correct.

  d. At the :guilabel:`Key Type` and the following key values steps,
     verify the provided values.

  e. At the :guilabel:`Automation Paths` step, verify the provided paths.

  f. Click :guilabel:`Install`.

  g. Click :guilabel:`Finish` once installation is complete.
---
title: "Login to |cloud|."
stepnum: 5
ref: login
edition:
  - cloud
---
title: "Login to |onprem|."
stepnum: 5
ref: login
edition:
  - onprem
---
title: "Verify the Automation Agent is running."
stepnum: 6
ref: verify-automation-agent
content: |

  The Deployment page should display after login.

  a. Click on the stacked box icon next to `Servers`.

  b. Verify that the :guilabel:`Automation Agent` is showing the correct
     version.
---
title: "Repeat installation procedure for each MongoDB server."
stepnum: 7
ref: repeat
...
