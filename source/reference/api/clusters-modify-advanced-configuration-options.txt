=====================================================
Modify Advanced Configuration Options for One Cluster
=====================================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol


.. include:: /includes/fact-atlas-free-tier-limits.rst

.. include:: /includes/fact-projects-groups-synonyms.rst

.. include:: /includes/api-requirements.rst

Resource
--------

.. include:: /includes/api/base-api-uri.rst

.. code-block:: http

   PATCH /groups/{GROUP-ID}/clusters/{CLUSTER-NAME}/processArgs

Request Path Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :header-rows: 1
   :stub-columns: 1
   :widths: 20 14 11 55

   * - Path Parameter
     - Type
     - Necessity
     - Description

   * - GROUP-ID
     - string
     - Required
     - Unique identifier for the :ref:`project <group-id>`
       containing the cluster you want to retrieve.

   * - CLUSTER-NAME
     - string
     - Required
     - Name of the cluster to retrieve.

Request Query Parameters
~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/api/no-query-single-parameters.rst

Request Body Parameters
~~~~~~~~~~~~~~~~~~~~~~~

Specify one or all of the following options.

.. list-table::
   :header-rows: 1
   :stub-columns: 1
   :widths: 20 14 11 55

   * - Body Parameter
     - Type
     - Necessity
     - Description

   * - defaultReadConcern
     - string
     - Optional
     - :manual:`Default level of acknowledgment requested from MongoDB for read operations </reference/read-concern/>`
       set for this cluster.

       MongoDB 4.4 clusters default to :manual:`available </reference/read-concern-available>`.

       .. MongoDB 5.0 clusters default to :manual:`/reference/read-concern-local`.

   * - defaultWriteConcern
     - string
     - Optional
     - :manual:`Default level of acknowledgment requested from MongoDB for write operations </reference/write-concern/>`
       set for this cluster.

       MongoDB 4.4 clusters default to :manual:`1 </reference/write-concern>`.

       .. MongoDB 5.0 clusters default to :manual:`majority </reference/write-concern>`.

   * - failIndexKeyTooLong
     - boolean
     - Optional
     - Flag that indicates whether you can insert or update documents
       where all indexed entries don't exceed 1024 bytes. If you set
       this to ``false``, |mongod| writes documents that exceed this
       limit but *doesn't* index them.

       Changing this option corresponds to modifying the
       :parameter:`failIndexKeyTooLong <param.failIndexKeyTooLong>`
       parameter via the :dbcommand:`setParameter` command for each
       |mongod| in the cluster.

       .. include:: /includes/admonitions/removed-fail-index-key-too-long.rst

   * - javascriptEnabled
     - boolean
     - Optional
     - .. include:: /includes/fact-javascriptEnabled-description.rst

       .. include:: /includes/admonitions/changed-javascript-enabled-mongos.rst

   * - minimumEnabledTlsProtocol
     - string
     - Optional
     - Minimum Transport Layer Security (TLS) version that the cluster
       accepts for incoming connections. Clusters using |tls| 1.0 or 1.1
       should consider setting |tls| 1.2 as the minimum |tls| protocol
       version. |service| accepts the following values: ``TLS1_0``,
       ``TLS1_1``, ``TLS1_2``. |service| sets the default value for all
       clusters to ``TLS1_2``.

       To learn more, see :ref:`faq-tls-1.0-deprecation`.

       .. note::

          If you consider this option to enable the deprecated |tls| 1.0
          protocol version, read :ref:`faq-tls-1.0-deprecation` before
          first. |tls| 1.0 carries security risks for any |service|
          cluster that uses it. Enable |tls| 1.0 only until you to
          update your application stack to support |tls| 1.2.

       Changing this option corresponds to configuring the
       :setting:`net.ssl.disabledProtocols` configuration file option
       for each |mongod| in the cluster.

       To deploy the specified changes, |service| performs a rolling
       deployment upgrade to maintain high availability. For sharded
       clusters, this involves a rolling restart of all shards and the
       config server replica set. To learn more about how |service|
       supports high availability during maintenance operations, see
       :ref:`high-availability`.

   * - noTableScan
     - boolean
     - Optional
     - When ``true``, the cluster disables the execution of any query
       that requires a collection scan to return results. When
       ``false``, the cluster allows the execution of those operations.

       Changing this option corresponds to modifying the
       :parameter:`notablescan <param.notablescan>` parameter via the
       :dbcommand:`setParameter` command for each |mongod| in
       the cluster.

   * - oplogSizeMB
     - integer
     - Optional
     - Custom :term:`oplog` size of the cluster. A value of ``null``
       indicates that the cluster uses the default oplog size
       calculated by |service|.

       You can check the oplog size by connecting to your cluster
       via {+mongosh+} and authenticating as a user
       with the :atlasrole:`Atlas admin` role. Run the
       :method:`rs.printReplicationInfo() <rs.printReplicationInfo>`
       method to view the current oplog size and time.

       Changing this option corresponds to modifying the
       :setting:`replication.oplogSizeMB <replication.oplogSizeMB>`
       configuration file option for each |mongod| in the cluster.

       |service| can deploy the specified changes without performing a
       rolling restart.

   * - sampleSizeBIConnector
     - integer
     - Optional
     - Number of documents per database to sample when gathering schema
       information. Defaults to ``100``. Available only for |service|
       deployments in which |bic| :ref:`is enabled <create-cluster-enable-bi>`.

       .. seealso::

          - :bic:`MongoDB Connector for BI </>`
          - :bic:`sampleSize (mongosqld option)
            </reference/mongosqld/#cmdoption-mongosqld-sampleSize>`

   * - sampleRefreshIntervalBIConnector
     - integer
     - Optional
     - Interval in seconds at which the :bic:`mongosqld process
       </reference/mongosqld/>` re-samples data to create its
       relational schema. The default value is 300. The specified value
       must be a positive integer. Available only for |service|
       deployments in which |bic| :ref:`is enabled
       <create-cluster-enable-bi>`.

       .. seealso::

          - :bic:`MongoDB Connector for BI </>`
          - :bic:`sampleRefreshIntervalSecs (mongosqld option) </reference/mongosqld/#cmdoption-mongosqld-samplerefreshintervalsecs>`

Response
--------

.. include:: /includes/api/list-tables/clusters/advanced-configuration-options-response.rst

Example Request
---------------

.. code-block:: shell
   :emphasize-lines: 5-13

   curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" --include --digest \
        --header "Content-Type: application/json" \
        --request PATCH "https://cloud.mongodb.com/api/atlas/v1.0/groups/{GROUP-ID}/clusters/LogData/processArgs" \
        --data '{
            "defaultReadConcern": "available",
            "defaultWriteConcern": "1",
            "failIndexKeyTooLong" : false,
            "javascriptEnabled" : false,
            "minimumEnabledTlsProtocol": "TLS1_2",
            "noTableScan" : true,
            "oplogSizeMB" : 2000,
            "sampleSizeBIConnector" : 5000,
            "sampleRefreshIntervalBIConnector" : 300
          }'


Example Response
----------------

Response Header
~~~~~~~~~~~~~~~

.. include:: /includes/api/api-headers/401.rst

.. include:: /includes/api/api-headers/200.rst

Response Body
~~~~~~~~~~~~~

.. code-block:: json
   :emphasize-lines: 2-10

   {
     "defaultReadConcern": "available",
     "defaultWriteConcern": "1",
     "failIndexKeyTooLong": false,
     "javascriptEnabled": false,
     "minimumEnabledTlsProtocol": "TLS1_2",
     "noTableScan": true,
     "oplogSizeMB": 2000,
     "sampleSizeBIConnector" : 5000,
     "sampleRefreshIntervalBIConnector" : 300
   }
