.. _kotlin-mongoclient:

====================
Create a MongoClient
====================

.. facet::
   :name: genre
   :values: reference

.. meta::
   :keywords: connection string, URI, server, Atlas, settings, client
   :description: Learn how to create a `MongoClient` in Kotlin to connect to a MongoDB deployment using a connection URI and customize connection behavior.

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Overview
--------

To connect to a MongoDB deployment, you need two things:

- A **connection URI**, also known as a *connection string*, which tells {+driver-short+}
  which MongoDB deployment to connect to.
- A **MongoClient** object, which creates the connection to the MongoDB deployment
  and lets you perform operations on it.

You can also use either of these components to customize the way {+driver-short+} behaves
while connected to MongoDB.

This guide shows you how to create a connection string and use a ``MongoClient`` object
to connect to MongoDB.

.. _kotlin-connection-uri:

Connection URI
--------------

The **connection URI** provides a set of instructions that the driver uses to
connect to a MongoDB deployment. It instructs the driver on how it should
connect to MongoDB and how it should behave while connected. The following
figure explains each part of a sample connection URI:

.. figure:: /includes/figures/connection_uri_parts.png
   :alt: Connection String parts figure

This figure uses the :manual:`Standard Connection String Format </reference/connection-string/#std-label-connections-standard-connection-string-format>`,
``mongodb`` for the protocol. You can also use the :manual:`DNS Seed List Connection Format </reference/connection-string/#dns-seed-list-connection-format>`,
``mongodb+srv``, if you want more flexibility of deployment and the ability
to change the servers in rotation without reconfiguring clients.

.. note::

   If your deployment is on MongoDB Atlas, see the
   :atlas:`Atlas driver connection guide </driver-connection?jmp=docs_driver_kotlin>`
   and select :guilabel:`Kotlin` from the language dropdown to retrieve your connection
   string.

The next part of the connection URI contains your credentials if you are
using a password-based authentication mechanism. Replace the value of ``user``
with your database username and ``pass`` with your database user's password. If your
authentication mechanism does not require credentials, omit this part of
the connection URI.

The next part of the connection URI specifies the hostname or IP
address, followed by the port of your MongoDB instance. In the example,
``sample.host`` represents the hostname and ``27017`` is the port number.
Replace these values to refer to your MongoDB instance.

The last part of the connection URI contains connection options as parameters.
In the example, we set two connection options: ``maxPoolSize=20`` and
``w=majority``. For more information on connection options, see the
:ref:`kotlin-connection-options` guide.

.. _mongoclient:

MongoClient
-----------

You can connect to and communicate with MongoDB by using the ``MongoClient``
class.

Use the ``MongoClient.create()`` method to construct a ``MongoClient``.

The following code shows how to create a ``MongoClient`` that connects to a local
MongoDB deployment:

.. code-block:: kotlin

   import com.mongodb.kotlin.client.coroutine.MongoClient

   val uri = "mongodb://localhost:27017/"
   val client = MongoClient.create(uri)

.. important:: Reuse Your Client

   As each ``MongoClient`` represents a thread-safe pool of connections to the
   database, most applications only require a single instance of a
   ``MongoClient``, even across multiple threads.
   All resource usage limits, such as max connections, apply to individual
   ``MongoClient`` instances.

To learn about the different settings you can use to control the behavior of
your ``MongoClient``, see the :ref:`MongoClient Settings
<specify-mongoclient-settings>` guide.

.. tip::

   Always call ``MongoClient.close()`` to clean up resources when an
   instance is no longer needed.

API Documentation
-----------------

For more information about the methods and classes mentioned in this section,
see the following API documentation:

- `MongoClient <{+driver-api+}/-mongo-client/index.html>`__
- `create() <{+driver-api+}/-mongo-client/-factory/create.html>`__