ref: run-facet-query-nodejs
stepnum: 1
title: "Run an |fts| facet query that groups the genre and year fields
       into buckets."
content: |

  a. Create a file named ``facet-query.js``. 
  #. Copy and paste the following code into the
     ``facet-query.js`` file.

     The code example performs the following tasks:

     - Imports ``mongodb``, MongoDB's Node.js driver.
     - Creates an instance of the ``MongoClient`` class to establish a 
       connection to your |service| cluster.
     - Uses the following searchMeta clauses to query the collection: 

       .. include:: /includes/extracts/fts-facet-constant-desc.rst 

     - Iterates over the cursor to print the documents that match the 
       query.
       
     .. literalinclude:: /includes/fts-tutorial/facet/tutorial.js
        :language: javascript
        :linenos:
        :dedent:

  #. .. include:: /includes/fact-fts-driver-connection-string.rst
  #. Run the following command to query your collection: 
  
     .. code-block:: sh 
     
        node facet-query.js

  When you run ``facet-query.js``, the program prints 
  the following documents to your terminal:

  .. code-block:: javascript
     :copyable: false

     '{"count":{"lowerBound":23026},
       "facet":{
         "genresFacet":{
           "buckets":[
             {"_id":"Drama","count":13527},
             {"_id":"Comedy","count":6922},
             {"_id":"Romance","count":3615},
             {"_id":"Crime","count":2649},
             {"_id":"Thriller","count":2603},
             {"_id":"Action","count":2505},
             {"_id":"Documentary","count":2041},
             {"_id":"Adventure","count":2016},
             {"_id":"Horror","count":1662},
             {"_id":"Biography","count":1373}]},
         "yearFacet":{
           "buckets":[
             {"_id":1910,"count":23},
             {"_id":1920,"count":89},
             {"_id":1930,"count":308}]}}}'

...
