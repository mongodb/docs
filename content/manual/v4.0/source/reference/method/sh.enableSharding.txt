===================
sh.enableSharding()
===================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Definition
----------

.. method:: sh.enableSharding(database, primaryShard)

   Enables sharding on the specified database. Once you enabled
   sharding for a database, you can use :method:`sh.shardCollection()`
   to shard collections in that database. The :binary:`~bin.mongo`
   shell method :method:`sh.enableSharding()` wraps the
   :dbcommand:`enableSharding` command.

Syntax
------

The :method:`sh.enableSharding` has the following form:

.. code-block:: javascript

   sh.enableSharding( 
      <database>,
      <primary shard>  // Optional. Available starting in MongoDB 4.0.14
   )

Parameter
~~~~~~~~~

The :method:`sh.enableSharding()` method takes the following parameter:

.. list-table::
   :header-rows: 1
   :widths: 20 20 60

   * - Parameter
     - Type
     - Description

   * - :ref:`database <method-enableSharding-db>`

     - String

     - .. _method-enableSharding-db:

       The database for which you wish to enable sharding.

   * - :ref:`primaryShard <method-enableSharding-primaryShard>`

     - String

     - .. _method-enableSharding-primaryShard:

       Optional. The :ref:`primary shard <primary-shard>` for the
       database; the primary shard contains the unsharded collection
       for this database. In general, rather than explicitly specifying
       the primary shard, it is recommended to let the balancer select
       the primary shard instead.

       .. admonition:: Tip
          :class: warning

          In general, you should not need to specify the primary shard. Allow
          the balancer to select the primary shard instead.

       *Available starting in MongoDB 4.0.14*

Behavior
--------

Write Concern
~~~~~~~~~~~~~~

.. include:: /includes/extracts/mongos-operations-wc-enable-sharding.rst

Primary Shard
~~~~~~~~~~~~~

In general, you should not need to specify the :ref:`primaryShard
<method-enableSharding-primaryShard>` in the command. Instead, allow the
balancer to select the primary shard. 

However, if you do specify the :ref:`primary shard
<method-enableSharding-primaryShard>` for a database and the database
is already enabled for sharding with a different primary shard, the
operation returns an error and the primary shard for the database
remains as before. To change the primary shard for a database, use the
:dbcommand:`movePrimary` command instead.


Example
-------

The following example, run from a :binary:`~bin.mongos`, enables
sharding for the ``test`` database:

.. code-block:: javascript

   sh.enableSharding("test")

To verify, run :method:`sh.status()`.

.. seealso::

   - :method:`sh.shardCollection()`
   - :doc:`/tutorial/deploy-shard-cluster`

