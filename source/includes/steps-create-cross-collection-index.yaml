title: Create an on-demand materialized view.
stepnum: 1
ref: create-on-demand-materialized-view
content: |
  Create an
  :manual:`On-Demand Materialized View </core/materialized-views/>`,
  using an
  :manual:`aggregation pipeline </core/aggregation-pipeline>`
  with a
  :manual:`$merge </reference/operator/aggregation/merge>`
  stage.
---
stepnum: 2
title: Define an {+app-services+} Function to perform the ``$merge`` aggregation.
ref: define-aggregation-function
content: |
  To keep the on-demand materialized 
  view up to date,
  :realm:`define an {+app-services+} function </functions/define-a-function/>`
  that performs the 
  ``$merge`` aggregation 
  on a periodic basis.
---
stepnum: 3
title: Keep the materialized view up to date using an {+app-services+} Scheduled Trigger.
ref: update-collection-with-scheduled-trigger
content: |
  To refresh the on-demand materialized view on 
  a periodic basis,
  create a 
  :realm:`{+app-services+} Scheduled Trigger </triggers/scheduled-triggers/>`
  that calls the ``$merge`` aggregation 
  {+app-services+} function created in the previous step.
---
stepnum: 4
title: :ref:`Create an Atlas Search Index <ref-create-index>`
  on the materialized view. 
ref: create-index
---
stepnum: 5
title: :ref:`Run an Atlas Search Query <fts-tutorial-run-query>` on the materialized view.
ref: run-query
...
