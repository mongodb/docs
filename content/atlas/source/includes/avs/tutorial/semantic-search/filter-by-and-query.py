import pymongo

# connect to your Atlas cluster
client = pymongo.MongoClient("<connection-string>")

# define pipeline
pipeline = [
  {
    '$vectorSearch': {
      'index': 'vector_index', 
        'path': 'plot_embedding_voyage_3_large', 
        'filter': {
          '$and': [
            {
              'genres': {
                '$nin': [
                  'Drama', 'Western', 'Crime'
                ], 
                '$in': [
                  'Action', 'Adventure', 'Family'
                ]
              }
            }, {
              'year': {
                '$gte': 1960, 
                '$lte': 2000
              }
            }
          ]
        }, 
        'queryVector': [-0.021090532,-0.026399033,-0.024103465,-0.025538195,-0.000549233,0.011836523,-0.013199517,-0.003766167,-0.005165028,-0.02238179,0.037876874,0.010617003,0.010903949,-0.001354026,0.006850836,-0.018005863,-0.02195137,0.019512329,-0.041894119,-0.008357302,0.027546817,-0.025251249,0.004340059,-0.02195137,-0.003748232,-0.006205208,0.021377478,0.008931194,-0.00173961,-0.009827901,-0.016642869,-0.033572685,-0.026399033,0.015208139,0.010114847,-0.0233861,-0.011406104,-0.033142265,-0.008895326,-0.014347301,-0.019081909,-0.049067769,0.034433521,-0.023673046,0.004160717,-0.01334299,-0.06714537,0.032568373,-0.022525262,-0.024677357,0.011334368,0.027403345,0.026399033,-0.016786342,-0.015925504,0.013916882,-0.005487842,-0.0233861,0.026542507,-0.052798066,-0.025681669,-0.025394723,0.014203828,0.014921193,-0.031564061,0.010760476,0.010688739,0.013916882,-0.037876874,0.039598551,-0.000816003,0.003766167,-0.001694775,0.026972925,-0.009469219,0.015351612,-0.007245387,0.028981548,-0.035724778,0.010688739,0.001228488,0.004106915,-0.024677357,0.028551128,-0.033716157,-0.013486463,0.018292809,-0.018221073,0.009612692,-0.003622693,-0.001138817,-0.021234006,-0.045624416,0.020803586,0.007675806,-0.009612692,-0.021664424,-0.026685979,-0.025968615,0.001775478,-0.007496465,0.02051664,-0.054519743,0.018221073,0.014132091,-0.009684428,-0.025825141,-0.014921193,-0.057389203,-0.020660114,-0.028264182,-0.008931194,-0.019942747,-0.003228143,-0.014419037,0.021234006,-0.004573202,0.007317123,0.018651491,-0.016571132,-0.036155198,-0.032855317,0.000726332,-0.031851009,0.018938437,0.021234006,-0.048206929,0.017934127,-0.013414727,-0.009469219,0.064849801,0.006348681,-0.039024659,0.021377478,-0.022668736,-0.026829453,-0.019081909,0.027977237,-0.004627005,-0.038450766,0.004465597,-0.041894119,0.008213829,0.03055975,0.052224174,-0.00277979,-0.032137953,-0.013629936,0.022094844,-0.005918262,0.020660114,0.010617003,-0.020373167,-0.001614071,0.021090532,-0.005523711,0.004878082,-0.021090532,0.029698912,0.000726332,0.003371616,-0.022238316,0.008715985,0.038737711,0.013486463,-0.008536644,0.040172443,0.017503707,-0.028838074,0.061693393,-0.003066736,0.008285566,-0.034576993,0.01578203,-0.02238179,0.015925504,0.066571474,-0.038737711,-0.050215553,0.009325746,-0.010903949,-0.041607171,-0.006384549,0.026972925,-0.000119374,-0.003066736,-0.024103465,0.005093292,0.028981548,0.026829453,-0.001703742,0.043041904,0.010186584,0.010688739,0.004357993,-0.016571132,-0.010545266,-0.033142265,-0.005559579,-0.000365408,-0.00717365,0.019655801,0.047633037,0.044476632,0.01456251,-0.002977065,0.025681669,-0.015423348,-0.02051664,-0.019512329,0.014705983,0.002977065,0.03055975,-0.014347301,0.024390411,0.005882393,-0.012195205,0.004071047,-0.028694602,0.031277116,-0.010114847,0.005272633,0.017934127,0.037589926,-0.046198308,-0.02195137,-0.037876874,0.021234006,-0.034720469,-0.018005863,0.03055975,-0.015495085,-0.035150886,0.004178651,0.005882393,0.075753748,0.00595413,-0.083214343,-0.016284186,0.022238316,-0.032998793,-0.00491395,-0.009254009,-0.007819279,0.046198308,-0.008464907,0.014634247,0.031707536,-0.00317434,-0.026255561,-0.010617003,-0.033285737,0.020086221,-0.016858079,-0.012195205,-0.041894119,0.000721849,0.038163818,0.02238179,0.011406104,0.010330057,0.032137953,-0.01047353,0.039311603,-0.01291257,-0.03099017,-0.018938437,-0.013271254,-0.001820314,-0.005380238,0.003299879,-0.024533885,-0.001093982,0.012123469,-0.005236765,0.014132091,-0.018221073,0.013629936,0.022238316,-0.00317434,0.034003101,0.019081909,0.008034488,-0.02912502,0.026542507,-0.011334368,-0.077475421,0.038163818,-0.003568891,0.019081909,0.019512329,0.002385239,-0.032568373,-0.020373167,0.038737711,-0.013773409,0.01621245,-0.028407656,-0.021090532,-0.004411795,-0.013916882,-0.001533368,0.004322124,-0.024820831,0.004627005,-0.004591136,0.014849456,-0.014275564,-0.020229694,0.0233861,0.015566821,0.022525262,-0.024390411,-0.028694602,0.001766511,-0.036011726,0.006456285,-0.011262631,0.005523711,0.012266942,-0.019225383,-0.015423348,0.011836523,-0.011334368,-0.009827901,-0.011119158,0.007030177,0.00277979,0.004537334,-0.016571132,0.013127781,-0.013701673,-0.016571132,0.002941197,0.000959476,-0.004483532,0.010760476,0.043041904,-0.032568373,-0.015423348,0.006169339,-0.02094706,-0.050215553,0.012769097,0.015495085,0.001318158,0.00164994,-0.045337472,0.001533368,0.005595447,0.039311603,-0.030703224,0.023242628,-0.008787721,-0.021234006,-0.021234006,-0.001524401,0.007281255,0.01334299,0.00164994,-0.005451974,-0.011047422,-0.021234006,-0.033572685,-0.015423348,-0.005236765,0.025681669,-0.02051664,-0.024103465,-0.021377478,-0.00738886,-0.031707536,0.017790653,-0.026829453,0.007783411,-0.003335747,0.024677357,0.006384549,0.035724778,-0.004017244,-0.018651491,-0.014060355,-0.029842386,-0.012553888,0.006994309,-0.00317434,0.018292809,0.019942747,-0.01169305,0.002456975,0.010330057,-0.031707536,0.00799862,-0.019655801,-0.006205208,-0.012769097,-0.035294361,0.026112087,-0.004483532,0.02094706,0.019081909,0.001676841,-0.040746335,-0.004035179,-0.014992929,0.004375927,-0.049928606,-0.02051664,0.004268322,0.015351612,-0.037016038,-0.001452664,-0.021234006,-0.005738921,-0.051650282,-0.008285566,0.012840834,-0.015925504,0.018794963,-0.001228488,-0.035868254,-0.00347922,-0.003264011,0.002528712,0.01477772,-0.010545266,0.018221073,0.018149335,-0.028838074,-0.012984307,-0.037302982,-0.041607171,-0.043328848,-0.019799275,-0.019225383,-0.011047422,0.011908259,0.021664424,-0.012553888,0.004662873,0.005451974,-0.024533885,0.0067791,0.022812208,-0.037589926,-0.031564061,0.007101914,-0.00760407,-0.025107777,0.015566821,0.020803586,-0.033572685,0.062841177,0.034146577,-0.007532333,-0.001865149,-0.023673046,0.032424901,0.018508019,-0.005703052,-0.015853768,0.019655801,0.042181063,0.006671495,-0.004573202,0.024390411,0.009756165,-0.00029143,0.000107605,0.032711845,-0.005523711,-0.015566821,0.009110536,0.017216761,0.006241076,-0.003945508,0.007783411,0.024246939,0.048206929,0.00277979,-0.002367305,-0.05107639,-0.016284186,-0.016929815,0.016858079,0.000703914,-0.021234006,0.021234006,-0.014634247,0.001389895,0.008321434,-0.016499396,0.014921193,0.025394723,0.035437834,0.013486463,-0.022668736,-0.012338678,-0.034003101,-0.005559579,-0.008106225,0.023959992,-0.019368855,0.024533885,-0.000600793,0.009756165,-0.001936886,-0.014490774,0.018077599,0.004447663,0.011262631,-0.003658562,0.043328848,-0.018938437,0.00799862,-0.018221073,0.041320227,0.000363166,-0.003730298,0.002851526,-0.024103465,0.003515089,-0.0135582,-0.003497155,-0.006814968,0.014060355,0.027116399,-0.003192274,0.011406104,0.042468011,-0.036442146,-0.007245387,0.032424901,-0.038737711,0.008680117,-0.035581306,0.027546817,0.021664424,-0.000757717,-0.022238316,0.018221073,-0.006205208,0.005093292,0.001264356,-0.002116227,0.001098465,0.017431971,-0.042181063,0.010760476,0.033285737,0.002708053,-0.007352991,-0.009827901,-0.031994481,-0.020803586,0.009971374,-0.014849456,-0.003658562,0.024964303,-0.001793413,0.021090532,0.01578203,0.012984307,0.006922573,-0.032711845,-0.013701673,0.00390964,0.017503707,-0.015351612,0.006922573,0.028694602,0.012266942,-0.027259871,0.007675806,-0.002295568,-0.020086221,0.00595413,-0.027833764,0.001551302,0.008644248,-0.002187963,0.00040576,0.024964303,0.013916882,-0.015925504,0.014347301,-0.011549577,0.018938437,-0.032424901,0.003730298,0.003281945,0.032998793,0.005595447,0.025681669,0.011047422,0.026399033,0.02912502,-0.006241076,0.004627005,0.024390411,0.001542335,-0.034576993,0.011477841,-0.00491395,-0.014347301,0.023529572,-0.004770477,-0.014921193,-0.028264182,0.02812071,0.00164994,0.008680117,-0.005416106,0.035581306,-0.02812071,0.006097603,-0.016355922,-0.010114847,0.033142265,-0.021807898,0.001228488,-0.002170029,-0.032711845,0.018149335,0.014132091,0.03055975,0.031133642,-0.011979996,0.008967063,-0.013486463,-0.02812071,0.052224174,0.004124849,-0.008715985,-0.034863941,0.025251249,0.07977099,-0.000072297,-0.014705983,0.033142265,0.024103465,-0.004232454,-0.007496465,-0.024246939,-0.029698912,-0.009469219,0.010114847,0.001201586,0.00860838,0.012051732,-0.006025866,0.014490774,0.014992929,0.01169305,-0.003192274,0.005308501,0.0045194,0.017575443,0.001022245,-0.018794963,-0.001847215,0.011119158,0.02051664,-0.006886704,0.010330057,-0.003353682,0.018794963,0.013773409,0.026399033,0.007962752,-0.018221073,-0.012553888,-0.003586825,-0.002170029,0.047633037,0.011908259,0.007209518,0.045624416,0.028694602,0.004357993,0.023959992,0.004232454,0.009182272,0.003012933,0.035294361,-0.055954475,0.014849456,0.012553888,0.004340059,-0.000511123,-0.024390411,0.011406104,0.013127781,0.013629936,-0.011406104,0.002582514,-0.004555268,0.005559579,0.000569409,0.017934127,-0.014060355,0.02912502,0.003819969,0.011190895,-0.011262631,0.017001551,0.012553888,-0.02238179,0.024246939,0.032281429,0.032711845,-0.016714605,-0.021520952,0.016355922,-0.011334368,-0.003891705,-0.008572512,-0.016929815,0.0135582,-0.057963096,0.015566821,0.001856182,-0.002456975,-0.000766684,0.005380238,0.000923607,0.035581306,0.005272633,-0.009612692,0.018651491,-0.023959992,-0.001416796,0.033285737,-0.002725987,0.024533885,-0.010186584,0.003802035,-0.029268494,-0.011764786,0.003837903,0.022955682,0.053945851,-0.002232799,0.019512329,0.014419037,0.028407656,0.004985687,0.00210726,0.005774789,0.032568373,-0.024964303,0.019655801,-0.012123469,0.031994481,0.015638558,0.038450766,-0.011979996,0.033716157,0.019368855,0.017431971,0.022668736,0.015423348,-0.001927919,-0.001102949,0.028694602,-0.013701673,-0.036155198,-0.010688739,0.000535782,-0.021807898,-0.005200896,-0.040459387,0.007137782,-0.006492154,-0.00277979,0.020803586,0.027833764,-0.000780134,0.000600793,-0.025538195,-0.011764786,0.021090532,0.028694602,-0.016929815,-0.025251249,0.029268494,-0.013271254,0.014634247,0.000376617,-0.025251249,-0.026255561,-0.037302982,0.003138472,-0.024677357,-0.019799275,0.025825141,-0.040746335,0.002510778,-0.031851009,-0.014347301,-0.00158717,-0.046772201,-0.028838074,0.006635627,-0.001058113,0.014132091,-0.00286946,0.019368855,0.007281255,0.036155198,0.065710634,0.018794963,-0.029268494,0.003461286,0.012984307,0.006133471,0.003497155,0.046198308,-0.014132091,-0.010186584,0.028981548,-0.000286946,-0.003102604,0.011190895,0.014490774,-0.020660114,-0.00347922,-0.004842214,-0.000506639,0.002600448,0.017073289,-0.011836523,-0.026685979,-0.023959992,0.023673046,-0.006958441,0.040172443,-0.031133642,0.009182272,-0.015638558,-0.002421107,0.004555268,0.014705983,-0.028407656,-0.014921193,-0.015710294,-0.008751853,-0.006420417,-0.038450766,-0.011908259,0.006133471,0.002474909,-0.008070357,-0.01025832,-0.011119158,0.004465597,0.010903949,0.009074667,0.030703224,-0.019368855,-0.007891015,0.007675806,-0.005093292,0.023099154,0.022094844,0.00738886,0.007066045,-0.023242628,-0.020660114,0.009397482,-0.006635627,0.009540955,0.006348681,-0.013773409,-0.000186067,-0.021234006,-0.017145025,-0.007030177,0.010114847,0.024390411,-0.024964303,-0.041033279,0.0135582,0.014060355,0.008715985,0.018794963,-0.039598551,-0.015208139,0.027977237,0.020086221,0.012195205,-0.010760476,-0.025538195,0.025394723,0.012697361,-0.053371958,-0.008249698,0.005846525,-0.045624416,-0.027977237,-0.012410415,-0.02195137,-0.022955682,0.011477841,0.026972925,-0.031420588,-0.012051732,-0.015925504,-0.004322124,-0.017145025,0.012840834,0.01578203,-0.010186584,-0.00091464,-0.028264182,0.00369443,-0.029985858,-0.009899638,0.018794963,0.053945851,0.007317123,-0.020086221,0.008967063,-0.001506467,-0.006850836,0.011477841,-0.003120538,-0.005631316,-0.027977237,0.01047353,0.003120538,-0.001354026,-0.004160717,-0.004698741,-0.049067769,0.021807898,-0.037589926,0.03672909,-0.004878082,-0.006241076,0.000049879,0.014203828,-0.027259871,0.004196586,-0.002421107,0.008106225,-0.00760407,-0.003802035,-0.016140714,0.038737711,-0.010043111,-0.037589926,-0.062267285,-0.001506467,-0.006384549,-0.012697361,-0.011190895,-0.01578203,0.014132091,-0.02238179,-0.024677357,0.011621314,-0.028407656,0.010688739,0.039311603,0.009254009,-0.009612692,-0.040459387,0.021234006,0.007926884,-0.057102256,-0.045624416,0.003497155,-0.003120538,-0.015853768,-0.006528022,0.011334368,-0.008177961,-0.033716157,0.010114847,0.035868254,-0.021807898,-0.010975685,-0.039024659,0.021234006,0.001990688,-0.009756165,-0.003819969,-0.033142265,-0.035150886,0.028407656,0.007711674,0.018364545,0.005416106,0.010545266,-0.032281429,0.01291257,0.003102604,-0.009756165,0.05107639,-0.001080531,-0.043615796,0.025968615,0.012697361,0.024820831,0.024246939,-0.020086221,-0.012195205,0.00760407,0.009540955,-0.003802035,0.043328848,-0.010043111,0.003891705,-0.054519743,0.043041904,-0.032711845,0.024820831,0.018651491,-0.008357302,0.009540955,-0.003156406,-0.019081909,-0.025825141,-0.02912502,0.026255561,-0.017216761,0.010401793,-0.028551128,-0.005200896,0.012625624,-0.008142093,0.039311603,-0.00082497,-0.003784101,0.037876874,0.006599758,-0.021520952,0.047633037,0.012410415,-0.01477772,0.023529572,0.004985687,-0.031707536,0.007675806,-0.017934127,-0.034863941,0.018794963,-0.011119158,-0.027546817,0.009612692,0.00760407,0.057102256,0.006241076,0.007281255,-0.007675806,-0.008285566,0.012553888,-0.007245387,0.016284186,-0.024964303,0.007030177,-0.011836523,-0.045050524,0.021090532,-0.021664424,0.00369443,0.037016038,-0.010186584,-0.00656389,0.016355922,0.019225383,0.009002931,-0.008034488,-0.004555268,0.046772201,-0.014347301,0.014347301,-0.023959992,0.017790653,0.031133642,-0.025825141,0.035581306,-0.012769097,0.017360235,0.024677357,0.000046517,0.010903949,0.011262631,-0.000573892,0.026829453,-0.024820831,-0.001309191,0.008177961,-0.002143128,-0.018651491,-0.026685979,-0.040172443,-0.018651491,0.007568201,-0.018794963,0.003281945,-0.014347301,0.005738921,-0.020373167,-0.02051664,-0.028551128,-0.040172443,-0.017718917,0.046198308,0.003802035,-0.005523711,0.07345818,0.000412485,-0.025968615,0.024246939,-0.024964303,0.024820831,0.005882393,0.011190895,0.020086221,-0.029411966,-0.029842386,0.006922573,-0.004286256,0.0233861,-0.0135582,0.000551474,0.026255561,0.019799275,0.003568891,-0.025681669,-0.009469219,-0.002636316,0.013486463,0.050215553,-0.040459387,-0.003622693,0.019225383,-0.015853768,-0.017001551,0.028407656,0.02812071,0.01477772,-0.007209518,0.046198308,0.024246939,0.035868254,-0.019225383,-0.030272804,0.006599758,0.000473013,-0.018364545,0.033429209,-0.0233861,0.021664424,0.028694602,-0.009684428,-0.002815658,0.015136402,0.006994309,0.017360235,-0.027116399,0.042181063,-0.018794963,-0.037589926,-0.018508019,-0.012266942,-0.00277979,-0.01334299,-0.020373167,-0.004949819,-0.018651491,0.026829453,-0.011979996,0.00799862,0.040459387,-0.00738886,0.008249698,0.017718917,-0.042754956,-0.011119158,-0.043615796,-0.009325746,-0.009612692,-0.008285566,-0.008213829,0.012625624,0.000919124,-0.041033279,0.000636661,-0.045911364,-0.001909984,-0.016642869,0.013414727,0.03055975,-0.013414727,0.010186584,0.056241419,-0.008321434,-0.000200638,0.006205208,0.012625624,0.009756165,-0.035294361,0.034003101,-0.023529572,0.031564061,-0.026399033,0.029268494,0.001183652,0.01334299,0.004035179,-0.00491395,-0.002241766,-0.011764786,0.029268494,-0.011621314,0.037302982,-0.020086221,0.018651491,-0.01578203,-0.025825141,0.002528712,0.057102256,0.046198308,-0.006169339,0.008249698,0.009397482,-0.008142093,-0.037876874,-0.041607171,-0.01169305,-0.013773409,-0.020086221,-0.038737711,-0.019799275,-0.035437834,0.019368855,-0.001246422,-0.013845146,-0.037876874,-0.006814968,-0.003066736,0.003730298,0.016499396,0.012840834,0.02051664,-0.006994309,0.009182272,-0.00738886,-0.000193913,-0.037016038,0.007281255,-0.016427658,-0.003568891,0.02912502,0.021807898,0.02912502,0.004124849,-0.012625624,0.02195137,-0.036155198,0.011334368,0.018651491,0.040459387,0.006205208,0.015064666,-0.023959992,0.017360235,-0.000567167,0.032998793,-0.023099154,0.075753748,-0.038737711,-0.005057423,-0.019799275,0.014849456,-0.050215553,-0.001111916,-0.006169339,0.009469219,-0.019081909,-0.013127781,-0.028838074,-0.013414727,-0.008213829,0.006312812,-0.008177961,-0.021664424,-0.010832212,-0.012697361,0.014634247,0.004393861,-0.045337472,-0.010975685,-0.030703224,-0.003228143,-0.014849456,-0.034003101,0.009612692,-0.004806346,-0.006492154,0.018938437,0.00277979,0.023816518,-0.003407484,-0.01169305,0.006276944,-0.024820831,0.00189205,0.006814968,-0.019655801,0.035294361,0.009038799,0.006922573,0.011334368,-0.018651491,-0.009899638,0.029985858,-0.008285566,-0.013845146,0.032424901,-0.024533885,-0.024677357,0.031420588,0.003604759,0.004232454,0.01578203,-0.025107777,0.003784101,0.006276944,-0.010832212,0.009074667,-0.040172443,0.048780821,0.02094706,-0.009110536,0.008680117,-0.014132091,0.023816518,0.012051732,-0.012123469,-0.032998793,-0.032424901,-0.021664424,-0.025538195,-0.01047353,0.009002931,-0.039311603,-0.004806346,0.023673046,-0.012123469,-0.006850836,-0.030272804,0.043615796,0.002456975,0.001273323,-0.007711674,-0.008177961,0.06714537,-0.043615796,0.017216761,0.00882359,-0.005416106,-0.014060355,0.034146577,-0.022812208,-0.009899638,-0.00390964,-0.032137953,0.007245387,0.047633037,-0.007352991,0.006097603,-0.019225383,-0.027833764,-0.010545266,0.002905329,-0.002797724,0.038450766,-0.013629936,-0.008106225,-0.001143301,-0.000014361,-0.043328848,0.029698912,0.027690291,0.002143128,0.012051732,-0.02812071,0.024677357,-0.012984307,0.008715985,-0.005523711,0.039024659,-0.020373167,-0.028838074,0.026972925,0.018364545,-0.010114847,-0.011406104,0.033572685,-0.028838074,0.024677357,-0.011836523,-0.009612692,-0.03672909,0.025107777,-0.025251249,-0.009182272,0.002618382,0.030416278,-0.003210209,0.033859629,-0.015208139,-0.015279875,0.010975685,0.014132091,-0.010545266,-0.002600448,0.003945508,-0.001990688,-0.008859458,0.024533885,0.027116399,-0.005487842,-0.028551128,0.008321434,0.016714605,0.010617003,0.043328848,0.025251249,-0.033429209,0.005667184,-0.012840834,0.037589926,-0.012482151,0.002546646,0.01477772,-0.003120538,0.012984307,-0.054232799,-0.013199517,-0.029985858,-0.023673046,-0.014992929,-0.010760476,0.0233861,-0.02912502,-0.020803586,-0.010545266,0.022238316,0.005021555,0.041033279,0.016140714,-0.006097603,0.015351612,-0.017790653,-0.007675806,-0.032281429,-0.012338678,0.02955544,-0.016427658,0.039885495,0.001192619,-0.006241076,-0.000663563,-0.008070357,-0.001452664,0.025681669,-0.020803586,-0.010401793,0.001443697,0.012410415,0.007926884,-0.034003101,0.017360235,0.000999828,0.019799275,-0.001102949,0.005918262,0.010545266,-0.023529572,0.016714605,0.016571132,0.003604759,0.016140714,-0.020660114,-0.007101914,0.014132091,-0.035437834,-0.018938437,0.019225383,-0.006886704,-0.03629867,0.010545266,-0.017216761,0.005595447,-0.022812208,0.009971374,0.003371616,-0.022955682,-0.013701673,-0.019368855,-0.022238316,0.004627005,0.008213829,0.002600448,0.012769097,-0.027116399,0.015279875,-0.017073289,-0.019512329,-0.010043111,0.003120538,0.0045194,-0.024246939,0.010903949,0.001667874,-0.008895326,0.031277116,-0.016571132,-0.012266942,0.006348681,0.048493877,-0.010186584,0.001506467,0.022955682,-0.012625624,0.018938437,-0.004698741,-0.009002931,0.008249698,0.035724778,0.002887394,-0.00399931,0.007747543,-0.000780134,-0.001389895,-0.003138472,-0.016284186,-0.041033279,-0.018364545,-0.001847215,-0.011190895,0.006061735,-0.044189688,0.033859629,-0.010043111,0.040172443,-0.025251249,-0.006241076,-0.01621245,-0.028694602,-0.001345059,-0.021377478,0.037876874,0.007675806,0.006528022,0.019942747,-0.006133471,0.014275564,-0.005380238,-0.043328848,-0.05825004,0.019512329,-0.00090119,-0.018364545,-0.023099154,-0.003407484,0.026829453,-0.06542369,-0.024677357,0.011262631,-0.002618382,-0.013916882,0.031133642,-0.016427658,-0.017934127,0.020086221,-0.009827901,0.009899638,0.011621314,-0.005308501,0.021377478,-0.011621314,0.009971374,-0.037876874,-0.013916882,0.014419037,-0.001748577,0.014132091,-0.026972925,0.002725987,-0.03672909,-0.004017244,0.005738921,0.001748577,-0.014921193,-0.013127781,0.033572685,-0.022094844,-0.038163818,-0.030129332,0.005057423,0.034576993,0.028264182,0.029698912,-0.003443352,0.022238316,-0.026255561,-0.029842386,0.001883083,-0.006241076,-0.032711845,0.008429039,0.019799275,0.015710294,-0.019368855,-0.00882359,-0.007101914,-0.013414727,-0.004698741,0.01477772,-0.015351612,-0.018508019,0.034290049,-0.012984307,0.008859458,-0.010688739,-0.000573892,0.028694602,0.002313502,0.023959992,-0.013199517,-0.004770477,-0.035294361,0.003228143,0.004949819,-0.041033279,-0.015638558,0.02812071,0.009612692,-0.010760476,-0.005057423,0.010043111,-0.035868254,-0.003192274,0.016427658,-0.007711674,0.012051732,-0.013773409,0.034720469,0.00760407,0.009469219,0.012840834,-0.007962752,-0.024677357,0.006348681,-0.01334299,-0.00308467,0.012984307,0.015208139,0.02955544,0.002116227,0.000403518,-0.02195137,-0.015136402,0.002905329,0.008321434,-0.028981548,-0.035294361,-0.024533885,0.002994999,-0.017073289,-0.021664424,0.013414727,0.006384549,-0.024964303,0.018508019,0.002941197,0.01047353,-0.022668736,0.00421452,-0.034433521,0.005380238,-0.018938437,0.017001551,0.019081909,-0.002636316,-0.006456285,0.008644248,0.008859458,0.011190895,-0.00760407,0.006707363,0.007066045,-0.017718917,0.012195205,-0.037589926,-0.001013278,-0.002456975,-0.003658562,0.016499396,-0.00286946,0.002851526,-0.013414727,0.027977237,-0.040459387,-0.000515606,0.017431971,-0.00882359,0.029985858,-0.007532333,-0.01169305,-0.011836523,0.022525262,0.004627005,0.027403345,-0.010688739,-0.011334368,-0.031564061,-0.018221073,0.023959992,-0.016858079,0.045624416,0.017288497,-0.023529572,-0.016786342,0.042181063,0.003748232,-0.017288497,-0.008142093,-0.004268322,0.040172443,-0.019368855,0.006671495,-0.001488532,0.042754956,-0.020229694,-0.028694602,-0.041033279,0.01047353,0.004286256,0.004411795,-0.019081909,0.020803586,0.03672909,-0.008142093,-0.008751853,0.001640973,-0.014347301,-0.038450766,0.000522331,-0.020229694,-0.018508019,0.035581306,0.050789446,0.055093635,-0.021807898,0.038163818,-0.011262631,0.025251249,-0.034290049,0.045050524,0.0067791,-0.02094706,-0.048206929,0.008859458,0.007137782,-0.024677357,0.012769097,0.006025866,-0.035294361,0.009612692,-0.04476358,0.007675806,0.037876874,0.005236765,0.001156751,0.012625624,0.01025832,0.023529572,0.015423348,0.004160717,-0.021664424,-0.017862389,0.015925504,0.041033279,0.023242628,0.019512329,0.037876874,-0.018005863,-0.006635627,0.001981721,0.016571132,0.009540955,0.010114847,0.008715985,0.006599758,0.012410415,0.005236765,-0.014992929,0.03099017,-0.002797724,-0.039885495,0.05825004,0.000159165,0.016140714,0.043041904,-0.000887739,0.008034488,0.024964303,-0.028838074,-0.015638558,0.009182272,-0.033859629,-0.001963787,-0.008070357,-0.009612692,-0.012410415,0.003676496,-0.047633037,0.005236765,0.032711845,0.002439041,0.017073289,-0.011621314,-0.011764786,-0.018651491,0.003927574,0.002456975,-0.019225383,0.018938437,0.046198308,0.019081909,-0.045624416,-0.015423348,0.009182272,0.020086221,0.008393171,-0.003855837,-0.019942747,-0.02094706,0.000883256,0.015064666,-0.010688739,0.011119158,0.015495085,0.014490774,-0.022238316,0.012051732,0.012769097,-0.019081909,-0.005344369,-0.011621314,0.017145025,-0.008249698,-0.005344369,0.022812208,0.002286601,-0.009002931,0.028407656,-0.001865149,-0.013701673,-0.013845146,-0.006492154,0.022812208,-0.030416278,-0.035294361,-0.042754956,-0.016284186,0.007137782,0.002510778,0.008572512,-0.013701673,0.00656389,-0.006671495,0.012697361,-0.022238316,-0.001856182,0.006276944,0.006599758,0.008680117,-0.006133471,0.006958441,-0.023816518,0.008177961,0.009254009,0.003335747,-0.006635627,-0.015853768,0.007532333,-0.048206929,-0.05825004,-0.025394723,-0.031420588,-0.001049146,0.021377478,-0.023816518,-0.046198308,0.026112087,0.0045194,-0.028694602,-0.007747543,-0.024533885,-0.024677357,-0.032281429,0.018794963,-0.032711845,-0.009684428,0.011190895,-0.001380928,0.015279875,-0.025107777,-0.005738921,-0.004340059,-0.002170029,-0.017718917,-0.020373167,0.010186584,-0.009971374,-0.025394723,0.003622693,-0.048493877,0.015638558,-0.036155198,-0.016427658,-0.000600793,0.003281945,0.022094844,-0.009110536,-0.017145025,-0.023242628,-0.014921193,0.023673046,0.02195137,-0.025394723,0.003371616,-0.032998793,-0.000959476,-0.037589926,-0.013271254,-0.04476358,-0.015423348,-0.018651491,-0.049067769,0.033429209,-0.002089326,-0.033716157,-0.000932575,-0.001080531,0.036155198,-0.004106915,0.005272633,-0.02195137,-0.010043111,-0.027403345,-0.035868254,0.006814968,0.039598551,0.037302982,-0.041320227,-0.025394723,-0.025394723,-0.000699431,0.003604759,0.016355922,-0.00799862,-0.006994309,0.035150886,0.020229694,-0.007747543,0.017647181,0.026399033,-0.030416278,-0.011908259,0.026542507,-0.012195205,0.034146577,-0.006169339,-0.008859458,0.0045194,0.019799275,-0.031277116,-0.022812208,0.007066045,0.039885495,0.001264356,-0.026542507,-0.016355922,0.002214865,-0.018938437,-0.02955544,-0.008070357,-0.006420417,-0.001389895,0.002241766,-0.018292809,0.016355922,-0.002134161,0.037302982,0.00180238,-0.013199517,-0.020086221,-0.011621314,0.021377478,-0.005272633,-0.02195137,-0.017216761,0.037876874,0.033142265,0.041607171,-0.011477841,0.031133642,-0.045050524,-0.003981376,-0.025394723,-0.031707536,0.024533885,0.032568373,0.028694602,-0.021090532,-0.019942747,0.054806691,-0.004483532,-0.020086221,-0.01599724,0.018651491,0.020373167,0.000504397,-0.007424728,-0.063702017,-0.014203828,0.030846696,-0.006599758,-0.027259871,-0.024103465,-0.020660114,-0.004985687,0.005559579,-0.034146577,-0.011549577,-0.00173961,0.008321434,0.007030177,-0.015638558], 
       'numCandidates': 200, 
       'limit': 10
    }
  }, {
    '$project': {
      '_id': 0, 
      'title': 1, 
      'genres': 1, 
      'plot': 1, 
      'year': 1, 
      'score': {
        '$meta': 'vectorSearchScore'
      }
    }
  }
]

# run pipeline
result = client["sample_mflix"]["embedded_movies"].aggregate(pipeline)

# print results
for i in result:
    print(i)
