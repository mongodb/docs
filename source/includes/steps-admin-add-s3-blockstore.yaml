stepnum: 1
source:
  file: steps-source-admin-navigation.yaml
  ref:  admin-backup-snapshot
---
title: "Click :guilabel:`Create New S3 Blockstore`."
stepnum: 2
level: 4
ref: create-new-s3-blockstore
---
title: "Provide the S3 blockstore details."
stepnum: 3
level: 4
ref: provide-new-s3-blockstore-details
content: |

   .. list-table::
      :widths: 20 10 70
      :header-rows: 1
      :stub-columns: 1

      * - Field
        - Necessity
        - Contents

      * - Name
        - Required
        - Type the name for the |s3| blockstore.

      * - S3 Bucket Name
        - Required
        - Type the name of the |s3| bucket where you want to host the
          the |s3| blockstore.

      * - S3 Endpoint
        - Required
        - Type the |url| for this |aws| |s3| or |s3|-compatible bucket.

          What |url| you write depends upon:

          1. Your :guilabel:`S3 Bucket Name` and
          2. If you checked :guilabel:`Path Style Access`.

          .. example::

             You created an |s3| bucket called ``mybucket`` on |aws| in
             the **US East** region.

             .. list-table::
                :widths: 20 40 40
                :header-rows: 1
                :stub-columns: 1

                * - Path Style Access
                  - Checked
                  - Not Checked

                * - S3 Endpoint
                  - ``s3.us-east-2.amazonaws.com``
                  - ``mybucket.s3.us-east-2.amazonaws.com``

                * - Requests to Bucket
                  - ``https://s3.us-east-2.amazonaws.com/mybucket``
                  - ``https://mybucket.s3.us-east-2.amazonaws.com``

      * - S3 Max Connections
        - Required
        - Type a positive integer indicating the maximum number of
          connections to this |aws| |s3| or |s3|-compatible bucket.

      * - Path Style Access
        - Optional
        - Select if you want your |aws| |s3| or |s3|\-compatible bucket
          to use a path-style |url| endpoint
          (``s3.amazonaws.com/<bucket>``) instead of a
          virtual-host-style |url| endpoint
          (``<bucket>.s3.amazonaws.com``).

          To review the |s3| bucket |url| conventions, see the
          :aws:`AWS S3 documentation
          </AmazonS3/latest/dev/UsingBucket.html#access-bucket-intro>`

      * - Server Side Encryption
        - Optional
        - Select to enable :aws:`server-side encryption
          </AmazonS3/latest/dev/UsingServerSideEncryption.html>`.
          Clear to disable server-side encryption.

      * - S3 Authorization Mode
        - Required
        - Select the method used to authorize access to the |s3| bucket
          specified in :guilabel:`S3 Bucket Name`.

          .. list-table::
             :widths: 20 80
             :stub-columns: 1

             * - Keys
               - |mms| uses :guilabel:`AWS Access Key` and
                 :guilabel:`AWS Secret Key` to authorize access to your
                 |s3| bucket.
             * - IAM Role
               - |mms| uses an |aws| |iam| role to authorize access to
                 your |s3| bucket. :guilabel:`AWS Access Key` and
                 :guilabel:`AWS Secret Key` fields are ignored. To
                 learn more, see the :aws:`AWS documentation
                 </AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html#attach-iam-role>`

      * - AWS Access Key
        - Conditional
        - Type your |aws| Access Key ID.

          This field displays only if you set
          :guilabel:`S3 Authorization Mode` to :guilabel:`Keys`.

      * - AWS Secret Key
        - Conditional
        - Type your |aws| Secret Access Key.

          This field displays only if you set
          :guilabel:`S3 Authorization Mode` to :guilabel:`Keys`.

      * - Datastore Type
        - Required
        - Select :guilabel:`Standalone`, :guilabel:`Replica Set` or
          :guilabel:`Sharded Cluster`. This MongoDB database stores
          the metadata for the blockstore.

      * - MongoDB Host List
        - Conditional
        - Type a comma-separated list of |mongod| instances (for a
          Replica Set) or |mongos| instances (for a Sharded Cluster) in
          the ``<hostname:port>`` format that comprise the blockstore
          metadata database.

          .. example::

             ``host1.example.com:27017, host2.example.com:27017, host2.example.com:27018``

          This field displays only if you set
          :guilabel:`Datastore Type` to :guilabel:`Replica Set` or
          :guilabel:`Sharded Cluster`.

      * - MongoDB Hostname
        - Conditional
        - Type the hostname of the |s3| blockstore metadata database.

          This field displays only if you set
          :guilabel:`Datastore Type` to :guilabel:`Standalone`.

      * - MongoDB Port
        - Conditional
        - Type the port number of the |s3| blockstore metadata
          database.

          This field displays only if you set
          :guilabel:`Datastore Type` to :guilabel:`Standalone`.

      * - Username
        - Optional
        -

          .. list-table::
             :widths: 25 45 30
             :header-rows: 1

             * - Auth Mechanism
               - Action
               - Configure Instructions

             * - Username and Password (``SCRAM-SHA-1``)
               - Type the name of the user authorized to access the
                 |s3| blockstore metadata database.
               - :ref:`SCRAM <authentication-scram>`

             * - x.509 (``X.509``)
               - Type the :rfc:`RFC2253 <2253>`\-formatted subject
                 from the client certificate of the user authorized to
                 access the |s3| blockstore metadata database.
               - :manual:`x.509 </tutorial/configure-x509-client-authentication>`

             * - Kerberos (``GSSAPI``)
               - Type the |upn| of the user authorized to access the
                 |s3| blockstore metadata database.
               - :manual:`Kerberos </core/kerberos>`

             * - LDAP (``PLAIN``)
               - Type the name of the |ldap| user authorized to access
                 the |s3| blockstore metadata database.
               - :manual:`LDAP </core/security-ldap>`

      * - Password
        - Optional
        - .. include:: /includes/warning-plaintext-password.rst

          .. list-table::
             :widths: 25 45 30
             :header-rows: 1

             * - Auth Mechanism
               - Action
               - Configure Instructions

             * - Username and Password (``SCRAM-SHA-1``)
               - Type the password associated with the username that
                 can access the |s3| blockstore metadata database.
               - :ref:`SCRAM <authentication-scram>`

             * - x.509 (``X.509``)
               - Leave it blank.
               - :manual:`x.509 </tutorial/configure-x509-client-authentication>`

             * - Kerberos (``GSSAPI``)
               - Kerberos retrieves the password from its
                 :doc:`keytab file </tutorial/enable-kerberos-authentication-for-group/>`.
                 You do not need to type a password into this field.
               - :manual:`Kerberos </core/kerberos>`

             * - LDAP (``PLAIN``)
               - Type the password of the |ldap| user authorized to
                 access the |s3| blockstore metadata database.
               - :manual:`LDAP </core/security-ldap>`

      * - Connection Options
        - Optional
        - Type any additional :manual:`configuration file options
          </reference/configuration-options>` for the MongoDB instance.

          This field supports unescaped values only.

          For proper syntax, see :manual:`Connection String URI
          Format </reference/connection-string>` in the MongoDB manual.

      * - Encrypted Credentials
        - Optional
        - Select if the credentials for the database were encrypted
          using the
          :doc:`credentialstool </tutorial/encrypt-user-credentials>`.
          The credentials include the Username, Password, |aws| Access
          Key ID and |aws| Secret Key.

      * - Use TLS/SSL
        - Optional
        - Select if the |s3| blockstore metadata database only accepts
          connection encrypted using |tls|.

          Beyond this checkbox, to connect this |s3| blockstore using
          |tls|, you must enable:

          - :manual:`TLS on the S3 blockstore database </tutorial/configure-ssl>`.

          - |onprem| to :ref:`use TLS <configure-ssl-backing>` to
            connect to this |s3| blockstore.

            .. note::

               All backing databases share the same |tls| certificates.
               If you have enabled |tls| for another backing database,
               you need only select this checkbox to enable a |tls|
               connection to this |s3| blockstore.

      * - New Assignment Enabled
        - Optional
        - Select if you want to enable this |s3| blockstore after
          creating it. This is selected by default so the |s3|
          blockstore can be assigned backup jobs. If you clear this
          checkbox, the |s3| blockstore is created but you cannot
          assign backups to this |s3| blockstore.

---
title: "Click :guilabel:`Create`."
stepnum: 4
level: 4
ref: create-blockstore
...
