title: "*Recommended*. Take a full backup of the |mms| database before beginning the upgrade procedure."
stepnum: 1
ref: full-backup
---
title: "Shut down the Automation Agent."
stepnum: 2
ref: shutdown-agent
content: |

  a. Click the :guilabel:`Start` button.

  b. Click :guilabel:`Administrative Tools`.

  c. Click :guilabel:`Services`.

  d. Right-click on the :guilabel:`MMS Automation Agent` and select :guilabel:`Stop`.
---
title: "Download the latest agent."
stepnum: 3
ref: download-agent
pre: |
  From a `Powershell <https://msdn.microsoft.com/en-us/powershell/>`_ prompt,
  issue the following command:
action:
  language: ps1
  copyable: true
  code: |
    $client = new-object System.Net.WebClient
    $client.DownloadFile("https://cloud.mongodb.com/download/agent/automation/mongodb-mms-automation-agent-latest.windows_x86_64.msi","C:\Temp\mongodb-mms-automation-agent-latest.windows_x86_64.msi")
edition:
  - cloud
---
title: "Download the latest agent."
stepnum: 3
ref: download-agent
pre: |

  From a `Powershell <https://msdn.microsoft.com/en-us/powershell/>`_
  prompt, issue the following command, where ``<OpsManagerHost>`` is
  the hostname of your |onprem| installation (for example,
  ``onprem.example.net``):

action:
  language: ps1
  copyable: true
  code: |
    $client = new-object System.Net.WebClient
    $client.DownloadFile("https://<OpsManagerHost>:<Port>/download/agent/automation/mongodb-mms-automation-agent-latest.windows_x86_64.msi,"C:\Temp\mongodb-mms-automation-agent-latest.windows_x86_64.msi")
  post: |
    The protocol can be ``http:`` or ``https:`` depending upon whether
    or not you have :doc:`configured SSL connections to Ops Manager
    </tutorial/configure-ssl-connection-to-web-interface>`.
edition:
  - onprem
---
title: "Install the Automation Agent"
stepnum: 4
ref: install-automation-agent
content: |
  a. After the MSI downloads, double-click the
     ``mongodb-mms-automation-agent-<version>.windows_x86_64.msi``

  #. If a security warning appears, click :guilabel:`Run`.

  #. Verify that the :guilabel:`Destination Folder`
     and :guilabel:`Configuration/Log Folder` paths are correct.

  #. At the :guilabel:`Key Type` and the following key values steps,
     verify the provided values.

  #. At the :guilabel:`Automation Paths` step, verify the provided
     paths.

  #. At the :guilabel:`Windows Firewall Configuration` step, click the
     preferred firewall settings.

     If you click :guilabel:`Configure firewall rules allowing access
     from only the specified IP addresses.`, type the necessary IP
     addresses into the provided box.

  #. (Conditional) If `Stealth Mode <https://technet.microsoft.com/en-us/library/dd448557(v=ws.10).aspx>`_
     has been enabled for the Windows Firewall on the MongoDB host, you
     are asked to disable it. Stealth Mode degrades the performance and
     capability of the :term:`Automation Agent`. Click
     :guilabel:`Disable Stealth Mode`.

  #. (Conditional) If `Disk Performance Counters <https://blogs.technet.microsoft.com/askcore/2012/03/16/windows-performance-monitor-disk-counters-explained/>`_
     are not enabled for the MongoDB host, click :guilabel:`Enable Disk
     Performance Counters`. The :term:`Automation Agent` uses these
     counters for some of its hardware monitoring activities.

  #. Click :guilabel:`Install`.

  #. Click :guilabel:`Finish` once installation is complete.
---
title: "Login to |cloud|."
stepnum: 5
ref: login
edition:
  - cloud
---
title: "Login to |onprem|."
stepnum: 5
ref: login
edition:
  - onprem
---
title: "Verify the Automation Agent is running."
stepnum: 6
ref: verify-automation-agent
content: |

  The Deployment page should display after login.

  a. Click on the stacked box icon next to `Servers`.

  b. Verify that the :guilabel:`Automation Agent` is showing the correct
     version.
---
title: "Repeat installation procedure for each MongoDB host."
stepnum: 7
ref: repeat
...
