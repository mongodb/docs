====================================================
Get Measurements of a Database for a MongoDB Process
====================================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. include:: /includes/fact-projects-groups-synonyms.rst

Get the measurements of the specified databases for a |service| MongoDB
process. A |service| MongoDB process can be either a :binary:`mongod
<bin.mongod>` or :binary:`mongos <bin.mongos>`.

.. include:: /includes/api-requirements.rst

.. include:: /includes/api-base-url.rst

Resource
--------

.. code-block:: none

   GET api/atlas/v1.0/groups/{GROUP-ID}/processes/{HOST}:{PORT}/databases/{DATABASE-ID}/measurements

Request Path Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :header-rows: 1

   * - Parameter
     - Required/Optional
     - Description

   * - ``GROUP-ID``
     - Required
     - ID of the project that owns this |service| MongoDB process.

   * - ``HOST``
     - Required
     - The hostname of the machine running the |service| MongoDB process.

   * - ``PORT``
     - Required
     - The port to which the |service| MongoDB process listens.

   * - ``DATABASE-ID``
     - Required
     - The name of the database to retrieve measurements for.

Request Query Parameters
~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/list-table-measurements-request-query-parameters.rst

Request Body Parameters
~~~~~~~~~~~~~~~~~~~~~~~

This endpoint does not use HTTP request body parameters.

Response Elements
-----------------

.. important:: Free Tier

   ``M0`` Free Tier clusters return a subset of the metrics documented here.


If you set the query element ``envelope`` to ``true``, the response is wrapped
by the ``content`` object.

The HTTP response returns a JSON document that includes the following objects:

.. list-table::
   :header-rows: 1
   :widths: 30 10 60

   * - Name
     - Type
     - Description

   * - ``databaseName``
     - string
     - The name of the database to which the measurements pertain.

   * - ``end``
     - string
     - The end of the period for which to retrieve measurements, specified as
       an ISO-8601_
       timestamp.

   * - ``granularity``
     - string
     - An ISO-8601_-formatted
       time period that specifies the size of the interval covered by each
       data point. For example, ``PT5M`` specifies a 5-minute granularity.

   * - ``groupId``
     - string
     - ID of the project that owns the |service| MongoDB process.

   * - ``hostId``
     - string
     - The hostname of the machine running the |service| MongoDB process.

   * - ``links``
     - array
     - An array of documents, representing a :ref:`link <atlas-api-linking>`
       to one or more sub-resources and/or related resources such as
       :ref:`list pagination <atlas-api-lists>`. See :ref:`atlas-api-linking` for
       more information.

   * - ``measurements``
     - object array
     - An array of measurements and their data points.

   * - ``measurements.dataPoints``
     - object array
     - An array of objects, where each object represents a single data
       point. If there is no data point available for a particular moment in
       time (i.e., a timestamp), the ``value`` field is set to ``null``.

   * - ``measurements.dataPoints.timestamp``
     - string
     - The timestamp of the beginning of the time interval represented
       by this data point.

   * - ``measurements.dataPoints.value``
     - float
     - The value of the data point.

   * - ``measurements.name``
     - string
     - The name of the measurement. For possible values, see
       :ref:`database-measurement-types` below on this page.

   * - ``measurements.units``
     - string
     - How the measurement is quantified. Possible units are:

       - ``PERCENT``
       - ``MILLISECONDS``
       - ``BYTES``
       - ``GIGABYTES``
       - ``BYTES_PER_SECOND``
       - ``MEGABYTES_PER_SECOND``
       - ``GIGABYTES_PER_HOUR``
       - ``SCALAR_PER_SECOND``
       - ``SCALAR``

   * -  ``processId``
     - string
     - The hostname and port of the machine running the |service| MongoDB
       process.

   * - ``start``
     - string
     - The start of the period for which to retrieve measurements, specified as
       an ISO-8601_ timestamp.


.. _database-measurement-types:

Measurement Values
~~~~~~~~~~~~~~~~~~

.. list-table::

   * - - ``DATABASE_AVERAGE_OBJECT_SIZE``
       - ``DATABASE_COLLECTION_COUNT``
       - ``DATABASE_DATA_SIZE``
       - ``DATABASE_STORAGE_SIZE``
       - ``DATABASE_INDEX_SIZE``
       - ``DATABASE_INDEX_COUNT``
       - ``DATABASE_EXTENT_COUNT``
       - ``DATABASE_OBJECT_COUNT``
       - ``DATABASE_VIEW_COUNT``

     - Measures the database's on-disk storage space, as collected from
       the MongoDB :manual:`dbStats </reference/command/dbStats>` command.

Example Request
---------------

Replace the information in brackets ``{}`` with your own |service| information
to execute this example request:


.. code-block:: shell

   curl -u "<ATLAS-USERNAME>:<API-KEY>" --digest -i "https://cloud.mongodb.com/api/atlas/v1.0/groups/{GROUP-ID}/processes/{HOST}:{PORT}/databases/measurements?granularity=PT24H&period=PT24H&pretty=true"

Example Response
----------------

.. code-block:: none

   {
      "databaseName":"monitoring",
      "granularity":"PT1M",
      "groupId":"12345678",
      "hostId":"shard-00-00.mongodb.net:27017",
      "links":[
         {
            "href":"https://cloud.mongodb.com/api/atlas/v1.0/groups/12345678/processes/shard-00-00.mongodb.net:27017/databases/monitoring/measurements?granularity=PT24H&period=PT24H&pretty=true",
            "rel":"self"
         },
         {
            "href":"https://cloud.mongodb.com/api/atlas/v1.0/groups/12345678/processes/shard-00-00.mongodb.net:27017",
            "rel":"http://mms.mongodb.com/host"
         }
      ],
      "measurements":[
         {
            "dataPoints":[

            ],
            "name":"DATABASE_AVERAGE_OBJECT_SIZE",
            "units":"BYTES"
         },
         ...
      ],
      "processId":"shard-00-00.mongodb.net:27017"
   }

.. _ISO-8601:  http://www.iso.org/iso/home/standards/iso8601.htm
