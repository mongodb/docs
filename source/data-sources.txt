.. _data-sources:

============
Data Sources
============

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. include:: /includes/data-source-description.rst

To view, add, or remove data sources, click :guilabel:`Data Sources` in
the sidebar.

.. _data-sources-view:

Data Sources View
-----------------

The :guilabel:`Data Sources` list displays existing data sources
for which the currently logged-in user has :data:`Author` or
:data:`Owner` permissions. The data sources are displayed in a tabular
format with the following columns:

.. figure:: /images/charts/data-sources-saas.png
   :alt: Diagram of the "Data Sources" list
   :figwidth: 750px

.. list-table::
   :header-rows: 1
   :widths: 38 72

   * - Column
     - Description

   * - :guilabel:`Name`
     - Name of the data source. By default, this is the data source's
       corresponding database and collection name. To learn how to
       rename a data source, see :ref:`mod-data-source-alias`.

   * - :guilabel:`Source`
     - Contains two pieces of information for the data source:
     
       - Database and collection from which |charts-short| retrieves
         data for this data source.

       - Name of the |service| cluster or {+fdi+} that contains the
         collection.

   * - :guilabel:`Added`
     - When the data source was created.

   * - :guilabel:`Pipeline`
     - Aggregation stages applied to this data source. Data source
       :data:`Owners <Owner>` can define one :manual:`aggregation 
       pipeline </core/aggregation-pipeline/>` to pre-process data 
       before it reaches the chart builder.

       For more information on defining aggregation pipelines for a
       data source, see :ref:`data-sources-pipeline`.

   * - :guilabel:`Permission`
     - The icon next to the :guilabel:`Access` button denotes the
       :ref:`permission <permission-model>` you have on the data
       source. For details on the various data source permissions, see
       :ref:`Data Source Permissions <permission-model>`.

       To modify the permissions for a data source, see the
       :ref:`Modify a Data Source <mod-data-source-permissions>`
       section.

.. note::

   You can sort data sources by any of the columns by clicking on the
   column header.

.. _filter-data-sources:

Filter Data Sources
~~~~~~~~~~~~~~~~~~~

To search for specific data sources, use the search bar at the
upper right corner of the :guilabel:`Data Sources` list. You can search
by :guilabel:`Deployment`, :guilabel:`Database`,
:guilabel:`Collection`, or :guilabel:`Alias`.

Additionally, you can use the dropdown to the left of the search bar to
show either all data sources on your |charts| deployment, or only data
sources for which you have the ``Owner`` permission. For more
information on data source permissions, see
:ref:`Data Source Permissions <permission-model>`.

.. _add-data-source:

Add a Data Source
-----------------

1. From the :guilabel:`Data Sources` list, click the
   :guilabel:`Add Data Source` button.

#. Select one of the |service| clusters or {+fdis+}.

   |service| displays: 
   
   - All clusters in the current project for which the current user has 
     the :authrole:`Project Data Access Read Only` role or higher. 
   - All |dl|\s in the current project.

#. Click :guilabel:`Connect`.

#. Select the collections from which you wish to create data sources.
   |charts-short| creates a separate data source for each selected
   collection.

   Select or expand a database to display the number of documents in and
   the size of each collection it contains.

   .. figure:: /images/charts/collection-size.png
      :figwidth: 640px
      :alt: Collection size statistics shown on the Add Data Source modal

#. Click :guilabel:`Finish`.

.. important::

   |charts-short| grants the default
   :ref:`permissions <permission-model>` to each data source. To set the
   permissions for a data source, see
   :ref:`mod-data-source-permissions`. 

You will see your newly added data source listed in the
:guilabel:`Data Sources` list. To learn how to manage existing data
sources, see :doc:`manage-data-sources`.

.. _charts-sample-data:

Sample Data Source
------------------

The :guilabel:`Sample Data: Movies` data source is automatically
included in all |charts-short| tenants and provides sample movie data to
explore |charts|. The :ref:`Sample Dashboard <sample-dashboard>` uses
this data source to show the possible charts you can create. You can
access the sample data source from all dashboards. You do not have
:ref:`permissions <dashboard-permissions>` to the sample data source,
meaning you can not add, edit, or delete the data it contains

.. note::

   You cannot remove or edit the sample data source. You also
   cannot externally share or :ref:`embed <embedding-charts>` charts
   that use the sample data.

Data Source Read Preference
---------------------------

Each data source has a read preference which determines the
:manual:`replica set member </core/replica-set-members>` that the
data source reads data from. 

By default, a newly added |service| cluster data source has a read 
preference of Secondary, meaning that it reads from a secondary node 
within the |service| cluster. If another data source also reads from 
the same |service| cluster as the newly created data source, the newly 
created data source has the same read preference as the existing data 
source.

You can :ref:`change the read preference <mod-data-source-permissions>`
of a data source in the :guilabel:`Data Sources` list only if the data 
source is an |service| cluster. You cannot change the read preference 
of a data source if the data source is your |dl|.

.. toctree::
   :titlesonly:

   /manage-data-sources
   /data-source-permissions
   /data-source-pipeline
