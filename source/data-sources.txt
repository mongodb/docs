.. _data-sources:

============
Data Sources
============

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Data sources in |charts| reference a :ref:`collection <collections>`
or :ref:`view <3.4-reference-views>` in your MongoDB
deployment. The fields in that collection or view can be used
to construct a chart. When building a chart, you will need to specify
the data source that the chart uses.

To view, add, or remove data sources, click :guilabel:`Data Sources` in
the sidebar.

.. _data-sources-view:

Data Sources View
-----------------

The :guilabel:`Data Sources` list displays existing data sources
for which the currently logged-in user has :data:`Author` or
:data:`Owner` permissions. The data sources are displayed in a tabular
format with the following columns:

.. figure:: /images/charts/data-sources-saas.png
   :alt: Diagram of the "Data Sources" list
   :figwidth: 750px

.. list-table::
   :header-rows: 1
   :widths: 38 72

   * - Column
     - Description

   * - :guilabel:`Name`
     - Name of the data source. By default, this is the data source's
       corresponding database and collection name. To learn how to
       rename a data source, see :ref:`mod-data-source-alias`.

   * - :guilabel:`Collection & Deployment`
     - Contains two pieces of information for the data source:
     
       - Database and collection from which |charts-short| retrieves
         data for this data source.

       - Name of the |service| deployment which contains the
         collection.

   * - :guilabel:`Applied Aggregations`
     - Aggregation stages applied to this data source. Data source
       :data:`Owners <Owner>` can define an
       :manual:`aggregation pipeline </core/aggregation-pipeline/>`
       to pre-process data before it reaches the chart builder.

       For more information on defining aggregation pipelines for a
       data source, see :ref:`data-sources-pipeline`.

   * - :guilabel:`Created`
     - When the data source was created.

   * - :guilabel:`Permissions`
     - The icon next to the :guilabel:`Access` button denotes the
       :ref:`permissions <permission-model>` you have on the data
       source. For details on the various data source permissions, see
       :ref:`Data Source Permissions <permission-model>`.

       To modify the permissions for a data source, see the
       :ref:`Modify a Data Source <mod-data-source-permissions>`
       section.

.. note::

   You can sort data sources by any of the columns by clicking on the
   column header.

.. _filter-data-sources:

Filter Data Sources
~~~~~~~~~~~~~~~~~~~

To search for specific data sources, use the search bar at the
upper right corner of the :guilabel:`Data Sources` list. You can search
by :guilabel:`Deployment`, :guilabel:`Database`,
:guilabel:`Collection`, or :guilabel:`Alias`.

Additionally, you can use the dropdown to the left of the search bar to
show either all data sources on your |charts| deployment, or only data
sources for which you have the ``Owner`` permission. For more
information on data source permissions, see
:ref:`Data Source Permissions <permission-model>`.

.. _add-data-source:

Add a Data Source
-----------------

1. From the :guilabel:`Data Sources` list, click the
   :guilabel:`Add Data Source` button.

#. Select one of the |service| clusters.

   |service| displays all clusters in the current project for which
   the current user has the :authrole:`Project Data Access Read Only`
   role or higher.

#. Click :guilabel:`Connect`.

#. Select the collections from which you wish to create data sources.
   |charts-short| creates a separate data source for each selected
   collection.

#. Click :guilabel:`Set Permissions`.

#. Set the :ref:`permissions <permission-model>` for the data source.

   You can assign the :data:`Viewer` permission to every user in the
   project. To assign a user a specific permission level, search for
   the user by name or email address using the search bar.

   .. note::

      If you selected multiple collections for your data source in step
      4, the data source :ref:`permissions <permission-model>` you
      select are applied to all of the selected collections when you
      publish your data source. If you wish to apply different
      permissions to individual collections that you have selected, you
      will need to edit those data sources after publishing.

#. Click :guilabel:`Publish Data Source`.

You will see your newly added data source listed in the
:guilabel:`Data Sources` list. To learn how to manage existing
data sources, see :doc:`manage-data-sources`.

Data Source Read Preference
---------------------------

Each data source has a read preference which determines the
:manual:`replica set member </core/replica-set-members>` that the
data source reads data from. By default, a newly added data source
has a read preference of Secondary, meaning that it reads from a
secondary node within the Atlas cluster. If another data source also
reads from the same Atlas cluster as the newly created data source,
the newly created data source has the same read preference as the
existing data source.

You can :ref:`change the read preference <mod-data-source-permissions>`
of a data source in the :guilabel:`Data Sources` list.

.. class:: hidden

   .. toctree::
      :titlesonly:

      /manage-data-sources
      /data-source-permissions
      /data-source-pipeline
