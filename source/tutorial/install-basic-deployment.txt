============================
Install the Basic Deployment
============================

.. default-domain:: mongodb

Overview
--------

The basic deployment includes the :ref:`mms-application-package` and the :ref:`mms-application-database`, which provide full functionality for monitoring
MongoDB deployments, and optionally includes the :ref:`MMS Backup Daemon
<backup-daemon>` and :ref:`MMS Backup Blockstore database
<mms-backup-blockstore-database>`, which create and store snapshots to back up
your MongoDB deployments.

The deployment uses three servers. The |application| runs on the first
server. The Backup Daemon runs on the second. The two databases run as
three-member :term:`replica sets <replica set>` with members on all
three servers.

You will install the basic deployment on servers running **RHEL 6+** or
**Amazon Linux**. The tutorial first prepares the deployment's servers, then
installs the databases, and then installs the |application| and Backup
Daemon.

The following diagram shows the basic deployment.

.. image:: /figures/mms_onprem_basic_no_words.png
   :alt: "Basic Deployment"
   :width: 500px
   :align: center
   :target: ../../_static/mms_onprem_basic_no_words.png

Prerequisites
-------------

Your servers must meet the :ref:`hardware-requirements` described on the
:doc:`/core/requirements` page. For a server that hosts multiple components,
you must sum the requirements for each component to determine the
requirements for the server.

A basic deployment that can monitor up to 400 hosts has these requirements:

.. list-table::
   :header-rows: 1

   * - **Server**
     - **RAM**
     - **Storage Capacity**

   * - **Server 1**, which runs the |application|, the Primary for the |application|
       database, and the Arbiter for the Backup Blockstore.
     - 23 GB
     - 200 GB
   * - **Server 2**, which runs the Backup Daemon, the Primary for the Backup Blockstore, and
       the Arbiter for the |application| database.
     - 15 GB for the Backup Daemon **plus** 8 GB for every 1 TB of the Backup Blockstore database.
     - *Contact your MongoDB account manager.*
   * - **Server 3**, which runs the secondaries for the |application| and Backup Blockstore databases.
     - 8 GB for the |application| database **plus** 8 GB for every 1 TB of the Backup Blockstore
       database.
     - 200 GB for the |application| database. *Contact your MongoDB account manager for requirements
       for the Backup Blockstore database.*

You must have root access on the machines you are provisioning.

.. include:: /includes/requirements-aws-security.rst

.. note::

   For a **test installation**, you can install all the server-side components
   on a single server, as shown in the :ref:`test deployment diagram
   <on-prem-minimal-deployment-diagram>`. Install the |application| database
   and MMS Backup Blockstore database as single-member :term:`replica sets
   <replica set>`. For production installations, always use replica sets of at
   least three members, to provide redundancy.

   Running the components on a single server requires 15 GB of memory and 50
   GB of disk space for the root partition. You can meet the size requirements
   by using an AWS EC2 ``m3.xlarge`` instance and changing the size of the
   root partition from 8 GB to 50 GB. When you log into the instance, execute
   "``df -h``" to verify the root partition has 50 GB of space.

   **Running on a single physical server is *not* suitable for production
   deployments.** For production installations, ensure that you provision
   physical servers with enough RAM and disk space to comfortably handle all
   of the components and databases that run on them.

Procedures
----------

Prepare Each Server
+++++++++++++++++++

Set up servers that meet the above hardware requirements for deployments that
monitor up to 400 hosts. If your deployment will monitor more than 400 hosts,
use the requirements on the :doc:`/core/requirements` page instead.

.. include:: /includes/steps/prepare-servers-basic-install.rst

Deploy the |application| Database
+++++++++++++++++++++++++++++++++++

Install the :ref:`mms-application-database` as a
three-member :term:`replica set` with the primary on **server 1**, the arbiter
on **server 2**, and the secondary on **server 3**, as shown in the diagram above.

.. include:: /includes/steps/install-basic-application-database.rst

Deploy the Backup Blockstore Database (Optional)
++++++++++++++++++++++++++++++++++++++++++++++++

If you intend to use MMS Backup, deploy the :ref:`Backup Blockstore database
<mms-backup-blockstore-database>` as a three-member replica set with the
arbiter on **server 1**, the primary on **server 2**, and the secondary on **server
3**.

.. include:: /includes/steps/install-basic-backup-database.rst

Install the |application|
+++++++++++++++++++++++++++

Install the :ref:`mms-application-package` on **server 1**.
The |application| and |application| database together provide full
monitoring functionality.

.. include:: /includes/steps/install-basic-application.rst

Install the MMS Backup Daemon (Optional)
++++++++++++++++++++++++++++++++++++++++

If you will use MMS Backup, install the :ref:`MMS Backup Daemon
<backup-daemon>` on **server 2**.

For production, the Backup Daemon should always reside on a separate physical
server from the |application| and from any databases being monitored and/or
backed up.

.. include:: /includes/steps/install-basic-backup-daemon.rst

Next Steps
----------

To set up a replica set for a test environment, see
:doc:`/tutorial/test-new-deployment`. The tutorial populates the replica set
with test data, registers a user, and installs the Monitoring and Backup
Agents on a client machine in order to monitor the test replica set.

To register a user and download the Monitoring and Backup Agents to a client
machine, see :doc:`/user-guide`.
