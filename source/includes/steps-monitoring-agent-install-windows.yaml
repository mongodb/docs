title: Download and run the latest version of the Monitoring Agent MSI file.
stepnum: 1
edition:
  - cloud
ref: download-saas
action:
  - pre: |
      To download the 32-bit MSI file, use the following URL:
    language: sh
    code: |
      https://cloud.mongodb.com/download/agent/monitoring/mongodb-mms-monitoring-agent-latest.windows_i386.msi
  - pre: |
      To download the 64-bit MSI file, use the following URL:
    language: sh
    code: |
      https://cloud.mongodb.com/download/agent/monitoring/mongodb-mms-monitoring-agent-latest.windows_x86_64.msi
post: |
  During installation, the installer prompts you to specify the folder for
  storing configuration and log files. It is strongly advised that you
  encrypt or restrict access to this folder.
  
  To monitor a MongoDB deployments that use Kerberos authentication,
  when entering in the Agent API key, click :guilabel:`Advanced
  Settings...`. Enter the Active Directory user name, the corresponding
  password, and the NetBIOS name of a domain.
---
title: "Download and run the latest version of the Monitoring Agent MSI file."
stepnum: 1
edition:
  - onprem
ref: download-hosted
pre: |
  Download and run the 32-bit or 64-bit MSI file. During installation, the
  installer prompts you to specify the folder for storing configuration and
  log files. It is strongly advised that you encrypt or restrict access to
  this folder.
action:
  - pre: |
      To download the 32-bit MSI file, use the following URL, where
      ``<mms-server>`` is the hostname of the Monitoring server:
    language: sh
    code: |
      <mms-server>/download/agent/monitoring/mongodb-mms-monitoring-agent-latest.windows_i386.msi
  - pre: |
      To download the 64-bit MSI file, use the following URL, where
      ``<mms-server>`` is the hostname of the Monitoring server:
    language: sh
    code: |
      <mms-server>/download/agent/monitoring/mongodb-mms-monitoring-agent-latest.windows_x86_64.msi
post: |
  During installation, the installer prompts you to specify the folder for
  storing configuration and log files. It is strongly advised that you
  encrypt or restrict access to this folder.

  To monitor a MongoDB deployments that use Kerberos authentication,
  when entering in the Agent API key, click :guilabel:`Advanced
  Settings...`. Enter the Active Directory user name, the corresponding
  password, and the NetBIOS name of a domain.
  
---
stepnum: 2
source:
  file: steps-source-install-agent.yaml
  ref: retrieve-monitoring-mms-api-key
---
title: "Edit the ``monitoring-agent.config`` file to include your agent API key, the hostname of the Monitoring server and, optionally, the URL for a proxy server."
stepnum: 3
ref: configure-monitoring-mms-api-key
content: |
  In the ``C:\MMSData\Monitoring\monitoring-agent.config`` file, set these properties:

  .. list-table::
     :widths: 35 65
     :header-rows: 1

     * - Property

       - Value

     * - :msetting:`mmsApiKey`

       - Your API key

     * - :msetting:`mmsBaseUrl`

       - Hostname of the Monitoring server

     * - :msetting:`httpProxy` (optional)

       - The URL of to your proxy server
---
stepnum: 4
edition: onprem
source:
  file: steps-source-install-agent.yaml
  ref: start-monitoring
content: |
  In Windows ``Control Panel``, open ``Administrative Tools``, and then
  open ``Services``.

  In the list of services, select the |mms| Monitoring Agent service.
  Select the ``Action`` menu and select ``Start``.
---
stepnum: 4
edition: cloud
source:
  file: steps-source-install-agent.yaml
  ref: start-monitoring
content: |
  In Windows ``Control Panel``, open ``Administrative Tools``, and then
  open ``Services``.

  In the list of services, select the |mms| Monitoring Agent service.
  Select the ``Action`` menu and select ``Start``.
...
