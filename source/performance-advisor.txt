===================
Performance Advisor
===================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

The Performance Advisor monitors queries that MongoDB considers slow
and suggests new indexes to improve query performance. The Performance
Advisor recognizes a query as slow if it takes longer than ``100``
milliseconds to execute. For the selected host and time period, the
Performance Advisor evaluates up to the 20,000 most recent slow queries
found in the logs.

.. COMMENT  (may want to flip the wording to -- 100 milliseconds (i.e. value of the slowOp...)

Recommended indexes are accompanied by sample queries, grouped by :term:`query shape`,
that were run against a collection that would benefit from
the suggested index. The Performance Advisor is always enabled and does
not negatively affect the performance of your |service| clusters.

.. note::

   To view field values in a sample query in the :guilabel:`Performance
   Advisor`, you must be a user with at least one of the following
   access:

   - :authrole:`Project Owner` access

   - :authrole:`Project Data Access Admin` access

   - :authrole:`Project Data Access Read/Write` access

   - :authrole:`Project Data Access Read Only` access

   Users without one of these roles see redacted data rather than the
   field values.

Considerations
--------------

Indexes improve read performance, but a large number of indexes can
negatively impact write performance since indexes must be updated during
writes. It is important to consider this tradeoff when deciding whether
to create new indexes for a collection that already has several. Examine
whether a query for such a collection can be modified to take advantage
of existing indexes, as well as whether a query occurs often enough to
justify the cost of a new index.

.. _query-inefficiency-score:

Limitation
----------

The Performance Advisor cannot suggest indexes for MongoDB databases
configured to use the :manual:`ctime timestamp format </reference/program/mongod/#cmdoption-mongod-timestampformat>`.
As a workaround, set the timestamp format for such databases to either
:manual:`iso8601-utc </reference/program/mongod/#cmdoption-mongod-timestampformat>`
or :manual:`iso8601-local </reference/program/mongod/#cmdoption-mongod-timestampformat>`.

 
Understanding the Query Inefficiency Score
------------------------------------------

The Performance Advisor displays sample queries with recommended 
indexes. Each sample query includes a query inefficiency score, which is
how many documents were read for every document returned by the query.
A score of 1 represents a very efficient query because every document read matched
the query and was returned with the query results. The Performance Advisor
displays a warning icon next to any score over 1,000, which represent 
highly inefficient queries. All suggested indexes represent an opportunity
to improve query performance.


To access the :guilabel:`Performance Advisor`:

.. include:: /includes/steps/performance-advisor-view.rst

