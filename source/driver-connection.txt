==================
Connect via Driver
==================

.. default-domain:: mongodb

.. meta::
   :keywords: connect

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: twocols

The :guilabel:`Connect` dialog for a cluster provides the details to
connect to a cluster with an application using a MongoDB driver.

.. seealso:: :ref:`connection-limits`

Prerequisites
-------------

.. include:: /includes/fact-connection-prereq.rst

Connect Your Application
------------------------

.. include:: /includes/steps/connect-to-cluster-driver.rst

The following examples use the URI connection string to authenticate and
connect to an |service| cluster. In the examples, ``PASSWORD`` has been
replaced with the password (``myRealPassword``) for the user ``kay``.


.. _driver-connection-c:

C Driver Example
----------------

.. note::

   .. include:: /includes/extracts/driver-free-tier-c.rst

.. tabs::

   tabs:
   
   - id: mongodb3_6
     name: MongoDB Version 3.6 or later

     content: |

         .. code-block:: c

            client = mongoc_client_new ("mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/?serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000");
            db = mongoc_client_get_database (client, "test");

   - id: mongodb3_4
     name: MongoDB Version 3.4 and earlier

     content: |

        .. code-block:: c

           mongoc_client_t client = mongoc_client_new ("mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin&serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000");
           db = mongoc_client_get_database (client, "test");

.. list-table::
   :header-rows: 1

   * - MongoDB Version
     - Minimum Driver Version(s)

   * - MongoDB 3.6
     - :ref:`Version 1.9 or greater <reference-compatibility-mongodb-c>`

   * - MongoDB 3.4
     - :ref:`Version 1.5 or greater <reference-compatibility-mongodb-c>`

   * - MongoDB 3.2
     - :ref:`Version 1.3 or greater <reference-compatibility-mongodb-c>`

.. include:: /includes/extracts/c-driver-single-threaded.rst

.. _driver-connection-cpp:

C++ Driver Example
------------------

.. code-block:: cpp

   #include <mongocxx/client.hpp>
   #include <mongocxx/instance.hpp>

   //...

   mongocxx::instance inst{};
   mongocxx::client conn{mongocxx::uri{"mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin&serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000"}};
   mongocxx::database db = conn["test"];

.. admonition:: Minimum Driver Version(s)

   - C+11: :ref:`Version 0.3.0 <reference-compatibility-mongodb-cpp>`

   - Legacy series: :ref:`Version legacy-1.1.0+ <reference-compatibility-mongodb-cpp>`

   .. include:: /includes/extracts/driver-free-tier-cpp.rst

.. include:: /includes/extracts/cplus-driver-single-threaded.rst

.. _driver-connection-csharp:

C#/.Net Driver Example
----------------------

.. code-block:: csharp

   var client = new MongoClient("mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin");
   var database = client.GetDatabase("test");

.. admonition:: Minimum Driver Version(s)

   - 2.x series: :ref:`Version 2.2 <reference-compatibility-mongodb-csharp>`
   - 1.x series: :ref:`Version 1.11 <reference-compatibility-mongodb-csharp>`

   .. include:: /includes/extracts/driver-free-tier-csharp.rst

.. _driver-connection-java:

Java Driver Example
-------------------

.. note::

   .. include:: /includes/extracts/driver-free-tier-java.rst

.. tabs::

   tabs:

   - id: mongodb3_6
     name: MongoDB Version 3.6 or later

     content: |

         .. code-block:: java

            MongoClientURI uri = new MongoClientURI(
                "mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/");

            MongoClient mongoClient = new MongoClient(uri);
                MongoDatabase database = mongoClient.getDatabase("test");

   - id: mongodb3_4
     name: MongoDB Version 3.4 and earlier

     content: |

         .. code-block:: java

            MongoClientURI uri = new MongoClientURI(
                "mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin");

            MongoClient mongoClient = new MongoClient(uri);
            MongoDatabase database = mongoClient.getDatabase("test");


.. list-table::
   :header-rows: 1

   * - MongoDB Version
     - Minimum Driver Version(s)

   * - MongoDB 3.6
     - :ref:`Version 3.6 or greater <reference-compatibility-mongodb-java>`

   * - MongoDB 3.4
     - :ref:`Version 3.4 or greater <reference-compatibility-mongodb-java>`

   * - MongoDB 3.2

     - :ref:`Version 3.2 or greater
       <reference-compatibility-mongodb-java>` and :ref:`Version 2.14
       <reference-compatibility-mongodb-java>`

.. _driver-connection-node:

Node.js Driver Example
----------------------

.. note::

   .. include:: /includes/extracts/driver-free-tier-node.rst

.. tabs::

   tabs:

   - id: mongodb3_6
     name: MongoDB Version 3.6 or later

     content: |

         .. code-block:: javascript

            var MongoClient = require('mongodb').MongoClient;

            var uri = "mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/test";
            MongoClient.connect(uri, function(err, client) {
               const collection = client.db("test").collection("devices");
               // perform actions on the collection object
               client.close();
            });

   - id: mongodb3_4
     name: MongoDB Version 3.4 and earlier

     content: |

         .. code-block:: javascript

            var MongoClient = require('mongodb').MongoClient;

            var uri = "mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin";
            MongoClient.connect(uri, function(err, db) {
               db.close();
            });

         .. include:: /includes/extracts/connection-details-driver.rst

         For example, the following connection string specifies
         ``test`` in the database component and includes the
         ``authSource=admin`` option.

         .. code-block:: javascript

            var uriTestDb = "mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/test?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin";
            MongoClient.connect(uriTestDb, function(err, db) {
               db.close();
            });

.. list-table::
   :header-rows: 1

   * - MongoDB Version
     - Minimum Driver Version(s)

   * - MongoDB 3.6
     - :ref:`Version 3.0 or greater <reference-compatibility-mongodb-node>`

   * - MongoDB 3.4
     - :ref:`Version 2.2.0 or greater <reference-compatibility-mongodb-node>`

   * - MongoDB 3.2
     - :ref:`Version 2.2.0 or greater <reference-compatibility-mongodb-node>`

.. _driver-connection-perl:

Perl Driver Example
-------------------

.. code-block:: perl

   my $client = MongoDB->connect("mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin&serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000"");
   my $db = $client->get_database( 'test' );

.. admonition:: Minimum Driver Version(s)

   :ref:`Version 1.2.x <reference-compatibility-mongodb-perl>`

   .. include:: /includes/extracts/driver-free-tier-perl.rst

.. include:: /includes/extracts/perl-driver-single-threaded.rst

.. _driver-connection-php:

PHP Driver Example
------------------

The following example uses the MongoDB PHP Library which provides a
high-level abstraction around the lower-level PHP driver:

.. code-block:: php

   $client = new MongoDB\Client(
       'mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin&serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000"');

   $db = $client->test;

.. admonition:: Minimum Driver Version(s)

   - :ref:`PHP library 1.0+ <reference-compatibility-mongodb-php>`

   - :ref:`Version mongodb-1.1 <reference-compatibility-mongodb-php>`

   .. include:: /includes/extracts/driver-free-tier-php.rst

.. include:: /includes/extracts/php-driver-single-threaded.rst

.. _driver-connection-python:

Python Driver Example
---------------------

.. note::

   .. include:: /includes/extracts/driver-free-tier-python.rst

.. tabs::

   tabs:

   - id: mongodb3_6
     name: MongoDB Version 3.6 or later

     content: |

        .. code-block:: python

           client = pymongo.MongoClient("mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/test")
           db = client.test

   - id: mongodb3_4
     name: MongoDB Version 3.4 and earlier

     content: |

        .. code-block:: python

           client = pymongo.MongoClient("mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin")
           db = client.test

.. list-table::
   :header-rows: 1

   * - MongoDB Version
     - Minimum Driver Version(s)

   * - MongoDB 3.6
     - :ref:`Version 3.6 or greater <reference-compatibility-mongodb-python>`
   
   * - MongoDB 3.4
     - :ref:`Version 3.4 or greater <reference-compatibility-mongodb-python>`

   * - MongoDB 3.2
     - :ref:`Version 3.2 or greater <reference-compatibility-mongodb-python>`

.. admonition:: macOSX and Python 3.6 Installers

   The Python 3.6 installers for macOS from `<https://www.python.org>`_ do not
   automatically install any CA certificates. Without installed CA
   certificates, connections to |service| will fail certificate
   verification.

   As such, after you have run the installer from
   `<https://www.python.org>`_ to install Python 3.6, you must run the
   following script to install an up-to-date CA certificates bundle in
   order to connect to |service|:

   .. code-block:: sh

      open "/Applications/Python 3.6/Install Certificates.command"

   For more information on Python 3.6 installers for macOS from
   `<https://www.python.org>`_, see
   `<https://bugs.python.org/issue29065#msg283984>`_. Earlier versions
   of Python as well as Python 3.6 installed by other means are not
   affected.

.. _driver-connection-ruby:

Ruby Driver Example
-------------------

.. note::

   .. include:: /includes/extracts/driver-free-tier-ruby.rst

.. tabs::

   tabs:

   - id: mongodb3_6
     name: MongoDB Version 3.6 or later

     content: |
        .. code-block:: ruby

           client = Mongo::Client.new('mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/test')

   - id: mongodb3_4
     name: MongoDB Version 3.4 and earlier

     content: |

        .. code-block:: ruby

           client = Mongo::Client.new('mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin')

        .. include:: /includes/extracts/connection-details-driver.rst

        For example, the following connection string specifies ``test`` in the
        database component and includes the ``authSource=admin`` option.

        .. code-block:: ruby

           client = Mongo::Client.new('mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/test?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin')

.. list-table::
   :header-rows: 1

   * - MongoDB Version
     - Minimum Driver Version(s)
   * - MongoDB 3.6
     - :ref:`Version 2.5 or greater <reference-compatibility-mongodb-ruby>`

   * - MongoDB 3.4
     - :ref:`Version 2.4 or greater <reference-compatibility-mongodb-ruby>`

   * - MongoDB 3.2
     - :ref:`Version 2.2 or greater <reference-compatibility-mongodb-ruby>`

Mongoid Example
~~~~~~~~~~~~~~~

.. code-block:: yaml

   production:
     # Configure available database clients. (required)
     clients:
       # Defines the default client. (required)
       default:
         # Defines the name of the default database that Mongoid can connect to.
         # (required).
         database: 'myDatabaseName'

         # Provides the hosts the default client can connect to. Must be an array
         # of host:port pairs. (required)
         hosts:
           - mycluster0-shard-00-00.mongodb.net:27017
           - mycluster0-shard-00-01.mongodb.net:27017
           - mycluster0-shard-00-02.mongodb.net:27017
         options:
           # The name of the user for authentication.
           user: kay

           # The password of the user for authentication.
           password: myRealPassword

           # The database or source to authenticate the user against. If the database
           # specified above is not admin, admin MUST be specified here.
           auth_source: admin

           # All Atlas servers use SSL. (default: false)
           ssl: true

.. list-table::
   :header-rows: 1

   * - MongoDB Version
     - Minimum ODM Version

   * - MongoDB 3.6

     - `Version 6.3.0 or greater <https://docs.mongodb.com/mongoid/6.3/>`_

   * - MongoDB 3.4 or earlier

     - `Version 6.1.0 or greater <https://docs.mongodb.com/mongoid/6.1/>`_


.. _driver-connection-scala:

Scala Driver Example
--------------------

.. code-block:: scala

   val uri: String = "mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin"
   System.setProperty("org.mongodb.async.type", "netty")
   val client: MongoClient = MongoClient(uri)
   val db: MongoDatabase = client.getDatabase("test")

.. admonition:: Minimum Driver Version(s)

   :ref:`Version 1.1 <reference-compatibility-mongodb-scala>`

   .. include:: /includes/extracts/driver-free-tier-scala.rst

