.. _mcli-atlas-cluster-update-command:

=============================
mongocli atlas cluster update
=============================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

The ``cluster update`` command modifies your |service| cluster
settings. You can only modify:

- ``M10`` or larger clusters
- A single-region replica set

You can also modify a cluster through the |service|
:atlas:`console </scale-cluster/>` or
:atlas:`API </reference/api/clusters-modify-one/>`.

.. _atlas-cluster-update-syntax:

Syntax
------

.. code-block:: sh

   mongocli atlas cluster(s) update <cluster-name>
        [ --diskSizeGB <size-of-disk> ]
        [ --file|-f <path-to-cluster-config-file> ]
        [ --tier <cluster-tier> ]
        [ --mdbVersion <mongodb-version> ]
        [ --profile|-P <profile-name> ]
        --projectId <id-of-project>

.. include:: /includes/fact-command-line-help.rst

.. _atlas-cluster-update-options:

Options
-------

.. list-table::
   :header-rows: 1
   :widths: 20 10 60 10

   * - Option
     - Type
     - Description
     - Required?

   * - ``<cluster-name>``
     - string
     - Name of your |service| cluster. You cannot change the name of
       your cluster.
     - yes

   * - ``--diskSizeGB``
     - integer
     - Size of the serverâ€™s root volume in GB. Increase this number to
       add capacity.
     - no

   * - ``--file``, ``-f``
     - string
     - Path to a |json| configuration file that defines cluster
       settings. Any settings specified in the configuration file take
       precedence over settings specified by a command option.

       For a list of settings you can define, see the
       :atlas:`Create One Cluster API </reference/api/clusters-create-one/#request-body-parameters>`.
     - no

   * - ``--tier``
     - string
     - Name of the :atlas:`cluster tier </cluster-tier/>` to use.
     - no

   * - ``--mdbVersion``
     - string
     - Major version of MogoDB to which you want to upgrade your
       cluster. You cannot downgrade the MongoDB version of your
       cluster.

       .. note::

          Before your upgrade, refer to the current
          :atlas:`recommended best practices for major version upgrades </tutorial/major-version-change/>`.
     - no

   * - ``--profile``, ``-P``
     - string
     - Name of the profile to use for accessing the |service| project.
       If omitted, uses the ``default`` profile.
     - no

   * - ``--projectId``
     - string
     - Unique identifier of the project containing the cluster you want
       to update.
     - yes

.. _atlas-cluster-update-output:

Output
------

The command returns the following |json| document if the command succeeds. If the command returns errors, see
:ref:`Troubleshooting <troubleshooting>` for recommended solutions.

.. include:: /includes/atlas-cluster-output-fields.rst

.. _atlas-cluster-update-examples:

Examples
--------

Example 1
~~~~~~~~~

The following ``mongocli atlas cluster update`` command migrates the
cluster named ``sbxCluster`` in the specified project from ``M10`` to
``M20``. It uses the default profile to access the project.

.. code-block:: sh
   :copyable: false

   mongocli atlas cluster update sbxCluster \
            --projectId 5e2211c17a3e5a48f5497de3 \
            --tier M20

The command returns the following |json| document:

.. code-block:: json
   :copyable: false

   {
     "autoScaling": {
       "diskGBEnabled": true
     },
     "backupEnabled": false,
     "biConnector": {
       "enabled": false,
       "readPreference": "secondary"
     },
     "clusterType": "REPLICASET",
     "diskSizeGB": 2,
     "encryptionAtRestProvider": "NONE",
     "id": "5e2f1f657a3e5a052beddd92",
     "groupId": "5e2211c17a3e5a48f5497de3",
     "labels": [
       {
         "key" : "Infrastructure Tool",
         "value" : "mongoCLI"
       }
     ],
     "mongoDBVersion": "4.2.3",
     "mongoDBMajorVersion": "4.2",
     "mongoURI": "mongodb://sbxcluster-shard-00-00-7hgjn.mongodb-dev.net:27017,sbxcluster-shard-00-01-7hgjn.mongodb-dev.net:27017,sbxcluster-shard-00-02-7hgjn.mongodb-dev.net:27017",
     "mongoURIUpdated": "2020-01-27T17:41:49Z",
     "mongoURIWithOptions": "mongodb://sbxcluster-shard-00-00-7hgjn.mongodb-dev.net:27017,sbxcluster-shard-00-01-7hgjn.mongodb-dev.net:27017,sbxcluster-shard-00-02-7hgjn.mongodb-dev.net:27017/?ssl=true\u0026authSource=admin\u0026replicaSet=sbxCluster-shard-0",
     "name": "sbxCluster",
     "numShards": 1,
     "paused": false,
     "providerBackupEnabled": false,
     "providerSettings": {
       "diskIOPS": 100,
       "encryptEBSVolume": true,
       "instanceSizeName": "M20",
       "providerName": "AWS",
       "regionName": "US_EAST_1",
       "volumeType": "STANDARD"
     },
     "replicationFactor": 3,
     "replicationSpec": {
       "US_EAST_1": {
         "analyticsNodes": 0,
         "electableNodes": 3,
         "priority": 7,
         "readOnlyNodes": 0
       }
     },
     "replicationSpecs": [
       {
         "id": "5e2f1f657a3e5a052beddd8d",
         "numShards": 1,
         "zoneName": "Zone 1",
         "regionsConfig": {
           "US_EAST_1": {
             "analyticsNodes": 0,
             "electableNodes": 3,
             "priority": 7,
             "readOnlyNodes": 0
           }
         }
       }
     ],
     "srvAddress": "mongodb+srv://sbxcluster-7hgjn.mongodb-dev.net",
     "stateName": "UPDATING"
   }

Example 2
~~~~~~~~~

The following ``mongocli atlas cluster update`` command uses a
configuration file to:

- Increase the cluster tier from ``M10`` to ``M20`` and
- Increase the server's root volume to ``200 GB``.

The command uses the profile named ``egAtlasProfile``, which
contains the public and private keys for accessing |service|.

.. code-block:: sh
   :copyable: false

   mongocli atlas cluster update myCluster \
            --file cluster-config.json \
            --projectId 5e2211c17a3e5a48f5497de3 \
            --profile egAtlasProfile

The cluster configuration file contains the updated document:

.. code-block:: json
   :copyable: false

   {
     "diskSizeGB": 200,
     "providerSettings": {
        "providerName": "AWS",
        "diskIOPS": 100,
        "instanceSizeName": "M20"
    },
    "replicationFactor": 3
   }

The command returns the following |json| document. To learn more about
these fields, see :ref:`Output <atlas-cluster-create-output-fields>`.

.. code-block:: json
   :copyable: false

   {
      "autoScaling": {
         "diskGBEnabled": true
      },
      "backupEnabled": false,
      "biConnector": {
         "enabled": false,
         "readPreference": "secondary"
      },
      "clusterType": "REPLICASET",
      "diskSizeGB": 120,
      "encryptionAtRestProvider": "NONE",
      "id": "5e66718ec4121d0a54021794",
      "groupId": "5e2f04ecf10fab66c7d4072e",
      "labels": [
         {
            "key" : "Infrastructure Tool",
            "value" : "mongoCLI"
         }
      ],
      "mongoDBVersion": "4.2.3",
      "mongoDBMajorVersion": "4.2",
      "mongoURI": "mongodb://cluster0-shard-00-00-xgwul.mongodb-dev.net:27017,cluster0-shard-00-01-xgwul.mongodb-dev.net:27017,cluster0-shard-00-02-xgwul.mongodb-dev.net:27017",
      "mongoURIUpdated": "2020-03-09T16:47:50Z",
      "mongoURIWithOptions": "mongodb://cluster0-shard-00-00-xgwul.mongodb-dev.net:27017,cluster0-shard-00-01-xgwul.mongodb-dev.net:27017,cluster0-shard-00-02-xgwul.mongodb-dev.net:27017/?ssl=true\u0026authSource=admin\u0026replicaSet=Cluster0-shard-0",
      "name": "Cluster0",
      "numShards": 1,
      "paused": false,
      "providerBackupEnabled": true,
      "providerSettings": {
         "diskIOPS": 360,
         "encryptEBSVolume": true,
         "instanceSizeName": "M10",
         "providerName": "AWS",
         "regionName": "US_EAST_1",
         "volumeType": "STANDARD"
      },
      "replicationFactor": 3,
      "replicationSpec": {
         "US_EAST_1": {
            "analyticsNodes": 0,
            "electableNodes": 3,
            "priority": 7,
            "readOnlyNodes": 0
         }
      },
      "replicationSpecs": [
         {
            "id": "5e667185746809055da6b383",
            "numShards": 1,
            "zoneName": "Zone 1",
            "regionsConfig": {
               "US_EAST_1": {
                  "analyticsNodes": 0,
                  "electableNodes": 3,
                  "priority": 7,
                  "readOnlyNodes": 0
               }
            }
         }
      ],
      "srvAddress": "mongodb+srv://cluster0-xgwul.mongodb-dev.net",
      "stateName": "UPDATING"
   }

