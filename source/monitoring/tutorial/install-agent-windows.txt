.. _tutorial-install-windows:

=======================================
Install the Monitoring Agent on Windows
=======================================

Overview
--------

To install the MMS Monitoring Agent on Windows, you must download the
latest agent software from MMS and then install the agent on a system
where it can connect to your MongoDB hosts to collect data. The Agnet
must also be able to connect to the MMS service itself.

If you use Kerberos authentication, or your Monitoring Agent must connect
to the internet via proxy, you will need to continue to use the legacy Python
Monitoring Agent, also available through MMS. See
:ref:`install-legacy-agent` for complete instructions.

.. include:: /includes/fact-new-go-agent.rst

Prerequisites
-------------

Requirements
++++++++++++

The latest Monitoring Agent does not have any dependencies.

System Resources
++++++++++++++++

The Monitoring agent does have some resource requirements and should run on
separate systems to avoid impacting ``mongod`` and ``mongos`` performance. To
monitor five or fewer nodes, you can safely deploy on an AWS "micro instance."
Similarly, if you are only monitoring a small number of databases, you may be
able to deploy the agent on the system running the ``mongos`` process.

Credentials
+++++++++++

.. include:: /includes/install-saas-registration.rst

Procedures
----------

Install Agent Without Kerberos or Network Proxies
+++++++++++++++++++++++++++++++++++++++++++++++++

.. include:: /includes/steps/monitoring-install-windows-go.rst

.. _install-legacy-agent:

Install Agent With Kerberos or Network Proxies
++++++++++++++++++++++++++++++++++++++++++++++

For environments with Kerberos or connections to the internet with a proxy,
follow these instructions to install the Monitoring Agent based on the
operating system, Python version, and other factors.

Considerations
--------------

The legacy monitoring agent download includes a ``WINDOWS.txt`` file
with instructions for using the agent on Windows platforms. Before you
can use the agent on Windows platforms, you must ensure your system
meets the system requirements.

To install the legacy monitoring agent you must have Python
installed. If your system doesn't have python installed, install the
latest' version of Python 2.7.x.

If your system supports 64-bit executable, use the 64-bit
version. Also install the correct PyMongo build for your Python
installation both in terms of version number (e.g .2.6, 2.7, etc.) and
system architecture (e.g. 32 or 64-bit.)

If available the legacy monitoring agent will use PyMongo's native
extension, which provide significant performance improvements. To
install PyMongo with native extensions, you must have``gcc``
installed.

Permissions
+++++++++++

To install the legacy monitoring agent on Windows you must have the
appropriate permissions to enable unsigned script execution with
PowerShell. As described below, permissions must be set at the
``HKEY_LOCAL_MACHINE`` level or ``HKEY_CURRENT_USER`` level. In some
cases, your system administrator may have used Group Policy to block
unsigned PowerShell scripts; contact your administrator if the
``Set-ExecutionPolicy`` commands below generate errors.

Requirements
''''''''''''

.. include:: /includes/monitoring-install-reqs-windows.rst

Procedure
'''''''''

.. include:: /includes/steps/monitoring-install-windows.rst

Next Steps
----------

.. include:: /includes/monitoring-install-next-steps.rst

Also, consider reading the `PyMongo documentation
<http://api.mongodb.org/python/current/installation.html>`_.
