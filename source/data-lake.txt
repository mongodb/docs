===================
Query a |data-lake|
===================

.. default-domain:: mongodb

.. include:: /includes/fact-data-lake-beta.rst

.. meta::
   :keywords: |data-lake|

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

About |service| |data-lake|
---------------------------

Using |service| |data-lake| to ingest your S3 data into |service| clusters allows you to:

* Quickly query data stored in their |aws| |s3| buckets using the :manual:`Mongo Shell </mongo>`, 
  :doc:`MongoDB Compass </compass-connection>`, and any MongoDB driver.

* Use the `Charts <https://docs.mongodb.com/charts/saas/>`_ data visualization service to analyze the data
  returned by |data-lake|.
  
* Automate the creation and maintenance of |data-lakes| with the MongoDB :doc:`Data Lake API </reference/api/query-engine.txt>`.

When you create a |data-lake|, you will grant |service| read only access to |s3| buckets in your |aws| account and create a data
configuration file that maps data from your |s3| buckets to your MongoDB databases and collections.
|service| supports using any M10+ cluster, including Global Clusters, to connect to |data-lakes| in the same project. 

.. note::

   If you update your custom |aws| role arn, you must update the |aws|
   trust policy associated with the role. See the :guilabel:`Configure a New Data Lake` modal for instructions.

Any MongoDB user in the |service| project with the  :ref:`atlasAdmin <atlas-user-privileges>`
MongoDB database user privilege can query an |service| |data-lake|. To view, create, or modify
any existing |data-lakes| in an |service| project, click :guilabel:`Data Lake` on the left hand navigation.

|data-lake| supports the following data formats:

* `Avro <https://avro.apache.org/docs/current/>`_
* `Parquet <https://parquet.apache.org/documentation/latest/>`_
* JSON
* JSON/Gzipped
* BSON
* CSV
* TSV 

Prerequisites
-------------

Verify that you meet the following prerequisites before you create a |data-lake|:

* One or more |aws| |s3| buckets in the same |aws| account.

* An |aws| CLI configured to access your |aws| account. Alternatively, you must have access to the |aws| Management Console
  with permission to create `IAM roles <https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user.html>`_.

  .. note:

   To prevent excessive charges on your bill, create your |service|
   |data-lake| in the same |aws| region as your |s3| data source.

  .. class:: hidden

   .. toctree::
      :titlesonly:

      /data-lake-limitations