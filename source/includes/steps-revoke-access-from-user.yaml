title: Connect with the Privilege to Revoke Roles
stepnum: 1
ref: connect-with-revoke-role-privileges
pre: |
  Connect to the :program:`mongod` or :program:`mongos` as a user with the
  :authaction:`revokeRole` action on the role's database.
action:
  pre: |
    The following example operation connects to the MongoDB instance as a user
    named ``roleManager``:
  language: javascript
  code: |
    mongo --port 27017 -u roleManager -p 12345678 --authenticationDatabase products
---
title: Verify Your Privileges
stepnum: 2
ref: verify-revoke-role-privileges
pre: |
  Verify that the user you are connected as has the :authaction:`revokeRole`
  actions on the role's database.
action:
  pre: |
    The following example operation checks privileges for the user connected
    as ``roleManager``:
  language: javascript
  code: |
    db.runCommand(
      {
        usersInfo:"roleManager",
        showPrivileges:true
      }
    )
  post: |
    The resulting ``users`` document displays the privileges granted to the user.
---
source:
  file: steps-change-user-privileges.yaml
  ref: collect-roles
---
source:
  file: steps-change-user-privileges.yaml
  ref: identify-privileges
---
source:
  file: steps-change-user-privileges.yaml
  ref: select-roles-to-modify
---
title: Revoke a Role from a User
stepnum: 6
ref: revoke-role-from-user
pre: |
  Revoke the role from the user using the :method:`db.revokeRolesFromUser` method.
action:
  pre: |
    For example:
  language: javascript
  code: |
    use products
    db.revokeRolesFromUser(
      "purchaseAgent",
      [
        {
          role: "readAnyDatabase", db:"admin"
        }
      ]
    )
...
