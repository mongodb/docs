.. _required-permissions-mms-backup:

================================
Required Access for Backup Agent
================================

.. default-domain:: mongodb

.. only:: cloud

   If your MongoDB deployment enforces access control, the MMS Backup
   Agent must authenticate to MongoDB as a user with the proper access. To
   authenticate, create a user with the appropriate roles in MongoDB.

.. only:: classic or onprem

   If your MongoDB deployment enforces access control, the MMS Backup
   Agent must authenticate to MongoDB as a user with the proper access. To
   authenticate, create a user with the appropriate roles in MongoDB. The
   following tutorials include instructions and examples for creating the
   MongoDB user:

   .. include:: /includes/ref-configure-access-control.rst

MongoDB user roles are separate from |MMS| :doc:`user roles
</reference/user-roles>`.

Considerations
--------------

.. include:: /includes/considerations-agent-access-control.rst

.. only:: classic or cloud

   There are additional authentication configuration requirements for
   MMS Backup when using MongoDB 2.4 with authentication.

MongoDB 2.6
-----------

.. _access-control-backup-2.6.4:

2.6.4 and After
~~~~~~~~~~~~~~~

To backup MongoDB instances running 2.6.4 and later, the Backup Agent
must authenticate as a user with the following role:

.. list-table::
   :header-rows: 1

   * - Required Role
     - 
   * - :authrole:`backup` role on the ``admin`` database
     -

.. _access-control-backup-2.6.3:

2.6.0 through 2.6.3
~~~~~~~~~~~~~~~~~~~

To backup MongoDB 2.6.0 through 2.6.3 instances, the Backup Agent must
be able to authenticate to with the following roles:

.. list-table::
   :header-rows: 1

   * - Required Role
     - 
   * - :authrole:`clusterAdmin` role on the ``admin`` database
     -
   * - :authrole:`readAnyDatabase` role on the ``admin`` database
     -
   * - :authrole:`userAdminAnyDatabase` role on the ``admin`` database
     -
   * - :authrole:`readWrite` role on the ``admin`` database
     -
   * - :authrole:`readWrite` role on the ``local`` database
     -

.. _access-control-backup-2.4:

MongoDB 2.4
-----------

To backup MongoDB 2.4 instances, the Backup Agent must be able to
authenticate to the database with a user that has specified ``roles``
and ``otherDBRoles``. Specifically, the user must have the following
roles:

.. list-table::
   :header-rows: 1

   * - Required Role
     - 
   * - :authrole:`clusterAdmin` role on the ``admin`` database
     -
   * - :authrole:`readAnyDatabase` role on the ``admin`` database
     -
   * - :authrole:`userAdminAnyDatabase` role on the ``admin`` database
     -

And the following ``otherDBRoles``:

.. list-table::
   :header-rows: 1

   * - Required Role
     - 
   * - :authrole:`readWrite` role on the ``local`` database
     -
   * - :authrole:`readWrite` role on the ``admin`` database
     -
   * - :authrole:`readWrite` role on the ``config`` database
     -

.. only:: classic or onprem

   Authentication Mechanisms
   -------------------------

   To authenticate, create the user in MongoDB with the appropriate
   access. The authentication method that the MongoDB deployment uses
   determines how to create the user as well as determine any additional
   agent configuration:

   .. include:: /includes/ref-configure-access-control-verbose.rst

   
