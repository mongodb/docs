====================
Manage Oplog Storage
====================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Throughout the lifecycle of a backup, {+bagent+} tails the
:term:`oplog` of each :term:`replica set` and sends new oplog entries
to |onprem|. The oplog entries are sent in compressed bundles of
approximately 10 MB in size called :term:`oplog slices <oplog slice>`.
These oplog slices are stored in one or more MongoDB databases called
:term:`Oplog Stores <Oplog Store Database>`. Every |onprem| deployment
needs at least one Oplog Store.

When you enable backups, you are prompted to create one Oplog Store.
Once one Oplog Store is created, you manage it separately from your
snapshot stores and can create additional Oplog Stores.

This tutorial covers creating additional Oplog Stores to store oplog
entries. Like any MongoDB instance,
:term:`Oplog Stores <Oplog Store Database>` can exist on any host
running MongoDB that the |onprem| application can access.

Prerequisites
-------------

Before creating any Oplog Stores:

- Ensure storage volume(s) with sufficient capacity to store the oplog
  MongoDB database are attached to the |onprem| or MongoDB host.

- :doc:`Deploy the dedicated MongoDB instance(s) </tutorial/prepare-backing-mongodb-instances>`
  to host the Oplog Stores.

- Ensure the host running the |onprem| :term:`Backup Daemon` service
  has sufficient capacity to store the :term:`head` database.

- Secure the instance that stores your
  :term:`Oplog Stores <Oplog Store Database>` using
  :manual:`authentication </core/authentication>` and
  :manual:`TLS </tutorial/configure-ssl/>`. Oplog Stores support
  :urioption:`all authentication mechanisms <authMechanism>`.

Procedures
----------

.. include:: /includes/tabsets/storage-settings-selection.rst

.. _add-oplogstore:

Add One Oplog Store
~~~~~~~~~~~~~~~~~~~

.. include:: /includes/steps/admin-add-oplogstore.rst

Edit One Existing Oplog Store
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|onprem| lists :term:`Oplog Stores <Oplog Store Database>` in a table
on the :ref:`Oplog Storage page <oplog-stores-page>`. Each row
contains the settings for each Oplog Store.

.. include:: /includes/steps/admin-edit-oplogstore.rst

.. _delete-oplogstore:

Delete One Oplog Store
~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/steps/admin-delete-oplogstore.rst
