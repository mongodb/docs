:orphan:

.. _voyage-migrate-to-atlas-api:

======================================================================
Migrate Your Applications to use the {+voyage-api-full+}
======================================================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

If you are an existing {+voyageai+} user, complete the following steps 
to migrate your application to use the {+voyage-api-full+}.

Procedure
---------

.. procedure::
   :style: normal

   .. step:: `Sign up for a free Atlas account or log in. <https://www.mongodb.com/cloud/atlas/register>`__

      If you're new to |service|, it creates an organization and project for you. 
      
      To learn more, see :ref:`create-atlas-account`.
      
   .. step:: Create a {+model-api-key+} for your project.

      a. In your |service| project, select :guilabel:`AI Models` from the navigation bar.
      #. Click :guilabel:`Create {+model-api-key+}`.
      #. Give the API key a name and then click :guilabel:`Create`.
      #. To confirm your API key is valid, you can make a test request to the {+voyage-api+}:

         .. code-block:: bash

            curl \
              --request POST 'https://ai.mongodb.com/v1/embeddings' \
              --header "Authorization: Bearer $VOYAGE_API_KEY" \
              --header "Content-Type: application/json" \
              --data '{
                "input": "Sample text",
                "model": "voyage-4-lite",
                "input_type": "document"
              }'

      To learn more about creating and managing API keys, 
      see :ref:`voyage-manage-api-keys`.
       
   .. step:: Replace your existing {+voyage+} API key with the {+model-api-key+}.

      For example, if you set your API key as an environment variable, 
      update the value:

      .. code-block:: bash

         VOYAGE_API_KEY="<your-new-model-api-key>"

      If you pass the API key directly in your code, update the value 
      where you initialize the client or make API requests.
         
      .. note::
         
         If you set your API key as an environment variable, you can run
         the following command to verify the variable is set:

         .. code-block:: bash

            echo $VOYAGE_API_KEY

   .. step:: Replace explicit API endpoints with the {+voyage-api+} endpoints.

      If your application explicitly specifies API endpoints,
      update it to use the equivalent {+voyage-api+} API endpoints:

      .. list-table::
         :widths: 50 50
         :header-rows: 1

         * - Old Endpoint
           - New Endpoint
         * - ``https://api.voyageai.com/v1/embeddings``
           - ``https://ai.mongodb.com/v1/embeddings``
         * - ``https://api.voyageai.com/v1/rerank``
           - ``https://ai.mongodb.com/v1/rerank``
         * - ``https://api.voyageai.com/v1/multimodalembeddings``
           - ``https://ai.mongodb.com/v1/multimodalembeddings``
         * - ``https://api.voyageai.com/v1/contextualizedembeddings``
           - ``https://ai.mongodb.com/v1/contextualizedembeddings``

      .. note::

         If you use the ``voyageai`` Python client (version 0.3.7 or later),
         the client automatically routes requests to the correct endpoint
         based on the API key format. No endpoint changes are required 
         if you use the client without explicitly setting the ``base_url`` 
         parameter.

         To learn more, see :ref:`voyage-python-client`.

   .. step:: Verify that your application works with the new API key.

      Test your application to ensure it 
      correctly generates embeddings and performs reranking operations 
      using the {+voyage-api+}.

   .. step:: Delete your old Voyage AI API key.

      After you confirm that your application works with the
      {+model-api-key+}, delete your old API key from the Voyage AI 
      platform to prevent unauthorized access.
