=========================================
Deploy a Replica Set From a Single Server
=========================================

.. default-domain:: mongodb

This tutorial describes how to deploy a three-member :term:`replica set`
from a standalone instance of MongoDB.

To deploy a replica set from multiple existing instances of MongoDB, see
:doc:`/tutorial/deploy-replica-set`.

For background information on replica set deployments, see
:doc:`/core/replication` and
:doc:`/administration/replication-architectures`.

Procedure
---------

These procedures assume you have a standalone instance of MongoDB
installed. If you have not already installed MongoDB, see the
:ref:`installation tutorials <tutorials-installation>`.

1. Shut down the your MongoDB instance and then restart using
   the :option:`--replSet <mongod --replset>` option and the name of the
   :term:`replica set`, which is ``rs0`` in the example below.

   To minimize downtime, consider pre-allocating new local data files by
   using the :setting:`oplogSize` option. If you choose not to use this
   option, the server allocate the new data files before starting back
   up. This example does not use the :setting:`oplogSize` option.

   Use a command similar to the following:

   .. code-block:: sh

      mongod --port 27017 --replSet rs0

   This starts the instance as a member of a replica set named ``rs0``.
   For more information on configuration options, see
   :doc:`/reference/configuration-options`.

#. Open a :program:`mongo` shell and connect to the :program:`mongod`
   instance. If you are running the command remotely, replace
   "localhost" with the appropriate hostname. In a new shell session,
   enter the following:

   .. code-block:: sh

      mongo localhost:27017

#. Use :method:`rs.initiate()` to initiate the replica set:

   .. code-block:: javascript

      rs.initiate()

   The server is now operational as the :term:`primary` in a replica set
   that consists of a single node. To display the replica configuration,
   issue the :method:`rs.conf()` method. To check the status of the
   replica set, issue :method:`rs.status()`.

#. The next step is to add members to the replica set. To do so, see
   :doc:`/tutorial/expand-replica-set`.
