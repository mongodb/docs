import com.mongodb.client.MongoClient;
import com.mongodb.client.MongoClients;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;
import com.mongodb.client.model.search.FieldSearchPath;
import org.bson.Document;
import org.bson.conversions.Bson;

import java.util.List;

import static com.mongodb.client.model.Aggregates.project;
import static com.mongodb.client.model.Aggregates.vectorSearch;
import static com.mongodb.client.model.Projections.fields;
import static com.mongodb.client.model.Projections.include;
import static com.mongodb.client.model.Projections.exclude;
import static com.mongodb.client.model.Projections.metaVectorSearchScore;
import static com.mongodb.client.model.search.SearchPath.fieldPath;
import static com.mongodb.client.model.search.VectorSearchOptions.approximateVectorSearchOptions;
import static java.util.Arrays.asList;

public class BasicQuery {
  public static void main( String[] args ) {
    // specify connection
    String uri = "<connection-string>";

    // establish connection and set namespace
    try (MongoClient mongoClient = MongoClients.create(uri)) {
      MongoDatabase database = mongoClient.getDatabase("sample_mflix");
      MongoCollection<Document> collection = database.getCollection("embedded_movies");
      

      // define $vectorSearch query options
      List<Double> queryVector = (asList(-0.034731735d,0.008558298d,-0.0153717d,-0.029912498d,0.011549547d,0.010261648d,-0.011964999d,-0.023265276d,0.010303194d,-0.006896493d,-0.00054528d,0.003926015d,-0.025757983d,0.027419789d,0.001199616d,-0.036227357d,-0.005297005d,0.021935832d,0.010303194d,-0.019193852d,0.025093261d,-0.040049512d,-0.033900831d,-0.011466458d,-0.01827986d,-0.0153717d,0.023265276d,0.007727395d,0.000114249d,0.005317777d,-0.043871664d,-0.02127111d,-0.019609304d,0.016368784d,-0.004756918d,0.003552109d,0.006522586d,-0.005400868d,-0.015620971d,-0.034565553d,-0.018695312d,-0.023099095d,0.050851244d,-0.034731735d,0.004819236d,0.022268193d,-0.095719993d,0.05517194d,-0.046198189d,-0.036393538d,0.007187308d,-0.02459472d,-0.036725901d,0.009472291d,0.019027673d,0.020938748d,-0.011051006d,0.027087428d,0.04586583d,-0.022600554d,-0.05517194d,0.044204023d,0.01213118d,0.047859997d,-0.03938479d,0.002928932d,0.002056484d,0.019443123d,-0.028583053d,0.013543714d,0.022932915d,0.011632638d,0.004923099d,0.000389486d,0.020024756d,-0.024096178d,-0.022766734d,0.011217186d,-0.003198975d,0.007104218d,-0.047195274d,-0.013377533d,0.013294443d,0.024096178d,-0.056501385d,-0.026755067d,-0.008433662d,-0.001911076d,0.007976666d,-0.008101301d,-0.014042255d,0.008641388d,-0.02176965d,0.010012378d,-0.000607598d,-0.024927082d,0.024927082d,-0.018612221d,-0.001184036d,0.005567048d,0.001324251d,-0.019526213d,-0.023597637d,0.060489718d,-0.010178559d,-0.019609304d,0.004112968d,-0.011217186d,-0.031574301d,-0.008766023d,0.005483958d,-0.061819162d,-0.023431456d,-0.040714234d,0.015039339d,0.026422706d,0.016202603d,0.004653055d,0.041046593d,-0.018030589d,0.040381871d,-0.002638116d,0.013045172d,0.004216831d,0.005650138d,0.027419789d,0.003926015d,-0.028749233d,0.004798463d,-0.030244859d,0.063813329d,0.007145763d,-0.017448956d,0.025591804d,-0.045201108d,0.010718645d,0.002804297d,0.014291527d,0.04586583d,-0.015205519d,-0.021603471d,-0.035230275d,0.00760276d,0.033236109d,0.016534964d,-0.043206941d,-0.003115885d,-0.026256526d,0.005940954d,0.016534964d,0.024262359d,-0.001630647d,0.028084511d,-0.012795902d,0.007270399d,0.001381376d,-0.009763107d,-0.006896493d,0.008433662d,-0.019360034d,0.000386889d,0.030411039d,0.025591804d,0.010469374d,0.037722982d,-0.001147684d,-0.005400868d,0.052845411d,-0.052513052d,0.00768585d,-0.004299921d,0.00922302d,0.011881908d,0.012962082d,-0.068798743d,0.003593654d,0.020938748d,-0.013792985d,-0.034565553d,-0.007519669d,-0.04021569d,-0.020689478d,0.006273315d,0.046862911d,0.006107135d,0.002638116d,-0.013792985d,-0.005400868d,-0.020274026d,0.007644305d,-0.010801735d,0.026422706d,0.043871664d,0.003780607d,0.010261648d,-0.064145692d,0.011881908d,-0.009056839d,0.009347656d,-0.02459472d,0.026422706d,0.033236109d,0.041212775d,0.019027673d,-0.00315743d,0.004424557d,0.020689478d,-0.0153717d,-0.015205519d,-0.034897912d,0.020274026d,0.016867325d,0.040714234d,-0.022766734d,-0.010967916d,0.026256526d,0.007062673d,-0.015953332d,-0.007727395d,0.031574301d,-0.002887387d,-0.00614868d,0.004569965d,0.019027673d,0.012878992d,0.011798819d,0.004258377d,-0.019193852d,-0.021437289d,-0.021603471d,0.000301202d,-0.051183607d,-0.004985416d,-0.030078677d,0.012629721d,0.065142773d,-0.031740483d,-0.021104928d,-0.03938479d,-0.003365156d,-0.016036423d,0.036393538d,0.009804652d,-0.018612221d,0.060489718d,-0.003697517d,0.000547876d,0.063480966d,0.02758597d,0.010053922d,-0.003655972d,-0.001485239d,0.018362951d,0.021104928d,-0.003905243d,0.019443123d,-0.002658889d,-0.00380138d,-0.013626805d,0.035894997d,0.035396457d,-0.005691683d,0.002762751d,0.012878992d,-0.009596926d,-0.009970833d,-0.015953332d,0.022434372d,0.00614868d,-0.021188019d,0.001557943d,-0.020190936d,0.009763107d,0.017448956d,0.006730312d,0.005567048d,0.019692395d,-0.00218112d,-0.016867325d,0.006854947d,0.007976666d,0.019193852d,0.040880412d,0.007353489d,-0.02127111d,-0.031906664d,-0.026755067d,-0.017947499d,0.040381871d,0.042209856d,0.00913993d,-0.0307434d,-0.017781317d,-0.015039339d,0.03057722d,0.017532047d,0.0187784d,-0.060822077d,0.002928932d,-0.026422706d,-0.005899409d,0.039717149d,0.026588887d,-0.000971118d,0.004923099d,-0.013626805d,0.0187784d,-0.031408124d,-0.000695881d,0.050851244d,-0.014457707d,-0.007311944d,-0.001293092d,-0.002139574d,-0.019276943d,0.00290816d,0.019360034d,-0.017781317d,0.002160347d,0.016618054d,-0.006522586d,0.011798819d,0.029247776d,-0.02775215d,0.010344739d,-0.018362951d,-0.036725901d,-0.015870241d,0.015704062d,-0.012463541d,0.02459472d,-0.024096178d,0.001152877d,-0.031408124d,0.025425622d,0.027087428d,0.00922302d,0.034565553d,0.015704062d,-0.020689478d,-0.00517237d,-0.014706978d,-0.001589101d,0.026090344d,0.014956249d,0.011715728d,0.004299921d,-0.00913993d,0.022434372d,-0.03705826d,0.048524719d,-0.030411039d,0.008433662d,0.017033506d,-0.000511525d,-0.031408124d,0.005940954d,-0.012962082d,-0.031574301d,0.017448956d,0.010178559d,-0.011383367d,-0.020107845d,-0.005151597d,0.006647222d,0.013128263d,0.007145763d,0.008059756d,-0.045201108d,-0.004943871d,0.015787151d,-0.045201108d,-0.020772567d,-0.020274026d,0.028250692d,-0.024262359d,-0.004424557d,0.009804652d,0.000472576d,-0.005691683d,0.001443693d,-0.013294443d,0.001412535d,0.013211353d,-0.01213118d,-0.002118802d,0.017781317d,-0.007353489d,-0.031075761d,-0.004923099d,0.011383367d,-0.004486875d,-0.010178559d,0.016618054d,0.014457707d,0.023763817d,-0.02459472d,-0.00388447d,0.012546631d,-0.007519669d,0.015704062d,-0.014291527d,0.009680017d,-0.035562634d,0.023763817d,0.053510133d,-0.0555043d,-0.003572882d,0.022102011d,0.021603471d,-0.017282777d,-0.001474852d,-0.043539301d,0.007810486d,-0.025757983d,-0.005400868d,0.029912498d,-0.00760276d,0.014125346d,0.030909581d,-0.03340229d,-0.009680017d,0.018030589d,0.008849114d,0.03057722d,0.019775484d,0.014125346d,0.031906664d,-0.03057722d,-0.027087428d,-0.023597637d,-0.022434372d,-0.012878992d,0.016285693d,-0.021603471d,-0.029746316d,0.029746316d,0.020357117d,0.006314861d,-0.001158071d,0.028749233d,-0.045201108d,0.011383367d,0.011134096d,-0.021437289d,-0.035728816d,0.001827986d,0.008267482d,-0.057498466d,0.01213118d,-0.01213118d,-0.040548053d,0.010718645d,0.004798463d,-0.004881553d,-0.019526213d,-0.008558298d,0.0059825d,-0.000262254d,-0.017615138d,0.005193142d,0.019692395d,-0.00198378d,-0.002845842d,0.012546631d,0.006107135d,-0.008225936d,-0.008890659d,0.015870241d,0.00517237d,0.002596571d,-0.010427829d,-0.019110762d,0.024262359d,0.012048089d,-0.032405205d,0.006522586d,0.013211353d,0.013211353d,-0.038221523d,-0.007727395d,-0.008267482d,-0.019276943d,0.001474852d,0.031408124d,-0.035562634d,0.017532047d,-0.023431456d,-0.015454791d,-0.011383367d,0.016534964d,-0.02176965d,0.008682934d,0.027253609d,0.020190936d,-0.0247609d,-0.007311944d,0.009555381d,-0.01852913d,-0.011632638d,0.011549547d,0.027419789d,-0.034067012d,-0.01229736d,0.0307434d,0.003946788d,0.0046946d,0.037722982d,0.03057722d,-0.010427829d,0.002284982d,0.033236109d,0.030078677d,-0.013377533d,0.007395034d,-0.012048089d,0.040714234d,-0.028749233d,-0.000102565d,-0.0059825d,-0.041046593d,0.017698228d,-0.006356406d,0.003178203d,0.009056839d,0.023099095d,0.00606559d,0.011881908d,-0.02127111d,-0.001126912d,-0.027087428d,0.011134096d,0.001204809d,-0.017033506d,0.011051006d,-0.014374617d,0.017864408d,0.023431456d,-0.002077257d,-0.026755067d,-0.043871664d,0.025757983d,-0.006190225d,0.001152877d,0.011798819d,-0.024262359d,0.006564131d,-0.070128188d,-0.004362239d,0.012962082d,-0.013626805d,-0.001402148d,-0.012214269d,0.011217186d,-0.015953332d,0.015787151d,0.011134096d,0.027253609d,0.024262359d,-0.048192356d,0.009970833d,0.018944582d,-0.00517237d,0.021935832d,0.02775215d,0.003406701d,-0.010884825d,0.075113602d,-0.015953332d,0.007727395d,0.026755067d,-0.006190225d,-0.012712811d,0.013377533d,0.005940954d,-0.008309027d,0.02459472d,0.002316141d,-0.022434372d,-0.012712811d,0.03057722d,-0.015787151d,0.026755067d,-0.001069787d,0.03988333d,-0.003697517d,0.039550968d,-0.019027673d,-0.0059825d,-0.00031029d,-0.012546631d,-0.003614427d,0.007478124d,0.005525503d,0.032571387d,-0.011798819d,-0.011466458d,-0.00606559d,-0.011798819d,0.018446039d,0.007976666d,0.018944582d,-0.02176965d,0.026588887d,-0.006273315d,-0.012463541d,-0.007395034d,0.012048089d,-0.029247776d,0.015454791d,-0.007145763d,0.006481041d,-0.015620971d,-0.00388447d,-0.025757983d,-0.001651419d,-0.032903746d,-0.005068507d,0.03938479d,0.003926015d,0.004715373d,0.022600554d,-0.012546631d,0.022932915d,0.007810486d,0.040714234d,0.019941665d,0.013543714d,0.003406701d,0.010884825d,-0.03988333d,0.042209856d,-0.022766734d,0.027419789d,-0.029580137d,0.043206941d,0.022932915d,0.021104928d,-0.056833744d,0.005193142d,0.036061179d,-0.012878992d,0.008516753d,-0.02758597d,-0.030244859d,-0.011798819d,0.001111332d,-0.014125346d,-0.014125346d,0.019027673d,0.029081594d,0.018861491d,0.013626805d,0.06846638d,0.023099095d,0.041378956d,0.001599488d,-0.028749233d,0.017781317d,0.016285693d,0.021603471d,-0.018113678d,0.011300277d,-0.032239024d,0.022434372d,-0.02459472d,-0.013626805d,0.005483958d,0.013460624d,-0.031574301d,-0.015620971d,0.016451873d,0.014790068d,-0.008849114d,0.011134096d,0.00461151d,0.015122429d,0.036227357d,0.00206687d,0.000877641d,0.022102011d,-0.028250692d,0.022600554d,-0.026422706d,0.004029878d,-0.032072846d,0.017116595d,0.010884825d,0.019609304d,0.00614868d,0.005733229d,0.016119512d,0.002866614d,-0.014540797d,0.012463541d,-0.003905243d,0.003759835d,-0.000485559d,-0.022766734d,-0.016285693d,0.037722982d,0.009513836d,0.001506011d,0.011964999d,0.004029878d,0.019941665d,-0.000965924d,0.002129188d,0.015205519d,0.071125269d,0.022932915d,0.005940954d,-0.00044661d,0.010220103d,-0.03423319d,-0.016285693d,-0.016867325d,-0.000659529d,-0.008018211d,-0.011383367d,0.000016634d,0.004071423d,-0.029413955d,0.019941665d,-0.00913993d,-0.024096178d,0.010635555d,0.010594009d,0.001547556d,0.036227357d,-0.030078677d,0.020772567d,0.022268193d,-0.014125346d,0.008766023d,-0.012962082d,-0.007187308d,0.017033506d,-0.007187308d,-0.015205519d,-0.005608593d,0.044536386d,-0.001235968d,0.007852031d,0.001599488d,0.005857864d,-0.005940954d,-0.010510919d,-0.005567048d,0.006730312d,0.016285693d,-0.010801735d,-0.024428539d,0.015122429d,-0.02176965d,0.01528861d,-0.007436579d,0.00226421d,-0.004715373d,0.004507647d,0.004341467d,0.005525503d,-0.031075761d,-0.005899409d,0.037556801d,0.014873158d,-0.000342747d,0.009970833d,-0.019443123d,0.023597637d,-0.012048089d,-0.025259443d,0.006024044d,-0.01827986d,0.010012378d,0.016784234d,0.013211353d,-0.005400868d,-0.024428539d,-0.02176965d,-0.035230275d,0.009347656d,0.028583053d,-0.015704062d,-0.017781317d,0.00226421d,0.001199616d,-0.003385928d,0.008267482d,0.002326528d,0.022434372d,-0.020190936d,-0.015787151d,0.000789358d,0.031241942d,0.011300277d,0.001506011d,-0.023265276d,-0.010967916d,0.009056839d,0.011300277d,-0.030244859d,0.007478124d,0.001111332d,-0.035894997d,0.0153717d,0.002700434d,0.021104928d,0.010884825d,-0.003344383d,0.00768585d,0.010386284d,0.00452842d,-0.014706978d,0.028084511d,0.013377533d,0.014873158d,0.046862911d,-0.015454791d,0.021188019d,0.013959166d,0.012629721d,0.025924165d,-0.018695312d,-0.00922302d,-0.0093892d,0.007727395d,0.036892079d,0.007228854d,-0.01229736d,0.029247776d,-0.004943871d,-0.027253609d,-0.008433662d,0.043206941d,0.002825069d,0.028583053d,-0.023431456d,0.034897912d,-0.041545134d,-0.016534964d,0.003053567d,-0.012712811d,0.002741979d,-0.007187308d,-0.025093261d,-0.045201108d,-0.004424557d,-0.016618054d,-0.008890659d,0.008018211d,-0.05184833d,-0.019526213d,-0.013377533d,-0.010469374d,0.030244859d,-0.005068507d,0.051183607d,0.005483958d,-0.006024044d,0.035064094d,-0.011134096d,0.014956249d,0.002284982d,0.001724123d,-0.01229736d,0.012629721d,0.010261648d,0.014540797d,0.048857078d,-0.029580137d,-0.024927082d,-0.008350573d,-0.03988333d,0.000939959d,0.013543714d,0.013626805d,-0.021437289d,-0.012962082d,0.006771857d,0.013709894d,-0.0059825d,0.035396457d,-0.006439496d,-0.029580137d,0.0046946d,0.019609304d,-0.007270399d,0.014291527d,-0.015620971d,0.00118923d,-0.00760276d,-0.017199686d,0.023265276d,0.026588887d,-0.030078677d,-0.016701145d,-0.025757983d,0.004964644d,0.026588887d,0.043206941d,0.011051006d,-0.009846197d,0.028915415d,0.031574301d,0.023763817d,0.009264565d,-0.008433662d,-0.035064094d,-0.000579035d,-0.0247609d,0.014125346d,0.016618054d,0.028749233d,-0.052513052d,-0.016867325d,-0.01238045d,0.002741979d,0.013709894d,0.010718645d,0.013626805d,0.009596926d,-0.004403784d,-0.02758597d,-0.000945152d,0.000420645d,0.003759835d,0.012546631d,-0.011881908d,0.008392117d,0.012795902d,0.005483958d,-0.009763107d,0.006397951d,-0.010801735d,0.012795902d,-0.03938479d,0.005733229d,0.005733229d,-0.000433627d,0.015454791d,0.002357686d,-0.006564131d,0.030244859d,-0.024428539d,0.016036423d,0.014291527d,-0.004964644d,0.029413955d,0.040381871d,0.012629721d,-0.033568468d,-0.026422706d,-0.037889164d,-0.034399372d,-0.03423319d,0.021935832d,0.004133741d,-0.014623888d,-0.013543714d,-0.05517194d,0.004736145d,0.006314861d,0.00006037d,0.006356406d,0.003323611d,-0.010344739d,0.007062673d,0.005899409d,-0.00623177d,-0.001973394d,-0.0555043d,0.011881908d,0.001350217d,-0.033069927d,-0.026921248d,0.022268193d,0.028583053d,-0.021021837d,0.010884825d,0.019692395d,-0.005442413d,0.031574301d,-0.014956249d,0.01238045d,-0.006356406d,0.006273315d,-0.003095113d,-0.014540797d,-0.02176965d,0.005006189d,-0.002658889d,0.042542219d,-0.02176965d,0.017199686d,-0.016701145d,-0.001599488d,0.016950415d,-0.021188019d,0.017864408d,0.023763817d,-0.000669915d,0.025093261d,0.021104928d,0.008807569d,0.037390623d,-0.025591804d,-0.003178203d,-0.001319058d,0.020523297d,0.005255459d,0.019276943d,-0.00226421d,0.00760276d,-0.057166107d,-0.006896493d,-0.034067012d,0.043871664d,0.038221523d,0.008101301d,0.03988333d,0.015870241d,0.000955538d,-0.004299921d,-0.002928932d,-0.002118802d,-0.020523297d,-0.001168457d,-0.011134096d,-0.000685495d,0.003323611d,0.011549547d,0.034565553d,0.029247776d,-0.029746316d,0.005213914d,0.019110762d,-0.003302838d,0.026422706d,0.028915415d,-0.036227357d,0.033236109d,0.038387705d,-0.035230275d,0.004071423d,-0.021935832d,0.002928932d,0.000976311d,0.000527104d,-0.006854947d,-0.003822153d,-0.001199616d,0.019858574d,-0.002762751d,0.039052427d,-0.008641388d,0.032239024d,-0.002295369d,0.035396457d,0.044536386d,-0.029413955d,0.025093261d,-0.03423319d,-0.016867325d,-0.008849114d,0.008433662d,-0.004486875d,0.017033506d,0.006730312d,-0.008599843d,-0.008225936d,-0.024428539d,0.006564131d,-0.007561215d,-0.032072846d,-0.019941665d,0.035396457d,0.019276943d,0.010261648d,0.005857864d,0.032239024d,-0.044204023d,-0.018944582d,0.002409618d,0.032903746d,0.05517194d,-0.03655972d,0.007976666d,0.030909581d,-0.023929998d,0.016368784d,0.01528861d,-0.00768585d,0.02176965d,0.013626805d,-0.02459472d,0.04021569d,-0.032737568d,0.006854947d,-0.011383367d,0.014873158d,-0.02176965d,0.00243039d,0.0093892d,0.0093892d,-0.029580137d,0.019858574d,0.01827986d,0.024428539d,0.017864408d,-0.028250692d,-0.001111332d,0.056169022d,0.007478124d,-0.010718645d,0.041046593d,-0.015704062d,0.034731735d,0.002523867d,-0.032571387d,0.004341467d,-0.023597637d,-0.011881908d,-0.035562634d,0.006688767d,0.007810486d,-0.012712811d,0.022600554d,0.03057722d,0.022600554d,0.010552464d,0.0307434d,-0.009638472d,0.02176965d,-0.018030589d,0.024262359d,-0.036227357d,-0.020772567d,0.001641033d,-0.022932915d,-0.014623888d,0.018362951d,0.002575798d,0.006190225d,-0.011051006d,0.021021837d,0.019110762d,0.02127111d,-0.028583053d,-0.052180689d,-0.014291527d,-0.010552464d,0.036393538d,0.042542219d,-0.04586583d,-0.001869531d,0.008350573d,-0.008516753d,-0.020772567d,0.000294711d,0.015704062d,-0.014457707d,-0.020772567d,0.008766023d,-0.026588887d,-0.004736145d,-0.028084511d,-0.007519669d,0.010552464d,-0.016534964d,0.006190225d,0.012962082d,-0.016618054d,0.012546631d,0.02459472d,0.022932915d,0.020440206d,-0.027918331d,-0.008059756d,0.020689478d,-0.014623888d,-0.011466458d,-0.006896493d,-0.020024756d,-0.031408124d,0.021603471d,0.007270399d,-0.03057722d,0.008350573d,-0.021437289d,0.00072704d,-0.043871664d,0.006314861d,-0.017199686d,0.02176965d,0.024262359d,-0.020357117d,-0.000542683d,-0.005213914d,0.001963008d,-0.00064395d,-0.022434372d,0.022102011d,-0.006688767d,-0.028583053d,0.002191506d,-0.005047734d,0.002368073d,0.014956249d,0.023929998d,-0.003302838d,-0.032239024d,0.022268193d,-0.013377533d,-0.010801735d,0.003676744d,0.009015295d,-0.039550968d,0.010884825d,-0.033568468d,0.013709894d,-0.029413955d,-0.006356406d,-0.020274026d,0.023597637d,0.030909581d,0.02176965d,0.016285693d,0.045533467d,-0.024096178d,-0.030909581d,-0.026422706d,0.002783524d,-0.010594009d,0.004362239d,-0.070792913d,0.009472291d,-0.022102011d,0.011134096d,-0.017448956d,-0.011549547d,-0.056833744d,0.00082571d,0.026588887d,-0.013709894d,0.002575798d,0.02176965d,-0.000568649d,-0.007270399d,0.004279149d,-0.042874578d,-0.026588887d,0.016784234d,0.036725901d,-0.028915415d,-0.009513836d,0.017448956d,0.002035712d,-0.007228854d,0.011383367d,0.011134096d,0.028915415d,0.0153717d,-0.027087428d,0.043871664d,-0.005089279d,0.006314861d,0.014291527d,-0.003240521d,0.025924165d,-0.001230775d,-0.015454791d,-0.012629721d,0.031740483d,-0.039717149d,-0.031075761d,0.006605676d,-0.008641388d,-0.032239024d,0.037722982d,-0.03705826d,-0.024096178d,0.001911076d,0.018196769d,-0.007353489d,-0.011300277d,-0.029081594d,0.004590738d,-0.018030589d,-0.026588887d,0.010261648d,0.038221523d,0.008392117d,-0.01213118d,0.018362951d,-0.034731735d,-0.017781317d,-0.011632638d,0.005255459d,0.000851675d,0.014208436d,-0.000039922d,-0.000228498d,0.014790068d,0.00913993d,0.0004544d,-0.011798819d,-0.020440206d,0.005899409d,0.008350573d,0.006314861d,0.040548053d,0.003427474d,-0.010801735d,0.008599843d,0.002586185d,-0.041212775d,-0.016368784d,0.020024756d,0.000965924d,-0.021021837d,-0.008475208d,0.0307434d,0.00760276d,0.003614427d,0.003489791d,-0.025924165d,0.000799744d,0.013460624d,-0.020440206d,0.048857078d,0.004320694d,-0.048857078d,0.015039339d,-0.029580137d,0.025924165d,0.018861491d,-0.014706978d,0.000576439d,-0.031241942d,0.0307434d,0.0153717d,0.014706978d,0.028084511d,-0.01238045d,-0.031241942d,0.018196769d,-0.034897912d,0.008142847d,0.010718645d,0.00922302d,0.047859997d,-0.00072704d,-0.010427829d,0.007104218d,0.026256526d,0.012214269d,-0.013377533d,-0.05184833d,0.005276232d,0.021935832d,-0.007021128d,0.009804652d,0.007893575d,0.024096178d,-0.002357686d,0.033900831d,-0.031740483d,0.034565553d,-0.036892079d,-0.015454791d,0.030411039d,0.010552464d,-0.022268193d,-0.001391762d,-0.008184392d,-0.008558298d,0.008475208d,-0.009929287d,0.010427829d,0.041378956d,-0.009555381d,-0.008724478d,-0.039052427d,0.034731735d,-0.014291527d,0.023099095d,0.029081594d,0.007519669d,0.010967916d,-0.008142847d,0.006190225d,-0.031075761d,0.033734649d,-0.001672192d,0.047859997d,-0.022434372d,-0.007395034d,0.01213118d,0.056169022d,0.002762751d,-0.029413955d,-0.000763392d,-0.015787151d,0.010801735d,0.008142847d,0.029912498d,-0.0018176d,0.033236109d,-0.046198189d,-0.002492708d,-0.006730312d,0.008807569d,-0.03655972d,0.009430746d,-0.053842496d,-0.060489718d,0.046862911d,0.002783524d,-0.0187784d,0.000571246d,0.00760276d,0.002482322d,0.001319058d,-0.014291527d,0.001464466d,-0.011632638d,-0.012463541d,-0.004902326d,0.000841289d,0.006688767d,0.030244859d,0.018944582d,0.000532297d,-0.015620971d,0.007104218d,0.005608593d,0.002035712d,-0.023763817d,0.003032795d,0.010594009d,-0.023597637d,-0.042376038d,-0.005255459d,0.001199616d,-0.0247609d,-0.007893575d,-0.011632638d,0.013045172d,-0.005691683d,-0.007104218d,0.027419789d,-0.004320694d,-0.005525503d,-0.026090344d,0.031408124d,-0.012795902d,-0.007062673d,0.000939959d,0.000030185d,0.004175286d,0.014291527d,0.033236109d,-0.038720068d,0.074116521d,-0.019692395d,0.001589101d,0.013792985d,-0.056169022d,-0.028749233d,-0.001599488d,0.004175286d,0.014790068d,0.00162026d,-0.007519669d,-0.041378956d,0.016534964d,-0.003572882d,-0.002575798d,-0.019526213d,-0.00922302d,-0.033900831d,-0.042043675d,-0.014208436d,0.010178559d,0.017698228d,0.032239024d,0.00913993d,0.009264565d,-0.012463541d,-0.005857864d,-0.015870241d,0.004486875d,0.018861491d,-0.000176567d,-0.029912498d,0.016784234d,0.012546631d,0.051183607d,0.023597637d,0.032903746d,0.0153717d,-0.013377533d,-0.000016634d,-0.061486799d,-0.034565553d,0.016119512d,0.00380138d,-0.003863698d,0.004362239d,-0.017532047d,-0.002762751d,0.000102565d,-0.021437289d,0.029247776d,-0.010718645d,-0.015870241d,-0.016285693d,0.010220103d,-0.000373906d,0.012962082d,0.010137013d,-0.007228854d,0.02127111d,-0.029247776d,0.018113678d,0.009181475d,0.002233051d,0.014374617d,-0.00396756d,0.010801735d,0.007644305d,0.020855658d,0.014790068d,0.032737568d,-0.037390623d,0.003032795d,0.010801735d,-0.01553788d,-0.014790068d,0.019526213d,-0.017947499d,-0.007893575d,-0.011964999d,-0.00614868d,-0.005857864d,-0.032072846d,-0.025924165d,0.001163264d,-0.013294443d,-0.01553788d,0.016701145d,-0.013460624d,-0.001111332d,0.00760276d,0.01553788d,-0.033734649d,0.048192356d,-0.003282066d,0.031906664d,0.002845842d,0.003240521d,0.017116595d,-0.01827986d,0.006896493d,-0.00760276d,-0.009680017d,-0.02459472d,-0.020689478d,-0.053510133d,0.00614868d,-0.010552464d,-0.032405205d,-0.0307434d,0.025093261d,0.003635199d,-0.008101301d,-0.00606559d,-0.007436579d,0.00606559d,-0.012962082d,0.026921248d,0.009098385d,0.046530552d,-0.011632638d,0.032571387d,-0.033900831d,0.009846197d,0.002866614d,0.032903746d,0.008973749d,0.012712811d,0.040049512d,0.013626805d,-0.026256526d,-0.031408124d,0.036227357d,0.011964999d,-0.006024044d,-0.001848759d,0.015704062d,-0.021188019d,-0.035064094d,-0.013377533d,-0.009721561d,-0.01553788d,0.008766023d,0.005400868d,0.004507647d,-0.018362951d,-0.026588887d,-0.00913993d,-0.025591804d,0.035894997d,0.021935832d,-0.031906664d,-0.000602404d,0.026422706d,-0.006397951d,0.006647222d,0.0093892d,0.020606387d,0.00913993d,0.015620971d,-0.024096178d,0.00063616d,-0.006564131d,0.01238045d,-0.013709894d,0.000563456d,-0.009887742d,0.016618054d,-0.003323611d,0.000451803d,0.001609874d,0.008682934d,0.025259443d,0.020024756d,-0.027253609d,0.010884825d,0.028250692d,-0.054839578d,0.033568468d,-0.004902326d,0.003053567d,0.020274026d,-0.015704062d,-0.00614868d,-0.063813329d,0.002482322d,0.009763107d,-0.001609874d,-0.012214269d,0.020107845d,0.001921462d,0.018695312d,-0.004923099d,0.007270399d,-0.023763817d,0.005234687d,0.003406701d,0.002565412d,0.007104218d,0.000841289d,0.016202603d,0.01827986d,-0.031075761d,-0.035562634d,-0.025259443d,-0.007021128d,0.000641353d,-0.033069927d,0.010718645d,0.005650138d,0.024927082d,-0.002658889d,0.00380138d,0.009929287d,-0.004258377d,-0.039717149d,-0.022434372d,0.025425622d,0.00198378d,0.006356406d,0.017615138d,-0.032072846d,0.046862911d,-0.026921248d,0.005940954d,0.021603471d,-0.002253824d,0.002825069d,-0.030411039d,-0.003115885d,0.023597637d,-0.004320694d,-0.007852031d,0.018030589d,-0.008724478d,-0.005733229d,0.032903746d,0.013876075d,0.015454791d,-0.023597637d,0.005151597d,-0.035396457d,0.02176965d,-0.012463541d,0.025591804d,0.014540797d,-0.027918331d,0.004154514d,0.008724478d,0.016036423d,-0.015870241d,0.005400868d,-0.017365867d,-0.044868745d,-0.000485559d,0.020357117d,-0.00760276d,-0.023265276d,-0.012048089d,0.008433662d,0.018362951d,-0.006979583d,0.0307434d,0.008392117d,0.027087428d,-0.019360034d,0.016119512d,0.02127111d,0.010801735d,0.00299125d,0.002949705d,0.012463541d,-0.000025966d,0.015953332d,0.029413955d,0.020024756d,0.003780607d,0.022102011d,-0.031740483d,0.01553788d,0.010386284d,0.028749233d,-0.010884825d,0.008682934d,-0.003531337d,-0.05517194d,-0.019360034d,-0.009347656d,-0.002025325d,0.003261293d,-0.025425622d,-0.01553788d,-0.000251867d,0.014291527d,0.012546631d,0.035728816d,-0.007062673d,-0.006605676d,0.000384293d,-0.005047734d,-0.032571387d,-0.021188019d,-0.02127111d,-0.016036423d,0.008475208d,-0.004009106d,0.014291527d,-0.008101301d,0.004424557d,-0.038221523d,-0.019360034d,0.015039339d,-0.015454791d,-0.029580137d,0.035728816d,0.004466102d,-0.000778971d,-0.005068507d,-0.017781317d,0.00477769d,0.001838372d,0.030244859d,0.01213118d,-0.022932915d,-0.005359322d,0.037390623d,0.005899409d,0.002046098d,0.037889164d,0.016701145d,0.010303194d,0.02127111d,-0.009513836d,-0.022268193d,-0.005650138d,-0.00388447d,0.016534964d,-0.023265276d,-0.00054528d,0.004819236d,0.004715373d,-0.001178843d,-0.051183607d,-0.00614868d,-0.010552464d,-0.002741979d,-0.009181475d,0.023597637d,0.019193852d,0.017199686d,-0.036393538d,-0.00243039d,-0.015870241d,-0.014706978d,-0.00145408d,0.016368784d,-0.011632638d,-0.014623888d,-0.01229736d,-0.01553788d,0.040880412d,0.023929998d,-0.014623888d,0.002648502d,0.031906664d,-0.033734649d,-0.026755067d,0.002783524d,0.005359322d,0.009970833d,0.001412535d,0.016950415d,0.016285693d,-0.006730312d,-0.02459472d,0.050851244d,-0.001827986d,-0.020855658d,0.020938748d,0.004071423d,-0.021603471d,-0.007852031d,-0.023929998d,-0.029912498d,-0.003365156d,0.017365867d,-0.010427829d,-0.011715728d,0.014956249d,0.011383367d,0.032405205d,-0.028583053d,-0.017448956d,0.018446039d,0.017615138d,0.035728816d,-0.010095468d,-0.00254464d,0.010012378d,0.028250692d,-0.020855658d,-0.002305755d,-0.001002276d,-0.014125346d,-0.007021128d,-0.028583053d,-0.045533467d,-0.02758597d,-0.020440206d,0.001350217d,0.010053922d,0.020689478d,-0.017615138d,0.026422706d,0.040880412d,0.012463541d,-0.010718645d,-0.014706978d,0.068134025d,0.038720068d,0.047859997d,-0.012546631d,0.015704062d,-0.002087643d,-0.010303194d,0.014790068d,0.018612221d,0.007395034d,-0.014790068d,-0.017864408d,-0.005068507d,-0.054507218d,0.004902326d,-0.004050651d,0.021603471d,0.019775484d,-0.024262359d,-0.012795902d,0.021935832d,-0.004009106d,-0.039717149d,0.037556801d,-0.016701145d,-0.025757983d,0.005483958d,-0.005110051d,-0.021935832d,-0.003406701d,0.010594009d,0.015787151d,-0.049854163d,0.007727395d,-0.008392117d,-0.017199686d,0.009970833d,-0.008849114d,-0.013876075d,-0.0059825d,-0.015870241d,-0.007104218d,0.028250692d,-0.029081594d,0.026921248d,0.00299125d,-0.017781317d,0.042542219d,0.018196769d,0.052845411d,-0.004819236d,-0.014125346d,0.02459472d,-0.011715728d,0.015787151d,-0.005774774d,0.004902326d,-0.004964644d,-0.02758597d,-0.013959166d,-0.033568468d,-0.027918331d,-0.017698228d,0.003489791d,-0.020024756d,-0.021603471d,0.019360034d,0.028084511d,-0.002503094d,-0.018861491d,-0.002295369d,0.050851244d,-0.020689478d,-0.000459593d,-0.026090344d,0.002783524d,-0.005899409d,-0.026921248d,-0.0093892d,-0.004112968d,0.031574301d,0.003926015d,-0.032903746d,-0.046198189d,-0.019027673d,-0.00913993d,0.030411039d,-0.019443123d,0.001963008d,-0.005193142d,0.010884825d,-0.02127111d,-0.025259443d,0.032737568d,0.00089322d,0.003282066d,0.001713737d,-0.006439496d,0.016867325d,-0.031574301d,0.031075761d,-0.009970833d,0.022600554d,-0.023597637d,-0.014956249d,0.004009106d,0.00198378d,0.026588887d,-0.023431456d,-0.023763817d,-0.013294443d,-0.029746316d,0.001381376d,-0.042874578d,-0.00913993d,0.014873158d,0.016202603d,0.012878992d,-0.006024044d,0.009638472d,0.010552464d,-0.017033506d,-0.027087428d,0.044536386d,-0.038055345d,0.001329444d,-0.019609304d,0.023597637d,-0.043206941d,0.040049512d,0.017615138d,0.046862911d,0.02127111d,0.013294443d,-0.039550968d,-0.018861491d,-0.019609304d,-0.033734649d,0.00623177d,-0.017199686d,0.041212775d,-0.017781317d,-0.024262359d,0.054507218d,-0.009721561d,0.005816319d,-0.00206687d,-0.008766023d,0.017365867d,-0.000737426d,0.018362951d,-0.023597637d,-0.019110762d,0.021935832d,0.041545134d,-0.020357117d,-0.017615138d,0.044868745d,-0.018030589d,-0.032405205d,-0.050186522d,-0.014540797d,0.005213914d,-0.006688767d,0.047527634d,0.040714234d));
      String indexName = "vector_index";
      FieldSearchPath fieldSearchPath = fieldPath("plot_embedding_voyage_3_large");
      int limit = 10;
      int numCandidates = 150;
      
      // define pipeline 
      List<Bson> pipeline = asList(
        vectorSearch(
          fieldSearchPath,
          queryVector,
          indexName,
          limit,
          approximateVectorSearchOptions(numCandidates)),
        project(
          fields(exclude("_id"), include("title"), include("plot"),
          metaVectorSearchScore("score"))));
      
      // run query and print results
      collection.aggregate(pipeline)
        .forEach(doc -> System.out.println(doc.toJson()));	
    }
  }
}
