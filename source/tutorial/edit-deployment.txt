=================================
Edit a Deployment's Configuration
=================================

.. default-domain:: mongodb

Overview
--------

You can modify a deployment's configuration and topology, including its
MongoDB versions, storage engines, and numbers of hosts or shards. You can
make modifications at all levels of a deployment's topology from the
top-level, such as a :term:`sharded cluster <sharded cluster>` or
:term:`replica set`, to lower levels, such as a replica set within a
sharded cluster or an individual process within a replica set. You can
also modify :term:`standalone <standalone>` processes.

Considerations
--------------

MongoDB Version
~~~~~~~~~~~~~~~

To choose which versions of MongoDB are available to |mms|, see
:doc:`/tutorial/configure-available-mongodb-version`.

.. include:: /includes/considerations-change-mongodb-version.rst

.. include:: /includes/compatibility-mongodb-3-0-and-monitoring-agent.rst

Storage Engine
~~~~~~~~~~~~~~

If you run or upgrade to MongoDB 3.0 or higher and modify the MongoDB
storage engine, |mms| shuts down and restarts the MongoDB process. For a
multi-member replica set, |mms| performs a rolling :term:`initial sync` of
each member.

Before you can change the storage engine for a standalone instance or
single-member replica set, you must give the Automation Agent write access
to the MongoDB data directory's *parent* directory. The agent creates a
temporary backup of the data in parent directory when updating the storage engine.

You cannot change the storage engine on a :term:`config server`. For more
information on storage engines and the available options, see
:manual:`Storage </core/storage>` in the MongoDB manual.

Fixed Properties
~~~~~~~~~~~~~~~~

Certain properties of a deployment cannot be changed, including data
paths, log paths, ports, and the server assignment for each MongoDB
process.

Deployment Topology
~~~~~~~~~~~~~~~~~~~

You can make modifications at all levels of a deployment's topology,
including child processes. If you edit a child process, any future related
edits to the parent might no longer apply to the child. For example, if
you turn off journaling for a replica set member and then later change the
journal commit interval for the replica set, the change will not apply to
the member.

You can also modify the topology itself. To do so use this tutorial or one
of the more specific tutorials available in this section of the manual,
such as :doc:`/tutorial/migrate-member-to-new-hardware`.

Group-Level Modifications
~~~~~~~~~~~~~~~~~~~~~~~~~

Some modifications that affect a deployment occur at the group level. The
following changes affect every MongoDB process in the group. For these
changes, use the specified tutorials:

- To enable SSL for the deployment, see
  :doc:`/tutorial/enable-ssl-for-a-group`.

- To enable authentication for the deployment, see
  :doc:`/tutorial/nav/security-enable-authentication`.

- To add or modify MongoDB users and roles for the deployment, see
  :doc:`/tutorial/manage-mongodb-users`.

Multiple Modifications
~~~~~~~~~~~~~~~~~~~~~~

You can combine multiple modifications into one deployment. For example,
you could make all the following modifications before clicking the
:guilabel:`Review & Deploy` button:

- Add the latest stable version of MongoDB to the :ref:`version-manager`.

- Enable SSL for the deployment's MongoDB processes.

- Add a new sharded cluster running the latest stable version of MongoDB
  from above.

When you click :guilabel:`Review & Deploy`, the review displays all the
changes on one screen for you to confirm before deploying.

Procedure
---------

To edit the deployment's configuration:

.. include:: /includes/steps/edit-deployment.rst
