=================
Back Up a Cluster
=================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Backup Data
-----------

Backup takes and stores snapshots based on a snapshot :ref:`retention
policy <retention-policy>`. 

Sharded clusters snapshots temporarily stop the balancer via the
:program:`mongos` so that they can insert a marker token into all
shards and config servers in the cluster. |service| takes a snapshot
when the marker tokens appear in the backup data.

Compression and block-level de-duplication technology reduce snapshot
data size. The snapshot only stores the differences between successive
snapshots. Snapshots use only a fraction of the disk space required for
full snapshots.

Enable Backup
-------------

You can enable backup during the :doc:`cluster creation
</create-new-cluster>` or during the :doc:`modification of an existing
cluster <scale-cluster>`. 

To backup a cluster, in the cluster configuration, set ``Do you want to
enable backup?`` to ``Yes``.

Modify Backup Schedule
----------------------

If you enable backup for a cluster, |service| takes a base snapshot of
your data every 6 hours.

To change a deployment's backup schedule, go to :guilabel:`Backup`. For
the cluster whose backup schedule you wish to modify, click the
ellipsis and select :guilabel:`Edit Snapshot Schedule` menu option.

.. _retention-policy:

Retention Policy
----------------

|service| retains snapshots for the time periods listed in the following
table. If you terminate a backup, |service| immediately deletes the backup's
snapshots.

.. list-table::
   :widths: 30 30 40
   :header-rows: 1

   * - Snapshot
     - Default Retention Policy
     - Maximum Retention Setting
   * - Base snapshot.
     - 2 days
     - 5 days.
   * - Daily snapshot
     - 7 days
     - 360 days
   * - Weekly snapshot
     - 4 weeks
     - 52 weeks
   * - Monthly snapshot
     - 13 months
     - 36 months
