.. _tutorial-enable-backup-for-replica-set:

.. _tutorial-install-backup-agent:

.. _tutorial-register-backup-service:

==================================
Install and Start the Backup Agent
==================================

Overview
--------

The |backup| agent polls the primary MongoDB instance of
every backup-enabled replica set and transmits the operations to MMS.

The Backup agent relies on the MMS Monitoring Agent to populate the
list of sharded clusters and replica sets eligible for backup. If
the appropriate hosts are not added, or the Monitoring Agent is not
being correctly run, the lists may be incomplete or out-of-date.
If you have not already installed and configured |monitoring|,
please refer to the :doc:`/tutorial/install-monitoring-agent`
documentation.

Considerations
--------------

The replica set must be MongoDB version 2.0 or later. To avoid resource
contention, run the agent on a host other than the hosts where the
MongoDB instances are running. Be sure the agent can access the MongoDB
hosts.

If you run the Backup agent on Amazon EC2, do not use the ``t1.micro``
instance type, which has a CPU scheduling policy that does not
typically provide sufficient capacity to support a Backup agent for a
production deployment. Use a larger instance type instead.

Prerequisites
-------------

Install and configure the |monitoring|, as described in the
:doc:`/tutorial/install-monitoring-agent` documentation.

If your MongoDB instances operate within a firewall, configure your
network infrastructure to allow outbound connections on port ``443``
(SSL) to ``api-backup.mongodb.com``.

If you use |backup| with a MongoDB deployment that uses
authentication, see the following before installing
the |backup| Agent:

- :doc:`/tutorial/backup-deployments-with-auth`

- :doc:`/reference/authentication`

Procedure
---------

.. include:: /includes/steps/backup-install-saas.rst

Additional Information
----------------------

If you installed the Backup agent from the ``tar.gz``
archives, see :doc:`/tutorial/rotate-agent-log-files` to configure log
rotation.

The :file:`README` included with the downloaded package also provides
information about the Backup agent.

For details about backup operations, see the :doc:`/faq/backup` page.
