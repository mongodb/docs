.. _restore-http-snapshot:

===========================================
Restore a Completed Snapshot using ``HTTP``
===========================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

To restore a snapshot using ``HTTP``, the :term:`Backup Daemon` creates
and displays a download link in |mms| to the appropriate snapshot in
snapshot storage.

After clicking the download link, |mms| streams the snapshot archive to
the target snapshot host.

.. include:: /images/restore-regular-http.rst

1. The user selects a snapshot:

   - Through the |mms| application:

     1. Click on a snapshot.
     #. Submit their request.

   - Through the :doc:`API </reference/api/restorejobs/get-one-single-restore-job-for-one-cluster>`:

     1. Find the cluster to restore.
     #. :doc:`Create new Restore Job </reference/api/restorejobs/create-one-restore-job-for-one-cluster>`
        for that cluster.

#. |mms| creates a RestoreJob document.

#. The :term:`Backup Daemon` service picks up the RestoreJob document
   and adds certain fields to that job document including a pull
   verification key.

#. The :term:`Backup Daemon` service sets the status of this Restore
   Job to :guilabel:`Waiting for Customer...`.

#. With this key in place and the status set to
   :guilabel:`Waiting for Customer...`, |mms| creates a URL.

#. The user clicks the :guilabel:`get link` link, then
   :guilabel:`Download` in the |mms| application to
   download the :term:`snapshot`.

#. |mms| sets the RestoreJob status to :guilabel:`Transferring...` and
   starts streaming the :term:`snapshot` in the requested format from
   the Snapshot Store to the target snapshot host.

   a. The :term:`Blockstore <Backup Blockstore Database>` streams the
      Blocks that comprise the snapshot through |mms|.
   #. The :term:`S3 Snapshot Store` streams the Blocks that comprise the
      snapshot through |mms|.
   #. The :term:`File System Store` streams the Files that comprise the
      snapshot through |mms|.


