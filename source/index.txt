.. _atlas-data-lake:

=====================
|service| |data-lake|
=====================

.. default-domain:: mongodb

.. meta::
   :keywords: |data-lake|

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. _atlas-data-lake-about:

About |service| |data-lake|
---------------------------

MongoDB |service| |data-lake| allows you to natively query, transform, 
and move data across |aws| |s3| and MongoDB |service| clusters. You can 
query your richly structured data stored in |json|, |bson|, CSV, TSV, 
Avro, ORC, and Parquet formats using the |mongo| shell, :dl:`MongoDB 
Compass <compass>`, or any :driver:`MongoDB driver </>`.

Sample Uses 
-----------

You can use {+adl+} to: 

- Convert richly structured MongoDB data into columnar Parquet or CSV 
  files.
- `Query across multiple Atlas clusters <https://developer.mongodb.com/how-to/query-multiple-databases-with-atlas-data-lake/?tck=featlearn>`__ 
  to get a holistic view of your data.
- Materialize aggregations from MongoDB or |s3| data.
- Automatically import data from your |s3| bucket into an |service| 
  cluster.

|data-lake| Access 
------------------

When you create a |data-lake|, you grant |service| either read only or 
read and write access to |s3| buckets in your |aws| account. To access 
your |service| clusters, |service| uses your existing :manual:`Role 
Based Access Controls</core/authorization>`. You can view and edit the 
generated data storage :ref:`configuration 
<datalake-configuration-file>` that maps data from your |s3| buckets 
and |service| clusters to virtual databases and collections.

A database user must have one of the following roles to query an 
|service| |data-lake|:

- :atlas:`readWriteAnyDatabase </security-add-mongodb-users/#readWriteAnyDatabase>`

- :atlas:`readAnyDatabase </security-add-mongodb-users/#readAnyDatabase>`

- A :atlas:`custom role </security-add-mongodb-roles/>` with the  
  :manual:`find </reference/privilege-actions/>` privilege

.. _atlas-data-lake-prereqs:

Prerequisites
-------------

Verify that you meet the following prerequisites before you create a 
|data-lake|:

* One or more |aws| |s3| buckets in the same |aws| account.

* An |aws| CLI configured to access your |aws| account. Alternatively, 
  you must have access to the |aws| Management Console with permission 
  to create `IAM roles <https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user.html>`__.

  .. note:

   To prevent excessive charges on your bill, create your |service|
   |data-lake| in the same |aws| region as your |s3| data source.

.. _atlas-data-lake-regions:

{+adl+} Regions 
-----------------------

{+adl+} routes your {+dl+} requests through one of the following 
regions:

.. include:: /includes/list-table-supported-aws-regions.rst

.. note::

   You will incur charges when running {+data-lake+} queries. For more
   information, see :ref:`atlas-data-lake-billing` below.

.. _atlas-data-lake-billing:

Billing
-------

|service| |data-lake| incurs costs for the amount of data processed and
returned by the service.

Total Data Processed
~~~~~~~~~~~~~~~~~~~~

|service| charges for the total number of bytes that |data-lake| 
processes from your |aws| S3 buckets, rounded up to the nearest 
megabyte. |service| charges **$5.00 per TB** of processed data, with a 
minimum of **10 MB** or **$0.00005 per query**.

You can use partitioning strategies and compression in |aws| |s3| to
reduce the amount of data processed.

Total Data Returned
~~~~~~~~~~~~~~~~~~~

|service| charges for the total number of bytes returned by
|data-lake|. This total is the sum of the following data transfers:

- The number of bytes transferred between |data-lake| service nodes
- The number of bytes transferred from |data-lake| to the client

Returned data is billed as outlined in the :guilabel:`Data Transfer
Fees` section of the `Atlas pricing page 
<https://www.mongodb.com/cloud/atlas/pricing?tck=docs_atlas>`_. The 
cost of data transfer depends on the Cloud Service Provider charges 
for same-region, region-to-region, or region-to-internet data transfer.

.. toctree::
   :titlesonly:
   :hidden:

   /tutorial/getting-started
   /deployment/deploy-adl
   /config/config-data-lake
   /administration
   /query/query-data-lake
   /admin/query-with-sql
   /reference
   /supported-unsupported
   /supported-unsupported/limitations
   /release-notes/data-lake
