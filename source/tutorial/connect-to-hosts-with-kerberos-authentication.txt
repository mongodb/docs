=============================================
Connect to Hosts with Kerberos Authentication
=============================================

.. admonition:: Enterprise Feature

   Only MongoDB Enterprise provides support for Kerberos.

Kerberos is a generic authentication protocol available in MongoDB
Enterprise after version 2.4. The Monitoring and Backup Agents can
authenticate to hosts using Kerberos in addition to the default MongoDB
authentication protocol.

Considerations
--------------

Agent Directory
~~~~~~~~~~~~~~~

.. include:: /includes/fact-backup-agent-install-directory.rst

Kerberos
~~~~~~~~

Install the :doc:`Monitoring Agent </tutorial/nav/monitoring-getting-started>`
and/or :doc:`Backup Agent </tutorial/nav/backup-getting-started>`
and all requirements before beginning to configure Kerberos.

You must configure the Kerberos Key Distribution Center (KDC) to grant
tickets that are valid for at least four hours. The Monitoring Agent takes
care of periodically renewing the ticket. The KDC service provides session
tickets and temporary session keys to users and computers.

Install Required Operating System Packages
------------------------------------------

Debian and Ubuntu Linux
~~~~~~~~~~~~~~~~~~~~~~~

Install the following required packages:

.. code-block:: sh

   sudo apt-get install krb5-user libsasl2-modules-gssapi-mit

Red Hat Enterprise, CentOS and Fedora Linux
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Install the following required packages:

.. code-block:: sh

   sudo yum install krb5-workstation.x86_64 cyrus-sasl-gssapi.x86_64

Configure Kerberos Environment
------------------------------

.. include:: /includes/steps/kerberos-configure-environment.rst

Create Kerberos Principal and MongoDB User
------------------------------------------

.. tip::

   If you are running both the Monitoring Agent and the Backup Agent on the
   same server, then both agents must connect as the same Kerberos Principal.

.. include:: /includes/steps/kerberos-create-users.rst

Specify Kerberos for Hosts
--------------------------

For each host that connects with Kerberos, go to the :guilabel:`Hosts`
page, and the :guilabel:`Hosts`, :guilabel:`Mongos`, or
:guilabel:`Configs` tab to display the lists of available hosts. Click the
:guilabel:`gear icon` on the right of any host and select
:guilabel:`Kerberos (GSSAPI)` as the Auth Mechanism on the
:guilabel:`Credentials` tab of the Edit Host interface.
