=====================================
Manage S3 Blockstore Snapshot Storage
=====================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. include:: /includes/fact-backup-snapshot-store-options.rst

This tutorial covers backing up your MongoDB databases as snapshots stored in
S3 buckets. The metadata for S3 blockstores is stored in a MongoDB database.

.. include:: /includes/note-add-capacity-using-multiple-stores.rst

Prerequisites
-------------

Before creating any S3 blockstores:

- Ensure a storage volume with sufficient capacity to store the S3 blockstore
  metadata database and the oplog MongoDB database is attached to the |onprem|
  application server, the backing MongoDB servers, or the backup MongoDB
  servers.

- :doc:`Deploy the dedicated MongoDB instance(s) </tutorial/prepare-backing-mongodb-instances>` 
  to host the S3 blockstore metadata database and oplog
  stores for the S3 blockstore.

- Ensure the server running the |onprem| Backup Daemon has enough disk
  capacity to store the :term:`head` database.

- If you plan on requiring authentication for the S3 blockstore metadata
  database,
  :manual:`configure your database for SCRAM-SHA-1 authentication </core/security-scram-sha-1>`. 
  S3 blockstore metadata databases only support SCRAM-SHA-1 authentication.

- Create your own `AWS access keys <https://aws.amazon.com/developers/access-keys/>`_ 
  so you can create S3 buckets and store snapshot files in them. MongoDB does not
  create or issue AWS access keys.

- Create your own `S3 bucket <http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html#create-bucket-intro>`_ 
  to store your S3 blockstore snapshots. 

.. _add-s3-blockstore:

Add an S3 Blockstore
--------------------

.. include:: /includes/steps/admin-add-s3-blockstore.rst

.. _edit-s3-blockstore:

Edit an Existing S3 Blockstore
------------------------------

Once created, S3 blockstores are listed directly on the :guilabel:`Snapshot
Storage` page in a table. Each row contains the settings for each S3
blockstore.

.. include:: /includes/steps/admin-edit-s3-blockstore.rst

.. _delete-s3-blockstore:

Delete an S3 Blockstore
-----------------------

.. include:: /includes/steps/admin-delete-s3-blockstore.rst
