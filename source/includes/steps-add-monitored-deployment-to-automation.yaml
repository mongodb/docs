stepnum: 1
level: 4
source:
  file: steps-source-deployment-page.yaml
  ref: select-the-deployment-page
---
title: "Click the :guilabel:`Processes` tab, then the :guilabel:`Topology` view."
stepnum: 2
level: 4
ref: select-first-processes-icon
---
title: "Click the :guilabel:`Add` button for the replica set, sharded cluster, or standalone."
stepnum: 3
level: 4
ref: wrench-icon
---
title: "Follow the prompts to add the replica set, cluster, or standalone to Automation."
stepnum: 4
level: 4
ref: add-automation
content: |

  In the course of adding a MongoDB deployment to an existing automated
  deployment, you are given the option of importing the added
  deployment's users and roles. 

  How the imported users and roles are handled depends upon if you:

  - Set :guilabel:`Ensure Consistent Set` to ``YES`` or ``NO``

    .. note::

      - :guilabel:`Enforce Consistent Set` set to ``NO`` allows
        separate set of users and roles across the deployments in an
        Ops Manager group. Ops Manager can be made aware of these users
        and groups but does not manage them. Users and roles can be
        created and/or updated through a direct connection to the
        MongoDB database.

      - :guilabel:`Enforce Consistent Set` set to ``YES`` enforces a
        consistent set of users and roles across all deployments in an
        Ops Manager group. Ops Manager manages all MongoDB users and
        roles.

    .. warning::

       When :guilabel:`Enforce Consistent Set` is set to ``YES`` that
       means that if you manually add a user or role, or import a
       cluster with users or roles different from the managed list,
       then Automation removes them immediately.

  - Check :guilabel:`Yes, import additional users and roles` when the
    importing users to merge them with the users |mms| manages

  - Set |mms| to :guilabel:`Sync` these new users with the existing users.

    .. note::
       If a user is set to :guilabel:`Sync`, automation ensures that
       that user exists on all deployment items.

  To import these users and roles:

  a. Check :guilabel:`Yes, merge in additional users and roles` if you
     want to try to merge the imported users with the |mms|-managed
     users.

     .. note::

        Merging is not required, but is recommended to if you want to
        carry over users and roles from the imported deployment.

     .. important::

        If there are users with the same name but different roles in
        both the imported and managed MongoDB deployments, you are asked
        to resolve these conflicts before completing the import.

  b. Click :guilabel:`Continue`. 

---
title: "Resolve conflicts for merged users and roles. (Optional)"
stepnum: 5
level: 4
ref: resolve-conflicts
content: |

  If you chose to merge the imported users and roles and one or more
  conflict with those already in the automated deployment, you are
  prompted to select which versions of the users and roles should be
  used:

  a. Select the correct user or role.

  b. Click :guilabel:`Review & Deploy`. 

  .. warning::

     If you choose not to resolve conflicts, the conflicting
     records are overridden by the current configuration. Any
     non-conflicting users can be imported later. You can create
     new, or modify existing, users and roles for the added deployment
     once it is under automation.

     See :doc:`/tutorial/manage-users` for how to create or modify
     users and :doc:`/reference/user-roles` for the list and
     definitions of roles in |mms|.
...
