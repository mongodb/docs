title: Download and run the latest version of the Monitoring Agent installation binary.
stepnum: 1
edition:
  - cloud
ref: download-saas
action:
  pre: |
      To download the installation binary, use the following URL:
  language: sh
  code: |
    https://cloud.mongodb.com/download/agent/monitoring/mongodb-mms-monitoring-agent-latest.windows_x86_64.msi
post: |
  During installation, the installer prompts you to specify the folder
  for storing configuration and log files. It is strongly advised that
  you encrypt or restrict access to this folder.

---
title: "Download and run the latest version of the Monitoring Agent installation binary."
stepnum: 1
edition:
  - onprem
ref: download-hosted
action:
  pre: |
    To download the installation binary, use the following URL: 
  language: sh
  code: |
    //<OpsManagerHost:Port>/download/agent/monitoring/mongodb-mms-monitoring-agent-latest.windows_x86_64.msi
  post: |
    .. note::
       Replace ``<OpsManagerHost:Port>`` with the hostname and port
       of your |onprem| installation.
post: |  
  During installation, the installer prompts you to specify the folder
  for storing configuration and log files. It is strongly advised that
  you encrypt or restrict access to this folder.
  
---
title: "Generate an agent API key or retrieve an existing agent API key for your |mms| project." 
stepnum: 2
ref: retrieve-monitoring-mms-api-key
pre: |
      a. Click :guilabel:`+ Generate Key`.

      .. include:: /includes/extracts/agent-api-key-generate-note.rst

      b. Enter your password and click :guilabel:`Verify`.
  
      c. Click :guilabel:`+ Generate Key` again.

      .. include:: /includes/extracts/agent-api-key-admonition.rst
post: |
  To monitor MongoDB deployments that use Kerberos authentication,
  do the following when pasting the Agent API key:

  a. Click :guilabel:`Advanced Settings...`. 
  b. Type the Active Directory username.
  c. Type the corresponding password.
  d. Type the NetBIOS name of the corresponding :abbr:`AD (Active Directory)`
     domain.

---
title: "Edit the ``monitoring-agent.config`` file to include your agent API key, the hostname of the Monitoring server and, optionally, the URL for a proxy server."
stepnum: 3
ref: configure-monitoring-mms-api-key
content: |
  In the ``C:\MMSData\Monitoring\monitoring-agent.config`` file, set these properties:

  .. list-table::
     :widths: 35 65
     :header-rows: 1

     * - Property

       - Value

     * - :msetting:`mmsApiKey`

       - Agent API key

     * - :msetting:`mmsGroupId`

       - Project ID

     * - :msetting:`mmsBaseUrl`

       - Hostname of the Monitoring server

     * - :msetting:`httpProxy` (optional)

       - The URL of to your proxy server
---
stepnum: 4
edition: onprem
source:
  file: steps-source-install-agent.yaml
  ref: start-monitoring
content: |
  In Windows ``Control Panel``, open ``Administrative Tools``, and then
  open ``Services``.

  In the list of services, select the |mms| Monitoring Agent service.
  Select the ``Action`` menu and select ``Start``.
---
stepnum: 4
edition: cloud
source:
  file: steps-source-install-agent.yaml
  ref: start-monitoring
content: |
  In Windows ``Control Panel``, open ``Administrative Tools``, and then
  open ``Services``.

  In the list of services, select the |mms| Monitoring Agent service.
  Select the ``Action`` menu and select ``Start``.
...
