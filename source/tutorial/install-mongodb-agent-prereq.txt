===========================
{+mdbagent+} Prerequisites
===========================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. include:: /includes/styles/corrections.rst

.. tabs-pillstrip:: platforms

Use 64-bit Chip Architectures
-----------------------------

The {+mdbagent+} must run on 64-bit architectures.

Set Host Network Access
-----------------------

The hosts that serve the MongoDB deployments must:

- Have full networking access to each other through their fully
  qualified domain names (FQDNs). Each host must be able to reach every
  other host through the |fqdn|.

.. tabs-platforms::

   .. tab::
      :tabid: windows

      - Find the |fqdn| for each host. Run the following command in
        Powershell:

        .. code-block:: powershell

           net config workstation | findstr /C:"Full Computer name"

      - Download and install the
        `Windows BIND <http://www.isc.org/downloads/>`__ tools.

   .. tab::
      :tabid: debian

      - Find the |fqdn| for each host. Run the following command in
        the shell:

        .. code-block:: sh

           hostname -f

   .. tab::
      :tabid: rhel

      - Find the |fqdn| for each host. Run the following command in
        the shell:

        .. code-block:: sh

           hostname -f

   .. tab::
      :tabid: linux

      - Find the |fqdn| for each host. Run the following command in
        the shell:

        .. code-block:: sh

           hostname -f

- Resolve each |fqdn| to a unique IP address. Run the following
  command in the shell to resolve the |fqdn|:

  .. code-block:: shell

     dig +short myip.opendns.com @resolver1.opendns.com

- Set the Common Name or :rfc:`Subject Alternative Name <3280>` value
  of any |ssl| certificates to the MongoDB hostâ€™s |fqdn|.

The network configuration must allow each {+mdbagent+} to
make a direct connection to every MongoDB deployment listed on the
:guilabel:`Deployment` page. |mms| does not support port forwarding.

.. tabs-platforms::

   .. tab::
      :tabid: windows

      Disable Windows Firewall Stealth Mode
      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      For best performance,
      `Disable Windows Firewall stealth mode <https://support.microsoft.com/en-us/help/2586744/disable-stealth-mode>`__
      on the MongoDB hosts on which you installed the {+mdbagent+}.

Set Host Permissions
--------------------

On a Host that Already Runs MongoDB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If you install the {+mdbagent+} to a host that is running a MongoDB
process, the agent must have:

- Permission to stop any MongoDB processes. The {+mdbagent+}
  restarts the process using the Agent's own set of MongoDB binaries.
  If you had installed MongoDB with a package manager, use the same
  package manager to install the {+mdbagent+}. This gives the agent
  the same owner as MongoDB.

- ``Read`` and ``Write`` permissions on the MongoDB data directory and
  log directory.

On a Host Before Installing MongoDB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If you deploy the {+mdbagent+} to a host that doesn't have MongoDB
installed, ensure the user that owns the {+mdbagent+} has ``Read`` and
``Write`` permissions on the MongoDB data and log directories you plan
to use.

.. tabs-platforms::

   .. tab::
      :tabid: debian

      Root Access
      ~~~~~~~~~~~

      To install the {+mdbagent+} using a ``deb`` package, you need to
      be logged in as ``root`` or a user with ``sudo`` privileges to
      install packages.

   .. tab::
      :tabid: rhel

      To install the {+mdbagent+} using a ``.rpm`` package, you
      need to be logged in as ``root`` or a user with ``sudo``
      privileges to install packages.

   .. tab::
      :tabid: linux

      To install the {+mdbagent+} using a ``.tar`` package, you need
      to be logged in as ``root`` or a user with ``sudo`` privileges to
      install packages.

.. _generate-agent-api-key:

.. include:: /includes/prerequisites-agent-api-key.rst




