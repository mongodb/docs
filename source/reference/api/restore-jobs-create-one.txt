======================
Create One Restore Job
======================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Creates one restore job for the specified cluster.

This endpoint does not support the following:

- Delivering restored snapshots by SCP

- Creating point-in-time restore jobs

- Creating checkpoint restore jobs for sharded clusters with the HTTP
  delivery method

- Creating restore jobs for queryable backup snapshots

.. include:: /includes/fact-groups-projects-synonyms.rst

.. include:: /includes/api-requirements.rst

.. include:: /includes/api-base-url.rst

Resource
--------

.. code-block:: none

   POST /groups/{GROUP-ID}/clusters/{CLUSTER-NAME}/restoreJobs

Request Parameters
------------------

Request Path Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :header-rows: 1
   :widths: 15 10 75

   * - Path Element
     - Required/Optional
     - Description

   * - ``GROUP-ID``

     - Required.

     - The unique identifier of the :ref:`group <group-id>` that owns
       the snapshots.

   * - ``CLUSTER-NAME``

     - Required

     - The name of the cluster that contains the snapshots that you want
       to retrieve.

Request Query Parameters
~~~~~~~~~~~~~~~~~~~~~~~~

This endpoint may use any of the HTTP request query parameters available
to all |service| API resources. These are all optional.

.. include:: /includes/base-query-parameters.rst

Request Body Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/restore-job-request-documents.rst

Response
--------

.. include:: /includes/list-table-restore-jobs-http-response.rst

Example Request
---------------

Create a restore job that transfers a compressed snapshot using HTTP.

.. cssclass:: copyable-code
.. code-block:: sh

   curl --user "{USERNAME}:{APIKEY}" --digest \
      --header "Accept: application/json" \
      --header "Content-Type: application/json" \
      --include \
      --request POST "https://cloud.mongodb.com/api/atlas/v1.0/groups/6b99999887d9d61443b41657/clusters/Cluster0/restoreJobs?pretty=true" \
      --data '
       {
         "delivery" : {
           "methodName" : "HTTP"
         },
         "snapshotId" : "5a681ff180eef54e09de20d1"
       }'

Example Response
----------------

.. cssclass:: copyable-code
.. code-block:: sh

   {
	"links": [{
		"href": "https://cloud.mongodb.com/api/atlas/v1.0/groups/6b99999887d9d61443b41657/clusters/Cluster0/restoreJobs?batchId=5a69049d87d9d62a94d01adc",
		"rel": "self"
	}],
	"results": [{
		"batchId": "5a69049d87d9d62a94d01adc",
		"clusterId": "6c66689487d9d61443b46150",
		"clusterName": "Cluster0",
		"created": "2018-01-24T22:11:41Z",
		"delivery": {
			"expirationHours": 1,
			"maxDownloads": 1,
			"methodName": "HTTP",
			"statusName": "NOT_STARTED"
		},
		"encryptionEnabled": false,
		"groupId": "6b99999887d9d61443b41657",
		"id": "5a69049d87d9d62a94d01add",
		"links": [{
			"href": "https://cloud.mongodb.com/api/atlas/v1.0/groups/6b99999887d9d61443b41657/clusters/Cluster0/restoreJobs/5a69049d87d9d62a94d01add",
			"rel": "self"
		}],
		"pointInTime": false,
		"snapshotId": "5a682026e2bfb30d6616ae54",
		"statusName": "IN_PROGRESS",
		"timestamp": {
			"date": "2018-01-24T05:55:03Z",
			"increment": 1
		}
	}, {
		"batchId": "5a69049d87d9d62a94d01adc",
		"clusterId": "6c66689487d9d61443b46150",
		"clusterName": "Cluster0",
		"created": "2018-01-24T22:11:41Z",
		"delivery": {
			"expirationHours": 1,
			"maxDownloads": 1,
			"methodName": "HTTP",
			"statusName": "NOT_STARTED"
		},
		"encryptionEnabled": false,
		"groupId": "6b99999887d9d61443b41657",
		"id": "5a69049d87d9d62a94d01ade",
		"links": [{
			"href": "https://cloud.mongodb.com/api/atlas/v1.0/groups/6b99999887d9d61443b41657/clusters/Cluster0/restoreJobs/5a69049d87d9d62a94d01ade",
			"rel": "self"
		}],
		"pointInTime": false,
		"snapshotId": "5a682028fcc17841e4d5851g",
		"statusName": "IN_PROGRESS",
		"timestamp": {
			"date": "2018-01-24T05:55:03Z",
			"increment": 1
		}
	}, {
		"batchId": "5a69049d87d9d62a94d01adc",
		"clusterId": "5a66689487d9d61443b46149",
		"clusterName": "Cluster0",
		"created": "2018-01-24T22:11:41Z",
		"delivery": {
			"expirationHours": 1,
			"maxDownloads": 1,
			"methodName": "HTTP",
			"statusName": "NOT_STARTED"
		},
		"encryptionEnabled": false,
		"groupId": "6b99999887d9d61443b41657",
		"id": "5a69049d87d9d62a94d01adf",
		"links": [{
			"href": "https://.mongodb.com/api/atlas/v1.0/groups/6b99999887d9d61443b41657/clusters/Cluster0/restoreJobs/5a69049d87d9d62a94d01adf",
			"rel": "self"
		}],
		"pointInTime": false,
		"snapshotId": "5a682026e2bfb30d161c3859",
		"statusName": "IN_PROGRESS",
		"timestamp": {
			"date": "2018-01-24T05:55:03Z",
			"increment": 1
		}
	}],
	"totalCount": 3
   }

