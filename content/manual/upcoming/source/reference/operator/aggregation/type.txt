===================
$type (aggregation)
===================

.. meta::
   :description: Use the `$type` aggregation operator to return the BSON type of an argument, such as string"

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Definition
----------

.. expression:: $type

   Returns a string that specifies the :ref:`BSON type
   <bson-types>` of the argument.

   :expression:`$type` has the following :ref:`operator expression
   syntax <agg-quick-ref-operator-expressions>`:

   .. code-block:: javascript

      { $type: <expression> }

   The argument can be any valid :ref:`expression
   <aggregation-expressions>`.

.. seealso::

   - :expression:`$isNumber` - checks if the argument is a number.
   - :query:`$type (Query) <$type>` - filters fields based on BSON type.

Behavior
--------

``$type``
~~~~~~~~~

Unlike the :query:`$type` query operator, which matches array
elements based on their BSON type, the :expression:`$type`
aggregation operator does not examine array elements. Instead,
when passed an array as its argument, the ``$type`` aggregation
operator returns the type of the argument, i.e. ``"array"``.

If the argument is a field that is missing in the input document,
:expression:`$type` returns the string ``"missing"``.

The following table shows the :expression:`$type` output for several
common types of expressions:

.. list-table::
   :header-rows: 1
   :widths: 80 20

   * - Example
     - Results

   * - ``{ $type: "a" }``
     - ``"string"``

   * - ``{ $type: /a/ }``
     - ``"regex"``

   * - ``{ $type: 1 }``
     - ``"double"``

   * - ``{ $type: Long(627) }``
     - ``"long"``

   * - ``{ $type: { x: 1 } }``
     - ``"object"``

   * - ``{ $type: [ [ 1, 2, 3 ] ] }``
     - ``"array"``

.. note::

   In the case of a literal array such as ``[ 1, 2, 3 ]``,
   enclose the expression in an outer set
   of array brackets to prevent MongoDB from parsing
   ``[ 1, 2, 3 ]`` as an
   :ref:`argument list <agg-quick-ref-operator-expressions>`
   with three arguments (``1, 2, 3``). Wrapping the array
   ``[ 1, 2, 3 ]`` in a :expression:`$literal` expression
   achieves the same result.

   See :ref:`operator expression syntax forms
   <agg-quick-ref-operator-expressions>` for more information.

Available Types
~~~~~~~~~~~~~~~

.. include:: /includes/fact-bson-types.rst

If the argument is a field that is missing in the input document,
:expression:`$type` returns the string ``"missing"``.

Example
-------

This example uses a :term:`collection <collection>` named ``coll`` with
the following :term:`documents <document>`:

.. literalinclude:: /code-examples/tested/command-line/mongosh/aggregation/expressions/type/load-data.js
   :language: shell
   :copyable: true
   :category: syntax example

The following aggregation operation uses the ``$type``
operator to display the type of field ``a`` for all documents
as part of the :pipeline:`$project` stage.

.. io-code-block::
   :copyable: true

   .. input:: /code-examples/tested/command-line/mongosh/aggregation/expressions/type/projection.js
      :language: shell
      :category: syntax example

   .. output:: /code-examples/tested/command-line/mongosh/aggregation/expressions/type/projection-output.sh
      :visible: false
      :language: shell

.. _missing-type-existence-check:

Existence Check 
~~~~~~~~~~~~~~~

:ref:`Expressions <aggregation-expressions>` do not support the :query:`$exists`
operator. To evaluate whether or not a field exists in an expression, you can
use the ``missing`` type.

The following aggregation operation uses the ``missing`` type to add an ``a``
field to documents from the ``coll`` collection above that are missing the
``a`` field. Notice that a document where ``a: null`` is not the same as a
document where the ``a`` field is missing.

.. io-code-block::
   :copyable: true

   .. input:: /code-examples/tested/command-line/mongosh/aggregation/expressions/type/missing-field.js
      :language: shell
      :category: syntax example

   .. output:: /code-examples/tested/command-line/mongosh/aggregation/expressions/type/missing-output.sh
      :visible: false
      :language: shell
      :emphasize-lines: 7-8 
