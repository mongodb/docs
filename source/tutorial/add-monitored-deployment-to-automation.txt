=====================================
Add Monitored Processes to Automation
=====================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Overview
--------

|mms| Automation lets you deploy, reconfigure, and upgrade your MongoDB
databases directly from the |mms| console.

If |mms| is already monitoring your MongoDB processes, you can add them to
Automation using this procedure.
If |mms| is not monitoring your MongoDB processes, see instead
:doc:`/tutorial/add-existing-mongodb-processes`, which adds the processes
to both Automation and Monitoring.

Automation relies on the Automation Agent, which you install on each
server that hosts a process to be added to automated management. The
Automation Agents regularly poll |mms| to determine goal configuration and
deploy changes as needed. An Automation Agent must run as the same user and
in the same group as the MongoDB process it will manage.

Considerations
--------------

Automation Agents can run only on 64-bit architectures.

Automation supports most but not all available MongoDB options. Automation
supports the options described in
:doc:`/reference/cluster-configuration-process-options`.

If the MongoDB process or the |mms| group requires authentication, the
addition of the MongoDB process to automation can update the security
settings.  See :ref:`automation-updated-security-settings`.

Prerequisites
-------------

|mms| is Monitoring the Processes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|mms| must be currently monitoring the MongoDB processes, and the
Monitoring Agent must be running. The processes must appear in the |mms|
:guilabel:`Deployment` tab.

The Automation Agent must have:

- Permission to stop the MongoDB processes. The Automation Agent will
  restart the processes using the agent's own set of MongoDB binaries. If
  you had installed MongoDB with a package manager, use the same package
  manager to install the Automation Agent. This gives the agent the same
  owner as MongoDB.

- ``Read`` and ``Write`` permissions on the MongoDB data directories and
  log directories.

The Process UID and GID must Match the Automation Agent
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The user (UID) and group (GID) of the MongoDB process must match that of the
Automation Agent. For example, if your Automation Agent runs as the "mongod"
user in the "mongod" group, the MongoDB process must also run as the "mongod"
user in the "mongod" group.

.. include:: /includes/prerequisites-automation-agent-servers.rst

Procedure
---------

Add Monitored Processes to Automation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/steps/add-monitored-deployment-to-automation.rst
