=========================================
Start MongoDB Processes with Init Scripts
=========================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Overview
--------

|mms| provides a tool to create init scripts that will run your MongoDB
processes if you should decide to stop managing them through Automation.
The tool creates scripts that can start your processes automatically upon
boot up or that you can use to start the processes manually.

The tool is available when you install the {+aagent+} using an
``rpm`` or ``deb`` package.

The "Make Init Scripts" Tool
----------------------------

When you install the {+aagent+} using an ``rpm`` or ``deb`` package,
the agent includes the following "Make Init Scripts" tool:

.. code-block:: sh

   /opt/mongodb-mms-automation/bin/mongodb-mms-automation-make-init-scripts

The tool creates an init script for each :program:`mongod` or
:program:`mongos` process on the server and has the following options:

.. list-table::
   :header-rows: 1

   * - Option

     - Description

   * - ``-boot``

     - Configures the init scripts to start the MongoDB processes on
       system boot. By default, the tool creates the scripts with this
       option disabled.

   * - ``-cluster <string>``

     - Specify the absolute path and filename of the local copy of the
       :doc:`automation configuration </reference/cluster-configuration>`
       **only if** the local copy does not use the default path and name,
       which are:

       ``/var/lib/mongodb-mms-automation/mms-cluster-config-backup.json``

       The tool references the local copy of the configuration file to
       determine the desired state of the MongoDB processes.

   * - ``-d <string>``, ``-distribution <string>``

     - Specifies the Linux distribution. By default, the tool auto-detects
       the distribution. If this fails, specify your distribution as
       either ``debian`` or ``redhat``.

   * - ``-h``, ``-help``

     - Describes the tool's options.

Procedures
----------

Remove Processes from Automation and Create Init Scripts
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This procedure creates scripts for stopping and starting MongoDB processes
and then removes the processes from Automation.

Perform this procedure on each server that runs processes you want to
remove from Automation. If you are removing a replica set, perform this on
each replica set member separately, which allows you to remove the set
from Automation without downtime.

.. include:: /includes/steps/stop-using-automation.rst

Start or Stop a MongoDB Process using the Init Script
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If you chose to run the "Make Init Scripts" tool without the ``-boot``,
then you must stop and start your MongoDB processes manually.

To start a MongoDB process using the init script, issue

.. code-block:: sh

   sudo /etc/init.d/<script-name> start

To stop a MongoDB process using its init script, issue:

.. code-block:: sh

   sudo /etc/init.d/<script-name> stop
