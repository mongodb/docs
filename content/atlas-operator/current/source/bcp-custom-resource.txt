.. _bcp-custom-resource:

===============================================
``AtlasBackupCompliancePolicy`` Custom Resource
===============================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

The ``AtlasBackupCompliancePolicy`` custom resource configures a 
:ref:`{+bcp+} <backup-compliance-policy>` that applies to the 
:ref:`atlasproject-custom-resource` to protect your backup data. When 
you create the ``AtlasBackupCompliancePolicy`` custom resource, |ak8so| 
tries to create or update a {+bcp+}.

|ak8so| does one of the following actions using the |service| 
:oas-bump-atlas-op:`Backup Compliance Policy API Resource 
<updategroupbackupcompliancepolicy>`:
   
- Creates a new {+bcp+}.
- Updates an existing {+bcp+}.

.. important::

   See the :ref:`ak8so-bcp-prohibited-actions` and
   :ref:`ak8so-bcp-considerations`. A {+bcp+} applies as the minimum 
   backup policy to all {+clusters+} in the project. The {+bcp+} 
   protects all existing snapshots. The {+bcp+} prevents any user, 
   regardless of role, from modifying or deleting existing 
   snapshots prior to their expiration. Changes made to this 
   {+bcp+} apply only to future snapshots. If you enable a 
   {+bcp+}, the {+bcp+} limits your ability to reduce backup 
   storage costs. You can't adjust the retention or delete a 
   backup to reduce the backup storage costs.

Example
-------

The following example shows a ``BackupCompliancePolicy`` custom 
resource. To learn more, see :ref:`ak8so-bcp`.

.. code-block::

   apiVersion: atlas.mongodb.com/v1
   kind: AtlasBackupCompliancePolicy
   metadata:
     name: my-backup-compliance-policy
     namespace: mongodb-atlas-system
   spec:
     authorizedEmail: john.doe@example.com
     authorizedUserFirstName: John
     authorizedUserLastName: Doe
     copyProtectionEnabled: false
     encryptionAtRestEnabled: false
     onDemandPolicy:
       retentionUnit: weeks
       retentionValue: 3
     overwriteBackupPolicies: false
     pointInTimeEnabled: true
     restoreWindowDays: 42
     scheduledPolicyItems:
     - frequencyInterval: 2
       frequencyType: daily
       retentionUnit: days
       retentionValue: 7

Parameters
----------

.. include:: /includes/manual-crds/atlas-backup-compliance-policy.rst
