title: Download the latest version of the Backup Agent package.
stepnum: 1
edition:
  - cloud
ref: download-saas
pre: |
  On a system shell, issue a ``curl`` command to download the ``rpm``
  for the agent that works on your platform:
action:
  - heading: "For RHEL on x64 architecture:"
    language: sh
    code: |
      curl -OL https://cloud.mongodb.com/download/agent/backup/mongodb-mms-backup-agent-latest.x86_64.rpm
  - heading: "For RHEL / CentOS (7.x) on PowerPC architecture:"
    language: sh
    code: |
      curl -OL https://cloud.mongodb.com/download/agent/backup/mongodb-mms-backup-agent-latest.ppc641e.rpm
---
title: "Download the latest version of the Backup Agent package."
stepnum: 1
edition:
  - onprem
ref: download-hosted
pre: |
  On a system shell, issue a ``curl`` command to download the ``rpm``
  for the agent that works on your platform:

  .. note::
     Replace ``<OpsManagerHost:Port>`` with the hostname and port of
     your |onprem| installation.

action:
  - heading: "For RHEL on x64 architecture:"
    language: sh
    code: |
      curl -OL https://<OpsManagerHost:Port>/download/agent/backup/mongodb-mms-backup-agent-latest.x86_64.rpm
  - heading: "For RHEL / CentOS (7.x) on PowerPC architecture:"
    language: sh
    code: |
      curl -OL https://<OpsManagerHost:Port>/download/agent/backup/mongodb-mms-backup-agent-latest.ppc641e.rpm
---
title: "Install the Backup Agent package."
stepnum: 2
ref: install
pre: |
  To install the agent that works on your platform, issue the
  appropriate command to install the package:
action:
  - heading: "For RHEL on x64 architecture:"
    language: sh
    code: |
      sudo rpm -U mongodb-mms-backup-agent-latest.x86_64.rpm
  - heading: "For RHEL / CentOS (7.x) on PowerPC architecture:"
    language: sh
    code: |
      sudo rpm -U mongodb-mms-backup-agent-latest.ppc641e.rpm
---
title: "Generate an agent API key or retrieve an existing agent API key for your |mms| group." 
stepnum: 3
ref: retrieve-backup-mms-api-key
pre: |
      a. Click :guilabel:`+ Generate Key`.

      .. note::

         The button appears only if the current user is the group owner and
         the group either has no api keys or only the original key.

      b. Enter your password and click :guilabel:`Verify`.
  
      c. Click :guilabel:`+ Generate Key` again.

      .. include:: /includes/extracts/agent-api-key-admonition.rst

      To retrieve an existing API key, go to the :guilabel:`Agent API Keys`
      tab. To navigate to the tab, select :guilabel:`Deployment`  view, then
      click the :guilabel:`Agents` tab and then the :guilabel:`Agent API
      Keys` tab.
---
title: "Configure the ``backup-agent.config`` file with the Group ID and the agent API key."
stepnum: 4
ref: configure
content: |
  Edit the ``/etc/mongodb-mms/backup-agent.config`` file.
 
  For ``mmsGroupId``, enter your GroupID.

  For ``mmsApiKey``, enter the :term:`agent API key`.

---
stepnum: 5
source:
  file: steps-source-install-agent.yaml
  ref: proxy
replacement:
  agentname: "Backup"
  httpProxy: ":bsetting:`httpProxy`"
  configfile: "/etc/mongodb-mms/backup-agent.config"
---
title: "For SUSE 11+ deployments only, configure the ``sslTrustedMMSServerCertificate`` property."
stepnum: 6
ref: suse-ssl
optional: true
pre: |
  If you are deploying on SUSE, you must configure the
  ``sslTrustedMMSServerCertificate`` setting. All other users should
  omit this step.

  Enter the following property and value in the
  ``/etc/mongodb-mms/backup-agent.config`` file:
action:
  language: sh
  code: |
    sslTrustedMMSServerCertificate=/etc/ssl/certs/UTN_USERFirst_Hardware_Root_CA.pem
post: |
  Save and close the file.
---
title: "Start the Backup Agent."
stepnum: 7
ref: start
action:
  pre: |
    Issue the following command:
  language: sh
  code: |
    sudo service mongodb-mms-backup-agent start
...
