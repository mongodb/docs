.. _avs-create-index:

===================================
Create an {+avs+} Index
===================================

.. default-domain:: mongodb

.. facet::
   :name: genre
   :values: tutorial

.. meta::
   :keywords: atlas vector search, create an atlas vector search index, create an atlas vector search index, create an atlas vector search index using the atlas ui, create an atlas vector search index using the atlas vector search ui
   :description: Create an Atlas Vector Search index using the Atlas UI, mongosh, or MongoDB driver.

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. include:: /includes/facts/fts-index-description.rst

You can create an {+avs+} index for all collections that contain vector
embeddings less than or equal to 4096 dimensions in width for any kind
of data along with other data on your |service| {+cluster+} through the
{+atlas-ui+}, {+atlas-admin-api+}, {+atlas-cli+}, {+mongosh+},
or a supported :driver:`MongoDB Driver </>`.

.. _avs-create-index-prerequisites:

Prerequisites
-------------

To create an {+avs+} index, you must have an |service| {+cluster+} with
the following prerequisites: 

- MongoDB version ``6.0.11``, ``7.0.2``, or higher
- A collection for which to create the {+avs+} index 

.. |command-type| replace:: create

.. include:: /includes/fact-search-commands-free-tier-limitation.rst

.. _avs-create-index-access:

Required Access
---------------

You need the :authrole:`Project Data Access Admin` or higher role to create
and manage {+avs+} indexes.

.. _avs-types-vector-search-egs:
.. _avs-create-index-supported-clients:
.. _avs-create-index-procedure:

Procedure 
---------

.. tabs-selector:: drivers

----------

.. |arrow| unicode:: U+27A4

|arrow| Use the **Select your language** drop-down menu to select the
client you want to use to create your index.

----------

.. note::

   The procedure includes index definition examples for the 
   ``embedded_movies`` collection in the ``sample_mflix`` database. If
   you load the :ref:`sample data <mflix-embedded_movies>` on your
   {+cluster+} and create the example |fts| indexes for this collection,
   you can run the sample :pipeline:`$vectorSearch` queries against this
   collection. To learn more about the sample queries that you can run,
   see :ref:`$vectorSearch Examples <vectorSearch-agg-pipeline-egs>`. 

.. tabs-drivers:: 

   .. tab::  
      :tabid: atlas-ui 

      .. include:: /includes/steps-avs-create-index-atlas-ui.txt

   .. tab::  
      :tabid: atlas-api 

      To create an {+avs+} index for a collection using the
      {+atlas-admin-api+}, send a ``POST`` request to the |fts|
      ``indexes`` endpoint with the required parameters. 
      
      .. literalinclude:: /includes/avs-examples/index-management/create-index/create-index-api.sh 
         :language: shell
         :copyable:
         :linenos:
      
      To learn more about the syntax and parameters for the endpoint, see
      :oas-atlas-op:`Create One Atlas Search Index </createAtlasSearchIndex>`.  
      
      .. example:: 

         The following index definition indexes the ``plot_embedding``
         field as the ``vector`` type and the ``genres`` and ``year``
         fields as the ``filter`` type in an {+avs+} index. The
         ``plot_embedding`` field contains embeddings created using
         OpenAI's ``text-embedding-ada-002`` embeddings model. The index 
         definition specifies ``1536`` vector dimensions and measures
         similarity using ``euclidean`` distance. 

         .. tabs:: 

            .. tab:: Basic Example
               :tabid: basic

               The following index definition indexes only the vector
               embeddings field for performing vector search.
                  
               .. literalinclude:: /includes/avs-examples/index-management/create-index/basic-example-api.sh 
                  :language: shell
                  :copyable:
                  :linenos:

            .. tab:: Filter Example 
               :tabid: advanced

               This index definition indexes the following fields: 
         
               - A string field (``genres``) and a numeric field (``year``)
                 for pre-filtering the data. 
               - The vector embeddings field (``plot_embedding``) for
                 performing vector search against pre-filtered data.

               .. literalinclude:: /includes/avs-examples/index-management/create-index/filter-example-api.sh 
                  :language: shell
                  :copyable:
                  :linenos:

   .. tab::  
      :tabid: atlas-cli 

      To create an {+avs+} index for a collection using the
      {+atlas-cli+} v1.14.3 or later, perform the following steps: 

      .. include:: /includes/steps-avs-create-index-acli.rst 

   .. tab::  
      :tabid: shell 

      To create an {+avs+} index for a collection using {+mongosh+}
      v2.1.2 or later, perform the following steps:
      
      .. include:: /includes/steps-avs-create-index-mongosh.rst 

   .. tab::
      :tabid: python

      To create an {+avs+} index for a collection using the
      `PyMongo <https://www.mongodb.com/docs/languages/python/pymongo-driver/current/indexes/atlas-search-index/>`__
      driver v4.7 or later, perform the following steps: 

      .. include:: /includes/steps-avs-create-index-pymongo.rst

   .. tab::
      :tabid: nodejs

      To create an {+avs+} index for a collection using the
      :driver:`MongoDB Node driver </node/current/fundamentals/indexes/>` 
      v6.6.0 or later, perform the following steps:

      .. include:: /includes/steps-avs-create-index-nodejs.rst
