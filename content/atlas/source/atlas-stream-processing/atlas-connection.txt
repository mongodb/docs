.. _atlas-sp-atlas-connection:

========================
{+service+} Connections
========================

.. default-domain:: mongodb

.. meta::
   :keywords: atlas stream procesisng, streaming data, real time, data processing, cluster, database, atlas, change stream
   :description: Learn how to create and configure Atlas connections in your Stream Processing Instance connection registry

.. facet::
   :name: genre
   :values: tutorial

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

{+atlas-sp+} supports both source and sink connections to {+service+}
{+clusters+} both within your {+atlas-sp+} project and in other
projects within your organization.

.. _atlas-sp-manage-atlas-cross-project:

Enable Cross-Project Connections
--------------------------------

.. note::

   If you need connections to {+clusters+} only within the same
   project as your {+atlas-sp+} workspace, skip this section.

To create cross-project connections, you must enable this feature at
the organization level. To do so, navigate to the :ref:`Organization
Settings <organization-settings>` page, and set the :guilabel:`Enable
Atlas Stream Processing Across Projects` toggle on.

If you disable this setting while running stream processors against
cross-project connections, {+atlas-sp+} suspends these processors.

.. _atlas-sp-manage-atlas-add:

Add an {+service+} Connection
--------------------------------

To add an {+service+} {+cluster+} connection to your {+spi+}:

.. tabs::

   .. tab:: {+atlas-cli+}
      :tabid: add-connection-cli

      .. include:: /includes/extracts/atlas-streams-connections-create.rst

      When you create a {+spi+} using the {+atlas-cli+}, you must provide a ``.json``
      configuration file to define the new connection's parameters. The format of this
      file depends on the type of connection you define.

      For an {+service+} database connection, provide a configuration
      file with the following syntax:

      .. code-block:: json

         {
	   "type": "Cluster",
	   "clusterName": "<clusterName>",
	   "dbRoleToExecute": {
	     "role": "<roleName>",
	     "type": "<roleType>"
	 }

   .. tab:: {+atlas-ui+}
      :tabid: add-connection-ui

      .. include:: /includes/procedures/atlas-sp-add-atlas-connection-ui.rst

   .. tab:: {+atlas-admin-api+}
      :tabid: add-connection-api

      The {+atlas-admin-api+} provides an endpoint for adding a 
      connection to a connection registry.

      :oas-atlas-tag:`Add a Connection to the Connection Registry
      </Streams/operation/createStreamConnection>`
