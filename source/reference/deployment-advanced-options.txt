========================================
Advanced Options for MongoDB Deployments
========================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. include:: /includes/styles/corrections.rst

The following :program:`mongod` and :program:`mongos` configuration
options are available through the |mms|
:guilabel:`Advanced Configuration Options` field when you deploy
MongoDB. You select advanced options when deploying:

- :doc:`replica sets </tutorial/deploy-replica-set>`
- :doc:`sharded clusters </tutorial/deploy-sharded-cluster>`
- :doc:`standalone instances </tutorial/deploy-standalone>`

The |mms| :guilabel:`Advanced Configuration Options` map to the MongoDB
configuration options and parameters described as follows.

.. admonition:: Limited to Listed Options
   :class: warning

   If a MongoDB option isn't listed on this page, you may use
   :manual:`setParameter </reference/parameters/>` to add the setting.
   Settings added in this way apply to MongoDB instances that |mms|
   manages when those instances start up.

.. _deployment-advanced-options-audit-log:

Audit Log
---------

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - auditEncryptionKeyIdentifier
     - :setting:`auditLog.auditEncryptionKeyIdentifier`
   * - compressionMode
     - :setting:`auditLog.compressionMode`
   * - auditDestination
     - :setting:`auditLog.destination`
   * - auditFilter
     - :setting:`auditLog.filter`
   * - auditFormat
     - :setting:`auditLog.format`
   * - localAuditKeyFile
     - :setting:`auditLog.localAuditKeyFile`
   * - auditPath
     - :setting:`auditLog.path`

You can add these :manual:`audit log parameters
</reference/parameters/#auditing-parameters>` with a ``setParameter``
option in the :guilabel:`Advanced Configuration Options` section. To
learn more, see the step about setting these parameters in the
:ref:`Deploy a Replica Set <deploy-replica-set>` procedure.

To encrypt the audit log, before you start MongoDB instances that
|mms| manages, add the :parameter:`auditEncryptKeyWithKMIPGet
<auditEncryptKeyWithKMIPGet>` and :parameter:`auditEncryptionHeaderMetadataFile
<auditEncryptionHeaderMetadataFile>` parameters in the
:guilabel:`Advanced Configuration Options` section.

Basis Tech
----------

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - basisTechRootDirectory
     - :setting:`basisTech.rootDirectory`

Kerberos
--------

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - kerberosKeytab
     - :setting:`kerberos.keytab`

.. _deployment-advanced-options-net:

Net
---

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - bind_ip
     - :setting:`net.bindIp`
   * - httpinterface
     - :setting:`net.http.enabled`
   * - ipv6
     - :setting:`net.ipv6`
   * - jsonp
     - :setting:`net.http.JSONPEnabled`
   * - maxConns
     - :setting:`net.maxIncomingConnections`
   * - rest
     - :setting:`net.http.RESTInterfaceEnabled`
   * - tlsClusterFile
     - :setting:`net.tls.clusterFile`
   * - tlsClusterPassword
     - :setting:`net.tls.clusterPassword`
   * - tlsCRLFile
     - :setting:`net.tls.CRLFile`
   * - tlsDisabledProtocols
     - :setting:`net.tls.disabledProtocols`
   * - tlsLogVersions
     - :setting:`net.tls.logVersions`

Numactl
-------

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - numCores
     - :setting:`numactl.numCores`

Operation Profiling
-------------------

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - profile
     - :setting:`operationProfiling.mode`
   * - slowms
     - :setting:`operationProfiling.slowOpThresholdMs`
   * - slowOpSampleRate
     - :setting:`operationProfiling.slowOpSampleRate`

Process Management
------------------

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - pidfilepath
     - :setting:`processManagement.pidFilePath`

.. _advanced-options-replication:

Replication
-----------

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - enableMajorityReadConcern
     - :setting:`replication.enableMajorityReadConcern`
   * - oplogSize
     - :setting:`replication.oplogSizeMB`

.. _advanced-options-security:

Security
--------

.. warning:: 
            
   .. include:: /includes/facts/fcv-transitioning-from-keyfile-to-KMIP-considerations.rst

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - clusterAuthMode
     - :setting:`security.clusterAuthMode`
   * - enableEncryption
     - :setting:`security.enableEncryption`
   * - encryptionCipherMode
     - :setting:`security.encryptionCipherMode`
   * - encryptionKeyFile
     - :setting:`security.encryptionKeyFile`
   * - javascriptEnabled
     - :setting:`security.javascriptEnabled`
   * - kmipClientCertificateFile
     - :setting:`security.kmip.clientCertificateFile`
   * - kmipClientCertificatePassword
     - :setting:`security.kmip.clientCertificatePassword`
   * - kmipKeyIdentifier
     - :setting:`security.kmip.keyIdentifier`
   * - kmipPort
     - :setting:`security.kmip.port`
   * - kmipServerCAFile
     - :setting:`security.kmip.serverCAFile`
   * - kmipServerName
     - :setting:`security.kmip.serverName`
   * - saslauthdSocketPath
     - :setting:`security.sasl.saslauthdSocketPath`
   * - saslHostname
     - :setting:`security.sasl.hostName`

Sharding
----------

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - autoSplit
     - :setting:`sharding.autoSplit`
   * - chunkSize
     - :setting:`sharding.chunkSize`

|snmp|
------

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - snmp-master
     - :setting:`snmp.master`
   * - snmp-subagent
     - :setting:`snmp.subagent`

Storage
-------

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - directoryperdb
     - :setting:`storage.directoryPerDB`
   * - engine
     - :setting:`storage.engine`
   * - inMemorySizeGB
     - :setting:`storage.inMemory.engineConfig.inMemorySizeGB`
   * - journal
     - :setting:`storage.journal.enabled`
   * - journalCommitInterval
     - :setting:`storage.journal.commitIntervalMs`
   * - nssize
     - :setting:`storage.nsSize`
   * - prealloc
     - :setting:`storage.preallocDataFiles`
   * - quota
     - :setting:`storage.quota.enforced`
   * - quotaFiles
     - :setting:`storage.quota.maxFilesPerDB`
   * - repairpath
     - :setting:`storage.repairPath`
   * - smallfiles
     - :setting:`storage.smallFiles`
   * - syncdelay
     - :setting:`storage.syncPeriodSecs`
   * - wiredTigerCacheSizeGB
     - :setting:`storage.wiredTiger.engineConfig.cacheSizeGB`
   * - wiredTigerCollectionBlockCompressor
     - :setting:`storage.wiredTiger.collectionConfig.blockCompressor`
   * - wiredTigerCollectionConfigString
     - :setting:`storage.wiredTiger.collectionConfig.configString`
   * - wiredTigerDirectoryForIndexes
     - :setting:`storage.wiredTiger.engineConfig.directoryForIndexes`
   * - wiredTigerEngineConfigString
     - :setting:`storage.wiredTiger.engineConfig.configString`
   * - wiredTigerIndexConfigString
     - :setting:`storage.wiredTiger.indexConfig.configString`
   * - wiredTigerIndexPrefixCompression
     - :setting:`storage.wiredTiger.indexConfig.prefixCompression`
   * - wiredTigerJournalCompressor
     - :setting:`storage.wiredTiger.engineConfig.journalCompressor`
   * - wiredTigerStatisticsLogDelaySecs
     - :setting:`storage.wiredTiger.engineConfig.statisticsLogDelaySecs`

System Log
----------

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - logappend
     - :setting:`systemLog.logAppend`
   * - logRotate
     - :setting:`systemLog.logRotate`
   * - quiet
     - :setting:`systemLog.quiet`
   * - syslogDestination
     - :setting:`systemLog.destination`
   * - syslogFacility
     - :setting:`systemLog.syslogFacility`
   * - timeStampFormat
     - :setting:`systemLog.timeStampFormat`
   * - verbosity
     - :setting:`systemLog.verbosity`

TLS
---

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - tlsCertificateKeyFile
     - :setting:`net.tls.certificateKeyFile`
   * - tlsCertificateKeyFilePassword
     - :setting:`net.tls.certificateKeyFilePassword`
   * - tlsFIPSMode
     - :setting:`net.tls.FIPSMode`
   * - tlsMode
     - :setting:`net.tls.mode`

.. only:: onprem

   .. _om-set-parameter:

.. only:: cloud

   .. _cm-set-parameter:

Set Parameter
-------------

.. important::

   |mms| does not check to see if the parameters you provide are
   valid. Check the
   :manual:`MongoDB Server Manual </reference/parameters>` for
   accepted parameters and values.

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - |mms| Interface
     - MongoDB Option

   * - [setParameter]
     - :setting:`setParameter.name`

       You can add any value from
       :manual:`Server Parameters </reference/parameters>` as a
       ``setParameter``.

