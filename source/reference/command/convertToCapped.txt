===============
convertToCapped
===============

.. default-domain:: mongodb

.. dbcommand:: convertToCapped

   The :dbcommand:`convertToCapped` command converts an existing,
   non-capped collection to a :term:`capped collection` within the same
   database.

   The command has the following syntax:

   .. code-block:: javascript

      {convertToCapped: <collection>, size: <capped size> }

   This command coverts an existing ``collection`` to a capped
   collection with a maximum size specified by the ``capped size`` in
   bytes.

   During the conversion, the :dbcommand:`convertToCapped` command
   exhibit the following behavior:

   - The documents in the original collection will be traversed in
     :term:`$natural order <natural order>` and loaded into a new
     capped collection.

   - If the ``capped size`` specified for the capped collection is
     smaller than the size of the original uncapped collection, then
     the documents will be aged out of the collection based on
     insertion order(First In, First Out).
     
   - The actual conversion process consists of the
     :dbcommand:`cloneCollectionAsCapped` command followed by a
     :dbcommand:`renameCollection` command. First, the
     :dbcommand:`cloneCollectionAsCapped` command creates the capped
     collection. Then, the original collection is dropped. Finally, the
     :dbcommand:`renameCollection` command renames the new capped
     collection to the name of the original collection.

   .. note::

      The :dbcommand:`convertToCapped` command is not supported in a
      sharded cluster.

   .. warning::

      The :dbcommand:`convertToCapped` will not recreate indexes from
      the original collection on the new collection. If you need
      indexes on this collection you will need to create these indexes
      after the conversion is complete.

   .. seealso:: :dbcommand:`create`

