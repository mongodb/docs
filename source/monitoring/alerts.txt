.. index:: alerts

======
Alerts
======

The "Alerts" section provides access to |mms|'s alert system. This
section has three tabs: open alerts, closed alerts, and alert
settings. Following the installation of your first Monitoring agent, the
system configures an alert to send an email when the agent is
down. You can delete or modify this alert as you like.

.. index:: alerts; types

Types
-----

.. only:: saas

   There are five possible alert types:

   - "**Old Host Version**" activates in response to ``mongod`` running
     an out of date version of MongoDB.

   - "**Host Down**" activates in response to a ``mongod`` or other
     monitored instance restarts or fails to check in to MMS within 9
     minutes. There are no "host down" alerts if the agent is down.

   - "**Agent Down**" activates in response to an agent that fails to
     report to MMS within 8 minutes.

   - "**Host Recovering**" activates when a replica set member enters
     ``RECOVERING`` status.

   - "**Metric Min/Max Value**" activates when a monitored metric
     passes a specified threshold.

.. only:: hosted

   There are four possible alert types.
   |monitoring|:

   - "**Host Down**" activates in response to a ``mongod`` or other
     monitored instance restarts or fails to check in to MMS within 90
     seconds. There are no "host down" alerts if the agent is down.

   - "**Agent Down**" activates in response to an agent that fails to
     report to MMS within 90 seconds.

   - "**Host Recovering**" activates when a replica set member enters
     ``RECOVERING`` status.

   - "**Metric Min/Max Value**" activates when a monitored metric
     passes a specified threshold.   

MMS will add additional alert types in the near future.

.. index:: alerts; notifications

Configure Notifications
~~~~~~~~~~~~~~~~~~~~~~~

.. only:: saas

   You can create notifications for any of the above alert types. Click 
   on the ``+ ADD ALERT`` button next to the word "Alerts" at the top of
   these pages. This will raise a dialogue where you can create email or 
   SMS alerts.

.. only:: hosted

   You can create notifications for any of the above alert types. Click on
   the ``+ Add Alert`` button next to the word "Alerts" at the top of
   these pages. This will raise a dialogue where you can create email, SMS,
   or SNMP alerts for any of these event types.

   .. note::

       The MIB file for SNMP is `available for download here
       <http://downloads.mongodb.com/on-prem-monitoring/MMS-10GEN-MIB.txt>`_.

You can configure the following options:

For all Alerts Except *Metric Min/Max Value*
````````````````````````````````````````````

.. only:: saas

   - **Address** specifies an address to send alert emails. For SMS
     alerts, specify the telephone number that will receive the alert.

.. only:: hosted

   - **Address** specifies an address to send alert emails. For SMS
     alerts specify the telephone number that will receive the alert. For
     SNMP alerts specify the hostname that will receive the v2c trap on
     standard port 162.

.. warning::

   Telephone numbers are not validated or checked, and users must
   ensure that they have entered the correct number into the Alerts
   interface.

.. include:: /includes/fact-two-factor-auth-India-limit.rst

.. only:: saas

   - **Type** to select from text email, HTML formatted email, and SMS
     alerts.

.. only:: hosted

   - **Type** to select from text email, HTML formatted email, SMS,
     or SNMP alerts.

- **Frequency Config (minutes)** to select how often to send alerts,
  in minutes.

- **Minimum Time Before Notification** specifies how long MMS will
  wait before sending a notification. Raising this value will increase
  the amount of time between the identification of an issue and the
  alert, but it may reduce potential false positives.

  You may also create multiple alerts with different minimum times
  before notification to implement alert escalation.

  .. important:: The time between re-notifications increases by the
     frequency amount every alert cycle (e.g. 5 minutes, 10 minutes,
     15 minutes, 20 minutes.)

For *Metric Min/Max Value* Alerts
`````````````````````````````````

- **Host Type** specifies the kind of monitored host. Options include:
  *standalone*, *primary*, *secondary*, *mongos*, *conf*, *master*,
  *slave*, and *individual/specific host*.

- **Replica Set** specifies a monitored replica set to include in the alert.

- **Field** specifies the metric to use in the alert.

- **Alert Value** specifies the alert threshold. Use the toggles in
  this field to select *greater than* or *less than* and *avg per
  second* or *total per epoch*.

.. only:: saas

   - **Contact Type** specifies the method of contact. Select from text
     email, HTML formatted email, and SMS alert.

.. only:: hosted

   - **Contact Type** specifies the method of contact. Select from text
     email, HTML formatted email, SMS message, and SNMP trap.

- **Contact Frequency Config (minutes)** to select how often to send
  alerts, in minutes.

- **Contact Min Time Before Notification** specifies how long MMS will
  wait before sending a notification. Raising this value will increase
  the amount of time between the identification of an issue and the
  alert, but it may reduce potential false positives.

  You may also create multiple alerts with different minimum times
  before notification to implement alert escalation.

  .. important:: The time between re-notifications increases by the
     frequency amount every alert cycle (e.g. 5 minutes, 10 minutes,
     15 minutes, 20 minutes.)

.. index:: alerts; unresolved

Unresolved Alerts
~~~~~~~~~~~~~~~~~

The "Open" tab displays a list of all monitored instances that
have current unresolved alerts. Check this tab to make sure that there
are no outstanding alerts.

.. index:: alerts; resolved

Resolved Alerts
~~~~~~~~~~~~~~~

The "Closed" tab displays a record of all historical alerts. Use
this tab as a record of past activity.

.. index:: alerts; setting
   single: setting; alerts

Alert Settings
~~~~~~~~~~~~~~

The "Settings" tab provides an interface for configuring alerts. You can
delete and disable existing alerts using
the function buttons in the right hand column.

.. only:: hosted

   .. include:: /includes/usage-snmp-hosted.rst
