===============================================================
Install or Upgrade |onprem| from ``tar.gz`` or ``zip`` Archives
===============================================================

.. default-domain:: mongodb

Overview
--------

This tutorial describes how to :ref:`install
<install-on-prem-from-archive>` or :ref:`upgrade
<upgrade-on-prem-from-archive>` the :ref:`mms-application-package` and the
optional :ref:`MMS Backup Daemon <backup-daemon>` using tar.gz or zip
files. This tutorial installs to a Linux OS. The |application| monitors
MongoDB deployments, and the Backup Daemon creates and stores deployment
snapshots.

Prerequisites
-------------

.. include:: /includes/prerequisites-on-prem-install.rst

.. _install-on-prem-from-archive:

Install Procedures
------------------

You must have administrative access on the machines to which you install.

Install and Start the |application|
+++++++++++++++++++++++++++++++++++

.. include:: /includes/steps/install-on-prem-from-archive.rst

Install the Backup Daemon (Optional)
++++++++++++++++++++++++++++++++++++

If you use MMS Backup, install the :ref:`MMS Backup Daemon <backup-daemon>`.

.. include:: /includes/steps/backup-install-backend-from-archive.rst

Next Steps
----------

To set up a replica set for a test environment, see
:doc:`/tutorial/test-new-deployment`. The tutorial populates the replica set
with test data, registers a user, and installs the Monitoring and Backup
Agents on a client machine in order to monitor the test replica set.

.. _upgrade-on-prem-from-archive:

Upgrade Procedures
------------------

Upgrade |mms| from 1.3 and Later
++++++++++++++++++++++++++++++++

If you have an existing |onprem| deployment, use the following
procedure to upgrade to the latest release. There are no supported
downgrade paths for |onprem|.

To upgrade a tarball installation, backup the configuration file and logs,
and then re-install the |onprem| server.

.. important:: It is crucial that you back up the existing
   configuration because the upgrade process will delete existing
   data.

In more detail:

.. include:: /includes/steps/upgrade-on-prem-from-archive.rst

Upgrade |mms| from 1.2 and Earlier
++++++++++++++++++++++++++++++++++

Due to the `company name change
<http://www.mongodb.com/press/10gen-announces-company-name-change-mongodb-inc>`_,
the name of the |mms| package changed between versions 1.2 and 1.3.
Therefore, to upgrade the |mms| server from *any* version before 1.3, use
the following procedure:

#. *Recommended.* Take a full backup of the |mms| database before
   beginning the upgrade procedure.

#. Shut down |mms|, using the following command:

   .. code-block:: sh

      /etc/init.d/10gen-mms stop

#. Download the latest package from
   `the downloads page <http://www.mongodb.com/subscription/downloads/mms>`_
   and proceed with the instructions
   for a fresh install. Do not attempt to use your package manager
   to do an upgrade. See :doc:`/installation` for more
   information.

   When complete, |mms| is installed in the ``/opt/mongodb/mms``
   directory.

#. Follow all procedures for a new install, including configuring the
   options in ``/opt/mongodb/mms/conf/conf-mms.properties``. If you
   used encrypted authentication credentials you will need to
   regenerate these manually.  *Do not copy the credentials from
   your old properties file. Old credentials will not work.*

#. Start |mms| using the new package name:

   .. code-block:: sh

      <install_dir>/bin/mongodb-mms start

#. Update any Monitoring Agent. See :doc:`/tutorial/nav/install-monitoring-agent` for
   more information.
