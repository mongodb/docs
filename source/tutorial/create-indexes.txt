==============
Manage Indexes
==============

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. only:: cloud

   .. admonition:: Available only with Cloud Manager Premium
      :class: note

      This feature is available only with Cloud Manager Premium, which
      comes with certain MongoDB subscriptions. For more information,
      `Contact MongoDB <https://www.mongodb.com/contact>`_.

|mms| Automation lets you build MongoDB indexes without downtime for
your deployment. The Automation Agent will sequentially take each
individual node in a replica set or cluster offline to build the
indexes. The agent builds the indexes without increasing load on your
deployment or blocking read or write operations. You can create any
type of MongoDB index. For available types, see 
:ref:`Index Types <index-types>` in the MongoDB manual.

.. note::

   For replica sets with one data-bearing node or less than three total
   nodes, |mms| builds the index in the foreground without taking the 
   cluster offline.

Create a Managed Index
----------------------

You can create two types of indexes:

.. list-table::
   :widths: 25 75 
   :stub-columns: 1
 
   * - Standard Index
     - An index on one or more fields of any of the 
       :manual:`types</core/index-types>` described in the MongoDB 
       manual.
 
   * - :abbr:`TTL (Time to Live)` Index
     - A single-field index that MongoDB can use to automatically 
       remove documents from a database that stores transient
       information, such as logs. 
 
       .. seealso::
 
          To learn more about 
          :manual:`TTL Indexes </core/index-ttl>`, see the MongoDB 
          manual.

.. tabs::

   tabs:
    - id: index
      name: Standard Index
      content: |
 
        .. include:: /includes/steps/create-index.rst
 
    - id: ttl-index
      name: TTL Index
      content: |
 
        .. include:: /includes/steps/create-ttl-index.rst

.. note::

   MongoDB backups automatically include any indexes you create using |mms|.

.. _remove-index:

Remove an Index
---------------

.. important::

   The Automation Agent does not currently support automated removal of
   an index from a collection. To remove an index that Automation 
   manages, first remove the index from Automation and then manually 
   remove the index from the collection.

.. include:: /includes/steps/remove-index.rst
