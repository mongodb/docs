==================================
Configure Multiple Snapshot Stores
==================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Overview
--------

Additional Snapshot Stores can be added to meet storage requirements. These additional stores can be deployed in the same data center as the first store. There are times where these stores need to be deployed to other data centers due to either network performance issues or regulatory requirements.

You can bind specific |onprem| :term:`groups <group>` to specific snapshot
stores and particular data centers. This assigns the backups of particular
MongoDB deployments to specific data centers to minimize network impact. This is called data locality.

This tutorial explains how to set up additional snapshot stores for data locality: creating two snapshot stores, one in each of two separate data
centers and attaching a separate group to each.

Prerequisites
-------------

* Configure the two |application| instances to share a single dedicated 
  :ref:`mms-application-database`. 

  * The members of the |application| Database replica set can be put in each data center.

* Configure each Backup Agent to use the URL for its local |application|.

  * Each |application| can use a different hostname or a split-horizon DNS to
    point each agent to its local |application|.

.. note::

   The |application| Database and the Backup Blockstore Databases are
   MongoDB databases and can run as :term:`standalones <standalone>` or
   :term:`replica sets <replica set>`. 

   For production deployments, use replica sets to provide database
   :manual:`high availability </core/replica-set-high-availability>`.

Procedures
----------

Provision Servers in Each Data Center
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Each data center must host its own :term:`Backup Blockstore Database` or
File System Store, :ref:`application` and 
:doc:`Backup Agent </tutorial/nav/install-backup-agent>`.

Each server must meet the cumulative hardware and software requirements
for the components it runs. See :doc:`/core/requirements`.

All servers running Backup and |application| Databases use MongoDB. They must meet the configuration requirements in the :manual:`MongoDB Production Notes </administration/production-notes>`.

Install MongoDB
~~~~~~~~~~~~~~~

Install MongoDB on the servers that host the:

- |application| Database
- Blockstore Databases

See :manual:`Install MongoDB </installation>` in the MongoDB manual to
find the correct install procedure for your operating system. 

To run replica sets for the |application| Database and Blockstore Databases, see :manual:`Deploy a Replica Set </tutorial/deploy-replica-set>` in the MongoDB manual.

Install and Start the |application|
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Install the |application| in each data center.

.. note::
   See :doc:`/tutorial/nav/install-application` for instructions for your
   operating system.

.. important::
   Each set of installation instructions for each operating system covers how
   to create a multiple instances of an |application|. These activities need
   to be completed before data locality can be configured.

Bind Groups to Backup Resources
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/steps/configure-backup-data-locality-bind-groups.rst
