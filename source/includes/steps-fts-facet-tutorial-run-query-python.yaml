ref: run-facet-query-python
stepnum: 1
title: "Run an |fts| facet query that groups the genre and year fields
       into buckets."
content: |

  a. Create a file named ``facet-query.py``. 
  #. Copy and paste the following code into the ``facet.py`` 
     file.

     The following code example:

     - Imports ``pymongo``, MongoDB's Python driver, and the ``dns``
       module, which is required to connect ``pymongo`` to ``Atlas`` 
       using a |dns| seed list connection string. 

     - Creates an instance of the ``MongoClient`` class to establish a 
       connection to your |service| cluster.

     - Uses the following searchMeta clauses to query the collection: 

       .. include:: /includes/extracts/fts-facet-constant-desc.rst 

     - Iterates over the cursor to print the documents that match the 
       query.

     .. literalinclude:: /includes/fts-tutorial/facet/tutorial.py
        :language: python
        :linenos:
        :dedent:

  #. .. include:: /includes/fact-fts-driver-connection-string.rst
  #. Run the following command to query your collection: 
  
     .. code-block:: sh 
     
        python facet-query.py

  When you run ``facet-query.py``, the program prints 
  the following documents to your terminal:

  .. code-block:: python
     :copyable: false
     
     {'count': {'lowerBound': 23026}, 
      'facet': {
        'genresFacet': {
          'buckets': [
            {'count': 13527, '_id': 'Drama'}, 
            {'count': 6922, '_id': 'Comedy'}, 
            {'count': 3615, '_id': 'Romance'}, 
            {'count': 2649, '_id': 'Crime'}, 
            {'count': 2603, '_id': 'Thriller'}, 
            {'count': 2505, '_id': 'Action'}, 
            {'count': 2041, '_id': 'Documentary'}, 
            {'count': 2016, '_id': 'Adventure'}, 
            {'count': 1662, '_id': 'Horror'}, 
            {'count': 1373, '_id': 'Biography'}]}, 
        'yearFacet': {
          'buckets': [
            {'count': 23, '_id': 1910}, 
            {'count': 89, '_id': 1920}, 
            {'count': 308, '_id': 1930}]}}}

...
