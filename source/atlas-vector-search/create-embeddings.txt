.. _create-vector-embeddings:

===============================
How to Create Vector Embeddings
===============================

.. default-domain:: mongodb

.. meta::
   :description: How to choose an embedding model and create vector embeddings for semantic and vector search.
   
.. facet::
   :name: genre
   :values: tutorial

.. facet::
   :name: programming_language
   :values: python, javascript/typescript

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

:term:`Vector embeddings <vector embeddings>` represent 
your data as points in multi-dimensional space. These
embeddings capture meaningful relationships in your data
and enable tasks such as semantic search and retrieval. 
You can store vector embeddings along with your other data
in |service| and use {+avs+} to query your vectorized data.

To perform vector search over your embeddings, do the following:

1. Choose a method to create vector embeddings.
#. Create vector embeddings from your data and store 
   them in |service|.
#. Create a vector embedding that represents your
   search query and run the query.

{+avs+} returns documents whose vector embeddings are closest 
in distance to the embedding that represents your query.
This indicates that they are similar in meaning. 

.. _create-embeddings:

Choose a Method to Create Embeddings
------------------------------------

To create vector embeddings, you must use 
an :term:`embedding model`. To connect to
an embedding model and create embeddings 
for {+avs+}, use one of the following methods:

.. list-table::
   :widths: 25 45 30
   :header-rows: 1

   * - Method
     - Description
     - Tutorials

   * - Load an open-source model
     - If you don't have |api| keys or credits with an embedding service,
       use an open-source embedding model by loading it locally
       from your application.
 
     - | :ref:`Create and Store Embeddings <create-embeddings-examples>` 
       | :ref:`Build a Local RAG Implementation <local-rag>`
        
   * - Call an embedding service
     - Most AI providers offer |api|\s for their proprietary embedding models 
       that you can use to create vector embeddings. 
    
     - :ref:`Create and Store Embeddings <create-embeddings-examples>`

   * - Use an integration
     - You can integrate {+avs+} with open-source frameworks like 
       :ref:`LangChain <langchain>` and :ref:`LlamaIndex <llamaindex>`, 
       services like :ref:`Amazon Bedrock <amazon-bedrock>`, and more.
       
       These integrations include built-in libraries and tools to help 
       you quickly connect to open-source and proprietary embedding models 
       and generate vector embeddings for {+avs+}.
     - :ref:`vector-search-integrations`

.. _create-embeddings-examples:
.. _create-embeddings-from-data:

Create and Store Embeddings From Data
-------------------------------------

The following procedure shows how to 
create vector embeddings and store them in |service| 
by using an open-source or proprietary embedding model.

----------

.. |arrow| unicode:: U+27A4

|arrow| Use the **Select your language** drop-down menu to set the 
language of the examples on this page.

----------

Prerequisites
~~~~~~~~~~~~~

To run these examples, you must have the following:

.. tabs-selector:: drivers

.. tabs-drivers::

   .. tab::
      :tabid: python

      - An |service| {+cluster+} running MongoDB version 6.0.11, 7.0.2, or later.
        Ensure that your :abbr:`IP address (Internet Protocal address)` is included
        in your |service| project's :ref:`access list <access-list>`.
      - An environment to run interactive Python notebooks 
        such as `Colab <https://colab.research.google.com>`__.
        
   .. tab::
      :tabid: nodejs

      - An |service| {+cluster+} running MongoDB version 6.0.11, 7.0.2, or later.
        Ensure that your :abbr:`IP address (Internet Protocal address)` is included
        in your |service| project's :ref:`access list <access-list>`.
      - A terminal and code editor to run your Node.js project.
      - `npm and Node.js <https://docs.npmjs.com/downloading-and-installing-node-js-and-npm>`__ installed.
              
Procedure
~~~~~~~~~

Complete the following steps to create vector embeddings
from custom data and store them in a
collection in |service|. You can also modify the following code
to generate embeddings from your own data of any type.  

.. note::

   If you want to create embeddings for an 
   existing collection, you must add a new field that contains 
   the embedding and :manual:`update </tutorial/update-documents/>` 
   each document in the collection.

.. tabs-drivers::

   .. tab::
      :tabid: python

      .. tabs::

         .. tab:: Open-Source Example
            :tabid: open-source

            .. include:: /includes/steps-avs-create-embeddings-open-source.rst

         .. tab:: OpenAI Example
            :tabid: openai

            .. include:: /includes/steps-avs-create-embeddings-openai.rst

   .. tab::
      :tabid: nodejs

      .. tabs::
         
         .. tab:: Open-Source Example
            :tabid: open-source

            .. include:: /includes/steps-avs-create-embeddings-open-source-nodejs.rst

         .. tab:: OpenAI Example
            :tabid: openai

            .. include:: /includes/steps-avs-create-embeddings-openai-nodejs.rst

.. _create-embeddings-for-queries:

Create Embeddings for Queries
-----------------------------

The following procedure shows how to 
create an embedding for {+avs+} queries by using an 
open-source or proprietary embedding model.

Procedure
~~~~~~~~~

Once you've :ref:`created embeddings 
from the sample data <create-embeddings-from-data>`,
complete the following steps to create an {+avs+}
index on your data and embeddings for 
vector search queries.

.. tabs-drivers::

   .. tab::
      :tabid: python
             
      .. tabs::

         .. tab:: Open-Source Example
            :tabid: open-source

            .. include:: /includes/steps-avs-query-embedding-open-source.rst

         .. tab:: OpenAI Example
            :tabid: openai

            .. include:: /includes/steps-avs-query-embedding-openai.rst

            .. tip::

               You can also create embeddings by calling the |api| endpoint directly.
               To learn more, see `OpenAI API Reference 
               <https://platform.openai.com/docs/api-reference/embeddings>`__.

   .. tab::
      :tabid: nodejs
             
      .. tabs::

         .. tab:: Open-Source Example
            :tabid: open-source

            .. include:: /includes/steps-avs-query-embedding-open-source-nodejs.rst

         .. tab:: OpenAI Example
            :tabid: openai

            .. include:: /includes/steps-avs-query-embedding-openai-nodejs.rst

To learn more about running vector search queries, see 
:ref:`return-vector-search-results`.
