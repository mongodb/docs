====================
Manage Oplog Storage
====================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Throughout the lifecycle of a backup, the :term:`Backup Agent` tails the
:term:`oplog` of each :term:`replica set` and sends new oplog entries to
|onprem|. The oplog entries are sent in compressed bundles of approximately 10
MB in size called :term:`oplog slices <oplog slice>`. These oplog slices are
stored in one or more MongoDB databases called 
:term:`Oplog Stores <Oplog Store Database>`. Every |onprem| deployment needs
at least one Oplog Store.

When you enable backups, you are prompted to create one Oplog Store. Once one
Oplog Store is created, you manage it separately from your snapshot stores and
can create additional Oplog Stores.

This tutorial covers creating additional Oplog Stores to store oplog entries.
Like any MongoDB instance, :term:`Oplog Stores <Oplog Store Database>` can
exist on any host running MongoDB that the |onprem| application can access.

Prerequisites
-------------

Before creating any Oplog Stores:

- Ensure storage volume(s) with sufficient capacity to store the oplog MongoDB
  database are attached to the |onprem| or MongoDB host.

- :doc:`Deploy the dedicated MongoDB instance(s) 
  </tutorial/prepare-backing-mongodb-instances>` 
  to host the Oplog Stores.

- Ensure the host running the |onprem| :term:`Backup Daemon` service has
  sufficient capacity to store the :term:`head` database.

- Secure the instance that stores your :term:`Oplog Stores <Oplog Store
  Database>` using :ref:`authentication <configure-auth-backing>` and
  :ref:`SSL <configure-ssl-backing>`. Oplog Stores support 
  `all authentication mechanisms 
  <https://docs.mongodb.com/manual/reference/connection-string/#urioption.authMechanism>`_.

.. _add-oplogstore:

Add a Oplog Store
-----------------

.. include:: /includes/steps/admin-add-oplogstore.rst

Edit an Existing Oplog Store
----------------------------

Once created, :term:`Oplog Stores <Oplog Store Database>` are listed directly
on the :guilabel:`Oplog Storage` page in a table. Each row contains the
settings for each Oplog Store.

.. include:: /includes/steps/admin-edit-oplogstore.rst

.. _delete-oplogstore:

Delete a Oplog Store
--------------------

.. include:: /includes/steps/admin-delete-oplogstore.rst
