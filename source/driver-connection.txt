==================
Connect via Driver
==================

.. default-domain:: mongodb

.. meta::
   :keywords: connect

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

The :guilabel:`Connect` dialog for a cluster provides the details to
connect to a cluster with an application using a
`MongoDB driver <https://docs.mongodb.com/ecosystem/drivers/>`_.

.. seealso:: :ref:`connection-limits`

Prerequisites
-------------

TLS/SSL
   Clients must have support for TLS/SSL to connect to an |service| cluster.

   Clients must have support for the `SNI
   <https://tools.ietf.org/html/rfc6066#section-3>`_ TLS extension to connect
   to an |service| ``M0`` Free Tier or ``M2/M5`` shared starter cluster.
   To verify that your driver supports the
   :abbr:`SNI (Server Name Indication)` TLS extension, refer to the
   `Driver Compatibility
   <https://docs.mongodb.com/ecosystem/drivers/driver-compatibility-reference/>`_
   matrix for your driver.
   Drivers which are compatible with MongoDB version 3.4 and up
   support the :abbr:`SNI (Server Name Indication)` TLS extension.

.. include:: /includes/fact-connection-prereq-whitelist.rst

.. include:: /includes/fact-connection-prereq-user.rst

Connect Your Application
------------------------

.. include:: /includes/steps/connect-to-cluster-driver.rst

Driver Examples
---------------

In the following example :manual:`URI connection strings
</reference/connection-string/>`, the user ``kay`` specifies their
password ``myRealPassword`` to authenticate and connect to an
|service| cluster.

Select your driver from the options below:

.. tabs-pillstrip:: languages

.. tabs-drivers::

   tabs:
     - id: c
       content: |

         .. note::

            .. include:: /includes/extracts/driver-free-tier-c.rst

         .. tabs::

            tabs:

            - id: mongodb3_6
              name: MongoDB Version 3.6 or later

              content: |

                .. code-block:: c

                   client = mongoc_client_new ("mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/?serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000");
                   db = mongoc_client_get_database (client, "test");

            - id: mongodb3_4
              name: MongoDB Version 3.4

              content: |

                .. code-block:: c

                   mongoc_client_t client = mongoc_client_new ("mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin&serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000");
                   db = mongoc_client_get_database (client, "test");

         .. list-table::
            :header-rows: 1

            * - MongoDB Version
              - Minimum Driver Version(s)

            * - MongoDB 4.0
              - :ref:`Version 1.11 or greater <reference-compatibility-mongodb-c>`

            * - MongoDB 3.6
              - :ref:`Version 1.9 or greater <reference-compatibility-mongodb-c>`

            * - MongoDB 3.4
              - :ref:`Version 1.5 or greater <reference-compatibility-mongodb-c>`

         Behavior
         ~~~~~~~~

         .. include:: /includes/extracts/c-driver-single-threaded.rst

     - id: cpp
       content: |

         .. note::

            .. include:: /includes/extracts/driver-free-tier-cpp.rst

         .. tabs::

            tabs:

            - id: mongodb3_6
              name: MongoDB Version 3.6 or later

              content: |

                .. code-block:: cpp

                   #include <mongocxx/client.hpp>
                   #include <mongocxx/instance.hpp>

                   //...

                   mongocxx::instance inst{};
                   mongocxx::client conn{mongocxx::uri{"mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/?ssl=true&authSource=admin&serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000"}};
                   mongocxx::database db = conn["test"];

            - id: mongodb3_4
              name: MongoDB Version 3.4

              content: |

                .. code-block:: cpp

                   #include <mongocxx/client.hpp>
                   #include <mongocxx/instance.hpp>

                   //...

                   mongocxx::instance inst{};
                   mongocxx::client conn{mongocxx::uri{"mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin&serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000"}};
                   mongocxx::database db = conn["test"];

         .. list-table::
            :header-rows: 1

            * - MongoDB Version
              - Minimum Driver Version(s)

            * - MongoDB 4.0
              - :ref:`Version 3.4.x <reference-compatibility-mongodb-cpp>`

            * - MongoDB 3.6
              - :ref:`Version 3.3.x <reference-compatibility-mongodb-cpp>`

            * - MongoDB 3.4
              - :ref:`Version 3.1.x <reference-compatibility-mongodb-cpp>`

         .. note::

            The Legacy C++ driver has reached End-Of-Life, and is no
            longer supported.

         Behavior
         ~~~~~~~~

         .. include:: /includes/extracts/cplus-driver-single-threaded.rst

     - id: csharp
       content: |

         .. note::

            .. include:: /includes/extracts/driver-free-tier-csharp.rst

         .. tabs::

            tabs:

            - id: mongodb3_6
              name: MongoDB Version 3.6 or later

              content: |

                .. code-block:: csharp

                   var client = new MongoClient("mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/?ssl=true&authSource=admin");
                   var database = client.GetDatabase("test");

            - id: mongodb3_4
              name: MongoDB Version 3.4

              content: |

                .. code-block:: csharp

                   var client = new MongoClient("mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin");
                   var database = client.GetDatabase("test");



         .. list-table::
            :header-rows: 1

            * - MongoDB Version
              - Minimum Driver Version(s)

            * - MongoDB 4.0
              - :ref:`Version 2.7 <reference-compatibility-mongodb-csharp>`

            * - MongoDB 3.6
              - :ref:`Version 2.5 <reference-compatibility-mongodb-csharp>`

            * - MongoDB 3.4
              - :ref:`Version 2.4 <reference-compatibility-mongodb-csharp>`

         .. note::

            The :abbr:`SNI (Server Name Indication)` TLS
            extension on Linux and OSX is only supported by
            .NET Core library versions *2.1 and greater*. Applications using prior versions of .NET Core on these
            operating systems cannot connect to a |service| ``M0``
            Free Tier or ``M2/M5`` shared tier cluster.

            For more information, see the
            `dotnet/corefx github page
            <https://github.com/dotnet/corefx/issues/9608>`_.

     - id: java-sync
       content: |

         .. note::

            .. include:: /includes/extracts/driver-free-tier-java.rst

         .. tabs::

            tabs:

            - id: mongodb3_6
              name: MongoDB Version 3.6 or later

              content: |

                .. code-block:: java

                   MongoClientURI uri = new MongoClientURI(
                       "mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/admin");

                   MongoClient mongoClient = new MongoClient(uri);
                   MongoDatabase database = mongoClient.getDatabase("test");

            - id: mongodb3_4
              name: MongoDB Version 3.4

              content: |

                .. code-block:: java

                   MongoClientURI uri = new MongoClientURI(
                       "mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin");

                   MongoClient mongoClient = new MongoClient(uri);
                   MongoDatabase database = mongoClient.getDatabase("test");


         .. list-table::
            :header-rows: 1

            * - MongoDB Version
              - Minimum Driver Version(s)

            * - MongoDB 4.0
              - :ref:`Version 3.8 or greater <reference-compatibility-mongodb-java>`

            * - MongoDB 3.6
              - :ref:`Version 3.6 or greater <reference-compatibility-mongodb-java>`

            * - MongoDB 3.4
              - :ref:`Version 3.4 or greater <reference-compatibility-mongodb-java>`

     - id: nodejs
       content: |

         .. note::

            .. include:: /includes/extracts/driver-free-tier-node.rst

         .. tabs::

            tabs:

            - id: mongodb3_6
              name: MongoDB Version 3.6 or later

              content: |

                  .. code-block:: javascript

                     const MongoClient = require('mongodb').MongoClient;
                     const uri = "mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/admin";
                     const client = new MongoClient(uri, { useNewUrlParser: true });
                     client.connect(err => {
                       const collection = client.db("test").collection("devices");
                      // perform actions on the collection object
                       client.close();
                     });

                  .. include:: /includes/extracts/connection-details-driver.rst

                  For example, the following connection string
                  specifies ``test`` in the database component and
                  includes the ``authSource=admin`` option.

                  .. code-block:: javascript

                     var uriTestDb = "mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/test?ssl=true&authSource=admin";
                     MongoClient.connect(uriTestDb, function(err, db) {
                        db.close();
                     });

            - id: mongodb3_4
              name: MongoDB Version 3.4

              content: |

                  .. code-block:: javascript

                     var MongoClient = require('mongodb').MongoClient;

                     var uri = "mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0";
                     MongoClient.connect(uri, function(err, client) {
                        const collection = client.db("test").collection("devices");
                        // perform actions on the collection object
                        client.close();
                     });

                  .. include:: /includes/extracts/connection-details-driver.rst

                  For example, the following connection string
                  specifies ``test`` in the database component and
                  includes the ``authSource=admin`` option.

                  .. code-block:: javascript

                     var uriTestDb = "mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/test?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin";
                     MongoClient.connect(uriTestDb, function(err, db) {
                        db.close();
                     });

         .. list-table::
            :header-rows: 1

            * - MongoDB Version
              - Minimum Driver Version(s)

            * - MongoDB 4.0
              - :ref:`Version 3.1 or greater <reference-compatibility-mongodb-node>`

            * - MongoDB 3.6
              - :ref:`Version 3.0 or greater <reference-compatibility-mongodb-node>`

            * - MongoDB 3.4
              - :ref:`Version 2.2.12 or greater <reference-compatibility-mongodb-node>`

     - id: perl
       content: |

         .. note::

            .. include:: /includes/extracts/driver-free-tier-perl.rst

         .. tabs::

            tabs:

            - id: mongodb3_6
              name: MongoDB Version 3.6 or later

              content: |

                  .. code-block:: perl

                     my $client = MongoDB->connect("mongodb+srv://kay:myRealPassword@cluster0.mongodb.net");
                     my $db = $client->get_database( 'test' );

            - id: mongodb3_4
              name: MongoDB Version 3.4

              content: |

                  .. code-block:: perl

                      my $client = MongoDB->connect("mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin&serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000");
                      my $db = $client->get_database( 'test' );

         .. list-table::
            :header-rows: 1

            * - MongoDB Version
              - Minimum Driver Version(s)

            * - MongoDB 4.0
              - :ref:`Version 3.1 or greater <reference-compatibility-mongodb-perl>`

            * - MongoDB 3.6
              - :ref:`Version 3.0 or greater <reference-compatibility-mongodb-perl>`

            * - MongoDB 3.4
              - :ref:`Version 2.2.12 or greater <reference-compatibility-mongodb-perl>`

         Behavior
         ~~~~~~~~

         .. include:: /includes/extracts/perl-driver-single-threaded.rst

     - id: php
       content: |

         .. note::

            .. include:: /includes/extracts/driver-free-tier-php.rst

         The following example uses the MongoDB PHP Library which provides a
         high-level abstraction around the lower-level PHP driver:

         .. tabs::

            tabs:

            - id: mongodb3_6
              name: MongoDB Version 3.6 or later

              content: |

                .. code-block:: php

                   $client = new MongoDB\Client(
                       'mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/?ssl=true&authSource=admin&serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000"');

                   $db = $client->test;

            - id: mongodb3_4
              name: MongoDB Version 3.4

              content: |

                .. code-block:: php

                   $client = new MongoDB\Client(
                       'mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin&serverSelectionTryOnce=false&serverSelectionTimeoutMS=15000"');

                   $db = $client->test;

         .. list-table::
            :header-rows: 1

            * - MongoDB Version
              - Minimum Driver Version(s)

            * - MongoDB 4.0
              - :ref:`PHPLIB 1.4 + mongodb-1.5 <reference-compatibility-mongodb-php>`

            * - MongoDB 3.6
              - :ref:`PHPLIB 1.3 + mongodb-1.3 <reference-compatibility-mongodb-php>`

            * - MongoDB 3.4
              - :ref:`PHPLIB 1.1 + mongodb-1.1 <reference-compatibility-mongodb-php>`

         Behavior
         ~~~~~~~~

         .. include:: /includes/extracts/php-driver-single-threaded.rst

     - id: python
       content: |

         .. note::

            .. include:: /includes/extracts/driver-free-tier-python.rst

         .. tabs::

            tabs:

            - id: mongodb3_6
              name: MongoDB Version 3.6 or later

              content: |

                 .. code-block:: python

                    import pymongo
                    import dns # required for connecting with SRV

                    client = pymongo.MongoClient("mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/admin")
                    db = client.test

            - id: mongodb3_4
              name: MongoDB Version 3.4

              content: |

                 .. code-block:: python

                    import pymongo

                    client = pymongo.MongoClient("mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin")
                    db = client.test

         .. list-table::
            :header-rows: 1

            * - MongoDB Version
              - Minimum Driver Version(s)

            * - MongoDB 4.0
              - :ref:`Version 3.7 or greater <reference-compatibility-mongodb-python>`

            * - MongoDB 3.6
              - :ref:`Version 3.6 or greater <reference-compatibility-mongodb-python>`

            * - MongoDB 3.4
              - :ref:`Version 3.4 or greater <reference-compatibility-mongodb-python>`

         .. admonition:: macOSX and Python 3.6 Installers

            The Python 3.6 installers for macOS from
            `<https://www.python.org>`_ do not automatically install
            any CA certificates. Without installed CA certificates,
            connections to |service| will fail certificate
            verification.

            After you run the installer from
            `<https://www.python.org>`_ to install Python 3.6, you
            must run the following script to install an up-to-date CA
            bundle before connecting to |service|:

            .. code-block:: sh

               open "/Applications/Python 3.6/Install Certificates.command"

            For more information on Python 3.6 installers for macOS
            from `<https://www.python.org>`_, see
            `<https://bugs.python.org/issue29065#msg283984>`_. Earlier
            versions of Python as well as Python 3.6 installed by
            other means (e.g. `Homebrew
            <https://brew.sh/#install>`__), are not affected.

     - id: ruby
       content: |

         .. note::

            .. include:: /includes/extracts/driver-free-tier-ruby.rst

         .. tabs::

            tabs:

            - id: mongodb3_6
              name: MongoDB Version 3.6 or later

              content: |
                 .. code-block:: ruby

                    client = Mongo::Client.new('mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/?ssl=true')

                 .. include:: /includes/extracts/connection-details-driver.rst

                 For example, the following connection string specifies ``test`` in the
                 database component and includes the ``authSource=admin`` option.

                 .. code-block:: ruby

                    client = Mongo::Client.new('mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/test?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin')

            - id: mongodb3_4
              name: MongoDB Version 3.4

              content: |

                 .. code-block:: ruby

                    client = Mongo::Client.new('mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0')

                 .. include:: /includes/extracts/connection-details-driver.rst

                 For example, the following connection string specifies ``test`` in the
                 database component and includes the ``authSource=admin`` option.

                 .. code-block:: ruby

                    client = Mongo::Client.new('mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/test?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin')

         .. list-table::
            :header-rows: 1

            * - MongoDB Version
              - Minimum Driver Version(s)
            * - MongoDB 4.0
              - :ref:`Version 2.6 or greater <reference-compatibility-mongodb-ruby>`
            * - MongoDB 3.6
              - :ref:`Version 2.5 or greater <reference-compatibility-mongodb-ruby>`
            * - MongoDB 3.4
              - :ref:`Version 2.4 or greater <reference-compatibility-mongodb-ruby>`

         Mongoid Example
         ~~~~~~~~~~~~~~~

         .. code-block:: yaml

            production:
              # Configure available database clients. (required)
              clients:
                # Defines the default client. (required)
                default:
                  # Defines the name of the default database that Mongoid can connect to.
                  # (required).
                  database: 'myDatabaseName'

                  # Provides the hosts the default client can connect to. Must be an array
                  # of host:port pairs. (required)
                  hosts:
                    - mycluster0-shard-00-00.mongodb.net:27017
                    - mycluster0-shard-00-01.mongodb.net:27017
                    - mycluster0-shard-00-02.mongodb.net:27017
                  options:
                    # The name of the user for authentication.
                    user: kay

                    # The password of the user for authentication.
                    password: myRealPassword

                    # The database or source to authenticate the user against. If the database
                    # specified above is not admin, admin MUST be specified here.
                    auth_source: admin

                    # All Atlas servers use SSL. (default: false)
                    ssl: true

         .. list-table::
            :header-rows: 1

            * - MongoDB Version
              - Minimum ODM Version

            * - MongoDB 4.0

              - `Version 7.0.0 or greater <https://docs.mongodb.com/mongoid/7.0/>`_

            * - MongoDB 3.6

              - `Version 6.3.0 or greater <https://docs.mongodb.com/mongoid/6.3/>`_

            * - MongoDB 3.4

              - `Version 6.1.0 or greater <https://docs.mongodb.com/mongoid/6.1/>`_

     - id: scala
       content: |

         .. note::

            .. include:: /includes/extracts/driver-free-tier-scala.rst

         .. tabs::

            tabs:

            - id: mongodb3_6
              name: MongoDB Version 3.6 or later

              content: |
                 .. code-block:: scala

                    val uri: String = "mongodb+srv://kay:myRealPassword@cluster0.mongodb.net/?ssl=true&authSource=admin"
                    System.setProperty("org.mongodb.async.type", "netty")
                    val client: MongoClient = MongoClient(uri)
                    val db: MongoDatabase = client.getDatabase("test")

            - id: mongodb3_4
              name: MongoDB Version 3.4

              content: |

                 .. code-block:: scala

                    val uri: String = "mongodb://kay:myRealPassword@mycluster0-shard-00-00.mongodb.net:27017,mycluster0-shard-00-01.mongodb.net:27017,mycluster0-shard-00-02.mongodb.net:27017/admin?ssl=true&replicaSet=Mycluster0-shard-0&authSource=admin"
                    System.setProperty("org.mongodb.async.type", "netty")
                    val client: MongoClient = MongoClient(uri)
                    val db: MongoDatabase = client.getDatabase("test")

         .. list-table::
            :header-rows: 1

            * - MongoDB Version
              - Minimum Driver Version(s)
            * - MongoDB 4.0
              - :ref:`Version 2.4 or greater <reference-compatibility-mongodb-scala>`
            * - MongoDB 3.6
              - :ref:`Version 2.2 or greater <reference-compatibility-mongodb-scala>`
            * - MongoDB 3.4
              - :ref:`Version 1.2 or greater <reference-compatibility-mongodb-scala>`

Troubleshooting
---------------

.. include:: /includes/fact-connection-troubleshooting.rst
