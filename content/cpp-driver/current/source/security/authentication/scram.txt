.. _cpp-authentication-scram:


====================
SCRAM Authentication
====================

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. facet::
    :name: genre
    :values: reference

.. meta::
    :keywords: salt, default, code example

Overview
--------

**Salted Challenge Response Authentication Mechanism (SCRAM)** is a family of
authentication mechanisms that use a challenge-response mechanism to authenticate
the user. SCRAM-SHA-256, as defined by `RFC 7677 <https://tools.ietf.org/html/rfc7677>`__
, uses the SHA-256 algorithm to hash your password, is the
default authentication mechanism for deployments running MongoDB v.4.0 or later. 
SCRAM-SHA-1, as defined by `RFC 5802 <https://tools.ietf.org/html/rfc5802>`__, 
is  supported for compatibility with deployments running MongoDB v3.6.

You can use SCRAM to authenticate to MongoDB Atlas, MongoDB
Enterprise Advanced, and MongoDB Community Edition.

.. tip:: SCRAM Mechanisms

   To learn more about the SCRAM family of authentication mechanisms, see
   `RFC 5802 <https://tools.ietf.org/html/rfc5802>`__ and
   :wikipedia:`Salted Challenge Response Authentication Mechanism <Salted_Challenge_Response_Authentication_Mechanism>`
   on Wikipedia.

   For more information about the MongoDB implementation of SCRAM, see
   :manual:`SCRAM </core/security-scram>` in the {+mdb-server+} manual.

Code Placeholders 
~~~~~~~~~~~~~~~~~

The code examples on this page use the following placeholders:  

- ``<db_username>``: The MongoDB database username of the user to authenticate.
- ``<db_password>``: The MongoDB database password of the user to authenticate.
- ``<hostname>``: The network address of your MongoDB deployment.
- ``<port>``: The port number of your MongoDB deployment. If you omit this parameter,
  the driver uses the default port number (``27017``). You don't need a port number
  when connecting to a MongoDB Atlas cluster.

To use the code examples on this page, replace these
placeholders with your own values.

Using SCRAM Authentication in Your Application
----------------------------------------------

To use SCRAM to authenticate your MongoDB user, specify your MongoDB username
and password in the connection URI along with the ``authSource`` and 
``authMechanism`` parameters. The examples on this page use ``authSource=admin``, 
which is the default authentication database, and set ``authMechanism`` to either 
``SCRAM-SHA-256`` or ``SCRAM-SHA-1``.

You can connect in the following ways:

- By using a connection URI alone
- By using a connection URI with Transport Layer Security (TLS) options configured
  in a ``mongocxx::options::client`` object

The following tabs show examples for both SCRAM-SHA-256 and SCRAM-SHA-1, for
both TLS and non-TLS connections. Select the tab that matches the authentication
mechanism and connection method you want to use.

.. tabs::

    .. tab:: SCRAM-SHA-256
        :tabid: scram-sha-256

        .. literalinclude:: /includes/authentication.cpp
            :language: cpp
            :copyable: true
            :start-after: // start-scram-sha-256
            :end-before: // end-scram-sha-256

    .. tab:: SCRAM-SHA-256 with TLS
        :tabid: scram-sha-256-tls

        .. literalinclude:: /includes/authentication.cpp
            :language: cpp
            :copyable: true
            :start-after: // start-scram-sha-256-tls
            :end-before: // end-scram-sha-256-tls

    .. tab:: SCRAM-SHA-1
        :tabid: scram-sha-1

        .. literalinclude:: /includes/authentication.cpp
            :language: cpp
            :copyable: true
            :start-after: // start-scram-sha-1
            :end-before: // end-scram-sha-1

    .. tab:: SCRAM-SHA-1 with TLS
        :tabid: scram-sha-1-tls

        .. literalinclude:: /includes/authentication.cpp
            :language: cpp
            :copyable: true
            :start-after: // start-scram-sha-1-tls
            :end-before: // end-scram-sha-1-tls

API Documentation
-----------------

To learn more about creating a ``mongocxx::client`` object in {+driver-short+},
see the following API documentation:

- `mongocxx::client
  <{+api+}/classmongocxx_1_1v__noabi_1_1client.html>`__ 
- `mongocxx::options::client <{+api+}/classmongocxx_1_1v__noabi_1_1options_1_1client.html>`__
- `mongocxx::options::tls <{+api+}/classmongocxx_1_1v__noabi_1_1options_1_1tls.html>`__

