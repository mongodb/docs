.. _daemons-interface:

=======
Daemons
=======

.. include:: /includes/styles/corrections.rst

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

This page lists all active :term:`Backup Daemons <Backup Daemon>` and
provides configuration options. |onprem| automatically detects Backup
Daemons and displays them here. You can reconfigure daemons from this
page. Changes can take up to 5 minutes to take effect.

Click :guilabel:`Pre-Configure New Daemon` at the bottom of the page if
you want to add a daemon but do not want it to take new jobs. Type the
``<machine>:<roothead path>`` in the text field above
:guilabel:`Pre-Configure New Daemon`. Click the button to configure the
new Backup Daemon.

For each daemon, the page lists the server name, configuration,
:term:`head <head database>` space used, head space free, the number of
replica sets backed up, the percentage of time the Backup Daemon
Service was busy, and job runtime counts by 1 minute, 10 minutes,
60 minutes, less than or equal to 180 minutes, and greater than 180
minutes.

The page includes the following fields and links to manage and
configure daemons:

.. These table fields are internal only:
   Queryable Restore Jobs, Archive Jobs, Git Commit Hash: internal

.. list-table::
   :header-rows: 1
   :stub-columns: 1
   :widths: 20 80

   * - Field
     - Description

   * - :guilabel:`Show Detailed JSON`
     - Displays the Backup Daemon JSON. When the JSON displays, the
       :guilabel:`View raw runtime data` link appears under the code,
       allowing you to view the raw data.

   * - :guilabel:`Move all heads`
     - Moves all the Backup Daemon jobs that live on this daemon to a
       new daemon location.

       #. Click the link.
       #. Click the location.
       #. Click :guilabel:`Move all heads`.

   * - :guilabel:`Delete Daemon`
     - Deletes a Backup Daemon.

   * - :guilabel:`Assignment`
     - Allows the daemon to process more jobs. If the daemon's disk
       fills, clear this so the host is not overloaded.

   * - :guilabel:`Backup Jobs`
     - Allows the daemon to process more backup jobs. Clear this when
       performing maintenance on a daemon's host.

   * - :guilabel:`Resource Usage`
     - Collects information on :term:`blockstore` use (i.e., which
       snapshots still reference how many blocks). |onprem| uses this
       information to generate the :ref:`resource-usage-page` page and
       to prioritize garbage collection.

       .. note::

          If this |onprem| instance is running as a dedicated restore
          daemon host, you may want to clear this checkbox to ensure
          the fastest possible restore time.

   * - :guilabel:`Garbage Collection`
     - Allows the daemon to schedule :term:`groom` jobs to remove
       unused blocks and expired snapshots.

       .. note::

          If this |onprem| instance is running as a dedicated restore
          daemon host, you may want to clear this checkbox to ensure
          the fastest possible restore time.

   * - :guilabel:`Head Disk Type`
     - Indicates whether the disk type is |ssd| or |hdd|. If you change
       a daemon to |ssd|, then only jobs with an :term:`oplog` greater
       than 1GB/hour will go to this daemon unless no |hdd| daemon is
       available. Jobs with an oplog less than 1 GBph can go to this
       daemon only if no |hdd| daemon is available.

   * - :guilabel:`Assignment Labels`
     - Creates one or more labels that can be used to assign the daemon
       to a specific group.

   * - :guilabel:`Number of Workers`
     - Number of concurrent backup tasks processed at a time.

       .. include:: /includes/extracts/queryable-backup-workers.rst
