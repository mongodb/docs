[build]
    publish = "dist"
    base = "content/mongoid"

[build.environment]
    REPO_NAME = "docs-mongoid"
    SECRETS_SCAN_ENABLED = "false"
    MUT_COMMANDS_ENABLED = "false"


[context.production.environment]
    ENV = "dotcomprd"

[context.preprd.environment]
    ENV = "dotcomstg"

[context.deploy-preview.environment]
    ENV = "prd"

[context.branch-deploy.environment]
    ENV = "prd"

[context.preview-server.environment]
    ENV = "prd"

[context.dev.environment]
    ENV = "stg"




### OFFLINE REDIRECTS
### ALIAS REDIRECTS
### WILDCARD REDIRECTS (none)
### PAGE-SPECIFIC REDIRECTS (none)
### CATCH ALLS
 ##redirects any pages not at any of the active versions to current (makes eols technically unnecessary)


### OFFLINE REDIRECTS 
    [[redirects]]
    from = "/docs/mongoid/v8.1/*"
    to = "/docs/mongoid/current/:splat"

### ALIAS REDIRECTS
    [[redirects]]
    from = "/docs/mongoid/master/*"
    to = "/docs/mongoid/upcoming/:splat"

    [[redirects]]
    from = "/docs/mongoid/v9.0/*"
    to = "/docs/mongoid/current/:splat"
    status = 302

### PAGE-LEVEL REDIRECTS
##CURRENT
    [[redirects]] 
    from = "/docs/mongoid/current/reference/configuration/configuration-options/"
    to = "/docs/mongoid/current/"

[[redirects]] 
from = "/docs/mongoid/current/reference/sharding/indexes/"
to = "/docs/mongoid/current/reference/indexes/"

[[redirects]] 
from = "/docs/mongoid/current/reference/text-search/indexes/"
to = "/docs/mongoid/current/reference/indexes/"

[[redirects]] 
from = "/docs/mongoid/current/release-notes/mongoid-7.0/"
to = "/docs/mongoid/current/"

##UPCOMING
[[redirects]] 
from = "/docs/mongoid/upcoming/api/Mongoid/Document.html/"
to = "/docs/mongoid/current/api/Mongoid/Document.html/"


### WILDCARD REDIRECTS
    [[redirects]] 
    from = "/docs/mongoid/:version/installation-configuration/"
    to = "/docs/mongoid/:version/configuration/app-config/"
    
    [[redirects]] 
    from = "/docs/mongoid/:version/additional-resources/"
    to = "/docs/mongoid/:version/integrations-tools/external-resources/"

    [[redirects]] 
    from = "/docs/mongoid/:version/api/BSON/ObjectId.html/"
    to = "/docs/mongoid/:version/api/Mongoid/Extensions/ObjectId.html/"

    [[redirects]] 
    from = "/docs/mongoid/:version/api/Mongoid/Association/Referenced/NestedAttributes.html/"
    to = "/docs/mongoid/:version/api/Mongoid/Association/Referenced.html/"

    [[redirects]] 
    from = "/docs/mongoid/:version/api/Mongoid/Association/Referenced/NestedAttributes/One.html/"
    to = "/docs/mongoid/:version/api/Mongoid/Association/Nested/One.html/"

    [[redirects]] 
    from = "/docs/mongoid/:version/api/Mongoid/Config/Introspection.html/"
    to = "/docs/mongoid/:version/api/Mongoid/Config.html/"

    [[redirects]] 
    from = "/docs/mongoid/:version/api/Mongoid/Config/Introspection/Option.html/"
    to = "/docs/mongoid/:version/api/Mongoid/Config.html/"

    [[redirects]] 
    from = "/docs/mongoid/:version/api/Mongoid/Criteria/Inspectable.html/"
    to = "/docs/mongoid/:version/api/Mongoid/Criteria.html/"

    [[redirects]] 
    from = "/docs/mongoid/:version/api/Mongoid/Errors/InvalidStorageParent.html/"
    to = "/docs/mongoid/:version/api/"

    [[redirects]] 
    from = "/docs/mongoid/:version/api/Post.html/"
    to = "/docs/mongoid/:version/api/"

    [[redirects]] 
    from = "/docs/mongoid/:version/compatibility/"
    to = "/docs/mongoid/:version/reference/compatibility/"

    [[redirects]] 
    from = "/docs/mongoid/:version/contributing/code-documentation/"
    to = "/docs/mongoid/:version/code-documentation/"

    [[redirects]] 
    from = "/docs/mongoid/:version/contributing/contributing-guidelines/"
    to = "/docs/mongoid/:version/issues-and-help/"

    [[redirects]] 
    from = "/docs/mongoid/:version/ecosystem/"
    to = "/docs/mongoid/:version/integrations-tools/external-resources/"

    [[redirects]] 
    from = "/docs/mongoid/:version/installation/"
    to = "/docs/mongoid/:version/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/aggregation/"
    to = "/docs/mongoid/:version/interact-data/aggregation/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/associations/"
    to = "/docs/mongoid/:version/data-modeling/associations/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/callbacks/"
    to = "/docs/mongoid/:version/data-modeling/callbacks/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/collection-configuration/"
    to = "/docs/mongoid/:version/configuration/collection-config/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/configuration/"
    to = "/docs/mongoid/:version/configuration/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/crud/"
    to = "/docs/mongoid/:version/interact-data/crud/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/fields/"
    to = "/docs/mongoid/:version/data-modeling/field-types/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/indexes/"
    to = "/docs/mongoid/:version/data-modeling/indexes/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/inheritance/"
    to = "/docs/mongoid/:version/data-modeling/inheritance/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/map-reduce/"
    to = "/docs/mongoid/:version/interact-data/aggregation/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/nested-attributes/"
    to = "/docs/mongoid/:version/interact-data/nested-attributes/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/persistence-configuration/"
    to = "/docs/mongoid/:version/configuration/persistence-config/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/queries/"
    to = "/docs/mongoid/:version/interact-data/specify-query/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/rails-integration/"
    to = "/docs/mongoid/:version/integrations-tools/rails-integration/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/sessions/"
    to = "/docs/mongoid/:version/interact-data/transaction/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/sharding/"
    to = "/docs/mongoid/:version/configuration/sharding/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/text-search/"
    to = "/docs/mongoid/:version/interact-data/text-search/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/transactions/"
    to = "/docs/mongoid/:version/interact-data/transaction/"

    [[redirects]] 
    from = "/docs/mongoid/:version/reference/validation/"
    to = "/docs/mongoid/:version/data-modeling/validation/"

    [[redirects]] 
    from = "/docs/mongoid/:version/release-notes/mongoid-8.0/"
    to = "/docs/mongoid/:version/reference/release-notes/"

    [[redirects]] 
    from = "/docs/mongoid/:version/release-notes/mongoid-9.0/"
    to = "/docs/mongoid/:version/reference/release-notes/"

    [[redirects]] 
    from = "/docs/mongoid/:version/release-notes/upgrading/"
    to = "/docs/mongoid/:version/reference/release-notes/"

    [[redirects]] 
    from = "/docs/mongoid/:version/tutorials/"
    to = "/docs/mongoid/:version/"

    [[redirects]] 
    from = "/docs/mongoid/:version/tutorials/automatic-encryption/"
    to = "/docs/mongoid/:version/security/encryption/"

    [[redirects]] 
    from = "/docs/mongoid/:version/tutorials/common-errors/"
    to = "/docs/mongoid/:version/"

    [[redirects]] 
    from = "/docs/mongoid/:version/tutorials/documents/"
    to = "/docs/mongoid/:version/data-modeling/documents/"

    [[redirects]] 
    from = "/docs/mongoid/:version/tutorials/getting-started-rails6/"
    to = "/docs/mongoid/:version/quick-start-rails/"

    [[redirects]] 
    from = "/docs/mongoid/:version/tutorials/getting-started-rails7/"
    to = "/docs/mongoid/:version/quick-start-rails/"

    [[redirects]] 
    from = "/docs/mongoid/:version/tutorials/getting-started-sinatra/"
    to = "/docs/mongoid/:version/quick-start-sinatra/"

    [[redirects]] 
    from = "/docs/mongoid/:version/whats-new/"
    to = "/docs/mongoid/:version/reference/release-notes/"

    #Online versions: dict_keys(['upcoming', 'current'])
    ### CATCH ALLS (Redirects any /docs/mongoid/ page that would've 404ed to the version's landing page)
    [[redirects]]
    from = "/docs/mongoid/upcoming/*"
    to = "/docs/mongoid/intermediary/upcoming/:splat"
    status = 302

    [[redirects]]
    from = "/docs/mongoid/intermediary/upcoming/*"
    to = "/docs/mongoid/upcoming"
    status = 302
    
    [[redirects]]
    from = "/docs/mongoid/current/*"
    to = "/docs/mongoid/intermediary/current/:splat"
    status = 302

    [[redirects]]
    from = "/docs/mongoid/intermediary/current/*"
    to = "/docs/mongoid/current"
    status = 302
    
### CATCH ALLS (add slug to paths without slug)
    [[redirects]]
    from = "/docs/mongoid/upcoming/*"
    to = "/docs/mongoid/upcoming/:splat"
    status = 200
    
    [[redirects]]
    from = "/docs/mongoid/current/*"
    to = "/docs/mongoid/current/:splat"
    status = 200
    
    [[redirects]]
    from = "/docs/mongoid/*"
    to = "/docs/mongoid/current/:splat"