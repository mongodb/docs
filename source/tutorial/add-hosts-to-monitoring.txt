.. _tutorial-monitoring:

===========================
Add Hosts to MMS Monitoring
===========================

.. default-domain:: mongodb

.. start-content

The Monitoring agent automatically discovers MongoDB processes based on
existing cluster configuration. You'll have to manually seed at
least one of these hosts from the MMS console.

.. index:: adding hosts
   single: hosts; adding

To add a host to |monitoring|, click the :guilabel:`+ ADD HOST` button at the
top of the Hosts page. This displays the :guilabel:`New Host` interface. Enter
the hostname, port, and optionally an ``admin`` database username and
password. Then select :guilabel:`Add` to submit data.

If the host is only accessible by specific hostname or IP address, or
you need to specify the hostname to use for servers with multiple aliases, set up a
preferred hostname. See the :ref:`Preferred Hostnames
<group-settings-preferred-hostnames>` section for details.

.. index:: host discovery
   single: hosts; discovery

Once it has a seed host, the Monitoring agent will discover any other
nodes from associated clusters. These clusters, and their respective
seed hosts, include:

- Master databases, after adding slave databases.

- Shard clusters, after adding ``mongos`` instances.

- Replica sets, after adding any member of the set.

Once you add these seed nodes, the Monitoring agent will fetch this
information *from* the MMS servers. Thus, when configuring the
monitoring environment, you may need to wait for several update cycles
(e.g. 5-10 minutes) to complete the auto-discovery process and host
identification. During this period, you may see duplicate hosts in the
MMS web console. This is normal.

The Monitoring agent fetches configuration and reports to |monitoring| every
minute, so, again, there may be a delay of several minutes before data
and host information propagate to the MMS console.

.. include:: /images/mms-deployment.rst

You can find immediate evidence of a working installation in the agent output
or logs. For more information, check the MMS console's :guilabel:`Monitoring
Agent Log` tab on the :guilabel:`Hosts` page, as well as the :guilabel:`Last
Ping` and :guilabel:`Daily Pings` tabs visible when you click a hostname on the
:guilabel:`Hosts`, :guilabel:`Mongos`, and :guilabel:`Configs` tabs on the
:guilabel:`Hosts` page. Once |monitoring| has data, you can view and begin
using the statistics.

.. index:: agent timeout
   single: agent; timeout
   single: timeout

If the agent cannot collect information about a host for 24 hours, the
|monitoring| system deactivates the instance in the Monitoring agent and
console. Deactivated hosts must be manually reactivated from the MMS
console if you wish to collect data from these `hosts`.

.. end-content
