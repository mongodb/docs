.. _create-cluster-more-configuration-options:

============================
Configure Additional Options
============================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol


You can configure the following |mongod| runtime options on ``M10+``
paid tier clusters.

Considerations
--------------

|service| dynamically modifies the :guilabel:`Oplog Size` for replica
sets and sharded clusters. However, for the :guilabel:`Minimum TLS
Protocol Version` and :guilabel:`Allow Server-Side JavaScript`
settings, it performs a rolling restart of the shard members
and the config server replica set. To learn more about how |service|
supports high availability during maintenance operations, see
:ref:`high-availability`.

Locate Additional Settings
--------------------------

To view these settings, open the :guilabel:`More Configuration Options`
under :guilabel:`Additional Settings` in the cluster form.

.. _set-oplog-size:

Set Oplog Size
--------------

Modify the :term:`oplog` size of the cluster.

For sharded cluster deployments, this modifies the oplog size of each
shard in the cluster.

This option corresponds to modifying the
:setting:`replication.oplogSizeMB` configuration file option for each
|mongod| in the cluster.

Specify your desired :guilabel:`Oplog Size` in megabytes in the
input box.

.. warning::

   Reducing the size of the oplog requires removing data from the
   oplog. |service| cannot access or restore any oplog entries removed
   as a result of oplog reduction. Consider the ramifications of this
   data loss before reducing the oplog.

.. important::

   - You can't set the oplog to less than 990 megabytes.
   - |service| places no upper limit in megabytes on the oplog.
     However, |service| returns an error if the oplog size you choose 
     leaves your cluster's disk with less than 25 percent of its 
     capacity free.

To check the oplog size:

1. Connect to your cluster via {+mongosh+}.
2. Authenticate as a user with the :atlasrole:`Atlas admin` role.
3. Run the :method:`rs.printReplicationInfo() <rs.printReplicationInfo>` method.

|service| displays the current oplog size and time.

Disk Space Considerations
~~~~~~~~~~~~~~~~~~~~~~~~~

*Don't* reduce the size of the oplog as a means of increasing
available disk space. Only the oplog collection (``local.oplog.rs``)
can reclaim the space saved by reducing the oplog size. Other
collections do not benefit from reducing oplog storage.

Enforce Index Key Limit
-----------------------

Enable or disable enforcement of the 1024-byte index key limit.
Documents can only be updated or inserted if, for all indexed fields on
the target collection, the corresponding index entries do not exceed
1024 bytes.

If disabled, |mongod| writes documents that breach the limit but
*doesn't* index them. This option corresponds to modifying the
:parameter:`failIndexKeyTooLong <param.failIndexKeyTooLong>`
parameter via the :dbcommand:`setParameter` command for each |mongod|
in the cluster.

.. include:: /includes/admonitions/removed-fail-index-key-too-long.rst

Allow Server-Side JavaScript
----------------------------

.. include:: /includes/fact-javascriptEnabled-description.rst

.. include:: /includes/admonitions/changed-javascript-enabled-mongos.rst

Set Minimum TLS Protocol Version
--------------------------------

Sets the minimum TLS version the cluster accepts for incoming
connections. This option corresponds to configuring the
:setting:`net.ssl.disabledProtocols` configuration file option
for each |mongod| in the cluster.

.. note:: TLS 1.0 Deprecation

   For users considering this option as a method for enabling the
   deprecated Transport Layer Security (TLS) 1.0 protocol version, please read
   :ref:`faq-tls-1.0-deprecation` before proceeding. |service|
   deprecation of TLS 1.0 improves your security of data-in-transit
   and aligns with industry best practices. Enabling TLS 1.0 for any
   |service| cluster carries security risks. Consider enabling TLS
   1.0 only for as long as required to update your application stack
   to support TLS 1.1 or later.

Require Indexes for All Queries
-------------------------------

Enable or disable the execution of queries that require a collection
scan to return results. This option corresponds to modifying the
:parameter:`notablescan <param.notablescan>` parameter via the
:dbcommand:`setParameter` command for each |mongod| in
the cluster.

Default Read Concern
--------------------

Sets the 
:manual:`default level of acknowledgment requested from MongoDB for read operations </reference/read-concern/>`
for this cluster.

MongoDB 4.4 clusters default to :manual:`available </reference/read-concern-available>`.

MongoDB 5.0 clusters default to :manual:`local </reference/read-concern-local>`.

Default Write Concern
---------------------

Sets the 
:manual:`default level of acknowledgment requested from MongoDB for write operations </reference/write-concern/>`
for this cluster.


MongoDB 4.4 clusters default to :manual:`1 </reference/write-concern>`.

MongoDB 5.0 clusters default to :manual:`majority </reference/write-concern>`.
