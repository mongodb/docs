stepnum: 1
level: 4
source:
  file: steps-source-upgrade-onprem.yaml
  ref: shutdown
pre: |
  For platforms that use `systemd <https://freedesktop.org/wiki/Software/systemd>`_ (RHEL, CentOS, SUSE12):
post: |
  For platforms that use ``SysVInit`` (Amazon Linux):

  .. code-block:: sh

     sudo /etc/init.d/mongodb-mms stop
---
stepnum: 2
level: 4
# Note: This step is borrowed from the rpm install procedure, not from steps-source-upgrade.
source:
  file: steps-install-on-prem-with-rpm-packages.yaml
  ref: download
---
title: "Install the |onprem| package on each server being used for |onprem| services."
stepnum: 3
level: 4
ref: install
content: |

  Install the ``.rpm`` package on each |application| server by issuing
  the following command, where ``<version>`` is the version of the
  ``.rpm`` package:

  .. code-block:: sh

     sudo rpm -Uvh mongodb-mms-<version>.x86_64.rpm

  The ``rpm`` upgrade preserves the existing ``conf-mms.properties``
  configuration file and names the new configuration file
  ``conf-mms.properties.rpmnew``. Both are located in
  ``/opt/mongodb/mms/conf/``.

---
stepnum: 4
level: 4
source:
  file: steps-source-upgrade-onprem.yaml
  ref: start
pre: |
  For platforms that use `systemd <https://freedesktop.org/wiki/Software/systemd>`_ (RHEL, CentOS, SUSE12):
post: |
  For platforms that use ``SysVInit`` (Amazon Linux):

  .. code-block:: sh

     sudo /etc/init.d/mongodb-mms start

---
stepnum: 5
level: 4
source:
  file: steps-source-upgrade-onprem.yaml
  ref: upgrade-install-agents

...
