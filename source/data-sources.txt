:noprevnext:

============
Data Sources
============

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Data sources in |charts| reference a :ref:`collection <collections>`
or :ref:`view <3.4-reference-views>` in your MongoDB
deployment. When building a chart, you will need to specify the data
source that the chart uses.

To view, add, or remove data sources, click :guilabel:`Data Sources` on
the top navigation bar.

.. _data-sources-view:

Data Sources View
-----------------

The :guilabel:`Data Sources` view displays existing data sources that
the currently logged-in user has permission to view. The data sources
are displayed in a tabular format with the following columns:

.. figure:: /images/charts/data-sources-saas.png
   :alt: Diagram of the "Data Sources" view
   :figwidth: 750px

.. list-table::
   :header-rows: 1
   :widths: 38 72

   * - Column
     - Description

   * - :guilabel:`Deployment`
     - The MongoDB deployment containing the source database and
       collection. Identified by the |service| cluster associated
       with the |charts-short| instance.

   * - :guilabel:`Database`
     - The database containing the source collection or view.

   * - :guilabel:`Collection`
     - The collection or view from where |charts-short| retrieves data.

   * - :guilabel:`Alias`
     - Optional. The display name of the data source used by the
       Chart Builder. Providing an :guilabel:`Alias` may result in a
       shorter and more identifiable name when selecting a data source
       in the :doc:`chart builder </build-charts>`.

       To modify the :guilabel:`Alias` for a data source, see the
       :ref:`Modify a Data Source <mod-data-source-alias>`
       section.

   * - :guilabel:`Last modified`
     - The date the data source was last modified.

   * - :guilabel:`Permissions`
     - The icon next to the :guilabel:`Access` button denotes the
       :ref:`permissions <permission-model>` you have on the data
       source. For details on the various data source permissions, see
       :ref:`Data Source Permissions <permission-model>`.

       To modify the permissions for a data source, see the
       :ref:`Modify a Data Source <mod-data-source-permissions>`
       section.

.. note::

   You can sort data sources by any of the columns by clicking on the
   column header.

.. _filter-data-sources:

Filter Data Sources
~~~~~~~~~~~~~~~~~~~

To search for specific data sources, use the search bar at the
upper right corner of the :guilabel:`Data Sources` view. You can search
by :guilabel:`Deployment`, :guilabel:`Database`,
:guilabel:`Collection`, or :guilabel:`Alias`.

Additionally, you can use the dropdown to the left of the search bar to
show either all data sources on your |charts| deployment, or only data
sources for which you have the ``Owner`` permission. For more
information on data source permissions, see
:ref:`Data Source Permissions <permission-model>`.

.. _add-data-source:

Add a Data Source
-----------------

1. From the :guilabel:`Data Sources` view, click the
   :guilabel:`New Data Source` button.

#. Select one of the |service| clusters.

   |service| displays all clusters in the current project for which
   the current user has the :authrole:`Project Data Access Read Only`
   role or higher.

#. Click :guilabel:`Connect`.

#. Select the collections from which you wish to create data sources.
   |charts-short| creates a separate data source for each selected
   collection.

#. Click :guilabel:`Set Permissions`.

#. Set the :ref:`permissions <permission-model>` for the data source.

   By default, |service| assigns the :ref:`Reader <data-source-roles>`
   permission to every user in the project. To change a user's permission,
   search for the user by name or email address using the search bar.

#. Click :guilabel:`Publish Data Source`.

   .. note::

      If you selected multiple collections for your data source in step
      4, the data source :ref:`permissions <permission-model>` you
      select are applied to all of the selected collections when you
      publish your data source. If you wish to apply different
      permissions to individual collections that you have selected, you
      will need to edit those data sources after publishing.

You will see your newly added data source listed in the
:guilabel:`Data Sources` view.

.. _charts-modify-data-source:

Modify a Data Source
--------------------

|charts| users can modify certain properties of a data source provided
they have appropriate :ref:`permissions <permission-model>` on the
target data source. You can modify a data source's :ref:`alias
<mod-data-source-alias>` and :ref:`permissions
<mod-data-source-permissions>` after you create it.

.. _mod-data-source-alias:

Modify Data Source Alias
~~~~~~~~~~~~~~~~~~~~~~~~

A data source ``Manager`` or ``Owner`` can modify the :guilabel:`Alias`
of a data source by hovering over the row's :guilabel:`Alias` field,
then clicking either :guilabel:`Add Alias` or the edit button
(pencil icon). Click the green check mark to save the alias.

.. _mod-data-source-permissions:

Modify Data Source Permissions
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A data source ``Owner`` can add, modify, and remove
:ref:`user permissions <permission-model>` on a data source.

1. From the :guilabel:`Data Sources` view, click the :guilabel:`Access`
   button in the :guilabel:`Permissions` column for the data source you
   want to modify permissions.

#. Perform the desired permission changes for the data source. Refer
   to the :ref:`Data Source Permissions <permission-model>` page for
   details on the permissions available and instructions on
   :ref:`setting the permissions <data-source-set-permissions>`.

#. Click :guilabel:`Apply Changes`.

.. _charts-remove-data-source:

Remove a Data Source
--------------------

.. important::

   To remove a data source, you must have the ``Owner``
   :ref:`permission <permission-model>` on that data source.

To remove a data source:

1. From the :guilabel:`Data Sources` view, click the ellipsis
   (:guilabel:`...`) button on the right-hand side of the data source
   you want to delete.

#. Click :guilabel:`Delete Data Source`.

#. Click :guilabel:`Delete Data Source` again in the dialog to confirm
   deletion.

.. important::

   Any charts using the deleted data source will need to be
   reconfigured using a different data source or deleted.

.. _data-source-embedding:

Enable or Disable Embedding
---------------------------

As a data source ``Owner``, you can allow other people to
:ref:`embed charts <embedding-charts>` which use your data source
in external web pages. In order to allow a chart to be embedded
in an external web page, you must enable embedding both on the
data source and the individual chart.

Embedding is disabled by default for all data sources. To enable
embedding for a data source:

1. Navigate to your :ref:`Data Sources View <data-sources-view>` page.

#. Click the ellipsis (:guilabel:`...`) button on the far right side
   of the desired data source.

#. Select :guilabel:`Embedding Options` from the dropdown menu.

#. Toggle the switch in the top right corner to :guilabel:`On`.

#. Select either:

   a. :guilabel:`Verified Signature only`. This option requires
      embedded charts to include a :ref:`secret embedding key
      <embedding-charts>` with each request sent to the data source.
      Without a verified signature, the chart will not render. This
      option allows the chart owner to ensure that the chart is used
      only in its intended context.

      Generating a verified signature for authorized users to include
      with their embedded charts requires some server-side code.
      Examples in several languages and platforms are available with
      the :ref:`verified signature documentation <embedding-charts>`.

   #. :guilabel:`Unauthenticated or Verified Signature`. This option
      allows the chart to be viewed either with or without a verified
      signature, so that anyone with the link may view the embedded
      chart. It is simpler to implement than the verified signature
      only option, but it is less secure. It should only be used for
      charts which display non-sensitive data.

After enabling embedding for a data source, you can enable embedding
for individual charts which use that data source.

.. note::

   If you change the embedding option for a data source from
   :guilabel:`On` to :guilabel:`Off`, all embedded charts which use
   that data source will stop rendering immediately.

.. class:: hidden

   .. toctree::
      :titlesonly:

      /data-source-permissions
