:orphan:

=============================================================
Install a Basic Production Deployment on RHEL or Amazon Linux
=============================================================

.. default-domain:: mongodb

.. note::

   For an evaluation tutorial that involves only a single server, see
   :doc:`/tutorial/install-simple-test-deployment`.

Overview
--------

This tutorial installs the minimally viable |onprem| deployment to servers
that run either **RHEL 6+** or **Amazon Linux**.
The deployment provides full functionality for monitoring and
automating your MongoDB deployments and optionally provides functionality
to back up your deployments.

The deployment uses three servers. The :ref:`application`
runs on the first server, and the :ref:`Backup Daemon <backup-daemon>` runs on
the second. The :ref:`mms-application-database`
and optional :ref:`backup-database` run as a three-member :term:`replica
sets <replica set>`, each with two data-bearing members and an arbiter
spread across the three servers.

The replica sets provide durability in case of failure by storing
redundant copies of your application data and snapshots. However, the
deployment does not provide high availability and cannot continue to
accept writes if a backing database loses a replica set member.

The tutorial prepares the deployment's
servers, installs the |application| Database and Backup
Database, and then installs the |application| and Backup Daemon. To
install |onprem| using a different configuration or operating system, see
:doc:`/core/deployments`.

The following diagram shows the basic deployment.

.. include:: /images/opsmanager-medium.rst

Prerequisites
-------------

Required System Configurations
++++++++++++++++++++++++++++++

All servers that host MongoDB instances must meet the system
configurations in the :manual:`MongoDB Production Notes
</administration/production-notes>`. This includes the server hosting the
Backup Daemon.

.. warning::

   Failure to configure servers according to the :manual:`MongoDB
   Production Notes </administration/production-notes>` can lead to
   production failure.

.. _basic-deploy-hardware-requirements:

Hardware Requirements
+++++++++++++++++++++

Your |onprem| and MongoDB servers must meet the :ref:`hardware-requirements`
described on the :doc:`/core/requirements` page.
When a server hosts multiple components, you must sum the requirements for
each component to determine the requirements for the server.

A basic deployment that can monitor up to 400 hosts has the following requirements:

.. list-table::
   :header-rows: 1

   * - **Server**
     - **RAM**
     - **Storage Capacity**

   * - **Server 1**, which runs the |application|, the Primary for the |application|
       Database, and the Arbiter for the Backup Database.
     - 23 GB
     - 200 GB
   * - 
     - 
     - 
   * - **Server 2**, which runs the Backup Daemon, the Primary for the Backup Database, and
       the Arbiter for the |application| Database.
     - 15 GB for the Backup Daemon **plus** 8 GB for every 1 TB of the Backup Database.
     - *Contact your MongoDB account manager.*
   * - 
     - 
     - 
   * - **Server 3**, which runs the secondaries for the |application| and Backup Database.
     - 8 GB for the |application| Database **plus** 8 GB for every 1 TB of the Backup
       Database.
     - 200 GB for the |application| Database. *Contact your MongoDB account manager for requirements
       for the Backup Database.*

Permissions and Networking Requirements
+++++++++++++++++++++++++++++++++++++++

You must have root access on the machines you are provisioning.

.. include:: /includes/requirements-aws-security.rst

Procedures
----------

.. _basic-deployment-prepare-servers:

Prepare Each Server
+++++++++++++++++++

Set up servers that meet the :ref:`hardware requirements <hardware-requirements>` for deployments that
monitor up to 400 hosts. If your deployment will monitor more than 400 hosts,
use the requirements on the :doc:`/core/requirements` page instead.

.. include:: /includes/steps/prepare-servers-basic-install.rst

Deploy the |application| Database
+++++++++++++++++++++++++++++++++++

Install the :ref:`mms-application-database` as a three-member
:term:`replica set`, as shown in the deployment diagram.

.. include:: /includes/note-cannot-manage-backing-dbs.rst

.. include:: /includes/steps/install-basic-application-database.rst

Deploy the Backup Database (Optional)
+++++++++++++++++++++++++++++++++++++

If you intend to use |mms| Backup, deploy the :ref:`backup-database`
as a three-member replica set,
as shown in the deployment diagram.

.. include:: /includes/steps/install-basic-backup-database.rst

Install the |application|
+++++++++++++++++++++++++++

Install the :ref:`mms-application-package` on **server 1**.
The |application| and |application| Database together provide full
monitoring and automation functionality.

.. include:: /includes/steps/install-basic-application.rst

Install the Backup Daemon (Optional)
++++++++++++++++++++++++++++++++++++++++

If you will use |mms| Backup, install the :ref:`Backup Daemon
<backup-daemon>` on **server 2**.

For production, the Backup Daemon should always reside on a separate physical
server from the |application| and from any databases being monitored and/or
backed up.

.. include:: /includes/steps/install-basic-backup-daemon.rst

Next Steps
----------

To set up a replica set for a test environment, see
:doc:`/tutorial/test-new-deployment`. The tutorial populates the replica set
with test data, registers a user, and installs the Monitoring and Backup
Agents on a client machine in order to monitor the test replica set.
