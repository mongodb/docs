title: Install PyMongo
ref: monitoring-install-windows-pymongo
pre: |
    Use the Windows installer to install `PyMongo from PyPi
    <http://pypi.python.org/pypi/pymongo/>`_.
    
    If PyMongo was previously installed without C extensions, :doc:`install PyMongo
    C extensions </monitoring/tutorial/install-pymongo-c-extensions>`.
    
    If you are installing PyMongo and the Monitoring agent on systems that do not
    have C compilers, :doc:`build PyMongo packages with PyMongo C extensions
    </monitoring/tutorial/building-pymongo-packages-with-c>`.
---
title: Enable Script Execution in PowerShell
ref: monitoring-install-enable-powershell
action:
  - pre: |
      Right click the PowerShell icon in the "Start Menu," and run PowerShell as
      administrator. Issue the following command:
    language: powershell
    code: |
      Get-ExecutionPolicy
  - pre: |
      This returns the current execution policy. Save this value for future use in
      Step 4 below. If the policy is "``Unrestricted``" you can proceed to the next
      step. If the policy is not "``Unrestricted``" issue the following command:
    language: powershell
    code: |
      Set-ExecutionPolicy -ExecutionPolicy Unrestricted
  - pre: |
      If this command returns an error denying access to a HKEY_LOCAL_MACHINE 
      registry key, this command sets the execution policy scope to the current 
      local user (HKEY_CURRENT_USER), not globally for the local machine:
    language: powershell
    code: |
      Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope CurrentUser
post: |
  Confirm the policy change when prompted.
---
title: Install the MMS Monitoring Agent
ref:  monitoring-install-mms-agent-windows
action:
  pre: |
    Start an administrator command window. Change to the folder containing the
    Monitoring agent files. Run ``mongommsinstall.bat``. If this succeeds, the
    Monitoring agent will be running and will start on system boot.
    
    Download the `Python 2.7 64-bit Windows Installer
    <http://www.python.org/ftp/python/2.7.2/python-2.7.2.amd64.msi>`_ from the
    following URL:
  language: none
  code: http://www.python.org/ftp/python/2.7.2/python-2.7.2.amd64.msi
  post: |
    Now you can start and stop the Windows service to control the MMS agent.
    Consult the ``WINDOWS.txt`` file for more information.
---
title: Disable Script Execution in PowerShell
ref: install-monitoring-disable-powershell
action:
  pre: |
    If you have changed the execution policy, after the installation has completed
    successfully set it back to its original value using the following command:
  language: powershell
  code: |
    Set-ExecutionPolicy -ExecutionPolicy <original value>
  post: |
    Replace ``<original value>`` with the value that you recorded above in Step 2.
...