.. _atlas-search-queries:

=================
Run |fts| Queries
=================

.. default-domain:: mongodb

.. facet::
   :name: genre
   :values: tutorial

.. meta::
   :keywords: export query to a programming language, go driver, java driver, node.js driver, python driver, pymongo, compass, mongodb shell, mongo shell, mongosh
   :description: Test your search terms by running a simple wildcard query and viewing your Atlas Search query syntax in the Atlas UI.

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

You can run |fts| queries in the Search Tester, Compass, Drivers and 
``mongosh``. |fts| also provides query guidance in the {+atlas-ui+}.

.. tip::

   Quickly try |fts| without needing an |service| account, {+cluster+}, or collection, 
   with `the {+playground+} <https://search-playground.mongodb.com/>`__. To learn more, 
   see :ref:`the documentation<fts-playground>`.

.. _query-guidance-template:

View Query Guidance Template
----------------------------

|fts| provides a sample :ref:`compound <compound-ref>` query template 
with guidance. The template demonstrates how to build a compound query 
and the index definition for that query. For an example tutorial, see 
:ref:`compound-query-custom-score-tutorial`.

To view this query guidance template:

.. procedure::
   :style: normal

   .. include:: /includes/nav/steps-db-deployments-page.rst

   .. include:: /includes/nav/steps-atlas-search.rst

   .. step:: View the query guidance template.
      
      a. Click :guilabel:`View Compound Query Example`.

      #. Expand each operator to learn more.

      #. Click :guilabel:`View Index Definition` to view the sample 
         definition.

.. _atlas-search-query-ui:

Run |fts| Queries in the Search Tester
--------------------------------------

The :guilabel:`Search Tester` feature in the :guilabel:`Atlas Search` tab 
allows you to: 

- Enter the term to search in the collection. 
- Run a :pipeline:`$search` or :pipeline:`$searchMeta` query. 
  By default, the :guilabel:`Search Tester` 
  shows a basic wildcard query.  
- View, edit, and copy your |fts| query syntax, 
  which you can then run in {+mongosh+} or |compass|. 

  .. tip::

     |fts| also provides :ref:`templates <fts-edit-query-syntax-ui>` 
     for popular search queries that you can adapt.

For :pipeline:`$search` queries, the :guilabel:`Search Tester` returns
the top 10 documents sorted based on relevance :ref:`score
<scoring-ref>`. For :pipeline:`$searchMeta` queries, the
:guilabel:`Search Tester` shows one meta document.

Prerequisites 
~~~~~~~~~~~~~

To use the :guilabel:`Search Tester` in the {+atlas-ui+}, you must have 
the following: 

- An |service| {+cluster+} running MongoDB version 4.2 or higher.
- |fts| :ref:`index <ref-index-definitions>` on your collection in the 
  |service| {+cluster+}.

.. _fts-search-collection-ui:

Search Your Collection 
~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/fts/ui/fts-search-collection-steps.rst

.. _fts-view-query-syntax-ui:
.. _fts-copy-export-query-syntax-ui:
.. _fts-edit-query-syntax-ui:

View, Edit, or Copy Query Syntax
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/fts/syntax/fts-view-query-syntax-steps.rst

.. _atlas-search-query-compass:
.. _atlas-search-query-drivers:
.. _atlas-search-query-mongosh:

Run |fts| Queries in Compass, Drivers and ``mongosh``
-----------------------------------------------------

To run a |fts| query, you must have the following: 

- An |service| cluster running MongoDB version 4.2 or higher.
- |fts| :ref:`index <ref-index-definitions>` on your collection in the 
  |service| cluster.
- A connection to the client you want to use to run the query.

The :ref:`fts-tutorial-run-query` page demonstrates how to connect to
your |service| cluster and run :pipeline:`$search` queries against the
``sample_mflix.movies`` collection using the following clients. To learn
more, select a client using the **Select your language** drop-down menu
on the :ref:`fts-tutorial-run-query` page.

.. list-table::
   :widths: 13 87
   :header-rows: 1
   :stub-columns: 1

   * - Client
     - Steps

   * - |compass|
     - 
       1. :compass:`Install </install/>` and see
          :ref:`atlas-connect-via-compass` to connect to your |service|
          cluster using |compass|. 
       
       #. In the |compass| :guilabel:`Aggregations` tab, manually
          enter your aggregation pipeline.
       
       To learn more, see :compass:`Aggregation Pipeline Builder
       </aggregation-pipeline-builder/>`.

   * - Drivers
     - 
       1. Install any one of the following drivers:
       
          - :driver:`C </c/#installation>`
          - :driver:`C#/.NET </csharp/#installation>`
          - :driver:`C++ </cxx/#installation>`
          - :driver:`Go </go/current/quick-start/>`
          - :driver:`Java </java-drivers/>`
          - :driver:`Node.js </node/current/quick-start/>`
          - :driver:`PHP </php/#installation>`
          - :driver:`Python </python/>`
          - :ruby:`Ruby </installation/>`
          - :driver:`Rust </rust/#installation>`
          - :driver:`Scala </scala/#installation>`
          - :driver:`Swift </swift/#installation>`
      
       #. See :ref:`connect-via-driver` to connect to your |service|
          cluster using the installed driver. 
       
       #. Define and run an aggregation pipeline in your code editor. 
       
       To learn more about running :pipeline:`$search` queries using
       these drivers, see :ref:`fts-tutorial-run-query`. Each example in
       the :ref:`fts-tutorial-run-query` page performs the following:
          
       - Creates a connection to your |service| cluster with the ``MongoClient``.
       - Defines a pipeline.
       - Runs the pipeline.
       - Prints the query result.
  
   * - MongoDB Shell
     - 
       1. :mdb-shell:`Install </install>` and see
          :ref:`connect-mongo-shell` to connect to your |service|
          cluster using the MongoDB Shell.
       
       #. Define and run an |fts| query. 
       
       To learn more about running :pipeline:`$search` queries using
       ``mongosh``, see :ref:`fts-tutorial-run-query`.
