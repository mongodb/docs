title: Remove the broken secondary from your replica set.
stepnum: 1
ref: remove-broken-secondary
action:
  language: sh
  code: |
    rs.remove("SECONDARYHOST:SECONDARYPORT")
---
title: "Login to the server on which to create the new secondary."
stepnum: 2
ref: login-to-server
---
title: "Bring up new node as a standalone."
stepnum: 3
ref: bring-up-new-node
action:
  language: sh
  code: |
    tar -xvf backup-restore-name.tar.gz
    mv backup-restore-name data
    mongod --port <alternate-port> --dbpath /data
  post: |
    Where ``ALTERNATEPORT`` is not the usual port your secondary runs on.
---
title: "Run ``seedSecondary.sh`` or ``seedSecondary.bat`` to create oplog collection and seed it with correct timestamp."
stepnum: 4
source: 
  file: steps-restore-primary.yaml
  ref: seed
pre: |
  The ``seedSecondary.sh`` and ``seedSecondary.bat`` scripts re-create
  the oplog collection and seed it with the correct timestamp.
---
title: "Shut down the new secondary on the alternate port."
stepnum: 5
ref: shut-down-new-secondary
---
title: "Start up the new secondary."
stepnum: 6
ref: start-new-secondary
action:
  language: sh
  code: |
    mongod --port <secondary-port> --dbpath /data  --replSet REPLICASETNAME
---
title: "Add the new secondary to the replica set on the primary host."
stepnum: 7
ref: add-new-secondary
action:
  language: sh
  code: |
    rs.add("<secondary-host>:<secondary-port>")
...
