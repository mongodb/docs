.. _5.0.31-changelog:

5.0.31 Changelog
----------------

Sharding
~~~~~~~~

- :issue:`SERVER-89348` [v5.0] ReplicaSet started with --shardsvr but
  not added to a cluster doesn't consider all collections as unsharded
- :issue:`SERVER-89529` Retryable writes during resharding may execute
  more than once if chunk migration follows the reshard operation

Aggregation
~~~~~~~~~~~

- :issue:`SERVER-91436` Remove unused _internalCollation parameter to
  $lookup aggregation stage
- :issue:`SERVER-94839` [v5.0] Fix underflow in window function memory
  tracker

Storage
~~~~~~~


WiredTiger
``````````

- :issue:`WT-9939` Enter split generation on eviction to prevent split
  parent free too early
- :issue:`WT-13092` Perform dirty eviction when the page has obsolete
  time window
- :issue:`WT-13262` Limit the number of btrees that can be processed
  when cleaning up obsolete time window info
- :issue:`WT-13525` Migrate to AWS-based MacOS hosts
- :issue:`WT-13527` Migrating to new IBM-hosted zSeries hosts

Build and Packaging
~~~~~~~~~~~~~~~~~~~

- :issue:`WT-9102` Migrate WT Mac tests from macOS 10.14 to 11.0
- :issue:`WT-9637` WiredTiger strict compilation failure with gcc-11 on
  ubuntu 22.04
- :issue:`WT-13643` Upgrade evergreen rhel81-power8 hosts to rhel8-power
- :issue:`WT-13801` Update mongodbtoolchain version for ubuntu2004
  stress tests

Internals
~~~~~~~~~

- :issue:`SERVER-60057` Remove ConcurrentCatalogWriteBatches test
- :issue:`SERVER-62921` Improve sync source selection logging
- :issue:`SERVER-70508` Add current thread count to extra_info in
  serverStatus on Linux
- :issue:`SERVER-70597` QueryPlannerAccess::processIndexScans fails when
  MatchExpression is not optimized
- :issue:`SERVER-75566` Disable powercycle on windws
- :issue:`SERVER-76043` Allow shell to construct native PLAIN SASL
  client mechanisms
- :issue:`SERVER-76489` movePrimary set wrong collection version on new
  primary shard
- :issue:`SERVER-76631` Store CPU model name in FTDC metadata
- :issue:`SERVER-78019` Increase reshardingCriticalSectionTimeoutMillis
  for resharding_update_tag_zones_large.js
- :issue:`SERVER-78311` mongos does not report writeConcernError in
  presence of writeErrors for insert command
- :issue:`SERVER-84045` Ensure that the PlanExecutor remains in scope
  while accessing the shard key index in AutoSplitVector
- :issue:`SERVER-85627` Log information of interrupted thead in stepdown
  killOp
- :issue:`SERVER-86669` Invalid authoritative knowledge on secondary
  node after move primary locally creates the collection on the primary
  shard
- :issue:`SERVER-86674` Primary catch-up may believe it is caught up
  when it is not
- :issue:`SERVER-88811` Parsing oplog entries before the stable
  timestamp can fail
- :issue:`SERVER-91113` Avoid invalidating the catalog cache with a
  timestamp of a different namespace
- :issue:`SERVER-91339` $redact may corrupt memory if $$ROOT is used in
  the expression.
- :issue:`SERVER-91374` Fix data race between getTerm and updateTerm in
  _doReplSetReconfig
- :issue:`SERVER-91376` Use std::string instead of StringData for
  horizonString
- :issue:`SERVER-91412` Unowned BSONObj use in splitVector
- :issue:`SERVER-92780` Move sys-perf tasks and variants to DSI
- :issue:`SERVER-92902` Fix overflow issue when casting numInitialChunks
  from size_t to int
- :issue:`SERVER-93264` Add additional handling of deadlines and sleeps
  for Topology Observer unit test
- :issue:`SERVER-93497` Move user cache invalidation from OpObserver to
  onCommit handlers
- :issue:`SERVER-93575` Increase the time
  cursor_server_status_metrics_lifespan_histogram.js waits
- :issue:`SERVER-93616` Improve testing of user cache invalidation
- :issue:`SERVER-93855` Add enterprise "jstests" to the list of
  CODEOWNERs exclusions
- :issue:`SERVER-94008` Slow down verify_session_expiration_sharded.js
- :issue:`SERVER-94122` [v5.0] Mark "bypassEmptyTsReplacement" as
  unstable in "write_ops.idl"
- :issue:`SERVER-94187` Do not use git ssh in copybara
- :issue:`SERVER-94211` Pin 10gen/jepsen to the latest
  jepsen-mongodb-master commit
- :issue:`SERVER-94272` Reduce powercycle timeouts to meet Evergreen
  constraints
- :issue:`SERVER-94316` Properly catch and handle exceptions in the
  router service entry point
- :issue:`SERVER-94440` PoC on generate_token
- :issue:`SERVER-94592` Check inner arguments for explain
- :issue:`SERVER-94635` Make session refresh parameters configurable
- :issue:`SERVER-94662` Retry pipx install db-contrib-tool
- :issue:`SERVER-94764` Create unit test fixture for testing peer
  certificate validation
- :issue:`SERVER-94766` Expand testing of intermediate CA chain
  validation
- :issue:`SERVER-94767` Expand testing of Certificate Revocation Lists
- :issue:`SERVER-94820` Reduce the number of pipelines generated by the
  fuzzer
- :issue:`SERVER-95059` Remove UndoDB live-record variant
- :issue:`SERVER-95240` Remove PeerID from SSL handshakes
- :issue:`SERVER-95445` SSLManagerOpenSSL should validate entire cert
  chain against CRL, not just the leaf
- :issue:`SERVER-95688` Evaluate whether BSON errors should log memory
  context by default
- :issue:`SERVER-95700` Sanitize bad bson type error message returned to
  the user
- :issue:`SERVER-98062` update authenticode key alias

