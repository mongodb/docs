.. _json-cluster-config:

======
|json|
======

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

If an {+atlas-cli+} command accepts the ``--file`` option, you can pass 
a ``.json`` configuration file to define specific settings. For example, 
you can pass a configuration file when using the {+atlas-cli+} to:

- :ref:`Create <atlas-clusters-create>`, :ref:`update <atlas-clusters-update>`, 
  or :ref:`upgrade a cluster <atlas-clusters-upgrade>`.
- :ref:`Update a cloud backup schedule <atlas-backups-schedule-update>`.
- :ref:`Create <atlas-clusters-search-indexes-create>` or 
  :ref:`update an Atlas Search Index <atlas-clusters-search-indexes-update>`.
- :ref:`Create <atlas-clusters-search-nodes-create>` or 
  :ref:`update search nodes <atlas-clusters-search-nodes-update>`.
- :ref:`Create a {+df+} database <atlas-dataFederation-create>`.
- :ref:`Create <atlas-alerts-settings-create>` or 
  :ref:`update an alert configuration <atlas-alerts-settings-update>`.
- :ref:`Create a rolling index <atlas-clusters-indexes-create>` for a cluster.
- :ref:`Update a project <atlas-projects-update>`
- :ref:`Update connected organizations for federated authentication <atlas-federatedAuthentication-federationSettings-connectedOrgConfigs-update>`.

Usage
-----

To learn which settings are accepted by the {+atlas-cli+}, view the request 
body schema and copy the request samples in the :ref:`Atlas Admin API Specification 
<api-resources-spec>` for the endpoint that corresponds to the {+atlas-cli+} 
command. The commands you can use include but are not limited to:

.. list-table::
  :header-rows: 1
  :widths: 50 50
          
  * - {+atlas-cli+} Command
    - API Endpoint

  * - :ref:`atlas-clusters-create`
    - :oas-atlas-op:`Create One Cluster </createLegacyCluster>`

  * - :ref:`atlas-clusters-update`
    - :oas-atlas-op:`Update Configuration of One Cluster </updateClusterConfiguration>`

  * - :ref:`atlas-clusters-upgrade`
    - :oas-atlas-op:`Upgrade One Shared-tier Cluster </upgradeSharedCluster>`

  * - :ref:`atlas-backups-schedule-update`
    - :oas-atlas-op:`Update Cloud Backup Schedule for One Cluster </updateBackupSchedule>`

  * - :ref:`atlas-clusters-search-indexes-create`
    - :oas-atlas-op:`Create One Atlas Search Index </createAtlasSearchIndex>`

  * - :ref:`atlas-clusters-search-indexes-update`
    - :oas-atlas-op:`Update One Atlas Search Index </updateAtlasSearchIndex>`

  * - :ref:`atlas-clusters-search-nodes-create`
    - :oas-atlas-op:`Create Search Nodes </createAtlasSearchDeployment>`

  * - :ref:`atlas-clusters-search-nodes-update`
    - :oas-atlas-op:`Update Search Nodes </updateAtlasSearchDeployment>`

  * - :ref:`atlas-dataFederation-create`
    - :oas-atlas-op:`Create One Federated Database Instance in One Project </createFederatedDatabase>`

  * - :ref:`atlas-alerts-settings-create`
    - :oas-atlas-op:`Create One Alert Configuration in One Project </createAlertConfiguration>`

  * - :ref:`atlas-alerts-settings-update`
    - :oas-atlas-op:`Update One Alert Configuration for One Project </updateAlertConfiguration>`

  * - :ref:`atlas-clusters-indexes-create`
    - :oas-atlas-op:`Create One Rolling Index </createRollingIndex>`

  * - :ref:`atlas-projects-update`
    - :oas-atlas-tag:`Update One Project </Projects/operation/updateProject>`

  * - :ref:`atlas-federatedAuthentication-federationSettings-connectedOrgConfigs-update`
    - :oas-atlas-tag:`Update One Org Config Connected to One Federation </Federated-Authentication/operation/updateConnectedOrgConfig>`

When you run the command in your terminal, specify the ``--file`` option 
and provide the path to the |json| configuration file that defines your 
desired settings. 

Example
~~~~~~~

For example, consider the following configuration file
to enable backups and add a label:

.. code-block:: sh
   :caption: /example.json

   {
     "backupEnabled" : true,
     "labels": [
       {
         "key": "<myKey>",
         "value": "<myValue>"
       }
     ]
   } 

The following command updates the ``myCluster`` deployment
based on the settings specified in the configuration file:

.. code-block:: sh

   atlas clusters update myCluster --file example.json

{+Cluster+} Configuration File
------------------------------

To learn more about {+cluster+} configuration files, see 
:ref:`atlas-cli-cluster-config-file`. For sample files,
see:

- :ref:`example-cluster-config-file`
- :ref:`multi-cloud-example-cluster-config-file`
- :ref:`geosharded-example-cluster-config-file`


Cloud Backup Schedule Configuration File
----------------------------------------

To learn more about cloud backup schedule configuration files, see 
:ref:`atlas-cli-cloud-backup-schedule-config-file`. To learn the syntax
for a file, see :ref:`example-cloud-backup-schedule-config-file`.

Atlas Search Index Configuration File
-------------------------------------

To learn more about |fts| index configuration files, see 
:ref:`atlas-cli-search-index-config-file`. To learn the syntax for a
file, see :ref:`example-search-index-config-file`.

Search Nodes Configuration File
-------------------------------

To learn more about search nodes configuration files, see 
:ref:`atlas-cli-search-nodes-config-file`. To learn the syntax for a
file, see :ref:`example-search-nodes-config-file`.

{+adf+} Configuration File
----------------------------------------

To learn more about {+adf+} configuration files, see 
:ref:`atlas-cli-data-federation-config-file`. To learn the syntax for a
file, see :ref:`example-fdi-config-file`.

Alert Configuration File
------------------------

To learn more about alert configuration files, see 
:ref:`atlas-cli-alert-config-file`. To learn the syntax for a file,
see :ref:`example-alert-config-file`.

Rolling Index Configuration File 
--------------------------------

To learn more about rolling index configuration files, see 
:ref:`atlas-cli-rolling-index-config-file`. For example files, see:

- `Unique indexes <https://github.com/mongodb/mongodb-atlas-cli/blob/master/test/e2e/atlas/data/create_2dspere_index.json>`__ 
- `Sparse Index <https://github.com/mongodb/mongodb-atlas-cli/blob/master/test/e2e/atlas/data/create_sparse_index.json>`__ 
- `Partial indexes <https://github.com/mongodb/mongodb-atlas-cli/blob/master/test/e2e/atlas/data/create_partial_index.json>`__ 

Project Configuration File
--------------------------

To learn more about project configuration files, see 
:ref:`atlas-cli-project-config-file`. To learn the syntax for a file,
see :ref:`example-project-config-file`.

Federated Authentication Configuration File
-------------------------------------------

To learn more about federated authentication configuration files, see 
:ref:`federated-auth-config-file`. To learn the syntax for a file,
see :ref:`example-connected-org-config-file`.


.. toctree::
   :titlesonly:

   Cluster </reference/json/cluster-config-file>
   Cloud Backup Schedule </reference/json/cloud-backup-schedule-config-file>
   Cloud Backup Compliance Policy </reference/json/cloud-backup-compliance-policy-config-file>
   Atlas Data Federation </reference/json/data-federation-config-file>
   Atlas Search Index </reference/json/search-index-config-file>
   Search Nodes </reference/json/search-nodes-config-file>
   Online Archive </reference/json/file-options-online-archive>
   Alert </reference/json/alert-config-file>
   Rolling Index </reference/json/rolling-index-config-file>
   Project </reference/json/project-config-file>
   Federated Authentication </reference/json/connected-org-config-file>
