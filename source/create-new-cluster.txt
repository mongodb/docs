.. _create-new-cluster:

================
Create a Cluster
================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

|service|-managed MongoDB deployments, or "clusters", can be either a
:term:`replica set` or a :term:`sharded cluster`. All |service| clusters
run using the  :ref:`WiredTiger storage engine <storage-wiredtiger>`.
This tutorial covers creating and configuring a new |service| cluster.

For a tutorial on modifying an existing |service| cluster, see
:doc:`scale-cluster`.

.. include:: /includes/extracts/fact-vpc-per-project.rst

.. _create-cluster-open-dialog:

A. Open the :guilabel:`Create New Cluster` Dialog
-------------------------------------------------

.. container:: admonition

   .. note::

      Before creating a cluster, check that you have the correct
      organization and project selected. Click the :guilabel:`Context`
      drop down in the top left corner to select a specific organization
      or project. For more information on creating and managing
      organizations and projects, see 
      :doc:`/tutorial/manage-organizations` and 
      :doc:`/tutorial/manage-projects`.

      .. include:: /includes/fact-cluster-project-limit.rst

   Go to the :guilabel:`Clusters` view and click the :guilabel:`Add New
   Cluster` or :guilabel:`Build a New Cluster` button to display the
   :guilabel:`Create New Cluster` dialog. As you build your cluster,
   |service| displays the associated costs at the bottom of the screen.
   You can hover over the displayed cost for additional estimates.

.. _create-cluster-cloud-provider-region:

B. Configure the Cluster :guilabel:`Cloud Provider & Region`
------------------------------------------------------------

.. container:: admonition

   Select your preferred cloud provider and region. The choice of cloud 
   provider and region affects the configuration options for the 
   available instance sizes, network latency for clients accessing your 
   cluster, the geographic location of the nodes in your cluster,
   and the :doc:`cost of running the cluster </billing>`.

   Regions marked as :guilabel:`Free Tier Available` support
   deploying ``M0`` Free Tier clusters. 

   Regions marked as |star| are
   :guilabel:`Recommended` regions that provide higher availability
   compared to other regions. For more information, see: 

   - :ref:`AWS Recommended Regions <amazon-aws-availability-zones>`.          
   - :ref:`GCP Recommended Regions <google-gcp-availability-zones>`.          
   - :ref:`Azure Recommended Regions <microsoft-azure-availability-zones>`.

   .. include:: /includes/extracts/fact-no-node-restriction-base.rst

   From the :guilabel:`Cloud Provider & Region` section, you can also 
   :ref:`create-cluster-multi-region`.

.. |star| unicode:: U+2605

.. _create-cluster-multi-region:

Configure the Cluster Across Multiple Regions
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterProviderRegionOnly.rst

.. _create-cluster-instance:

C. Select the :guilabel:`Cluster Tier`
--------------------------------------

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterInstance.rst

   .. admonition:: Free Tier
      :class: note

      To deploy a |service| ``M0`` Free Tier cluster, you must select the
      ``M0`` instance size. If the ``M0`` option is greyed out, check that:

      - The :guilabel:`Cloud Provider` is ``Amazon Web Services``,
      - The :guilabel:`Region` is ``N. Virginia (us-east-1)``, 
      - There is not already an ``M0`` Free Tier cluster in the |service| project, and
      - Under :guilabel:`Additional Settings` the MongoDB version is ``MongoDB 3.6 with WiredTiger``

   From the :guilabel:`Cluster Tier` section, you can also 
   :ref:`create-cluster-storage`.

.. _create-cluster-storage:

:guilabel:`Customize Your Storage`
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. container:: admonition
   
   .. include:: /includes/extracts/cluster-option-customizeStorage.rst

.. _create-cluster-additional-settings:

D. Select any :guilabel:`Additional Settings`
---------------------------------------------

.. container:: admonition

   From the :guilabel:`Additional Settings` section, you can

   - :ref:`create-cluster-version`,
   - :ref:`create-cluster-backups`,
   - :ref:`create-cluster-sharding`,
   - :ref:`create-cluster-shardNum`, and
   - :ref:`create-cluster-enable-bi`.

.. _create-cluster-version:

Select the MongoDB Version of the Cluster
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. container:: admonition

   Select the new MongoDB version from the :guilabel:`Select a version` 
   dropdown. |service| always deploys the cluster with the latest stable
   release of the specified version.

   .. include:: /includes/extracts/fact-mongodb-version-create-cluster.rst

.. _create-cluster-backups:

Enable Backup for the Cluster
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterBackup.rst

.. _create-cluster-sharding:

Deploy a Sharded Cluster
~~~~~~~~~~~~~~~~~~~~~~~~

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterSharding.rst

.. _create-cluster-shardNum:

Configure the Number of Shards
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterShardingNum.rst

.. _create-cluster-enable-bi:

Enable |bic|
~~~~~~~~~~~~

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-bi.rst

.. _create-cluster-name:

E. Enter the :guilabel:`Cluster Name`
-------------------------------------

.. container:: admonition

   This is the cluster name as it appears in |service|. You cannot change the
   cluster name once |service| deploys the cluster.

.. _create-cluster-payment:

F. Enter your Payment Information and Deploy your Cluster
---------------------------------------------------------

.. container:: admonition

   Click :guilabel:`Confirm & Deploy` to enter payment information. For
   |service| ``M0`` Free Tier cluster, |service| does not require payment
   information to deploy the cluster.

   See :ref:`billing-overview` for more information on |service|
   billing and payments.

.. _create-cluster-security:

G. (Optional) Create a MongoDB Administrative User
--------------------------------------------------

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterSecurity.rst

.. _create-cluster-connect:

H. Connect to your cluster
--------------------------

.. container:: admonition

   Once |service| deploys your cluster, click :guilabel:`Connect` on the
   cluster to open the :guilabel:`Connect` dialog. Follow the instructions to
   connect to your cluster. See :doc:`connect-to-cluster` for more information.

.. seealso:: :doc:`/tutorial/view-all-clusters`

.. include:: /includes/footnote-databearing.rst

.. class:: hidden

   .. toctree::
      :titlesonly:

      /pause-terminate-cluster.txt
