stepnum: 1
level: 4
source:
  file: steps-source-upgrade-onprem.yaml
  ref: backup
---
title: "Stop all existing |onprem| services."
stepnum: 2
level: 4
ref: shutdown
action:
  - pre: |
      Shut down the |onprem| Application:
    language: sh
    code: |
      <install_dir>/bin/mongodb-mms stop
  - pre: | 
      If you are upgrading from a pre-2.0 Ops Manager Application,
      and you are also running a Backup Daemon on the machine, shut down
      the Backup Daemon service: 
    language: sh 
    code: |
      <install_dir>/bin/mongodb-mms-backup-daemon stop
---
title: "On each |onprem| server, back up your existing configuration files and logs to a directory other than the install directory."
stepnum: 3
level: 4
ref: create-backups
content: |

  .. important::

     You will need to access the backed-up ``<install_dir>/conf/conf-mms.properties``
     file later in this procedure.

action:
  pre: |
    The following example backs up the configuration files and logs to the
    server's home directory:
  language: sh
  code: |
    cp -a <install_dir>/conf ~/mms_conf.backup
    cp -a <install_dir>/logs ~/mms_logs.backup
---
stepnum: 4
level: 4
# Note: This step is borrowed from the archive install procedure, not from steps-source-upgrade.
source:
  file: steps-install-on-prem-from-archive.yaml
  ref: download
---
title: "Install the |onprem| package on each server being used for |onprem|."
stepnum: 5
level: 4
ref: install
content: |

  Navigate to the directory to which to install |onprem|. Extract the
  archive to that directory:

     .. code-block:: sh

        tar -zxf mongodb-mms-<version>.x86_64.tar.gz
---
title: "Start |onprem| on every server."
stepnum: 6
ref: start
pre: |
  Issue the following command:
action:
  language: sh
  code: |
    <install_dir>/bin/mongodb-mms start
...
