.. index:: hosts-tab

=====
Hosts
=====

The "Hosts" section is the primary location for monitoring information
in the MMS console. This tabbed interface provides access to all of
your monitored objects. The tabs you see depend on the types of
processes in your deployment. The tab:

- "**Hosts**" displays all non-arbiter ``mongod`` instances.

- "**Mongos**" displays all ``mongos`` instances.

- "**Configs**" displays all database configuration servers.

- "**Arbiters**" lists the ``mongod`` processes functioning as
  arbiters in replica sets.

- "**Agents**" lists the MMS agents attached to this MMS account. 
   For more information, see ":ref:`Agents <hosts-agents>`."

The remaining "Host" section tabs contain information about the
monitoring process and environment. The tab:

- "**Agent Log**" displays a log of the MMS agent's activity.

- "**Pings**" provides access to the raw JSON document of the last 20
  pings sent to MMS by the agent.

.. index:: host aliases
   single: setting; host aliases

- "**Host Aliases**" shows the mapping between system hostnames and
  the names provided by the monitored process (e.g. ``mongod`` and
  ``mongos``.) In most cases, hosts are automatically aliased during
  auto-discovery. If needed, you may modify and configure the alias
  mapping in the "Settings" section of the console in the "Preferred
  Hostnames" section. For more information about creating host
  aliases, see ":ref:`Creating Host Aliases <creating-host-aliases>`".

  .. note::

     When you add or update a "Preferred Hostname" value, this action
     resets all previous hostname aliases.

- "**CommandLine**" shows the run time configuration options set in
  the configuration file and on the command line for each host.

All of these interfaces, except for the Command Line, provide a search
field in the upper right corner to filter the lists in real time.

.. note::

   If you see a hostname in displayed in orange on the host page, this
   means that:

   - MMS has detected startup warnings for this host. You can
     see the warning in the last ping for the host.

   - MMS suspects that the host has a low ``ulimit`` setting that is
     less than ``1024``. MMS infers the host's ``ulimit`` setting
     using the total number of
     available and current connections.

   MMS outlines deactivated hosts in a brown box on the host
   page. If you have deactivated hosts, MMS will add a warning icon
   with a red border on the Hosts page.

   .. important:: If you have deactivated hosts, review all
      deactivated hosts to ensure that they are still in use, and
      remove all hosts that are not active. Then click on the
      *Reactivate All Hosts* button.

The Hosts Table
---------------

Host Groups
~~~~~~~~~~~

From the Hosts page, you can display groups of hosts in one view. By
following a link from the "Cluster" or "Repl Set" columns, you can see
a side-by-side comparison of charts from all hosts in a given cluster
or replica set.

.. index:: host labels

Host Labels
~~~~~~~~~~~

"Host Labels" provide a method to narrow the list of hosts in the MMS
display. This is particularly crucial if you monitor a large number of
hosts and want to access a more limited set of hosts.

A pencil icon on the "Hosts" tab itself opens a dialogue where you may
create a new host label. After adding the first label, a drop down box
appears where you can narrow the view by selecting a group.

To add hosts to a label or labels, click on the "Edit Host," button (a
pencil) in the rightmost column in the host table. In the dialogue box 
that returns, the third tab allows you to select or remove labels 
from this host.

Hosts may belong to none, one, or multiple labels.

.. _creating-host-aliases:
.. index:: aliases
   single: host aliases

Creating Host Aliases
~~~~~~~~~~~~~~~~~~~~~

"Host Aliases" enables   you to create host aliases
for the hosts you monitor with MMS. These aliases are arbitrary, and
are useful if your machines have existing hostnames that do not
sufficiently describe the system in the context of MMS. 

To set an alias for a host, click on the "Edit Host" button 
(a pencil) in the far right column of the hosts table. Port numbers
are not appended to host aliases.

.. index:: removing hosts
.. index:: procedure; removing hosts
.. _removing-hosts:

Removing Hosts
~~~~~~~~~~~~~~

MMS cannot ignore any hosts added in the discovery process. You can
always manually delete a host from the MMS dashboard by clicking on
the trash icon on the far right of the host entry in the hosts table.
If you want to add monitoring for a host that you have deleted from
MMS, you must add this host manually using the "``+ ADD HOST``" button
at the top of the "Hosts" page. For more about monitoring hosts, see 
":doc:`Monitoring Hosts with MMS </monitoring/tutorial/monitor-hosts-with-mms>`".

.. index:: database profiling
.. _db-profiling-section:

DB Profiling
~~~~~~~~~~~~

MMS can collect data from MongoDB's profiler to provide statistics
about performance and database operations.

This data can include sensitive information, including the content of
database queries. Ensure that exposing this to MMS is consistent with
your information security practices. Additionally, be aware that the
profiler can consume resources which may adversely affect MongoDB
performance. Consider the implications before enabling profiling.

To allow MMS to collect profile data for a specific host, click the
"Enable profile data transmission," button (the clock icon), in the
far right column of the hosts table. It is the middle of the three
icons. This raises a dialogue box that describes the implications of
DB profiling and allows you to enable the transmission of the
profiling data to MMS.

.. note::

   The MMS agent attempts to minimize its effect on the monitored
   systems. If resource intensive operations, like polling profile
   data, begins to impact the performance of the database, MMS will
   throttle the frequency that it collects data. See 
   ":ref:`db-stats-warning`"for more information about the
   agent's throttling process.

   When enabled, MMS samples profiling data from monitored
   instances: the agent only sends the most recent 20 entries from
   last minute.

When you select "Enable Profile Info Transmission," the agent will
begin sending profile data to MMS. All configuration changes made in
the MMS console can take up to 2 minutes to propagate to the agent and
another minute before profiling data appears in the MMS interface.

However, to begin collecting profile data, you need to modify the value
of ``setProfilingLevel`` on the database itself. See the `database
profiler <http://www.mongodb.org/display/DOCS/Database+Profiler>`_
documentation for instructions for using the profiler. There is a link
at the bottom of the Host Statistics page that displays the profile
levels.

If you have profiling data, and wish to delete it from the system,
there is a button on the bottom of the "Profile Data" tab, that says
"Delete Profile Data." When you click on this button, the MMS Console
raises a confirmation dialogue. When you confirm, MMS will begin
removing stored profile data from this server's record.

.. note::

   If MMS is storing a large amount of profile data for your instance,
   the removal process will not be instantaneous.

.. _hosts-agents:
   
Agents
------

The "Agents" tab of the "Hosts" section contains information about the
deployed agents, and has the following fields:

- **Hostname:** the name of the host running the agent.

- **Address:** the IP address of the address running the agent.

- **Hosts:** the number of MongoDB instances this agent monitors.

- **Ping Count:** the number of pings (i.e. data payloads) sent by the
  agent since midnight GMT. Typically agents send pings every minute.

- **Conf Count:** the number of configuration requests sent by the
  agent since midnight GMT. Typically agents request configuration
  updates every two minutes.

- **Version:** the version of the agent software running on this agent
  instance.

- **Last Ping:** the last time this agent sent a ping to the MMS servers.

- **Last Conf:** the last time the agent made a configuration request
  of the MMS servers.

.. include:: /includes/mms-old-version-red.rst

Remember, if you have more than one agent, only one agent actively
monitors MongoDB instances at once. See
":ref:`Monitoring Architecture <monitoring-architecture>`" for more information.
