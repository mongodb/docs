=============
System Alerts
=============

.. default-domain:: mongodb

Overview
--------

System alerts are internal health checks that monitor the health of
|onprem| itself, including the health of backing databases, Backup
Daemons, and backed-up deployments. |onprem| runs health checks every 5
minutes.

To view system alerts, click the :guilabel:`Admin` link at the top of
|onprem|, select the :guilabel:`Alerts` tab, and then select the
:guilabel:`Open Alerts` link under :guilabel:`System Alerts`.

Users with the :ref:`global-owner-role` or
:ref:`global-monitoring-admin-role` roles can :ref:`modify notification
settings <edit-system-alert-notification>` or :ref:`disable
<disable-system-alert>` an alert.

System Alerts
-------------

|onprem| provides the following system alerts:

.. alert:: System detects backup oplog TTL was resized

   Sends an alert if the Backup Daemon has fallen so far behind in
   applying :term:`oplog` entries that |onprem| has extended the period of
   time it will store the
   entries. By default, |onprem| stores oplog entries in the :ref:`Oplog
   Store <oplog-stores-page>` for 24 hours. If the Daemon has not yet
   applied an entry an hour before its expiration, |onprem| extends the
   storage period by three hours. If the entry again reaches an hour from
   expiration, |onprem| continues to extend the storage period, up to
   seven days. The system sets the storage period in the Daemon's
   :setting:`mms.backup.restore.snapshotPITExpirationHours` setting.

   If you receive this alert, check that your Backup Daemon is running and
   that it has sufficiently performant hardware to apply oplog entries in a timely
   manner.

.. alert:: System detects backing database startup warnings

   Sends an alert if the MongoDB process hosting a :ref:`backing database
   <backing-database>` contains ``startupWarnings`` in its log files.
   Check the logs on the server running the MongoDB process.

.. alert:: System detects an unhealthy database backing the system

   Sends an alert if |onprem| cannot connect to a backing database and run
   the ping command.

.. alert:: System detects backup daemon is down

   Sends an alert the Backup Daemon has not pinged |onprem| for more than
   15 minutes.

.. alert:: System detects backup daemon has low free head space

   Sends an alert if the disk partition on which the local copy of a
   backed-up replica set is stored has less than 10 GB of free space
   remaining.

.. alert:: System detects backup was not moved successfully

   Sends an alert if you attempt to move a job to a new Backup Daemon but
   the move failed. The job will continue to run in its original location.
   For more information on moving jobs, see :ref:`jobs-page`.

.. .. alert:: System detects failed integrity check

..    Sends an alert if snapshots are potentially corrupt. |onprem| performs
      a periodic integrity check of a snapshot to make sure that it is
      complete in the blockstore. If that validation fails, the alert is
      triggered. Another result of an integrity failure is that |onprem| no
      longer uses past snapshots to optimize creation of future ones,
      which ensures future snapshots are complete.

..    If you receive this alert, contact MongoDB Support.

Procedures
----------

.. _edit-system-alert-notification:

Modify Notification Settings for a System Alert
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/steps/system-alerts-edit.rst

.. _disable-system-alert:

Disable a System Alert
~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/steps/system-alerts-disable.rst
