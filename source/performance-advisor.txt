===================
Performance Advisor
===================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

The Performance Advisor monitors queries that MongoDB considers slow
and suggests new indexes to improve query performance. Recommended 
indexes are accompanied by sample queries, grouped by :term:`query shape`,
that were run against a collection that would benefit from
the suggested index. The Performance Advisor is always enabled and does
not negatively affect the performance of your Atlas clusters.

.. note::

   To view field values in a sample query in the :guilabel:`Performance 
   Advisor`, you must have the Group Owner role. Users without this role
   cannot see field values.

Considerations
--------------

Indexes improve read performance, but a large number of indexes can
negatively impact write performance since indexes must be updated during
writes. It is important to consider this tradeoff when deciding whether
to create new indexes for a collection that already has several. Examine
whether a query for such a collection can be modified to take advantage
of existing indexes, as well as whether a query occurs often enough to
justify the cost of a new index.

Setting the Slow Query Threshold
--------------------------------

The Performance Advisor recognizes a query as slow if it takes longer to
execute than the value of :manual:`slowOpThresoldMs </reference/configuration-options/#operationProfiling.slowOpThresholdMs>`.
By default, this value is ``100`` milliseconds. You can change the threshold 
with either the :manual:`profile </reference/command/profile>` command or the 
:manual:`db.setProfilingLevel() </reference/method/db.setProfilingLevel>`
:manual:`mongo </reference/program/mongo>` shell method. For example, the following ``profile`` command example
sets the threshold at 200 milliseconds:

.. code-block:: json

   db.runCommand({ profile: 0, slowOpThresholdMs: 200 })

.. note::

   By default, the value of ``profile`` is ``0``. MongoDB recommends
   leaving this value unchanged since other values can negatively impact
   database performance.   

.. _query-inefficiency-score:
 
Understanding the Query Inefficiency Score
------------------------------------------

The Performance Advisor displays sample queries with recommended 
indexes. Each sample query includes a query inefficiency score, which is
how many documents were read for every document returned by the query.
A score of 1 represents a very efficient query because every document read matched
the query and was returned with the query results. The Performance Advisor
displays a warning icon next to any score over 1,000, which represent 
highly inefficient queries. All suggested indexes represent an opportunity
to improve query performance.


To access the :guilabel:`Performance Advisor`:

.. include:: /includes/steps/performance-advisor-view.rst

.. class:: hidden

   .. toctree::
      :titlesonly: