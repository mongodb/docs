title: "Log in the the host where the {+aagent+} is installed."
stepnum: 1
ref: login-agent-host
---
title: "Login to |cloud|."
stepnum: 2
ref: login
---
title: "Click :guilabel:`Deployment`, then :guilabel:`Agents`, and then :guilabel:`Downloads & Settings`."
stepnum: 3
ref: downloads-and-settings
---
title: "Select :guilabel:`<Linux-Distribution> - RPM`."
stepnum: 4
ref: select-distribution
---
title: Download the latest version of the Monitoring Agent package.
stepnum: 5
edition:
  - cloud
ref: download-saas
pre: |
  On a system shell, issue a ``curl`` command to download the ``rpm``
  for the agent that works on your platform:
action:
  - heading: "For RHEL on x64 architecture:"
    language: sh
    copyable: true
    code: |
      curl -OL https://cloud.mongodb.com/download/agent/monitoring/mongodb-mms-monitoring-agent-latest.x86_64.rpm
  - heading: "For RHEL on PowerPC architecture:"
    language: sh
    code: |
      curl -OL https://cloud.mongodb.com/download/agent/monitoring/mongodb-mms-monitoring-agent-latest.ppc641e.rpm
---
title: "Download the latest version of the Monitoring Agent package."
stepnum: 5
edition: onprem
ref: download-hosted
pre: |
  On a system shell, issue a ``curl`` command to download the ``rpm``
  for the agent that works on your platform:

  .. note::
     Replace ``<OpsManagerHost:Port>`` with the hostname and port of
     your |onprem| installation.

action:
  - heading: "For RHEL / CentOS on x64 architecture:"
    language: sh
    copyable: true
    code: |
      curl -OL https://<OpsManagerHost:Port>/download/agent/monitoring/mongodb-mms-monitoring-agent-latest.x86_64.rpm
  - heading: "For RHEL / CentOS (7.x) on PowerPC architecture:"
    language: sh
    copyable: true
    code: |
      curl -OL https://<OpsManagerHost:Port>/download/agent/monitoring/mongodb-mms-monitoring-agent-latest.ppc641e.rpm
---
title: "Install the Monitoring Agent package."
stepnum: 6
ref: install
pre: |
  To install the agent that works on your platform, issue the
  appropriate command to install the package:
action:
  - heading: "For RHEL / CentOS on x64 architecture:"
    language: sh
    copyable: true
    code: |
      sudo rpm -U mongodb-mms-monitoring-agent-latest.x86_64.rpm
  - heading: "For RHEL / CentOS (7.x) on PowerPC architecture:"
    language: sh
    copyable: true
    code: |
      sudo rpm -U mongodb-mms-monitoring-agent-latest.ppc641e.rpm
---
title: "Generate an agent API key or retrieve an existing agent API key for your |mms| project." 
stepnum: 7
ref: retrieve-monitoring-mms-api-key
pre: |
      a. Click :guilabel:`+ Generate Key`.

      .. include:: /includes/extracts/agent-api-key-generate-note.rst

      b. Enter your password and click :guilabel:`Verify`.
  
      c. Click :guilabel:`+ Generate Key` again.

      .. include:: /includes/extracts/agent-api-key-admonition.rst
---
title: "Edit the ``monitoring-agent.config`` file to include your Project ID and the agent API key."
stepnum: 8
ref: configure-monitoring-mms-api-key
content: |
  In the ``/etc/mongodb-mms/monitoring-agent.config`` file, set these settings: 

  .. list-table::
     :header-rows: 1

     * - Setting
       - New Value

     * - :msetting:`mmsGroupId`
       - The Project ID.

     * - :msetting:`mmsApiKey`
       - The agent API key.
edition:
  - cloud
---
title: "Edit the ``monitoring-agent.config`` file to include your Project ID and the agent API key."
stepnum: 8
ref: configure-monitoring-mms-api-key
content: |
  In the ``/etc/mongodb-mms/monitoring-agent.config`` file, set these settings: 

  .. list-table::
     :header-rows: 1

     * - Setting
       - New Value
    
     * - :msetting:`mmsBaseUrl`
       - The hostname and port for your |onprem|.

     * - :msetting:`mmsGroupId`
       - The Project ID.

     * - :msetting:`mmsApiKey`
       - The agent API key.
edition:
  - onprem
---
stepnum: 9
source:
  file: steps-source-install-agent.yaml
  ref: proxy
replacement:
  agentname: "Monitoring"
  httpProxy: ":msetting:`httpProxy`"
  configfile: "/etc/mongodb-mms/monitoring-agent.config"
---
title: "For SUSE deployments only, configure the ``sslTrustedMMSServerCertificate`` property."
stepnum: 10
ref: suse-ssl
optional: true
pre: |
  If you're deploying on SUSE, you must configure the
  ``sslTrustedMMSServerCertificate`` setting. All other users should
  omit this step.

  Enter the following property and value in the
  ``/etc/mongodb-mms/monitoring-agent.config`` file:
action:
  language: sh
  copyable: true
  code: |
    sslTrustedMMSServerCertificate=/etc/ssl/certs/UTN_USERFirst_Hardware_Root_CA.pem
post: |
  Save and close the file.
---
stepnum: 11
source:
  file: steps-source-install-agent.yaml
  ref: start-monitoring
action:
  language: sh
  copyable: true
  code: |
    sudo service mongodb-mms-monitoring-agent start
...
