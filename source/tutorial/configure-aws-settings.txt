===================================
Configure MMS to Deploy AWS Servers
===================================

.. default-domain:: mongodb

Overview
--------

If you have an Amazon Web Services (AWS) account, you can configure MMS to
deploy EC2 servers to that account directly from the MMS interface. MMS
integrates with AWS to deploy EC2 instances that come with Automation
Agents pre-installed.

.. _aws-checklist:

Prerequisites
-------------

The AWS account must satisfy the following conditions.

.. _security-group:

Security Group
~~~~~~~~~~~~~~

- The account must have at least one security group configured.

- The security group must allow inbound traffic on all MongoDB ports
  within the security group and allow SSH access from all IPs.

- You must have access to the AWS account's Access Key ID and Secret
  Access Key. To access the keys, click your username in the top right
  corner of AWS and select *Security Credentials*. You will provide MMS
  with these keys.

- You must have an SSH public key to provide to the AWS account. When you
  :doc:`provision a server </tutorial/provision-aws-servers>`, AWS uses
  this key to create a shared private key, allowing you to to connect to
  the server through SSH.

To complete this tutorial, you will copy the contents of
the public key in the :guilabel:`AWS Settings.`

VPC
~~~

- If you are deploying into a Virtual Private Cloud (VPC), the VPC
  must exist before provisioning.

- If you are using a VPC that you created and not a default AWS VPC,
  make sure that:

  - The VPC property ``DNS hostname`` is ``yes``, which
    guarantees that each instance provisioned in the VPC receives a
    hostname.

  - For all subnets created, that after clicking the ``Modify
    auto-assigned public IP`` button in the console, that the ``Enable
    auto-assign Public IP`` box is checked.

Limits
~~~~~~

- If you attempt to provision larger instances, be aware that Amazon
  often has a limited number of these instances in any given region
  which may prevent provisioning.

  .. LOCATION NO LONGER VALID: If you reach this limit MMS will
     provide an error message in the :guilabel:`Provision Machines
     Table`, which is located in the :guilabel:`Automation` tab's
     :guilabel:`Provisioning` page.

- AWS accounts have restrictions that limit the number of
  instances you can deploy. If you reach this limit, you must contact
  AWS support to raise this limit.

  .. LOCATION NO LONGER VALID: If you reach this limit MMS will
     provide an error message in the :guilabel:`Provision Machines
     Table`, which is located in the :guilabel:`Automation` tab's
     :guilabel:`Provisioning` page.

Procedure
---------

.. include:: /includes/steps/configure-aws-settings.rst
