.. _rm-prereq-oracle:

============================================
Configure Migration Prerequisites for Oracle
============================================

.. meta::
   :description: Configure Oracle database prerequisites for migration with Relational Migrator, including setting user permissions and enabling archive and supplemental logging.

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

When you migrate data from an Oracle source database, {+rel-mig+} 
automatically checks your database for needed configuration changes and 
generates a SQL script to implement them. Have a Database Administrator (DBA)
review the script and run the commands on the database server. This page 
provides more details on the required configuration steps.

For details on supported versions of Oracle, see 
:ref:`supported-databases`.

About this Task
---------------

- If you're migrating from an Oracle 12c instance, you must run commands as 
  the SYSDBA role.
- Oracle 12c introduced the concept of a pluggable database (PDB). Some
  commands can be run on a PDB, while commands like enabling ``ARCHIVELOG``
  must be run on the container/master database (CDB). For details on each
  architecture, see `Overview of Container Databases and Pluggable Databases <https://oracle-base.com/articles/12c/multitenant-overview-container-database-cdb-12cr1>`__.
- Some commands differ based on whether the database is single or
  multi-tenant. In a multi-tenant database, permissions must
  include the suffix ``CONTAINER=ALL``. To check whether the database is 
  multi-tenant or not, run the following SQL query:

  .. code-block:: sql
      :copyable: true

      SELECT cdb AS is_multitenant FROM v$database;

Steps
-----

To configure your Oracle instance for snapshot jobs:

.. procedure::
   :style: normal

   .. step:: Set up user permissions

      .. include:: /includes/fact-data-prep-oracle-step1.rst

Learn More
----------

- {+rel-mig+} relies on the open-source Debezium connector to 
  capture row-level changes. For more details, see `Debezium Oracle 
  <https://debezium.io/documentation/reference/stable/connectors/oracle.html#_preparing_the_databas>`__
- For details on enabling archive logging, see `Managing Archived Redo Logs 
  <https://docs.oracle.com/cd/B19306_01/server.102/b14231/archredo.htm>`__.
- For additional troubleshooting and debugging information, see the 
  `Debezium Oracle help blog post
  <https://debezium.io/blog/2022/09/30/debezium-oracle-series-part-1/#configure-oracle-users>`__.
