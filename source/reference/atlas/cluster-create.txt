.. _mcli-atlas-cluster-create-command:

=============================
mongocli atlas cluster create
=============================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

The ``cluster create`` command creates a cluster in the specified
project. You can also create a cluster with the |service|
:atlas:`console </tutorial/create-new-cluster/>` or
:atlas:`API </reference/api/clusters-create-one/>`.

.. include:: /includes/admonitions/note-atlas-api-free-tier-limits.rst

.. _atlas-cluster-create-syntax:

Syntax
------

.. code-block:: sh

   mongocli atlas cluster create <cluster-name>
        [ --backup ]
        [ --diskSizeGB <size-of-disk> ]
        [ --file|-f <path-to-cluster-config-file> ]
        [ --mdbVersion <mongodb-version> ]
        [ --members|-m <number-of-members> ]
        [ --output|-o <output-format> ]
        [ --profile|-P <profile-name> ]
        [ --projectId <project-ID> ]
          --provider AWS|GCP|AZURE
          --region|-r <region-name>
        [ --shards|-s <number-of-shards> ]
        [ --tier <cluster-tier> ]
        [ --type <replicaset-or-sharded>]
        
.. include:: /includes/fact-command-line-help.rst

.. _atlas-cluster-create-options:

Options
-------

.. list-table::
   :header-rows: 1
   :widths: 20 10 60 10

   * - Option
     - Type
     - Description
     - Required?

   * - ``<cluster-name>``
     - string
     - Name of the cluster. The cluster name cannot
       be changed after the cluster is created. Cluster
       name can contain ASCII letters, numbers, and
       hyphen.
     - yes

   * - ``--backup``
     - 
     - Flag to enable :atlas:`backup </backup-cluster>` on 
       ``M10`` and larger clusters. This option is not available
       for clusters smaller than ``M10``. If omitted, :atlas:`cloud 
       provider snapshots </backup/cloud-provider-snapshots>` is 
       disabled.
     - no

   * - ``--diskSizeGB``
     - int
     - Size of the disk in GB for storage. If omitted,
       uses the default disk size for the instance type.
       Select your cloud provider tab to view the default 
       disk size for each instance type:

       .. tabs-cloud-providers::

          .. tab::
             :tabid: aws

             .. include:: /includes/extracts/fact-cluster-instance-sizes-AWS.rst

          .. tab::
             :tabid: gcp

             .. include:: /includes/extracts/fact-cluster-instance-sizes-GCP.rst

          .. tab::
             :tabid: azure

             .. include:: /includes/extracts/fact-cluster-instance-sizes-AZURE.rst

     - no

   * - ``--file``, ``-f``
     - string
     - Path to a |json| configuration file that defines cluster
       settings. Any settings specified in the configuration file take
       precedence over settings specified by a command option.

       For a list of settings you can define, see the
       :atlas:`Create One Cluster API </reference/api/clusters-create-one/#request-body-parameters>`.

       .. note::

          You can't create Global Clusters through the {+mcli+}.
     - no

   * - ``--mdbVersion``
     - string
     - Major version of the cluster to deploy. Value can be:

       - ``4.2``
       - ``4.0`` - for ``M10+`` clusters only
       - ``3.6`` - for ``M10+`` clusters only

       By default, deploys v4.2.
     - no

   * - ``--members``, ``-m``
     - integer
     - Number of members in the replica set. The
       default value is ``3``.
     - no

   * - ``--output``, ``-o``
     - string 
     - .. include:: /includes/extracts/fact-basic-options-output.rst
     - no

   * - ``--profile``, ``-P``
     - string
     - Name of the profile where the public and private 
       keys for the project are set. If omitted, uses the 
       {+default-profile+}. To learn more about creating a 
       profile, see :ref:`mcli-configure`.
     - no

   * - ``--projectId``
     - string
     - .. include:: /includes/extracts/fact-basic-options-project-id.rst
     - no

   * - ``--provider``
     - string
     - Cloud service provider on which the servers are
       provisioned. Value can be:

       - ``AWS`` - Amazon AWS
       - ``GCP`` - Google Cloud Platform
       - ``AZURE`` - Microsoft Azure

     - yes

   * - ``--region``, ``-r``
     - string
     - Physical location of the MongoDB cluster. Select
       your cloud provider tab to view the available regions:

       .. tabs-cloud-providers::

          .. tab::
             :tabid: aws

             - ``US_EAST_1``
             - ``US_WEST_2``
             - ``EU_WEST_1``

             For a complete list of supported |aws| regions, see
             :atlas:`Amazon Web Services (AWS)
             </reference/amazon-aws/#amazon-aws>`.

          .. tab::
             :tabid: gcp

             - ``CENTRAL_US``
             - ``WESTERN_EUROPE``
             - ``EASTERN_ASIA_PACIFIC``

             For a complete list of supported |gcp| regions, see
             :atlas:`Google Cloud Platform (GCP)
             </reference/google-gcp/#google-gcp>`.

          .. tab::
             :tabid: azure

             - ``US_EAST_2``
             - ``US_WEST``
             - ``EUROPE_NORTH``

             For a complete list of supported Azure regions, see
             :atlas:`Microsoft Azure </reference/microsoft-azure/#microsoft-azure>`.

     - yes

   * - ``--shards``, ``-s``
     - integer
     - Number of shards in the sharded cluster. The
       default value is ``1``, which is equivalent to a replica set.
     - no
  
   * - ``--tier``
     - string
     - Name of the :atlas:`cluster tier </cluster-tier/>` you want to
       use. You can later modify your cluster tier with the
       :ref:`mongocli atlas cluster update <mcli-atlas-cluster-update-command>`
       command. If omitted, uses the tier ``M2``.
     - no

   * - ``--type``
     - string
     - Type of cluster to deploy. Value can be:

       - ``REPLICASET`` to deploy a 
         replica set, 
         or

       - ``SHARDED`` to deploy a 
         sharded cluster.

       By default, deploys a replica set.
     - no

.. _atlas-cluster-create-output-fields:

Output
------

.. include:: /includes/command-output-intro.rst

.. include:: /includes/atlas-cluster-output-fields.rst

.. _atlas-cluster-create-examples:

Examples
--------

Create a Cluster
~~~~~~~~~~~~~~~~

The following ``mongocli atlas cluster create`` command creates a sample
``M2`` cluster named ``myCluster`` in the AWS region ``US_EAST_1`` with
``3`` nodes. The command uses the {+default-profile+},
which contains the public and private keys for accessing |service|. 

.. code-block:: sh
   :copyable: false

   mongocli atlas cluster create myCluster --projectId 5e2211c17a3e5a48f5497de3 --provider AWS --region US_EAST_1 --members 3 --tier M2 --mdbVersion {+mdbVersion+} --diskSizeGB 10 --output json

The command returns the following to the terminal. To learn more about
these fields, see :ref:`Output <atlas-cluster-create-output-fields>`.

.. code-block:: json
   :copyable: false

   {
     "autoScaling": {
       "diskGBEnabled": false
     },
     "backupEnabled": false,
     "biConnector": {
       "enabled": false,
       "readPreference": "secondary"
     },
     "clusterType": "REPLICASET",
     "diskSizeGB": 10,
     "encryptionAtRestProvider": "NONE",
     "id": "5e272af4f10fab7c87718918",
     "groupId": "5e2211c17a3e5a48f5497de3",
     "labels": [
       {
         "key" : "Infrastructure Tool",
         "value" : "mongoCLI"
       }
     ],
     "mongoDBVersion": "4.2.2",
     "mongoDBMajorVersion": "4.2",
     "mongoURIUpdated": "2020-01-21T16:46:44Z",
     "name": "myCluster",
     "numShards": 1,
     "paused": false,
     "providerBackupEnabled": false,
     "providerSettings": {
       "backingProviderName": "AWS",
       "instanceSizeName": "M2",
       "providerName": "TENANT",
       "regionName": "US_EAST_1"
     },
     "replicationFactor": 3,
     "replicationSpec": {
       "US_EAST_1": {
         "analyticsNodes": 0,
         "electableNodes": 3,
         "priority": 7,
         "readOnlyNodes": 0
       }
     },
     "replicationSpecs": [{
       "id": "5e272af4f10fab7c87718912",
       "numShards": 1,
       "zoneName": "Zone 1",
       "regionsConfig": {
         "US_EAST_1": {
           "analyticsNodes": 0,
           "electableNodes": 3,
           "priority": 7,
           "readOnlyNodes": 0
         }
       }
     }],
     "stateName": "CREATING"
   }

Create a Cluster using a Configuration File
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The following ``mongocli atlas cluster create`` command creates a
sample ``M40`` cluster named ``myCluster`` in the |aws| region
``US_EAST_1`` with ``3`` nodes with a configuration file. The command
uses the profile named ``egAtlasProfile``, which contains the public
and private keys for accessing |service|.

.. code-block:: sh
   :copyable: false

   mongocli atlas cluster create myCluster \
            --file cluster-config.json \
            --output json \ 
            --projectId 5e2211c17a3e5a48f5497de3 \
            --profile egAtlasProfile 

The cluster configuration file contains the following settings:

.. code-block:: json
   :copyable: false

   {
     "name": "myCluster",
     "diskSizeGB": 100,
     "numShards": 1,
     "providerSettings": {
       "providerName": "AWS",
       "diskIOPS": 300,
       "instanceSizeName": "M40",
       "regionName": "US_EAST_1"
     },
     "clusterType" : "REPLICASET",
     "replicationFactor": 3,
     "replicationSpecs": [{
       "numShards": 1,
       "regionsConfig": {
         "US_EAST_1": {
           "analyticsNodes": 0,
           "electableNodes": 3,
           "priority": 7,
           "readOnlyNodes": 0
         }
       },
       "zoneName": "Zone 1"
     }],
     "backupEnabled": false,
     "providerBackupEnabled" : true,
     "autoScaling": {
       "diskGBEnabled": true
     }
   }

The command returns the following to the terminal. To learn more about
these fields, see :ref:`Output <atlas-cluster-create-output-fields>`.

.. code-block:: json
   :copyable: false

   {
      "autoScaling": {
         "diskGBEnabled": true
      },
      "backupEnabled": false,
      "biConnector": {
         "enabled": false,
         "readPreference": "secondary"
      },
      "clusterType": "REPLICASET",
      "diskSizeGB": 100,
      "encryptionAtRestProvider": "NONE",
      "id": "5e6165b47cb26270c310bfd5",
      "groupId": "5e2f04ecf10fab66c7d4072e",
      "labels": [
         {
            "key" : "Infrastructure Tool",
            "value" : "mongoCLI"
         }
      ],
      "mongoDBVersion": "4.0.16",
      "mongoDBMajorVersion": "4.0",
      "mongoURIUpdated": "2020-03-05T20:48:52Z",
      "name": "myCluster",
      "numShards": 1,
      "paused": false,
      "providerBackupEnabled": true,
      "providerSettings": {
         "diskIOPS": 300,
         "encryptEBSVolume": true,
         "instanceSizeName": "M40",
         "providerName": "AWS",
         "regionName": "US_EAST_1",
         "volumeType": "STANDARD"
      },
      "replicationFactor": 3,
      "replicationSpec": {
         "US_EAST_1": {
            "analyticsNodes": 0,
            "electableNodes": 3,
            "priority": 7,
            "readOnlyNodes": 0
         }
      },
      "replicationSpecs": [
         {
            "id": "5e6165b47cb26270c310bfcf",
            "numShards": 1,
            "zoneName": "Zone 1",
            "regionsConfig": {
               "US_EAST_1": {
                  "analyticsNodes": 0,
                  "electableNodes": 3,
                  "priority": 7,
                  "readOnlyNodes": 0
               }
            }
         }
      ],
      "stateName": "CREATING"
   }

Create a Sharded Cluster
~~~~~~~~~~~~~~~~~~~~~~~~

The following ``mongocli atlas cluster create`` command creates a sample
``M10`` sharded cluster named ``myShardedCluster`` in the |gcp| region 
``EASTERN_US`` with ``2`` shards and ``3`` nodes per shard. The command 
uses the {+default-profile+}, which contains the public and private 
keys for accessing |service|, as well as a default project ID.

.. code-block:: sh
   :copyable: false

   mongocli atlas cluster create myShardedCluster \
    --provider GCP \
    --region EASTERN_US \
    --type SHARDED \
    --shards 2 \
    --members 3 \
    --tier M10 \
    --mdbVersion {+mdbVersion+} \
    --diskSizeGB 10 \
    --output json

The command returns the following to the terminal. To learn more about
these fields, see :ref:`Output <atlas-cluster-create-output-fields>`.

.. code-block:: json
   :copyable: false

   {
      "autoScaling": {
        "diskGBEnabled": true,
        "compute": {
          "enabled": false,
          "scaleDownEnabled": false
        }
      },
      "backupEnabled": false,
      "biConnector": {
        "enabled": false,
        "readPreference": "secondary"
      },
      "clusterType": "SHARDED",
      "diskSizeGB": 10,
      "encryptionAtRestProvider": "NONE",
      "labels": [
        {
          "key": "Infrastructure Tool",
          "value": "mongoCLI"
        }
      ],
      "id": "5efe19b205e4b2501fb14374",
      "groupId": "5dd6fab7493979f10faffb78",
      "mongoDBVersion": "4.2.8",
      "mongoDBMajorVersion": "4.2",
      "mongoURIUpdated": "2020-07-02T17:30:25Z",
      "name": "testShard",
      "numShards": 2,
      "paused": false,
      "pitEnabled": false,
      "providerBackupEnabled": false,
      "providerSettings": {
        "instanceSizeName": "M10",
        "providerName": "GCP",
        "regionName": "EASTERN_US",
        "autoScaling": {
          "compute": {}
        }
      },
      "replicationFactor": 3,
      "replicationSpec": {
        "EASTERN_US": {
          "analyticsNodes": 0,
          "electableNodes": 3,
          "priority": 7,
          "readOnlyNodes": 0
        }
      },
      "replicationSpecs": [
        {
          "id": "505e4b24efe19b1fb1437429",
          "numShards": 2,
          "zoneName": "Zone 1",
          "regionsConfig": {
            "EASTERN_US": {
              "analyticsNodes": 0,
              "electableNodes": 3,
              "priority": 7,
              "readOnlyNodes": 0
            }
          }
        }
      ],
      "stateName": "CREATING",
      "connectionStrings": {}
   }
  