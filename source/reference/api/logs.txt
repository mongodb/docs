====
Logs
====

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Retrieves a compressed (``.gz``) log file that contains a range of log
messages for a particular host in an |service| cluster.

.. include:: /includes/fact-log-data-update-interval.rst

.. include:: /includes/fact-atlas-free-tier-limits.rst

.. include:: /includes/fact-projects-groups-synonyms.rst

.. important::

   You must have the :authrole:`Project Data Access Read Only` role or
   higher in the project that the cluster belongs to in order to
   retrieve the log.

.. include:: /includes/api-base-url-new.rst

Syntax
------

.. code-block:: none

   GET /groups/{GROUP-ID}/clusters/{HOSTNAME}/logs/{LOG-NAME}


Request Path Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :header-rows: 1
   :widths: 15 10 75

   * - Parameter
     - Required/Optional
     - Description

   * - ``GROUP-ID``
     - Required
     - Project identifier.

   * - ``HOSTNAME``

     - Required

     - The name of the host where the log files that you want to download
       are stored. To see the hostnames of your |service| cluster, use the
       :doc:`/api/atlas/v1.0/groups/{GROUP-ID}/clusters </reference/api/clusters-get-all>`
       endpoint.

   * - ``LOG-NAME``
     - Required
     - The name of the log file that you want to retrieve:
       
       - :manual:`mongodb.gz </reference/program/mongod>`
         
       - :manual:`mongos.gz </reference/program/mongos>`

       - ``mongodb-audit-log.gz``
         
       - ``mongos-audit-log.gz``

         .. note:: 

            Audit logs are only available if you have enabled
            :doc:`Database Auditing </database-auditing>` for an
            |service| project.

Request Query Parameters
~~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :header-rows: 1
   :widths: 15 10 75

   * - Field
     - Required/Optional
     - Description

   * - ``startDate``

     - Optional.

     - |Epoch-time| that specifies starting point for the range of
       log messages to retrieve. Default is 24 hours prior to the
       current timestamp.

   * - ``endDate``

     - Optional.

     - |Epoch-time| that specifies the end point for the range of log
       messages to retrieve. Default is current timestamp.

Request Body Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/no-body-parameters.rst

Response Elements
-----------------

The endpoint responds with a compressed log file :file:`mongodb.gz`.


Example
-------

This example downloads the log file to the directory from which you made the request.

Example Request
~~~~~~~~~~~~~~~

The following example downloads the server log for the ``mongod``
instance running on the specified host:

.. code-block:: sh

   curl --user '{PUBLIC-KEY}:{PRIVATE-KEY}' --digest \
    --header 'Accept: application/gzip' \
    --request GET "https://cloud.mongodb.com/api/atlas/v1.0/groups/{GROUP-ID}/clusters/{HOSTNAME}/logs/mongodb.gz" \
    --output "mongodb.gz"

Example Response
~~~~~~~~~~~~~~~~

The ``curl`` command in this example saves the log file to :file:`mongodb.gz`
and shows the following progress output. 

.. code-block:: sh
   :copyable: false

   %     Total  % Received % Xferd  Average  Speed   Time    Time     Time  Current
                                    Dload    Upload  Total   Spent    Left  Speed
   100   106     100       106      0        0       134     0 --:--:-- -   134



