====================================
MMS On-Prem Backup Binary Management
====================================

.. default-domain:: mongodb

Overview
--------

The MMS service backup daemon recreates every replica set you backup up
and applies the oplog entries sent by the backup agents. MMS
maintains a standalone MongoDB database on disk for each backed up replica
set, also called a *head*. Each head is less than or equal to the last oplog
supplied by the backup agent.

The backup daemon must use a :program:`mongod` equal or greater than the
version of any replica set it backs up. If version 2.4.9 is the latest
revision installed on the daemon, for example, backing up a :program:`mongod`
with version 2.4.8 will use a 2.4.9 mongo for head. However, backing up a
2.4.10 :program:`mongod` with a 2.4.9 daemon will result in an error.

The ``conf-daemon.properties`` configuration file in the
``/opt/mongodb/mms-backup-daemon/conf`` folder
includes two directives to manage and use the :program:`mongod`
binaries: :setting:`mongodb.release.directory` and
:setting:`mongodb.release.autoDownload`.

Settings
--------

.. setting:: mongodb.release.directory

   Specify the full directory path of a folder that contains every
   MongoDB release that the backup daemon requires. If you update
   versions manually, name the folders within this full directory path
   using the following form:

   .. code-block:: none

      mongodb-<platform>-<architecture>-<version>

   For example:

   .. code-block:: none

      mongodb-linux-x86_64-2.4.8
      mongodb-linux-x86_64-2.4.9
      mongodb-linux-x86_64-2.4.10
      mongodb-linux-x86_64-2.6.0

.. setting:: mongodb.release.autoDownload

   Specify ``true`` for active or ``false`` for inactive.

   The ``/opt/mongodb/backup-daemon/bin`` directory includes the
   ``mongodb-fetch`` utility that will download the latest releases
   directly from ``downloads.mognodb.org``. The
   :setting:`~mongodb.release.autoDownload` setting operation runs
   automatically this utility once an hour when the service starts.

   If automatic downloading is a security concern, set
   :setting:`mongodb.release.autoDownload` to
   ``false``. You must then place the needed MongoDB releases in the
   :setting:`mongodb.release.directory` manually.
