.. _atlas-create-peering-container-api:

======================================
Create a New Network Peering Container
======================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Creates one Network Peering container into which |service| can deploy
Network Peering connections.

The following table outlines the maximum number of Network Peering
containers per cloud provider:

.. list-table::
   :header-rows: 1
   :widths: 10 40

   * - Cloud Provider
     - Container Limit
   * - GCP
     - One container per project.
   * - AWS and Azure
     - One container per cloud provider region.

You must have either the :authrole:`Project Owner` or
:authrole:`Organization Owner` role to successfully call this endpoint.

.. include:: /includes/fact-projects-groups-synonyms.rst

.. include:: /includes/api/base-api-uri.rst

Resource
--------

.. code-block:: sh

   POST /groups/{GROUP-ID}/containers

Request Path Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :header-rows: 1
   :widths: 20 14 11 55

   * - Parameter
     - Type
     - Necessity
     - Description

   * - GROUP-ID
     - string
     - Required
     - Unique identifier for the |service| project whose Network
       Peering container details you want to retrieve.

Request Query Parameters
~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/api/no-query-single-parameters.rst

Request Body Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. tabs-cloud-providers::

   .. tab::
      :tabid: aws

      .. list-table::
         :header-rows: 1
         :stub-columns: 1
         :widths: 20 14 11 55

         * - Parameter
           - Type
           - Necessity
           - Description

         * - atlasCidrBlock
           - string
           - Required
           - |cidr| block that |service| uses for the network peering
             containers in your project.

             .. include:: /includes/fact-vpc-cidr-block.rst

         * - providerName
           - string
           - Optional
           - Cloud provider for this Network Peering connection.
             If omitted, |service| sets this parameter to **AWS**.

         * - regionName
           - string
           - Required
           - |service| region where the container resides.

             .. include:: /includes/fact-aws-region-names.rst

   .. tab::
      :tabid: gcp

      .. list-table::
         :header-rows: 1
         :stub-columns: 1
         :widths: 20 14 11 55

         * - Parameter
           - Type
           - Necessity
           - Description

         * - atlasCidrBlock
           - string
           - Conditional
           - |cidr| block that |service| uses for the network peering
             containers in your project.

             .. include:: /includes/fact-gcp-peering-atlas-cidr-block.rst

             This field is required if you use the standard |service|
             |cidr| block of **/18** for |gcp|-backed clusters.

             If your application requires |service| to use a smaller
             |cidr| block, this field is optional. If omitted, the
             value of this field defaults to **192.168.248.0/21**.

         * - providerName
           - string
           - Required
           - Cloud provider for this network peering connection. Set
             this value to **GCP**.

         * - regions
           - array of strings
           - Optional
           - |service| regions where the container resides. Provide
             this field only if you provide an **atlasCidrBlock**
             smaller than **/18**.

             |service| accepts the following values:

             .. include:: /includes/fact-gcp-region-names.rst

             .. important::

                - In this |service| project, you can deploy |service|
                  clusters only to the |gcp| regions that you specify
                  in the **regions** array. If you must deploy
                  |service| clusters to other |gcp| regions, create
                  additional |service| projects.
                - |service| accepts up to eight regions in the
                  **regions** field, based on the **atlasCidrBlock**
                  you choose.

   .. tab::
      :tabid: azure

      .. list-table::
         :header-rows: 1
         :stub-columns: 1
         :widths: 20 14 11 55

         * - Parameter
           - Type
           - Necessity
           - Description

         * - atlasCidrBlock
           - string
           - Required
           - |cidr| block that |service| uses for the network peering
             containers in your project.

             .. include:: /includes/fact-peering-azure-atlas-cidr-block.rst

         * - providerName
           - string
           - Required
           - Cloud provider for this network peering connection. Set
             this value to **AZURE**.

         * - region
           - string
           - Required
           - |service| region where the container resides. |service|
             accepts the following values:

             .. include:: /includes/fact-azure-region-names.rst


Response Elements
~~~~~~~~~~~~~~~~~

.. tabs-cloud-providers::

   .. tab::
      :tabid: aws

      .. list-table::
         :header-rows: 1
         :widths: 20 14 66

         * - Field
           - Type
           - Description

         * - atlasCidrBlock
           - string
           - |cidr| block that |service| uses for your clusters.

         * - id
           - string
           - Unique identifier of the Network Peering container.

         * - provisioned
           - boolean
           - Flag that indicates whether the project has Network
             Peering connections deployed in the container.

         * - regionName
           - string
           - Region. Provided for |aws| |vpc|\s only.

         * - vpcId
           - string
           - Unique identifier of the project's |vpc|.

   .. tab::
      :tabid: gcp

      .. list-table::
         :header-rows: 1
         :widths: 20 14 66

         * - Field
           - Type
           - Description

         * - atlasCidrBlock
           - string
           - |cidr| block that |service| uses for your clusters.

         * - gcpProjectId
           - string
           - Unique identifier of the |gcp| project in which the
             network peer resides. Returns **null**. This field value
             is populated when you
             :ref:`Create One New Network Peering Connection <vpc-create-peering-connection>`.

             See :ref:`Get Network Peering Containers in a Project by
             Cloud Provider <vpc-get-containers-list>` after you create
             a peering connection to get the updated value of this
             field. You must provide this value when you create a |vpc|
             in |gcp|.

         * - id
           - string
           - Unique identifier of the container.

         * - provisioned
           - boolean
           - Flag that indicates whether the project has Network
             Peering connections deployed in the container.

         * - networkName
           - string
           - Unique identifier of the Network Peering connection in the
             |service| project. Returns **null**. This field value is
             populated when you
             :ref:`Create One New Network Peering Connection <vpc-create-peering-connection>`.

             See :ref:`Get Network Peering Containers in a Project by
             Cloud Provider <vpc-get-containers-list>` after you create
             a peering connection to get the updated value of this
             field. You must provide this value when you create a |vpc|
             in |gcp|.

         * - regions
           - array of strings
           - |service| regions where the container resides. |service|
             returns values for this field only if you provided them in
             the request when you created the network peering
             container.

   .. tab::
      :tabid: azure

      .. list-table::
         :header-rows: 1
         :widths: 20 14 66

         * - Field
           - Type
           - Description

         * - atlasCidrBlock
           - string
           - CIDR block that |service| uses for the clusters in
             your project.

         * - azureSubscriptionId
           - string
           - Unique identifer of the Azure subscription in which the
             VNet resides.

         * - id
           - string
           - Unique identifier of the container.

         * - providerName
           - string
           - Name of the cloud provider.

         * - provisioned
           - boolean
           - Flag that indicates whether the project has Network
             Peering connections deployed in the container.

         * - region
           - string
           - Azure region where the container resides.

         * - vnetName
           - string
           - Name of the Azure VNet. This value is **null** until you
             provision an Azure VNet in the container.

Example Request
---------------

.. tabs-cloud-providers::

   .. tab::
      :tabid: aws

      .. code-block:: sh
         :emphasize-lines: 4-9
         :linenos:

         curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" --digest \
              --header "Accept: application/json" \
              --header "Content-Type: application/json" \
              --request POST "https://cloud.mongodb.com/api/atlas/v1.0/groups/5356823b3794dee37132bb7b/containers?pretty=true" \
              --data '
                {
                  "atlasCidrBlock" : "10.8.0.0/21",
                  "providerName" : "AWS",
                  "regionName" : "US_EAST_1"
                }'

   .. tab::
      :tabid: gcp

      .. code-block:: sh
         :emphasize-lines: 4-8
         :linenos:

         curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" --digest \
              --header "Accept: application/json" \
              --header "Content-Type: application/json" \
              --request POST "https://cloud.mongodb.com/api/atlas/v1.0/groups/5356823b3794dee37132bb7b/containers?pretty=true" \
              --data '
                {
                  "atlasCidrBlock" : "10.8.0.0/18",
                  "providerName" : "GCP"
                }'

   .. tab::
      :tabid: azure

      .. code-block:: sh
         :emphasize-lines: 4-9
         :linenos:

         curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" --digest \
              --header "Accept: application/json" \
              --header "Content-Type: application/json" \
              --request POST "https://cloud.mongodb.com/api/atlas/v1.0/groups/5356823b3794dee37132bb7b/containers?pretty=true" \
              --data '
                {
                  "atlasCidrBlock" : "10.8.0.0/21",
                  "providerName" : "AZURE",
                  "region" : "US_EAST_2"
                }'


Example Response
----------------

.. tabs-cloud-providers::

   .. tab::
      :tabid: aws

      .. code-block:: json
         :emphasize-lines: 2, 3, 5
         :linenos:

         {
           "atlasCidrBlock" : "10.8.0.0/21",
           "id" : "1112269b3bf99403840e8934",
           "provisioned" : true,
           "regionName" : "US_EAST_1",
           "vpcId" : "vpc-zz0zzzzz"
         }

   .. tab::
      :tabid: gcp

      .. code-block:: json
         :emphasize-lines: 2, 4, 5
         :linenos:

         {
           "atlasCidrBlock" : "10.8.0.0/18",
           "id" : "1112269b3bf99403840e8934",
           "gcpProjectId" : "null",
           "networkName" : "null",
           "provisioned" : true
         }

   .. tab::
      :tabid: azure

      .. code-block:: json
         :emphasize-lines: 2, 4, 7
         :linenos:

         {
           "atlasCidrBlock":"10.8.0.0/21",
           "azureSubscriptionId":"602336d43d098d433845971g",
           "id":"5cbf563d87d9d67253be590a",
           "providerName":"AZURE",
           "provisioned":false,
           "region":"US_EAST_2",
           "vnetName":null
         }
