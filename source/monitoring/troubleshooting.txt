===============
Troubleshooting
===============

The document provide troubleshooting advice for common issues
encountered installing the MMS agent, and working with hmac. For answers
to other questions, see the :doc:`FAQ </monitoring/faq>`.

.. _troubleshooting:

.. index:: troubleshooting
   single: agent; troubleshooting

Troubleshooting: MMS Agent Installation
---------------------------------------

Consider the following issues if you encounter difficulty installing
the MMS agent.

- Make sure that the system running the agent has ``pymongo``
  installed. If your system runs a 2.4.x series Python, verify the
  installation of other :ref:`requirements <mms-requirements>`.

- Ensure that the system running the agent can resolve and connect to the
  MongoDB instances. To confirm, log into the system where the agent
  is running and issue a command in the following form: ::

       mongo [hostname]:[port]

  Replace ``[hostname]`` with the hostname and ``[port]`` with the
  port that the database is listening on.

- Verify that the agent can connect on TCP port 443 (outbound) to the MMS
  server (i.e. "``mms.10gen.com``".)

- Allow the agent to run for 5-10 minutes to allow host discovery
  and initial data collection.

- If your MongoDB instances run with authentication enabled, ensure
  that MMS has these credentials. Supply these credentials on the "Add
  Host Interface," for every host that has authentication enabled, when
  adding a host. You may also click on the "Edit" host button (i.e. the
  pencil) on the Hosts page in the MMS console to provide credentials.

- If you continue to encounter problems, check the agent's output or
  logs for errors.

.. _troubleshooting-hmac:

.. index:: hmac; hmac troubleshooting

Troubleshooting: hmac Installation
----------------------------------

.. note::

   This section addresses a potential issue for users running a
   version of Python in the 2.4-series. Users of later Python
   versions do not require hmac.

If ``easy_install`` produces an error, or you see the following error
in your agent logs, you will need to install the ``hmac`` package
manually: ::

     AttributeError:'builtin_function_or_method' object has no attribute 'new'

To install the ``hmac`` package, begin by downloading the latest
source package. The following example uses version ``20101005``.
Issue the following command: ::

     curl http://pypi.python.org/packages/source/h/hmac/hmac-20101005.tar.gz > hmac-20101005.tar.gz

Always download the latest version of ``hmac``, which
you can find at the `hmac page on PyPi <http://pypi.python.org/pypi/hmac>`_.

Extract the files from the archive with the following command: ::

     tar -zxf hmac-20101005.tar.gz

Change directories, build and install the package with the following
sequence: ::

     cd hmac-20101005/
     python setup.py install

You may need root (i.e. ``sudo``) privileges to run the final
``install`` step.
