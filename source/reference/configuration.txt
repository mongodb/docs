.. _conf-mms.properties:

===============================
|onprem| Configuration Settings
===============================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. include:: /includes/styles/corrections.rst

.. include:: /includes/overview-ops-manager-config.rst

You configure local settings through a server's ``conf-mms.properties``
file. Each server's ``conf-mms.properties`` must contain the connection
string and authentication settings for accessing the |onprem|
Application Database. The ``conf-mms.properties`` file also contains
any overrides of global settings specific to that server.

The location of the ``conf-mms.properties`` file depends on how you
installed |onprem|, as described in the table below.

.. list-table::
   :widths: 35 65
   :header-rows: 1

   * - Install method

     - ``conf-mms.properties`` location

   * - ``rpm`` or ``deb`` package

     - ``/opt/mongodb/mms/conf/``

   * - ``tar.gz`` archive

     - ``<install-directory>/conf/``

   * - ``msi`` file (Windows)

     - ``<install-folder>\Server\Config``

       By default, this is: ``C:\MMSData\Server\Config``.

.. _bypass-ui-config:

Bypass Initial Configuration via the User Interface
---------------------------------------------------

If you would like to skip the initial setup wizard after creating the
first account and either edit the ``conf-mms.properties`` file or use
the API to configure |onprem|, change the following settings. This
setting can help if you are automating the deployment of |onprem|
instances.

.. include:: /includes/option/setting-fileConf-mms.ignoreInitialUiSetup.rst

All Clusters View
-----------------

.. include:: /includes/option/setting-fileConf-mms.allclusters.onlyMembership.rst

Application Database Connection Settings
----------------------------------------

The following settings configure the |onprem| connection to the
:ref:`mms-application-database`. You must configure this setting in the
:ref:`conf-mms.properties <conf-mms.properties>` file on each |onprem|
server. To encrypt authentication information, see
:ref:`encrypt-mongodb-user-credentials`.

.. include:: /includes/option/setting-fileConf-mongo.mongoUri.rst
.. include:: /includes/option/setting-fileConf-mongo.encryptedCredentials.rst

Kerberos Authentication to |application| Database
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/option/setting-fileConf-mms.kerberos.debug.rst
.. include:: /includes/option/setting-fileConf-mms.kerberos.keyTab.rst
.. include:: /includes/option/setting-fileConf-mms.kerberos.principal.rst
.. include:: /includes/option/setting-fileConf-jvm.java.security.krb5.conf.rst
.. include:: /includes/option/setting-fileConf-jvm.java.security.krb5.kdc.rst
.. include:: /includes/option/setting-fileConf-jvm.java.security.krb5.realm.rst

TLS/SSL Connection to the Application Database
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/option/setting-fileConf-mongo.ssl.rst
.. include:: /includes/option/setting-fileConf-mongodb.ssl.CAFile.rst
.. include:: /includes/option/setting-fileConf-mongodb.ssl.PEMKeyFile.rst
.. include:: /includes/option/setting-fileConf-mongodb.ssl.PEMKeyFilePassword.rst


Automation Default Paths
------------------------

.. include:: /includes/option/setting-fileConf-automation.default.backupAgentLogFile.rst
.. include:: /includes/option/setting-fileConf-automation.default.backupAgentLogFileWindows.rst
.. include:: /includes/option/setting-fileConf-automation.default.certificateAuthorityFile.rst
.. include:: /includes/option/setting-fileConf-automation.default.certificateAuthorityFileWindows.rst
.. include:: /includes/option/setting-fileConf-automation.default.dataRoot.rst
.. include:: /includes/option/setting-fileConf-automation.default.downloadBase.rst
.. include:: /includes/option/setting-fileConf-automation.default.downloadBaseWindows.rst
.. include:: /includes/option/setting-fileConf-automation.default.monitoringAgentLogFile.rst
.. include:: /includes/option/setting-fileConf-automation.default.monitoringAgentLogFileWindows.rst
.. include:: /includes/option/setting-fileConf-mms.agentCentralUrl.rst

Backup
------

.. include:: /includes/option/setting-fileConf-mms.alerts.BackupAgentConfCallFailure.maximumFailedConfCalls.rst
.. include:: /includes/option/setting-fileConf-mms.alerts.OutsideSpaceUsedThreshold.maximumSpaceUsedPercent.rst
.. include:: /includes/option/setting-fileConf-mms.backupCentralUrl.rst
.. include:: /includes/option/setting-fileConf-mms.backup.journal.heads.rst
.. include:: /includes/option/setting-fileConf-mms.backup.minimumOplogWindowHours.rst

Backup Snapshots
~~~~~~~~~~~~~~~~

.. include:: /includes/option/setting-fileConf-backup.fileSystemSnapshotStore.gzip.compressionLevel.rst

.. include:: /includes/option/setting-fileConf-brs.restore.digest.method.rst
.. include:: /includes/option/setting-fileConf-brs.snapshotSchedule.interval.rst
.. include:: /includes/option/setting-fileConf-brs.snapshotSchedule.retention.base.rst
.. include:: /includes/option/setting-fileConf-brs.snapshotSchedule.retention.daily.rst
.. include:: /includes/option/setting-fileConf-brs.snapshotSchedule.retention.monthly.rst
.. include:: /includes/option/setting-fileConf-brs.snapshotSchedule.retention.weekly.rst
.. include:: /includes/option/setting-fileConf-backup.kmip.server.host.rst
.. include:: /includes/option/setting-fileConf-backup.kmip.server.port.rst
.. include:: /includes/option/setting-fileConf-backup.kmip.server.ca.file.rst
.. include:: /includes/option/setting-fileConf-mms.backup.snapshot.maxSumFileForWorkersMB.rst
.. include:: /includes/option/setting-fileConf-mms.backup.snapshot.maxWorkers.rst


Queryable Snapshot Configuration
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/option/setting-fileConf-brs.queryable.connecttimeout.rst
.. include:: /includes/option/setting-fileConf-brs.queryable.expiration.rst
.. include:: /includes/option/setting-fileConf-brs.queryable.lruCacheCapacityMB.rst
.. include:: /includes/option/setting-fileConf-brs.queryable.mounttimeout.rst
.. include:: /includes/option/setting-fileConf-brs.queryable.pem.pwd.rst
.. include:: /includes/option/setting-fileConf-brs.queryable.pem.rst
.. include:: /includes/option/setting-fileConf-brs.queryable.proxyPort.rst

Email
-----

.. include:: /includes/option/setting-fileConf-mms.fromEmailAddr.rst
.. include:: /includes/option/setting-fileConf-mms.replyToEmailAddr.rst
.. include:: /includes/option/setting-fileConf-mms.adminEmailAddr.rst
.. include:: /includes/option/setting-fileConf-mms.emailDaoClass.rst

SMTP Email Server Settings
~~~~~~~~~~~~~~~~~~~~~~~~~~

*Conditional.* Use the following settings appear if
:setting:`mms.emailDaoClass` is
``com.xgen.svc.core.dao.email.JavaEmailDao``.

.. include:: /includes/option/setting-fileConf-mms.mail.transport.rst
.. include:: /includes/option/setting-fileConf-mms.mail.hostname.rst
.. include:: /includes/option/setting-fileConf-mms.mail.port.rst
.. include:: /includes/option/setting-fileConf-mms.mail.username.rst
.. include:: /includes/option/setting-fileConf-mms.mail.password.rst
.. include:: /includes/option/setting-fileConf-mms.mail.tls.rst

AWS Simple Email Service Settings
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

*Conditional.* Use the following settings appear if
:setting:`mms.emailDaoClass` is
``com.xgen.svc.core.dao.email.AwsEmailDao``.

.. include:: /includes/option/setting-fileConf-aws.ses.endpoint.rst
.. include:: /includes/option/setting-fileConf-aws.accesskey.rst
.. include:: /includes/option/setting-fileConf-aws.secretkey.rst

HTTP/HTTPS Proxy Settings
-------------------------

.. include:: /includes/option/setting-fileConf-http.proxy.host.rst
.. include:: /includes/option/setting-fileConf-http.proxy.port.rst
.. include:: /includes/option/setting-fileConf-http.proxy.username.rst
.. include:: /includes/option/setting-fileConf-http.proxy.password.rst

MongoDB Version Management
--------------------------

.. include:: /includes/option/setting-fileConf-automation.versions.source.rst
.. include:: /includes/option/setting-fileConf-automation.versions.directory.rst
.. include:: /includes/option/setting-fileConf-mongodb.release.autoDownload.rst
.. include:: /includes/option/setting-fileConf-mongodb.release.autoDownload.enterprise.rst
.. include:: /includes/option/setting-fileConf-mongodb.release.modulePreference.rst

MongoDB Usage
-------------

.. include:: /includes/option/setting-fileConf-default-server-mode.rst
.. include:: /includes/option/setting-fileConf-mongoDbUsage-ui-enabled.rst
.. include:: /includes/option/setting-fileConf-mongoDbUsage-collectData.rst


Monitoring
----------

.. include:: /includes/option/setting-fileConf-mms.agentCentralUrl.rst

.. _config-monitoring-agent-failover:
.. _standby-monitoring-agent:

Monitoring Failover
~~~~~~~~~~~~~~~~~~~

You can :ref:`activate the Monitoring function <activate-monitoring>`
on multiple {+mdbagent+}s to distribute monitoring assignments and
provide failover. |mms| distributes monitoring assignments among up to
100 running {+mdbagent+}s. Each {+mdbagent+} running active Monitoring
monitors a different set of MongoDB processes. One {+mdbagent+} running
active Monitoring per project is the primary Monitor. The primary
Monitor reports the cluster's status to |mms|. As {+mdbagent+}s have
Monitoring enabled or disabled, |mms| redistributes assignments. If the
primary Monitor fails, |mms| assigns another {+mdbagent+} running
active Monitoring to be the primary Monitor.

The following settings tune the interval |onprem| uses to determine if
a {+magent+} is unaccessible and the frequency with which standby
agents poll |onprem| to determine if they should receive monitoring
assignments.

.. include:: /includes/option/setting-fileConf-mms.monitoring.agent.session.timeoutMillis.rst
.. include:: /includes/option/setting-fileConf-mms.monitoring.agent.standbyCollectionFactor.rst

Public API
----------

.. include:: /includes/option/setting-fileConf-mms.publicApi.whitelistEnabled.rst

Security Settings
-----------------

.. include:: /includes/option/setting-fileConf-mms.security.disableBrowserCaching.rst
.. include:: /includes/option/setting-fileConf-mms.security.hstsMaxAgeSeconds.rst

.. _snmp-heartbeat-configure:

SNMP Heartbeat Settings
-----------------------

.. include:: /includes/fact-snmp-heartbeat-configure.rst

.. include:: /includes/option/setting-fileConf-snmp.community.rst
.. include:: /includes/option/setting-fileConf-snmp.default.heartbeat.interval.rst
.. include:: /includes/option/setting-fileConf-snmp.default.hosts.rst
.. include:: /includes/option/setting-fileConf-snmp.listen.port.rst

Non-Uniform Memory Access (NUMA) Settings
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/option/setting-fileConf-mongodb.disable.numa.rst

Twilio Integration Settings
---------------------------

.. include:: /includes/fact-twilio-config.rst

.. include:: /includes/option/setting-fileConf-twilio.account.sid.rst
.. include:: /includes/option/setting-fileConf-twilio.auth.token.rst
.. include:: /includes/option/setting-fileConf-twilio.from.num.rst

User Authentication
-------------------

.. include:: /includes/option/setting-fileConf-mms-email-validation.rst
.. include:: /includes/option/setting-fileConf-mms.userSvcClass.rst

Authentication through |onprem| Application Database
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/option/setting-fileConf-mms.password.maxDaysBeforeChangeRequired.rst
.. include:: /includes/option/setting-fileConf-mms.password.maxDaysInactiveBeforeAccountLock.rst
.. include:: /includes/option/setting-fileConf-mms.password.maxFailedAttemptsBeforeAccountLock.rst
.. include:: /includes/option/setting-fileConf-mms.password.minChangesBeforeReuse.rst
.. include:: /includes/option/setting-fileConf-mms.user.invitationOnly.rst
.. include:: /includes/option/setting-fileConf-mms.user.bypassInviteForExistingUsers.rst

Authentication through LDAP
~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/fact-ldap-configuration.rst

.. include:: /includes/option/setting-fileConf-mms.ldap.bindDn.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.bindPassword.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.global.role.automationAdmin.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.global.role.backupAdmin.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.global.role.monitoringAdmin.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.global.role.owner.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.global.role.readOnly.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.global.role.userAdmin.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.group.baseDn.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.group.member.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.group.separator.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.referral.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.ssl.CAFile.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.ssl.PEMKeyFile.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.ssl.PEMKeyFilePassword.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.url.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.user.baseDn.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.user.email.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.user.firstName.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.user.group.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.user.lastName.rst
.. include:: /includes/option/setting-fileConf-mms.ldap.user.searchAttribute.rst
.. include:: /includes/option/setting-fileConf-mms.login.newDeviceNotification.enabled.rst

Authentication through SAML
~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/option/setting-fileConf-mms.saml.idp.uri.rst
.. include:: /includes/option/setting-fileConf-mms.saml.sso.url.rst
.. include:: /includes/option/setting-fileConf-mms.saml.slo.url.rst
.. include:: /includes/option/setting-fileConf-mms.saml.x509.cert.rst
.. include:: /includes/option/setting-fileConf-mms.saml.ssl.PEMKeyFile.rst
.. include:: /includes/option/setting-fileConf-mms.saml.ssl.PEMKeyFilePassword.rst
.. include:: /includes/option/setting-fileConf-mms.saml.encrypted.assertions.rst
.. include:: /includes/option/setting-fileConf-mms.saml.signature.algorithm.rst
.. include:: /includes/option/setting-fileConf-mms.saml.global.role.owner.rst
.. include:: /includes/option/setting-fileConf-mms.saml.global.role.automationAdmin.rst
.. include:: /includes/option/setting-fileConf-mms.saml.global.role.backupAdmin.rst
.. include:: /includes/option/setting-fileConf-mms.saml.global.role.monitoringAdmin.rst
.. include:: /includes/option/setting-fileConf-mms.saml.global.role.userAdmin.rst
.. include:: /includes/option/setting-fileConf-mms.saml.global.role.readOnly.rst
.. include:: /includes/option/setting-fileConf-mms.saml.user.firstName.rst
.. include:: /includes/option/setting-fileConf-mms.saml.user.lastName.rst
.. include:: /includes/option/setting-fileConf-mms.saml.user.email.rst
.. include:: /includes/option/setting-fileConf-mms.saml.group.member.rst


Multi-Factor Authentication (MFA) Setttings
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/option/setting-fileConf-mms.multiFactorAuth.level.rst
.. include:: /includes/option/setting-fileConf-mms.multiFactorAuth.allowReset.rst
.. include:: /includes/option/setting-fileConf-mms.multiFactorAuth.issuer.rst
.. include:: /includes/option/setting-fileConf-mms.multiFactorAuth.require.rst

Other Authentication Settings
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/option/setting-fileConf-reCaptcha.enabled.registration.rst
.. include:: /includes/option/setting-fileConf-reCaptcha.enabled.rst
.. include:: /includes/option/setting-fileConf-reCaptcha.private.key.rst
.. include:: /includes/option/setting-fileConf-reCaptcha.public.key.rst
.. include:: /includes/option/setting-fileConf-mms.session.maxHours.rst

Web Server
----------

.. include:: /includes/option/setting-fileConf-mms.centralUrl.rst
.. include:: /includes/option/setting-fileConf-mms.https.PEMKeyFile.rst
.. include:: /includes/option/setting-fileConf-mms.https.PEMKeyFilePassword.rst
.. include:: /includes/option/setting-fileConf-mms.https.ClientCertificateMode.rst
.. include:: /includes/option/setting-fileConf-mms.https.CAFile.rst
.. include:: /includes/option/setting-fileConf-mms.remoteIp.header.rst
.. include:: /includes/option/setting-fileConf-mms.minimumTLSVersion.rst
.. include:: /includes/option/setting-fileConf-mms.disableCiphers.rst

Webhook
-------

.. include:: /includes/option/setting-fileConf-mms.alerts.webhook.adminEndpoint.rst
.. include:: /includes/option/setting-fileConf-mms.alerts.webhook.adminSecret.rst
