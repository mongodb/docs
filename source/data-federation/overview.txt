.. _data-federation-overview:

==============================
{+adf+} Overview  
==============================

.. default-domain:: mongodb

.. meta::
   :keywords: {+df+}

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. _atlas-data-federation-about:

About {+adf+}
---------------------------

{+adf+} is a distributed query engine that allows you to natively 
query, transform, and move data across various sources inside & outside 
of |service-fullname|. 

Sample Uses 
~~~~~~~~~~~

You can use {+adf+} to: 

- Copy |service| cluster data into Parquet or |csv| files written to 
  |aws| |s3| buckets. 
- Query across multiple |service| clusters to get a holistic view of 
  your data.
- Materialize aggregations across |service| clusters and |aws| |s3| 
  data.
- Read and import data from your |aws| |s3| buckets into an |service| 
  cluster.

Key Concepts 
~~~~~~~~~~~~

.. expression:: Federated Database Instance 

   A {+fdi+} is a deployment of {+adf+}. Each {+fdi+} contains virtual 
   databases and collections that map to data in your data stores.

.. expression:: Data Store 

   Data store refers to the location of your data. {+adf+} supports the 
   following data stores: 

   - |service| cluster 
   - {+adl+} datasets
   - |aws| |s3| buckets 
   - |http| endpoints

.. expression:: Storage Configuration 

   Storage configuration contains mappings between your virtual 
   databases and collections and data sources in |json| format. You can 
   define these mappings in the storage configuration to access and run 
   queries against your data.

.. _atlas-data-federation-regions:

{+adf+} Regions 
-----------------------------

.. note::

   To prevent excessive charges on your bill, create your {+adf+} in 
   the same |aws| region as your |s3| data source.

{+adf+} routes your federated database requests through one of the 
following regions:

.. include:: /includes/list-table-adf-supported-aws-regions.rst

.. note::

   You will incur charges when running federated queries. For more 
   information, see :ref:`atlas-data-federation-billing`.

{+adf+} Costs 
---------------------------

You incur {+adf+} costs for the following items: 

- Data processed by {+fdi+}
- Data returned by {+fdi+}

Total Data Processed
~~~~~~~~~~~~~~~~~~~~

|service| charges for the total number of bytes that {+adf+} processes 
from your |aws| |s3| buckets, rounded up to the nearest megabyte. 
|service| charges $5.00 per GB of processed data per query.

You incur "Data Processed" costs for the amount of data that {+adf+} 
processes to return results for your queries in addition to the "Data 
Returned" cost for the amount of data that {+adf+} returns. For 
example, for a 10 GB file, you incur the following "Data Processed" 
cost in addition to the "Data Returned" cost:

- If you have no partitions, {+adf+} reads the entire file to return 
  results for the query. Therefore, you incur 10 GB of "Data Processed" 
  cost.
- If you have 10 partitions of 1 GB each, {+adf+} targets and reads a 
  single partition. Therefore, you incur 1 GB of "Data Processed" cost.

You can use partitioning strategies and compression in |AWS| |s3| to 
reduce the amount of processed data.

Total Data Returned and Transferred
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|service| charges for the total number of bytes returned and 
transferred by your {+fdi+}. This total is the sum of all the following 
data transfers:

- The number of bytes returned and transferred within the |aws| region
- The number of bytes returned to the client

The cost of data transfer depends on the Cloud Service Provider charges 
for same-region, region-to-region, or region-to-internet data transfer. 
|aws| charges $0.01 per GB for the number of bytes returned and 
transferred within |aws| region and for the number of bytes returned to 
the client.

.. seealso:: 

   |service-pricing|
