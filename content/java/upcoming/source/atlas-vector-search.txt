.. _java-atlas-vector-search:

=====================
MongoDB Vector Search
=====================

.. facet::
   :name: genre
   :values: reference

.. meta::
   :keywords: full text, text analyzer, meta, pipeline, scoring, Lucene, AI, artificial intelligence, code example, semantic, nearest
   :description: Learn about how to use MongoDB Vector Search in the {+driver-long+}.

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Overview
--------

In this guide, you can learn how to use the 
:atlas:`{+vector-search+} </atlas-vector-search/vector-search-overview/>` 
feature in the {+driver-short+}. The ``Aggregates`` builders class provides the
the ``vectorSearch()`` helper method that you can use to
create a :atlas:`$vectorSearch </atlas-vector-search/vector-search-stage/>`
pipeline stage. This pipeline stage allows you to perform a **semantic
search** on your documents. A semantic search is a type of search which
locates information that is similar in meaning, but not necessarily
identical, to your provided search term or phrase.

.. important:: Feature Compatibility

   To learn what versions of MongoDB Atlas support this feature, see
   :atlas:`Limitations </atlas-vector-search/vector-search-stage/#limitations>`
   in the MongoDB Atlas documentation.

Perform a Vector Search
-----------------------

To use this feature, you must create a vector search index and index your
vector embeddings. To learn about how to programmatically create a
vector search index, see the :ref:`java-search-indexes` section in the
Indexes guide. To learn more about vector embeddings, see
:atlas:`How to Index Vector Embeddings for Vector Search
</atlas-search/field-types/knn-vector/>` in the Atlas documentation.

After you create a vector search index on your vector embeddings, you
can reference this index in your pipeline stage, as shown in the
following section.

Vector Search Example
~~~~~~~~~~~~~~~~~~~~~

The following example shows how to build an aggregation pipeline that uses the
``vectorSearch()`` and ``project()`` methods to compute a vector search score:

.. literalinclude:: /includes/fundamentals/code-snippets/builders/AggBuilders.java
   :start-after: // begin vectorSearch
   :end-before: // end vectorSearch
   :language: java
   :dedent:

.. tip:: Query Vector Type

   The preceding example creates an instance of ``BinaryVector`` to
   serve as the query vector, but you can also create a ``List`` of
   ``Double`` instances. However, we recommend that you use the
   ``BinaryVector`` type to improve storage efficiency.

The following example shows how you can run the aggregation and print
the vector search meta-score from the result of the preceding
aggregation pipeline:

.. literalinclude:: /includes/fundamentals/code-snippets/builders/AggBuilders.java
   :start-after: // begin vectorSearch-output
   :end-before: // end vectorSearch-output
   :language: java
   :dedent:

.. tip:: Java Driver Vector Search Examples
    
   Visit the :atlas:`Atlas documentation </atlas-vector-search/tutorials/>`
   to find more tutorials on using the {+driver-short+} to perform Atlas
   Vector Searches.

Query an Auto-Embedding Index
-----------------------------

.. include:: /includes/autoembeddings-note.rst

You can automate vector generation for text searches by querying an auto-embedding
{+vector-search+} index. To learn about how to create an auto-embedding index, see
:ref:`java-autoembedding-search-indexes`.

The following example constructs a vector search query that searches for semantic similarity to the phrase ``time travel`` in the ``plot`` field. The query
uses an auto-embedding {+vector-search+} index on the ``plot`` field named ``auto_embedding_index``:

.. io-code-block::
   :copyable: true

   .. input:: /includes/fundamentals/code-snippets/builders/AggBuilders.java
      :language: java
      :start-after: start-auto-embedding-query
      :end-before: end-auto-embedding-query
      :dedent:

   .. output::

      Title: Manuel on the Island of Wonders
      Plot: Manuel's fantasy travel through Time goes from Long Ago (Episode 1 - O jardim proibido / Le Jardin interdit) through Now (Episode 2 - O pique-nique dos sonhos / Le Pique-nique des r√®ves), ...
      ---
      Title: 11 Minutes Ago
      Plot: Traveling in 11-minute increments, a time-tumbler from 48-years in the future spends two years of his life weaving through a two-hour wedding reception.
      ---
      Title: Time Freak
      Plot: A neurotic inventor creates a time machine and gets lost traveling around yesterday.
      ---
      Title: Timecrimes
      Plot: A man accidentally gets into a time machine and travels back in time nearly an hour. Finding himself will be the first of a series of disasters of unforeseeable consequences.
      ---
      Title: The Little Girl Who Conquered Time
      Plot: A high-school girl acquires the ability to time travel.
      ---
      Title: Time Traveller
      Plot: A high-school girl acquires the ability to time travel.
      ---
      Title: Je t'aime je t'aime
      Plot: Recovering from an attempted suicide, a man is selected to participate in a time travel experiment that has only been tested on mice. A malfunction in the experiment causes the man to ...
      ---
      Title: A.P.E.X.
      Plot: A time-travel experiment in which a robot probe is sent from the year 2073 to the year 1973 goes terribly wrong thrusting one of the project scientists, a man named Nicholas Sinclair into a...
      ---
      Title: The Ah of Life
      Plot: Theoretical mathematician, Nigel Kline finds himself the subject of his own vertical time study. Entering into Einstein's relativity, three versions of Nigel face off with each other, weaving time and space in a world of fluid moments.
      ---
      Title: About Time
      Plot: At the age of 21, Tim discovers he can travel in time and change what happens and has happened in his own life. His decision to make his world a better place by getting a girlfriend turns out not to be as easy as you might think.
      ---

.. note::

   When using an auto embedding index, directly provide the text to search
   rather than a vector representation of that text.

For more information about auto-embedding {+vector-search+} indexes, see the :ref:`java-autoembedding-search-indexes` section of the Indexes guide.

API Documentation
-----------------

To learn more about the methods and types mentioned in this
guide, see the following API documentation:

- `Aggregates.vectorSearch()
  <{+core-api+}/client/model/Aggregates.html#vectorSearch(com.mongodb.client.model.search.FieldSearchPath,java.lang.Iterable,java.lang.String,long,com.mongodb.client.model.search.VectorSearchOptions)>`__

- `FieldSearchPath
  <{+core-api+}/client/model/search/FieldSearchPath.html>`__

- `VectorSearchOptions
  <{+core-api+}/client/model/search/VectorSearchOptions.html>`__

- `Projections.metaVectorSearchScore()
  <{+core-api+}/client/model/Projections.html#metaVectorSearchScore(java.lang.String)>`__

- `BinaryVector <{+api-root+}/bson/org/bson/BinaryVector.html>`__