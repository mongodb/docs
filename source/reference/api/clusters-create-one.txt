================
Create a Cluster
================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. include:: /includes/styles/corrections.rst

.. include:: /includes/fact-projects-groups-synonyms.rst

.. include:: /includes/fact-atlas-api-free-tier-limits.rst

.. include:: /includes/api-requirements.rst

.. include:: /includes/api-base-url.rst

Syntax
------

.. code-block:: none

   POST /api/atlas/v1.0/groups/{GROUP-ID}/clusters

Request Path Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :header-rows: 1
   :widths: 15 10 75

   * - Path Element
     - Required/Optional
     - Description

   * - ``GROUP-ID``

     - Required.

     - Unique identifier for the :ref:`project <group-id>` in which to
       create the cluster.

       .. include:: /includes/fact-cluster-project-limit.rst

Request Body Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/api/list-tables/create-cluster-request-body.rst

Response Elements
-----------------

.. include:: /includes/list-table-cluster-http-response.rst

Example
-------

Request
~~~~~~~

.. tabs::

   tabs:
     - id: single-region
       name: Create Single Region
       content: |

         .. code-block:: shell

            curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" --digest \
              --header "Content-Type: application/json" \
              --include \
              --request POST "https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters" \
              --data '
                {
                  "name" : "DataStore",
                  "diskSizeGB" : 100,
                  "numShards" : 1,
                  "providerSettings" : {
                    "providerName" : "AWS",
                    "diskIOPS" : 300,
                    "instanceSizeName" : "M40",
                    "regionName" : "US_EAST_1"
                  },
                  "replicationFactor" : 3,
                  "backupEnabled" : true,
                  "autoScaling":{"diskGBEnabled":true}
                }'


     - id: multi-region
       name: Create Multi-Region
       content: |

        .. code-block:: shell

           curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" --digest \
             --header "Content-Type: application/json" \
             --include \
             --request POST "https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters" \
             --data '
               {
                 "name" : "DataStore2",
                 "diskSizeGB" : 100,
                 "numShards" : 1,
                 "providerSettings" : {
                   "providerName" : "AWS",
                   "diskIOPS" : 300,
                   "instanceSizeName" : "M10"
                 },
                 "replicationSpec": {
                     "US_EAST_1": {
                       "electableNodes": 3,
                       "priority": 7,
                       "readOnlyNodes" : 0
                     },
                     "US_EAST_2": {
                       "electableNodes": 2,
                       "priority" : 6,
                       "readOnlyNodes" : 0
                     },
                     "US_WEST_1": {
                       "electableNodes" : 2,
                       "priority" : 5,
                       "readOnlyNodes": 2
                     }
                 },
                 "backupEnabled" : true
               }'

     - id: global
       name: Create Global
       content: |

         .. code-block:: shell

            curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" --digest \
               --header "Content-Type: application/json" \
               --include \
               --request POST "https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters?pretty=true" \
               --data '
                 {
                   "name": "DataStore3",
                   "diskSizeGB": 80,
                    "providerSettings": {
                      "providerName": "AWS",
                      "diskIOPS": "240",
                      "instanceSizeName": "M30"
                    },
                    "replicationSpecs": [{
                      "zoneName": "Zone 1",
                      "numShards": 2,
                      "regionsConfig": {
                        "US_EAST_1": {
                          "electableNodes": 3,
                          "readOnlyNodes": 0,
                          "priority": 7
                        }
                      }
                    },
                    { 
                      "zoneName": "Zone 2",
                      "numShards": 2,
                      "regionsConfig": {
                        "EU_CENTRAL_1": {
                          "electableNodes": 3,
                          "readOnlyNodes": 0,
                          "priority": 7
                        }
                      }
                    }],
                    "backupEnabled": false,
                    "providerBackupEnabled" : true,
                    "clusterType": "GEOSHARDED"
                 }'

Response
~~~~~~~~

.. tabs::

   hidden: true

   tabs:
     - id: single-region
       name: Create Single Region
       content: |

         .. code-block:: json
            :copyable: false

            {
              "autoScaling":{
                 "diskGBEnabled":true
              },
              "backupEnabled":true,
              "biConnector":{
                 "enabled":false,
                 "readPreference":"secondary"
              },
              "clusterType":"REPLICASET",
              "diskSizeGB":100.0,
              "encryptionAtRestProvider":"NONE",
              "groupId":"{group-id}",
              "id":"5c87f79087d9d612a175f46d",
              "links":[
                 {
                    "href":"https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters/DataStore",
                    "rel":"self"
                 },
                 {
                    "href":"https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters/DataStore/restoreJobs",
                    "rel":"http://mms.mongodb.com/restoreJobs"
                 },
                 {
                    "href":"https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters/DataStore/snapshots",
                    "rel":"http://mms.mongodb.com/snapshots"
                 }
              ],
              "mongoDBMajorVersion":"4.0",
              "mongoDBVersion":"4.0.6",
              "mongoURIUpdated":"2019-03-12T18:16:48Z",
              "name":"DataStore",
              "numShards":1,
              "paused":false,
              "providerBackupEnabled":false,
              "providerSettings":{
                 "providerName":"AWS",
                 "diskIOPS":300,
                 "encryptEBSVolume":true,
                 "instanceSizeName":"M40",
                 "regionName":"US_EAST_1",
                 "volumeType":"STANDARD"
              },
              "replicationFactor":3,
              "replicationSpec":{
                 "US_EAST_1":{
                    "analyticsNodes":0,
                    "electableNodes":3,
                    "priority":7,
                    "readOnlyNodes":0
                 }
              },
              "replicationSpecs":[
                 {
                    "id":"5c87f79087d9d612a175f46c",
                    "numShards":1,
                    "regionsConfig":{
                       "US_EAST_1":{
                          "analyticsNodes":0,
                          "electableNodes":3,
                          "priority":7,
                          "readOnlyNodes":0
                       }
                    },
                    "zoneName":"Zone 1"
                 }
              ],
              "stateName":"CREATING"
            }

     - id: multi-region
       name: Create Multi-Region
       content: |

         .. code-block:: json
            :copyable: false

            {
              "autoScaling":{
                 "diskGBEnabled":true
              },
              "backupEnabled":true,
              "biConnector":{
                 "enabled":false,
                 "readPreference":"secondary"
              },
              "clusterType":"REPLICASET",
              "diskSizeGB":100.0,
              "encryptionAtRestProvider":"NONE",
              "groupId":"{group-id}",
              "id":"5c87f50987d9d612a1739b89",
              "links":[
                 {
                    "href":"https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters/DataStore2",
                    "rel":"self"
                 },
                 {
                    "href":"https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters/DataStore2/restoreJobs",
                    "rel":"http://mms.mongodb.com/restoreJobs"
                 },
                 {
                    "href":"https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters/DataStore2/snapshots",
                    "rel":"http://mms.mongodb.com/snapshots"
                 }
              ],
              "mongoDBMajorVersion":"4.0",
              "mongoDBVersion":"4.0.6",
              "mongoURIUpdated":"2019-03-12T18:06:01Z",
              "name":"DataStore2",
              "numShards":1,
              "paused":false,
              "providerBackupEnabled":false,
              "providerSettings":{
                 "providerName":"AWS",
                 "diskIOPS":300,
                 "encryptEBSVolume":true,
                 "instanceSizeName":"M10",
                 "volumeType":"STANDARD"
              },
              "replicationSpec":{
                 "US_EAST_1":{
                    "analyticsNodes":0,
                    "electableNodes":3,
                    "priority":7,
                    "readOnlyNodes":0
                 },
                 "US_EAST_2":{
                    "analyticsNodes":0,
                    "electableNodes":2,
                    "priority":6,
                    "readOnlyNodes":0
                 },
                 "US_WEST_1":{
                    "analyticsNodes":0,
                    "electableNodes":2,
                    "priority":5,
                    "readOnlyNodes":2
                 }
              },
              "replicationSpecs":[
                 {
                    "id":"5c87f50887d9d612a1739b86",
                    "numShards":1,
                    "regionsConfig":{
                       "US_EAST_1":{
                          "analyticsNodes":0,
                          "electableNodes":3,
                          "priority":7,
                          "readOnlyNodes":0
                       },
                       "US_EAST_2":{
                          "analyticsNodes":0,
                          "electableNodes":2,
                          "priority":6,
                          "readOnlyNodes":0
                       },
                       "US_WEST_1":{
                          "analyticsNodes":0,
                          "electableNodes":2,
                          "priority":5,
                          "readOnlyNodes":2
                       }
                    }
                 }
              ],
              "stateName":"CREATING"
            }

     - id: global
       name: Create Global
       content: |

         .. code-block:: json
            :copyable: false

            {
              "autoScaling" : {
                "diskGBEnabled" : true
              },
              "backupEnabled" : false,
              "biConnector" : {
                "enabled" : false,
                "readPreference" : "secondary"
              },
              "clusterType" : "GEOSHARDED",
              "diskSizeGB" : 80.0,
              "encryptionAtRestProvider" : "NONE",
              "groupId" : "{group-id}",
              "id" : "5c87f04780eef53f47af4f8b",
              "links" : [ {
                "href" : "https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters/DataStore3",
                "rel" : "self"
              }, {
                "href" : "https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters/DataStore3/restoreJobs",
                "rel" : "http://mms.mongodb.com/restoreJobs"
              }, {
                "href" : "https://cloud.mongodb.com/api/atlas/v1.0/groups/{group-id}/clusters/DataStore3/snapshots",
                "rel" : "http://mms.mongodb.com/snapshots"
              } ],
              "mongoDBMajorVersion" : "4.0",
              "mongoDBVersion" : "4.0.6",
              "mongoURIUpdated" : "2019-03-12T17:45:43Z",
              "name" : "DataStore3",
              "paused" : false,
              "providerBackupEnabled" : true,
              "providerSettings" : {
                "providerName" : "AWS",
                "diskIOPS" : 240,
                "encryptEBSVolume" : true,
                "instanceSizeName" : "M30",
                "volumeType" : "STANDARD"
              },
              "replicationSpecs" : [ {
                "id" : "5c87f04680eef53f47af4f7d",
                "numShards" : 2,
                "regionsConfig" : {
                  "US_EAST_1" : {
                    "analyticsNodes" : 0,
                    "electableNodes" : 3,
                    "priority" : 7,
                    "readOnlyNodes" : 0
                  }
                },
                "zoneName" : "Zone 1"
              }, {
                "id" : "5c87f04680eef53f47af4f7e",
                "numShards" : 2,
                "regionsConfig" : {
                  "EU_CENTRAL_1" : {
                    "analyticsNodes" : 0,
                    "electableNodes" : 3,
                    "priority" : 7,
                    "readOnlyNodes" : 0
                  }
                },
                "zoneName" : "Zone 2"
              } ],
              "stateName" : "CREATING"
            }

.. _create-cluster-considerations:

Considerations
--------------

- .. include:: /includes/fact-cross-region-limits.rst

- If your |service| project contains a
  :ref:`custom role <mongodb-roles>` that uses actions introduced
  in a specific MongoDB version, you must delete that role before
  creating clusters with an earlier MongoDB version.
