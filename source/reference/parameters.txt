=========================
MongoDB Server Parameters
=========================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Synopsis
--------

MongoDB provides a number of configuration options that are accessible
via the :dbcommand:`setParameter` command or :option:`--setParameter
<mongod --setParameter>` option.s

For additional run time configuration options, see
:doc:`/reference/configuration-options` and :doc:`Manual Page for
mongod </reference/program/mongod>`.

Parameters
----------

.. |mongod-only| replace:: Available for :binary:`~bin.mongod` only.

.. |mongos-only| replace:: Available for :binary:`~bin.mongos` only.

.. |both| replace:: Available for both :binary:`~bin.mongod` and :binary:`~bin.mongos`.

Authentication Parameters
~~~~~~~~~~~~~~~~~~~~~~~~~

.. parameter:: authenticationMechanisms

   .. versionchanged:: 2.6
      Added support for the ``PLAIN`` and ``MONGODB-X509`` authentication
      mechanisms.

   |both|

   Specifies the list of authentication mechanisms the server accepts. Set
   this to one or more of the following values. If you specify multiple
   values, use a comma-separated list and no spaces. For descriptions
   of the authentication mechanisms, see :doc:`/core/authentication`.

   .. list-table::
      :header-rows: 1
      :widths: 20 40

      * - Value

        - Description

      * - MONGODB-CR

        - MongoDB challenge/response authentication.

      * - MONGODB-X509

        - MongoDB TLS/SSL certificate authentication.

      * - PLAIN

        - External authentication using LDAP. You can also use ``PLAIN``
          for authenticating in-database users. ``PLAIN`` transmits
          passwords in plain text. This mechanism is available only in
          `MongoDB Enterprise
          <http://www.mongodb.com/products/mongodb-enterprise>`_.

      * - GSSAPI

        - External authentication using Kerberos. This mechanism is
          available only in `MongoDB Enterprise
          <http://www.mongodb.com/products/mongodb-enterprise>`_.

   .. todo:: Per DOCS-2940, combine this with similar info in
             /includes/options-conf
             /includes/options-shared
             /reference/connection-string
             /tutorial/control-access-to-mongodb-windows-with-kerberos-authentication
             /tutorial/control-access-to-mongodb-with-kerberos-authentication.txt

   For example, to specify ``PLAIN`` as the authentication mechanism, use
   the following command:

   .. code-block:: sh

      mongod --setParameter authenticationMechanisms=PLAIN --auth

.. parameter:: clusterAuthMode

   .. versionadded:: 2.6

   |both|

   Set the :setting:`~security.clusterAuthMode` to either ``sendX509`` or
   ``x509``. Useful during :ref:`rolling upgrade to use x509 for
   membership authentication <upgrade-to-x509-internal-authentication>`
   to minimize downtime.

   .. include:: /includes/fact-ssl-supported.rst

   .. code-block:: sh

      db.getSiblingDB('admin').runCommand( { setParameter: 1, clusterAuthMode: "sendX509" } )

.. parameter:: enableLocalhostAuthBypass

   .. versionadded:: 2.4

   |both|

   Specify ``0`` or ``false`` to disable localhost authentication
   bypass. Enabled by default.

   :parameter:`enableLocalhostAuthBypass` is not available using
   :dbcommand:`setParameter` database command. Use the
   :setting:`setParameter` option in the configuration file or the
   :option:`--setParameter <mongod --setParameter>` option on the
   command line.

.. parameter:: saslauthdPath

   .. note:: Available only in MongoDB Enterprise (except MongoDB Enterprise for Windows).

   Specify the path to the Unix Domain Socket of the ``saslauthd``
   instance to use for proxy authentication.

.. parameter:: saslHostName

   .. versionadded:: 2.4

   :parameter:`saslHostName` overrides MongoDB's default hostname
   detection for the purpose of configuring SASL and Kerberos
   authentication.

   :parameter:`saslHostName` does not affect the hostname of the
   :binary:`~bin.mongod` or :binary:`~bin.mongos` instance for any purpose
   beyond the configuration of SASL and Kerberos.

   You can only set :parameter:`saslHostName` during start-up, and
   cannot change this setting using the :dbcommand:`setParameter`
   database command.

   .. note::

      :parameter:`saslHostName` supports Kerberos authentication and is
      only included in MongoDB Enterprise. For Linux systems, see
      :doc:`/tutorial/control-access-to-mongodb-with-kerberos-authentication`
      for more information.

      .. COMMENT
         .. versionadded:: 2.6
            MongoDB Enterprise now supports Windows systems,
            which includes support for Kerberos. See also
            :doc:`/tutorial/control-access-to-mongodb-with-kerberos-authentication-under-windows`.

.. parameter:: saslServiceName

   .. versionadded:: 2.4.6

   Allows users to override the default :doc:`Kerberos
   </tutorial/control-access-to-mongodb-with-kerberos-authentication>`
   service name component of the :doc:`Kerberos
   </tutorial/control-access-to-mongodb-with-kerberos-authentication>`
   principal name, on a per-instance basis. If unspecified, the
   default value is ``mongodb``.

   MongoDB only permits setting :parameter:`saslServiceName` at
   startup. The :dbcommand:`setParameter` command can not change
   this setting.

   :parameter:`saslServiceName` is only available in MongoDB
   Enterprise.

   .. important::

      Ensure that your driver supports alternate service names.

.. parameter:: sslMode

   .. versionadded:: 2.6

   |both|

   Set the :setting:`net.ssl.mode` to either ``preferSSL`` or
   ``requireSSL``. Useful during :doc:`rolling upgrade to TLS/SSL
   </tutorial/upgrade-cluster-to-ssl>` to minimize downtime.

   .. include:: /includes/fact-ssl-supported.rst

   .. code-block:: sh

      db.getSiblingDB('admin').runCommand( { setParameter: 1, sslMode: "preferSSL" } )

.. parameter:: supportCompatibilityFormPrivilegeDocuments

   .. versionadded:: 2.4

   .. deprecated:: 2.6
      :parameter:`supportCompatibilityFormPrivilegeDocuments` has no
      effect in 2.6 and will be removed in 3.0.

   |both|

   :parameter:`supportCompatibilityFormPrivilegeDocuments` is not
   available using :dbcommand:`setParameter` database command. Use the
   :setting:`setParameter` option in the configuration file or the
   :option:`--setParameter <mongod --setParameter>` option on the
   command line.

.. parameter:: userCacheInvalidationIntervalSecs

   .. versionadded:: 2.6

   *Default*: 600.

   |mongos-only|

   On a :binary:`~bin.mongos` instance, this specifies the amount of time in
   seconds to allow before the :binary:`~bin.mongos` instance purges the
   in-memory cache of user objects. The cache includes the users'
   credentials and roles.

   This parameter has a minimum value of ``30`` seconds and a maximum
   value of ``86400`` seconds (24 hours).

General Parameters
~~~~~~~~~~~~~~~~~~~

.. parameter:: connPoolMaxShardedConnsPerHost

   .. versionadded:: 2.6

   *Default*: 200

   |both|

   Set the maximum size of the connection pools for communication to the
   shards. The size of a pool does not prevent the creation of
   additional connections, but *does* prevent the connection pools from
   retaining connections above this limit.

   Increase the :parameter:`connPoolMaxShardedConnsPerHost` value
   **only** if the number of connections in a connection pool has a
   high level of churn or if the total number of created connections
   increase.

   You can only set :parameter:`connPoolMaxShardedConnsPerHost` during
   startup in the config file or on the command line, as follows to
   increase the size of the connection pool:

   .. code-block:: sh

      mongos --setParameter connPoolMaxShardedConnsPerHost=250

.. parameter:: connPoolMaxConnsPerHost

   .. versionadded:: 2.6

   *Default*: 200

   |both|

   Set the maximum size of the connection pools for outgoing connections
   to other :binary:`~bin.mongod` instances. The size
   of a pool does not prevent the creation of additional connections,
   but *does* prevent a connection pool from retaining connections in
   excess of the value of :parameter:`connPoolMaxConnsPerHost`.

   **Only** adjust this setting if your driver does *not* pool
   connections and you're using authentication in the
   context of a sharded cluster.

   You can only set :parameter:`connPoolMaxConnsPerHost` during startup
   in the config file or on the command line, as in the following
   example:

   .. code-block:: sh

      mongod --setParameter connPoolMaxConnsPerHost=250

.. parameter:: cursorTimeoutMillis

   .. versionadded:: 2.6.9

   *Default*: 600000 (i.e. 10 minutes)

   |both|

   Sets the expiration threshold in milliseconds for idle cursors
   before MongoDB removes them; i.e. MongoDB removes cursors that have
   been idle for the specified :parameter:`cursorTimeoutMillis`.

   For example, the following sets the :parameter:`cursorTimeoutMillis`
   to ``300000`` milliseconds (i.e. 5 minutes).

   .. code-block:: sh

      mongod --setParameter cursorTimeoutMillis=300000

   Or, if using the :dbcommand:`setParameter` command within the
   :binary:`~bin.mongo` shell:

   .. code-block:: javascript

      db.getSiblingDB('admin').runCommand( { setParameter: 1, cursorTimeoutMillis: 300000 } )

.. parameter:: failIndexKeyTooLong

   .. versionadded:: 2.6

   |mongod-only|

   In MongoDB 2.6, if you attempt to insert or update a document so
   that the value of an indexed field is longer than the
   :limit:`Index Key Length Limit <Index Key Limit>`, the operation
   will fail and return an error to the client. In previous versions
   of MongoDB, these operations would successfully insert or modify a
   document but the index or indexes would not include references to
   the document.

   To avoid this issue, consider using :doc:`hashed indexes
   </core/index-hashed>` or indexing a computed value. If you have an
   existing data set and want to disable this behavior so you can
   upgrade and then gradually resolve these indexing issues, you can
   use :parameter:`failIndexKeyTooLong` to disable this behavior.

   :parameter:`failIndexKeyTooLong` defaults to ``true``. When
   ``false``, a 2.6 :binary:`~bin.mongod` instance will provide the 2.4
   behavior.

   Issue the following command to disable the index key length
   validation: for a running:binary:`~bin.mongod` instance:

   .. code-block:: javascript

      db.getSiblingDB('admin').runCommand( { setParameter: 1, failIndexKeyTooLong: false } )

   You can also set :parameter:`failIndexKeyTooLong`  at
   run-time with the following operation.

   .. code-block:: sh

      mongod --setParameter failIndexKeyTooLong=false

.. parameter:: notablescan

   |mongod-only|

   Specify whether **all** queries must use indexes. If ``1``, MongoDB
   will not execute queries that require a collection scan and will return an
   error.

   Consider the following example which sets :parameter:`notablescan` to ``1``
   or true:

   .. code-block:: javascript

      db.getSiblingDB("admin").runCommand( { setParameter: 1, notablescan: 1 } )

   Setting :parameter:`notablescan` to ``1`` can be useful for testing
   application queries, for example, to identify queries that scan an
   entire collection and cannot use an index.

   To detect unindexed queries without ``notablescan``, consider reading
   the :doc:`/tutorial/evaluate-operation-performance` and
   :doc:`/tutorial/optimize-query-performance-with-indexes-and-projections`
   sections and using the :parameter:`logLevel` parameter,
   :doc:`/reference/program/mongostat` and :ref:`profiling
   <database-profiling>`.

   Don't run production :binary:`~bin.mongod` instances with
   :parameter:`notablescan` because preventing collection scans can potentially
   affect queries in all databases, including administrative queries.

.. parameter:: newCollectionsUsePowerOf2Sizes

   .. versionadded:: 2.6

   *Default*: ``true``.

   |mongod-only|

   :binary:`~bin.mongod` uses an allocation strategy called
   :collflag:`usePowerOf2Sizes` where each record has a size, in bytes
   that is a power of 2 (e.g. 32, 64, 128, 256, 512...16777216.) The
   minimum allocation for a document is 32 bytes.

   MongoDB stores documents in contiguous spaces on disk, and each
   record includes both the document itself and some additional space
   to allow the document to grow slightly through updates.

   By default, all *new* collections, created after 2.6 use
   the :collflag:`usePowerOf2Sizes` strategy. To revert to the prior
   *exact fit allocation* strategy, set
   :parameter:`newCollectionsUsePowerOf2Sizes` to
   ``false``.

   .. include:: /includes/fact-definition-new-collection.rst

   Issue the following command to change the allocation strategy for a
   running :binary:`~bin.mongod` instance:

   .. code-block:: javascript

      db.getSiblingDB('admin').runCommand( { setParameter: 1, newCollectionsUsePowerOf2Sizes: false } )

   You can also set :parameter:`newCollectionsUsePowerOf2Sizes`  at
   run-time with the following operation.

   .. code-block:: sh

      mongod --setParameter newCollectionsUsePowerOf2Sizes=false

.. parameter:: releaseConnectionsAfterResponse

   .. versionadded:: 2.2.4 and 2.4.2

   |both|

   Changes the behavior of the connection pool that :binary:`~bin.mongos` uses
   to connect to the shards. As a result, each :binary:`~bin.mongos`
   should need to maintain fewer connections to each shard. When
   enabled, the :binary:`~bin.mongos` will release a connection into the
   thread pool *after* each read operation or command.

   .. warning:: For applications that do not use the 
      :ref:`default <write-concern-acknowledged>`,
      :ref:`journaled <write-concern-replica-journaled>`, or
      :ref:`replica acknowledged <write-concern-replica-acknowledged>`
      write concern modes of the driver,
      :parameter:`releaseConnectionsAfterResponse` will affect the
      meaning of :dbcommand:`getLastError`.

      If an application allows read operations in between
      write operations and :dbcommand:`getLastError` calls,
      the resulting :dbcommand:`getLastError` will **not** report on
      the success of the proceeding write operation.

      Use with caution.

   To enable, use the following command while connected to a
   :binary:`~bin.mongos`:

   .. code-block:: javascript

      db.getSiblingDB('admin').runCommand( { setParameter: 1, releaseConnectionsAfterResponse: true } )

   Alternately, you may start the :binary:`~bin.mongos` instance with the
   following run-time option:

   .. code-block:: sh

      mongos --setParameter releaseConnectionsAfterResponse=true

   To change this policy for the entire cluster, you must set
   :parameter:`releaseConnectionsAfterResponse` on each
   :binary:`~bin.mongos` instance in the cluster.

.. parameter:: textSearchEnabled

   .. deprecated:: 2.6
      MongoDB enables the text search feature by default.
      Manual enabling of this feature is unnecessary.

   |both|

   Enables the :doc:`text search </core/index-text>` feature. When
   manually enabling, you must enable on **each and every**
   :binary:`~bin.mongod` for replica sets.

.. parameter:: ttlMonitorEnabled

   .. versionadded:: 2.4.6

   |mongod-only|

   To support :doc:`TTL Indexes </core/index-ttl>`, :binary:`~bin.mongod`
   instances have a background thread that is responsible for deleting
   documents from collections with TTL indexes.

   To disable this worker thread for a :binary:`~bin.mongod`, set
   :parameter:`ttlMonitorEnabled` to ``false``, as in the following
   operations:

   .. code-block:: javascript

      db.getSiblingDB('admin').runCommand( { setParameter: 1, ttlMonitorEnabled: false } )

   Alternately, you may disable the thread at run-time by starting the
   :binary:`~bin.mongod` instance with the following option:

   .. code-block:: sh

      mongod --setParameter ttlMonitorEnabled=false

Logging Parameters
~~~~~~~~~~~~~~~~~~

.. parameter:: logLevel

   |both|

   Specify an integer between ``0`` and ``5`` signifying the verbosity
   of the logging, where ``5`` is the most verbose.

   Consider the following example which sets the
   :parameter:`logLevel` to ``2``:

   .. code-block:: javascript

      use admin
      db.runCommand( { setParameter: 1, logLevel: 2 } )

   The default :parameter:`logLevel` is ``0``.

   .. seealso::

      :setting:`~systemLog.verbosity`.

.. parameter:: logUserIds

   .. versionadded:: 2.4

   |both|

   Specify ``1`` to enable logging of userids.

   Disabled by default.

.. parameter:: quiet

   |both|

   Sets quiet logging mode. If
   ``1``, :binary:`~bin.mongod` will go into a quiet logging
   mode which will not log the following events/activities:

   - connection events;

   - the :dbcommand:`drop` command, the
     :dbcommand:`dropIndexes` command, the
     :dbcommand:`diagLogging` command, the
     :dbcommand:`validate` command, and the
     :dbcommand:`clean` command; and

   - replication synchronization activities.

   Consider the following example which sets the
   ``quiet`` to ``1``:

   .. code-block:: javascript

      db = db.getSiblingDB("admin")
      db.runCommand( { setParameter: 1, quiet: 1 } )

   .. seealso:: :setting:`~systemLog.quiet`

.. parameter:: traceExceptions

   .. versionadded:: 2.2

   Configures :binary:`~bin.mongod` to log full source code stack traces for every database and socket C++ exception,
   for use with debugging.
   If ``true``, :binary:`~bin.mongod` will log full stack traces.

   Consider the following example which sets the
   ``traceExceptions`` to ``true``:

   .. code-block:: javascript

      db.getSiblingDB("admin").runCommand( { setParameter: 1, traceExceptions: true } )

   .. seealso:: :setting:`systemLog.traceAllExceptions`

Replication Parameters
~~~~~~~~~~~~~~~~~~~~~~

.. parameter:: replApplyBatchSize

   |mongod-only|

   Specify the number of oplog entries to apply as a single batch.
   :parameter:`replApplyBatchSize` must be an integer between 1 and
   1024. The default value is 1. This option only applies to
   master/slave configurations and is valid only on a :binary:`~bin.mongod`
   started with the ``--slave`` command line option.

   Batch sizes must be ``1`` for members with
   :option:`slavedelay <mongod --slavedelay>` configured.

.. parameter:: replIndexPrefetch

   .. versionadded:: 2.2

   |mongod-only|

   Use :parameter:`replIndexPrefetch` in conjunction with
   :setting:`~replication.replSetName` when configuring a replica
   set. The default value is ``all`` and available
   options are:

   - ``none``
   - ``all``
   - ``_id_only``

   By default :term:`secondary` members of a :term:`replica set` will
   load all indexes related to an operation into memory before
   applying operations from the oplog. You can modify this behavior so
   that the secondaries will only load the ``_id`` index. Specify
   ``_id_only`` or ``none`` to prevent the :binary:`~bin.mongod` from
   loading *any* index into memory.

Storage Parameters
~~~~~~~~~~~~~~~~~~

.. parameter:: journalCommitInterval

   Specify an integer between ``1`` and ``500`` signifying the number
   of milliseconds (ms) between journal commits.

   Consider the following example which sets the
   :parameter:`journalCommitInterval` to ``200`` ms:

   .. code-block:: javascript

      db.getSiblingDB("admin").runCommand( { setParameter: 1, journalCommitInterval: 200 } )

   .. seealso:: :setting:`~storage.journal.commitIntervalMs`.

.. parameter:: syncdelay

   |mongod-only|

   Specify the interval in seconds between :term:`fsync` operations
   where :binary:`~bin.mongod` flushes its working memory to disk. By
   default, :binary:`~bin.mongod` flushes memory to disk every 60
   seconds. In almost every situation you should not set this value
   and use the default setting.

   Consider the following example which sets the ``syncdelay`` to
   ``60`` seconds:

   .. code-block:: javascript

      db.getSiblingDB("admin").runCommand( { setParameter: 1, syncdelay: 60 } )

   .. seealso:: :setting:`~storage.syncPeriodSecs` and
      :parameter:`journalCommitInterval`.

Auditing Parameters
~~~~~~~~~~~~~~~~~~~

.. parameter:: auditAuthorizationSuccess

   .. include:: /includes/note-audit-in-enterprise-only.rst

   .. versionadded:: 2.6.5

   *Default*: ``false``

   Enables the :doc:`auditing </core/auditing>` of authorization
   successes for the :ref:`authCheck <audit-action-details-results>`
   action.

   When :parameter:`auditAuthorizationSuccess` is ``false``, the
   :doc:`audit system </core/auditing>` only logs the authorization
   failures for ``authCheck``.

   To enable the audit of authorization successes, issue the following
   command:

   .. code-block:: javascript

      db.adminCommand( { setParameter: 1, auditAuthorizationSuccess: true } )

   .. include:: /includes/fact-auditAuthorizationSuccess-performance-impact.rst
