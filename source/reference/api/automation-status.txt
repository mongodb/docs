=================
Automation Status
=================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Overview
--------

The Public API provides the ``automationStatus`` endpoint to let you see
whether each MongoDB process is up-to-date with the current
:doc:`automation configuration </reference/cluster-configuration>`. The
endpoint returns the ``goalVersion`` field to report the current version
of the automation configuration and the ``lastGoalVersionAchieved`` fields to
report the versions of the configuration running on each server.

.. include:: /includes/api/base-api-uri.rst

Syntax
------

.. code-block:: http

   GET /api/public/v1.0/groups/GROUP-ID/automationStatus

Request Parameters
------------------

Request Path Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :header-rows: 1

   * - Parameter
     - Required/Optional
     - Description

   * - ``GROUP-ID``
     - Required.
     - The unique identifier for the group.

Request Query Parameters
~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/api/no-query-parameters.rst

Request Body Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/api/no-body-parameters.rst

Response Elements
-----------------

.. list-table::
   :widths: 20 10 80
   :header-rows: 1

   * - Name
     - Type
     - Description
   * - ``goalVersion``
     - number
     - The version of the most recently submitted :ref:`automation
       configuration <automation-configuration-sample-entity>`. If there is a
       :ref:`conflict in submissions of automation configurations
       <concurrent-cluster-config>`, this field lists the winning
       configuration.
   * - ``processes``
     - array
     - The group's deployed MongoDB instances.
   * - ``processes.hostname``
     - string
     - The fully qualified domain name (retrieved by issuing ``hostname -f``)
       of the server on which the MongoDB process and Automation Agent are
       hosted.
   * - ``processes.name``
     - string
     - The process name as specified in the automation configuration.
   * - ``processes.lastGoalVersionAchieved``
     - number
     - The last version of the automation configuration with which this
       process had deployed as configured. If the ``processes.lastGoalVersionAchieved``
       number is not equal to the ``goalVersion`` number, the process has
       not yet deployed according to the current configuration.
   * - ``processes.plan``
     - array
     - Describes how a process that is not yet up-to-date with the
       configuration will achieve the goal state.

Examples
--------

Example Request
~~~~~~~~~~~~~~~

.. only:: cloud

   .. cssclass:: copyable-code
   .. code-block:: sh

      curl -i -u "{username}:{apiKey}" --digest -i "https://cloud.mongodb.com/api/public/v1.0/groups/533c5895b91030606f21033a/automationStatus"

.. only:: onprem

   .. cssclass:: copyable-code
   .. code-block:: sh

      curl -i -u "{username}:{apiKey}" --digest "https://{opsManagerHost}:{Port}/api/public/v1.0/groups/533c5895b91030606f21033a/automationStatus"

Example Response
~~~~~~~~~~~~~~~~

.. code-block:: http

   HTTP/1.1 200 OK

.. code-block:: json

   {
     "processes": [
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_0_0",
         "hostname": "testDeploy-0"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_0_1",
         "hostname": "testDeploy-1"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_0_2",
         "hostname": "testDeploy-2"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_1_3",
         "hostname": "testDeploy-3"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_1_4",
         "hostname": "testDeploy-4"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_myShard_1_5",
         "hostname": "testDeploy-5"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_config_6",
         "hostname": "testDeploy-6"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_config_7",
         "hostname": "testDeploy-7"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_config_8",
         "hostname": "testDeploy-8"
       },
       {
         "plan": [],
         "lastGoalVersionAchieved": 2,
         "name": "shardedCluster_mongos_9",
         "hostname": "testDeploy-9"
       }
     ],
     "goalVersion": 2
   }
