stepnum: 1
level: 4
ref: convert-replset-sharded-step1
inherit: 
  file: steps-source-project-nav.yaml
  ref: project-nav-clusters-page
---
stepnum: 2
level: 4
ref: convert-replset-sharded-step2
title: "Enable sharding for the {+cluster+}."
content: |

  a. For the {+cluster+} you want to modify, click :icon-mms:`ellipsis`,
     then select :guilabel:`Edit Configuration`.
  #. Expand :guilabel:`Additional Settings` to modify your cluster 
     configuration.
  #. Enable sharding in the :guilabel:`Shard your cluster` section 
     by setting the toggle to :guilabel:`On`.

     .. note:: 
    
        After you convert a replica set to a sharded cluster, you can't 
        convert it again to a replica set.
  #. Select :guilabel:`1 Shard` from the drop-down menu. You can
     increase the number of shards in a later step after
     you restart your application clients.
  #. Click :guilabel:`Review Changes` to review the changes to 
     billing and click :guilabel:`Apply Changes`.

  It may take some time for |service| to deploy the changes. Please 
  wait until |service| has converted your cluster before proceeding to 
  the next step.
---
stepnum: 3
level: 4
ref: convert-replset-sharded-step8
title: "Restart all application clients and reconnect to the sharded 
       cluster."
content: | 
  If you don't restart the application clients, your data might be 
  inconsistent after |service| begins distributing data across shards. 

  - If you are using a :manual:`DNS Seed List 
    </reference/connection-string/#dns-seed-list-connection-format>`
    connection string, your application automatically connects to the
    :binary:`mongos` for your sharded cluster.
  
  - If you are using a :manual:`standard connection string
    </reference/connection-string/#standard-connection-string-format>`,
    you must update your connection string to reflect your new cluster
    topology.

  - If you are using :doc:`private endpoints 
    </security-private-endpoint>` to connect to your |service| cluster, 
    perform a rolling restart of your applications to connect to the 
    :binary:`mongos` for your sharded cluster without any downtime.
  
  To learn more, see :doc:`/connect-to-database-deployment`.
---
stepnum: 4
level: 4
ref: convert-replset-sharded-increase-shards
title: "Increase the number of shards."
content: |

  a. For the cluster you want to modify, click :icon-mms:`ellipsis`,
     then select :guilabel:`Edit Configuration`.
  #. Expand :guilabel:`Additional Settings` to modify your cluster 
     configuration.
  #. Select the number of shards from the drop-down menu.
  #. Click :guilabel:`Review Changes` to review the changes to 
     billing and click :guilabel:`Apply Changes`.

  Sharding supports high throughput and large datasets, and you can  
  increase the number of shards as data requirements grow.
---
stepnum: 5
level: 4
ref: convert-replset-sharded-step9
title: "Distribute data across the shards in your cluster."
content: | 
  To shard the collection whose data you want to distribute, see 
  :method:`sh.shardCollection() <sh.shardCollection>` for more 
  information.

  .. include:: /includes/fact-shardCollection-fts-indexes.rst
  
---
stepnum: 6
level: 4
ref: convert-replset-sharded-step10
title: "Change any cluster-wide settings."
content: | 
  If you want to make further changes to the :term:`sharded cluster 
  <sharded cluster>`, see :ref:`scale-cluster` for more information 
  on the cluster-wide settings that you can modify. 
...
