.. _sql-schema-management:

=================
Schema Management
=================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. _sql-schema-overview:

{+asql+} schemas are JSON schemas that describe data as it exists in 
MongoDB, including its polymorphism, sparseness, and nested, structured 
data. {+adf+} can automatically generate a schema by sampling data from 
documents in your collection or view.

{+adf+} automatically generates a schema for a collection or view in 
the storage configuration when you:

- :ref:`Create <adf-create-collection-views-cmd>` the collection or view 
  in the storage configuration.

- :ref:`Rename <adf-rename-collection-cmd>` a collection or view that 
  does not already have a schema. If you rename a collection or view 
  that already has a schema, the schema is also renamed. {+adf+} does 
  not generate a new schema for a renamed collection or view if it 
  already exists.

- :ref:`Set <adf-setstorageconfig>` the storage configuration.

In addition, for wildcard (``*``) collections, {+adf+} generates a 
schema when it discovers the collections in the :ref:`namespace catalog
<manage-ns-catalog-cli>` for the wildcard (``*``) collections.

You can manually generate schemas for all collections and views using 
the :ref:`sqlgenerateschema-cmd` command, set or update the schema for 
your collections or views using the :ref:`sqlsetschema-cmd` command, 
and view the stored schema using the :ref:`sqlgetschema-cmd` command.

You can manually delete a schema for a collection or view by running 
the :ref:`sqlsetschema-cmd` command with an empty schema document. 
{+df+} automatically removes the schema for a collection or view when 
you:

- :ref:`Drop the collection or view <adf-drop-collection-views-cmd>` 
  from the storage configuration.
- :ref:`Modify the storage configuration <adf-setstorageconfig>` to 
  remove the collection or view from the storage configuration.
- :ref:`Drop the database <adf-drop-database-cmd>` that contains the 
  collection or view from the storage configuration.

In addition, for a wildcard (``*``) collection, {+adf+} deletes the 
schema when it discovers that the collection has been removed from the 
:ref:`namespace catalog <manage-ns-catalog-cli>`.

.. toctree::
   :titlesonly:
   :hidden:

   Format </data-federation/query/sql/sql-schema-format>
   Generate </data-federation/query/sql/sqlgenerateschema>
   Set </data-federation/query/sql/sqlsetschema>
   Retrieve </data-federation/query/sql/sqlgetschema>
