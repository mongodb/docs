============
Manage Users
============

.. default-domain:: mongodb

.. index:: users

.. only:: saas

   You can manage the users that have access to your MMS groups, and
   also enables you to create and manage groups.

.. only:: hosted

   You can manage the users that have access to your |mms| groups, create
   and manage groups, and assign :doc:`roles </reference/user-roles>` to
   users to provide controlled access to the MMS application.

   There is no planned upgrade path from existing MMS user
   authentication to using LDAP. You will need to recreate users,
   groups, and roles manually with your LDAP service, as described in
   the :doc:`/tutorial/configure-for-ldap-authentication` document.

Add Users
---------

.. include:: /includes/steps/add-user.rst

.. only:: saas

   If the console finds a connected Jira account, MMS will automatically
   add the user to your Jira group and the MMS console.

   Users can also create accounts using the `account registration page
   <https://mms.mongodb.com/user/register/user>`_, or through Jira at
   `jira.mongodb.org <http://jira.mongodb.org/>`_.

   .. index:: users; propagation

   .. note::

      If you create an account in Jira or make any changes to that
      account from *within* Jira, it can take up to 30 minutes for that
      change to propagate to MMS. During this window you cannot add a
      user to a group in MMS. Also, passwords changed in Jira are subject
      to the same propagation delay for MMS accounts.

.. only:: hosted

   .. note::

      With MongoDB Management Service On Prem, user accounts and groups are
      independent from JIRA. This is in contrast to the `MongoDB Management Service
      <http://mms.mongodb.com>`_, which shares account
      and group information with the `MongoDB JIRA
      <http://jira.mongodb.org/>`_ instance.

   Users can create accounts using the account registration
   page of your MMS installation.

   See :ref:`assign-roles-to-users` for details about roles and privileges, as
   well as adding users and assigning roles with LDAP integration.

View Requests
-------------

To view requests, click the :guilabel:`Users` tab and then select the
:guilabel:`Requests` page. The :guilabel:`Requests` page lists pending
requests to join your group. Users can request access when they create
their MMS account, as on the registration page.

View Invitations
----------------

To view invitations, click the :guilabel:`Users` tab and then select the
:guilabel:`Invitations` page. The :guilabel:`Invitations` page lists
pending invitations to your group. When you invite a user, MMS then sends
an email to the prospective new user and lists the invitation until the
user accepts.

View Users
----------

To view users, click the :guilabel:`Users` tab and then select the
:guilabel:`Users` page. The :guilabel:`Users` page lists users who have
access to your MMS group, their roles, their time zones, and other
information.

Remove Users
------------

.. include:: /includes/steps/remove-user.rst

.. index:: users; groups

Working with Multiple Environments
----------------------------------

.. _manage-groups:

Groups
~~~~~~

If you have multiple MongoDB systems in distinct environments and
cannot monitor all systems with a single agent, you will need to add a
new group. Having a second group makes it possible to run two agents.

You may also use a second group and agent to monitor a different set
of MongoDB instances in the same environment if you want to segregate
the hosts within the MMS console. A user can only view data from the
hosts monitored in a single group at once.

After adding a second group, the MMS interface will have a drop down list
that will allow you to change groups. Selecting a new group will
refresh the current page with the data available from the servers in
this group.

.. _create-group:

Create Group
~~~~~~~~~~~~

Create a group to monitor additional segregated systems or environments for
servers, agents, users, and other resources. For example, your deployment might
have two or more environments separated by firewalls. In this case, you would
need two or more separate MMS groups.

API and shared secret keys are unique to each group. Each group requires its
own agent with the appropriate API and shared secret keys. Within each group,
the agent needs to be able to connect to all hosts it monitors in the group.

.. include:: /includes/steps/add-group.rst

.. _assign-roles-to-users:

Assigning Roles to Users
------------------------

You can assign :doc:`roles </reference/user-roles>` to users to limit the
actions they can perform and the data they can view. You **cannot** assign
your own roles.

MMS User Roles
~~~~~~~~~~~~~~

.. only:: saas

   MMS can assign roles to individual users to limit actions users can perform,
   as well as data users see in the application.

.. only:: hosted

   MMS or an LDAP server can assign roles to individual users to limit actions
   users can perform, as well as data users see in the application. With LDAP
   integration, follow the steps to setup
   :doc:`/tutorial/configure-for-ldap-authentication` then create LDAP groups
   for each available MMS role.

   Users must have User Admin or Global User Admin roles assigned to them to
   assign roles to users. A person with the User Admin role can assign roles to
   users in their group. A person with the Global User Admin role can assign
   roles to any user in any group. You cannot assign roles for yourself.

Initial Creation
~~~~~~~~~~~~~~~~

.. only:: saas

   Upon successful login, the first user completes a welcome form to create the
   initial MMS group. This form includes assigning roles.

.. only:: hosted

   You can assign roles either through MMS or :ref:`through an LDAP server
   <assign-roles-with-ldap>`.

   Upon successful login, the first user completes a welcome form to create the
   initial MMS group. This form includes assigning roles. For LDAP
   authentication, the welcome form includes the ability to assign LDAP groups
   to the MMS group-level and global roles.

Required Permissions
~~~~~~~~~~~~~~~~~~~~

You must have either the :ref:`User Admin <user-admin-role>` role or
:ref:`Group Owner <group-owner-role>` role in a group to assign roles to
users in that group.

.. only:: hosted

   You must have either the :ref:`Global User Admin
   <global-user-admin-role>` role or :ref:`Global Owner
   <global-owner-role>` role to assign roles to any user in any group.

.. index:: users; roles

Assign an MMS Role
~~~~~~~~~~~~~~~~~~

To assign roles inside of |mms|, go to the :guilabel:`Users` tab, then click the
:guilabel:`Users` page, and then click the pencil icon to the right of the
user. Click the appropriate checkboxes to assign roles.

You cannot change your own roles. You can view your roles, but |mms| does not
let you save changes to your own roles.

.. only:: hosted

   .. _assign-roles-with-ldap:

   Assign Roles with LDAP
   ~~~~~~~~~~~~~~~~~~~~~~

   First, :doc:`configure LDAP authentication </tutorial/configure-for-ldap-authentication>`.

   Next, create groups on your LDAP server for each of the available MMS
   group-level and global roles.

   To assign LDAP groups to MMS roles, click the Admin link at the top
   right of any MMS page, then click Monitoring, which displays the Groups
   page. Click the pencil
   icon at the far right of a group name. Edit the Roles interface by adding
   the appropriate LDAP group name to its corresponding MMS group name.

   Because MMS does not update role assignments stored in your LDAP server,
   assign roles by assigning users to groups in your LDAP server.

   Configure global roles in ``conf-mms.properties`` file.

   See :doc:`/tutorial/configure-for-ldap-authentication` for more details
   about LDAP integration with MMS.
