
.. _data-sources-view:
.. _connect-disconnect-data-source:

==================================================
Connect or Disconnect Data Sources and Deployments
==================================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

On the :guilabel:`Data Sources` page, an |service| 
:authrole:`Project Owner` can: 

- :ref:`Connect a deployment <connect-deployment>` or 
  :ref:`connect a data source <connect-data-source>` to |charts|.
- :ref:`Disconnect a deployment <disconnect-deployment>` or
  :ref:`disconnect a data source <disconnect-data-source>` from 
  |charts|.

To learn more about data sources and deployments, see :ref:`data-sources`.

|charts-short| connects to all deployments and data sources by default.

.. _connect-deployment:

Connect a Deployment to |charts-short|
--------------------------------------

You can connect a deployment to |charts-short| to access the
data for the collections within the deployment in |charts-short|.

To connect a deployment to |charts-short|:

.. procedure::
   :style: normal

   .. include:: /includes/steps-access-deployment.rst

   .. include:: /includes/steps-connect-deployment.rst

      To learn more about the other information that displays for the
      deployment, see :ref:`manage-deployment`.

.. _add-data-source:
.. _connect-data-source:

Connect a Data Source to |charts-short|
---------------------------------------

Connect a data source to |charts-short| to use its data in your charts.

When you connect a data source, |charts-short| grants the default
:ref:`permissions <permission-model>` to |charts-short| users. To
customize the permissions for a data source, see
:ref:`mod-data-source-permissions`.

To connect a data source to |charts-short|:

.. procedure::
   :style: normal

   .. step:: Connect your deployment. 

      To learn more, see :ref:`connect-deployment`.

   .. step:: In the :guilabel:`Data Access` section, select the database that contains the data source.

      Select the database that contains the data source you want to
      connect. The database's data sources display, including 
      :ref:`charts views <charts-views>`.

      |charts-short| displays the following information about the data source:

      .. list-table::
         :header-rows: 1
         :widths: 38 72

         * - Column
           - Description

         * - :guilabel:`Data Source`
           - Human-readable label that identifies the data source and
             its chart views.

         * - :guilabel:`External Users`
           - Label that indicates whether: 
           
             - You enabled external user access.
             - The external user connection method is
               :guilabel:`Authenticated` or :guilabel:`Unauthenticated`.

         * - :guilabel:`Status`
           - Label that indicates whether you connected the 
             data source to |charts|.

   .. step:: Click :guilabel:`Manage` next to the data source's information.

      The data source's details page displays the following
      information:

      .. list-table::
         :header-rows: 1
         :widths: 38 72

         * - Field
           - Description

         * - :guilabel:`Data Source Name`
           - Human-readable label that identifies the data source in 
             |service|.
     
         * - :guilabel:`Data Source Connection Status`
           - Label that indicates whether you connected the 
             data source to |charts|.

      To learn more about the other information that displays on the
      data source's details page, see
      :ref:`manage-existing-data-sources`.

   .. step:: Check the connection status and connect the data source.

      If the data source connection status is :guilabel:`Connected`,
      you already connected this data source to |charts|. The
      :guilabel:`Data Access` section displays.
      
      If the data source connection status is :guilabel:`Disconnected`: 
        
      a. Click the connect icon :icon-fa5:`link` next to the data
         source connection status.
      #. Click :guilabel:`Reconnect` on the modal that displays. 
        
      The data source connects and the :guilabel:`Data Access`
      section displays.

      To learn more about the other information that displays in the
      data source's :guilabel:`Data Access` section, see
      :ref:`manage-existing-data-sources`.

.. _disconnect-deployment:

Disconnect a Deployment from |charts-short|
-------------------------------------------

Disconnect a deployment to disconnect all data sources within the
deployment from |charts-short|.

If you disconnect a deployment, you can :ref:`reconnect
<connect-deployment>` it later to resume rendering charts that use the
deployment's data sources.

To disconnect a deployment:

.. procedure::
   :style: normal

   .. include:: /includes/steps-access-deployment.rst

   .. step:: Check the connection status and disconnect the deployment.

      If the deployment connection status is :guilabel:`Disconnected`,
      the deployment is already disconnected from |charts-short|.
      
      If the deployment connection status is :guilabel:`Connected`:
      
      a. Click the disconnect icon :icon-fa5:`unlink` next to the deployment connection
         status. The :guilabel:`Disconnect Deployment` modal appears.
      #. Click :guilabel:`Check for connected charts` to
         learn whether any charts use the deployment's collections as a
         data source.
      #. Click :guilabel:`Disconnect`.
      
      The deployment disconnects from |charts-short|.

.. _disconnect-data-source:

Disconnect a Data Source from |charts|
--------------------------------------

Disconnect a data source from |charts-short| to remove its data from
your charts. If you disconnect a data source:

- Any charts you built that use the data source no longer
  render and display an error.
- Any charts that use :pipeline:`$lookup` to access data in the data
  source no longer render and display an error.
- You can't use the data source to build new charts.

You can also :ref:`disconnect a deployment <disconnect-deployment>`.

If you disconnect a data source, you can :ref:`reconnect
<connect-data-source>` it later to resume rendering charts that 
use its data.

.. note::

   .. include:: /includes/sample-data-source-description.rst

To disconnect a data source from |charts-short|:

.. procedure::
   :style: normal

   .. include:: /includes/steps-access-deployment.rst

   .. step:: In the :guilabel:`Data Access` section, select the database that contains the data source.

      Select the database that contains the data source you want to
      disconnect. The database's data sources display.

   .. step:: Click :guilabel:`Manage` next to the data source's information.

      The data source's details page displays.

   .. step:: Check the connection status and disconnect the data source.

      If the data source connection status is :guilabel:`Disconnected`,
      the data source is already disconnected from |charts|.
      
      If the data source connection status is :guilabel:`Connected`:
     
      a. Click the disconnect icon :icon-fa5:`unlink` next to the data
         source connection
         status. The :guilabel:`Disconnect Data Source` modal appears.
      #. Click :guilabel:`Check for connected charts` to
         learn whether any charts use the
         data source.
      #. Click :guilabel:`Disconnect`.
     
      The data source disconnects from |charts-short|.
