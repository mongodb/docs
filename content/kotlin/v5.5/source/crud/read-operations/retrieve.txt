.. _kotlin-fundamentals-retrieve-data:

==============
Find Documents
==============

.. facet::
   :name: genre
   :values: reference

.. meta::
   :keywords: code example, read, query, filter

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Overview
--------

In this guide, you can learn how to use the {+driver-short+} to retrieve data from a
MongoDB collection by using read operations. You can call the ``find()`` method to
retrieve documents that match a set of criteria specified in a query filter.

.. _retrieve-paint-order-collection:

Sample Data
~~~~~~~~~~~

The examples in this guide use the ``movies`` collection in the ``sample_mflix``
database from the :atlas:`Atlas sample datasets </sample-data>`. To learn how to create a
free MongoDB Atlas cluster and load the sample datasets, see the
:ref:`Get Started <unified-get-started>` guide.

The following {+language+} data class models the documents in this collection:

.. literalinclude:: /includes/read/Find.kt
   :start-after: start-movie-data-class
   :end-before: end-movie-data-class
   :language: kotlin

The following {+language+} data class models the results returned by the examples in this guide:

.. literalinclude:: /includes/read/Find.kt
   :start-after: start-results-data-class
   :end-before: end-results-data-class
   :language: kotlin

.. _retrieve-find:

Find Operation
--------------

The ``find()`` method retrieves documents from a collection. This
method takes a **query filter** and returns all matching documents. A query filter is a
document that specifies the criteria that the driver uses to match documents from the
collection.

To learn more about query filters, see the :ref:`kotlin-fundamentals-query` guide.

Find One Document Example
~~~~~~~~~~~~~~~~~~~~~~~~~

The following example chains the ``firstOrNull()`` method to the ``find()`` method call to find
the first document in which the value of the ``name`` field is ``"The Room"``:

.. io-code-block::
   :copyable: true

   .. input:: /includes/read/Find.kt
      :start-after: start-find-one
      :end-before: end-find-one
      :language: kotlin
      :dedent:
   
   .. output::
      :visible: false

      Movie(title=The Room, runtime=99, imdb=IMDB(rating=3.7))

Find Documents Example
~~~~~~~~~~~~~~~~~~~~~~

This example uses the ``find()`` method to find all documents in which the
value of the ``runtime`` field is less than ``15``. The ``find()`` operation returns a
``FindFlow`` object, which you can iterate through by using the ``collect()``
method, as shown in the following example:

.. io-code-block::
   :copyable: true

   .. input:: /includes/read/Find.kt
      :start-after: start-find
      :end-before: end-find
      :language: kotlin
      :dedent:
   
   .. output::
      :visible: false

      Movie(title=Meshes of the Afternoon, runtime=14, imdb=IMDB(rating=8.0))
      Movie(title=The Band Concert, runtime=9, imdb=IMDB(rating=7.9))
      Movie(title=What's Opera, Doc?, runtime=7, imdb=IMDB(rating=8.3))
      ...

.. note:: Find All Documents
 
   To find all documents in a collection, pass an empty filter to the ``find()`` method:

   .. literalinclude:: /includes/read/Find.kt
      :start-after: start-find-all
      :end-before: end-find-all
      :language: kotlin
      :dedent:

Modify Find Behavior
~~~~~~~~~~~~~~~~~~~~

You can modify the behavior of the ``find()`` method by chaining methods to
a ``FindFlow`` instance. The following table describes commonly used methods for
modifying queries:

.. list-table::
   :widths: 30 70
   :header-rows: 1

   * - Method
     - Description

   * - ``batchSize()`` 
     - | Limits the number of documents to return per batch. To learn more about
         batch size, see :manual:`cursor.batchSize() </reference/method/cursor.batchSize/>`
         in the MongoDB Server manual.

   * - ``collation()`` 
     - | Sets the collation options for the query. 
   
   * - ``collect()``
     - | Processes each element in the flow and applies the given lambda.

   * - ``comment()`` 
     - | Specifies a string to attach to the query. This can help you trace and interpret the
         operation in the server logs and in profile data.

   * - ``first()`` 
     - | Returns the first document that matches the query or throws a ``MongoClientException`` 
         if no matching documents exist.

   * - ``firstOrNull()`` 
     - | Returns the first document that matches the query or ``null`` if no matching documents exist.

   * - ``hint()`` 
     - | Specifies the index to use for the query.

   * - ``limit()``
     - | Limits the number of documents to be returned from the query.

   * - ``skip()``
     - | Sets the number of documents to skip.

   * - ``sort()``
     - | Defines the sort criteria to apply to the query.

The following example chains the ``limit()`` method to limit the
number of documents returned by the query to ``10``:

.. literalinclude:: /includes/read/Find.kt
   :start-after: start-find-limit
   :end-before: end-find-limit
   :language: kotlin
   :dedent:

For a full list of methods that modify the behavior of ``find()``, see the `FindFlow <{+driver-api+}/-find-flow/index.html>`__
class in the {+driver-short+} API documentation.

Additional Information
----------------------

To learn more about query filters, see :ref:`kotlin-fundamentals-query`.

API Documentation
~~~~~~~~~~~~~~~~~

To learn more about any of the methods or types discussed in this guide, see the following
API documentation:

- `MongoCollection.find() <{+driver-api+}/-mongo-collection/find.html>`__
- `FindFlow <{+driver-api+}/-find-flow/index.html>`__
