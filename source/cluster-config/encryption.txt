.. _create-cluster-enable-encryption:

===============================
Manage Your Own Encryption Keys
===============================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. include:: /includes/fact-atlas-free-tier-limits.rst

|service| encrypts all cluster storage and snapshot volumes,
ensuring the security of all cluster data at rest
(Encryption at Rest). |service|
:authrole:`Project Owners <project Owner>` can configure
an additional layer of encryption on their data at rest using the
MongoDB
:manual:`Encrypted Storage Engine </core/security-encryption-at-rest>`
and their |service|-compatible Encryption at Rest provider.

.. figure:: /images/additional-settings-kms.png
   :scale: 50%
   :alt: Image showing KMS selection

|service| supports the following Encryption at Rest providers:

- :ref:`AWS Key Management Services <security-aws-kms>`
- :ref:`Azure Key Vault <security-azure-kms>`
- :ref:`Google Cloud KMS <security-gcp-kms>`

Prerequisites
-------------

- You must configure the |service| project for Encryption at Rest
  using your Key Management before enabling the feature for your
  |service| clusters. To learn more,
  see :ref:`security-kms-encryption`.

- If you want to switch from one Encryption at Rest provider on your
  cluster to another, you must first disable Encryption at Rest for
  your cluster, then re-enable it with your desired Encryption at
  Rest provider. See :doc:`/security-kms-encryption`.

Procedure
---------

To start managing your own encryption keys for this cluster,
toggle :guilabel:`Encryption using your Key Management (M10 and up)`
to :guilabel:`Yes`.

|service| Encryption at Rest using your Key Management is available for
``M10`` or greater replica set clusters. |service| Encryption
at Rest supports encrypting :ref:`backup-cloud-provider` **only**.
You cannot enable Encryption at Rest on a cluster using
:ref:`legacy-backup`.

Managing your own encryption keys incurs an increase to the hourly run
costs of your clusters. For more information on |service| billing for
advanced security features, see :ref:`advanced-security`.

.. important::

   If |service| cannot access the |service| project key management
   provider or the encryption key used to encrypt a cluster, then
   that cluster becomes inaccessible and unrecoverable. Exercise
   extreme caution before modifying, deleting, or disabling an
   encryption key or key management provider credentials used by
   |service|.
