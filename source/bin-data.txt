.. _charts-bin-data:

========
Bin Data
========

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

|charts| supports *binning* both numeric and date fields in your
data. Binning breaks continuous data into discrete groups called
*bins*, with each bin containing a contiguous subset of the original
values. For example, you might group users into bins by the decade they were
born, or group timestamped calendar events by the month of their start
date.

.. _continuous-discrete-data:

.. cssclass:: admonition-example
.. admonition:: Continuous vs Discrete Data

   Continuous data can occupy any value over a continuous range.
   Some examples of continuous data include height, temperature, or
   the time a person was born.

   Alternatively, discrete data is data which can only take certain
   values, categorized into a classification. Examples of discrete
   data include eye color and the number of students in a class.

Bin Date Fields
---------------

When handling dates, this data often comes in a continuous
form. It can be useful to split this data into a specific windows of
time to uncover additional trends and patterns. |charts| supports the
following bins for dates:

.. hlist::
   :columns: 2

   * Year
   * Month
   * Week of Year
   * Date of the Month
   * Day of the Week
   * Hour
   * Minute
   * Second

To use binning for dates:

1. Drag a date field (signified by a calendar icon in the
   :guilabel:`Fields` section of the Chart Builder) to a
   :guilabel:`category` :ref:`encoding channel <encoding-channels>`.

   By default, binning is enabled as indicated by the
   :guilabel:`Binning On` toggle.

#. Use the dropdown to select the bin size for your dates.

.. _periodic-setting:

3. Toggle the :guilabel:`Periodic` setting as desired.

   - If enabled, |charts| creates bins relative to the next highest
     time period and repeats each bin to cover the timeframe spanned
     in the data field.

   - If disabled, the bins |charts-short| creates do not repeat.

   .. example::

      Consider a date field containing data spanning 5 years, and
      a bin selection of :guilabel:`Month`. If :guilabel:`Periodic` is
      disabled, |charts-short| adds the 60 months in the dataset to the
      visualization.

      Alternatively, if :guilabel:`Periodic` is enabled, |charts-short|
      only plots the 12 calendar months, and visualizes the total
      aggregated results from each calendar month.

   .. note::

      The :guilabel:`Periodic` setting is always enabled when selecting
      a bin size of :guilabel:`Day of the Week`.

      The :guilabel:`Periodic` setting is always disabled when
      selecting a bin size of :guilabel:`Year`, because year is the
      largest time period available in |charts-short|.

To disable binning, toggle the :guilabel:`Binning` setting
to off. In this case, each date from the field is added to the
visualization with no grouping performed.

.. example::

   The following chart visualizes historical sales data for an office
   supply store. Every sale is represented by a document in the
   ``supplySales`` collection. Each document in the collection includes
   the date of the sale as ``salesDate`` and a list of items included
   in the sale as the ``items`` array.

   The ``saleDate`` field contains :ref:`continuous
   <continuous-discrete-data>` timestamp data. The field
   is binned by :guilabel:`Date of the Month` with the
   :guilabel:`Periodic` setting enabled. This means that over the
   course of the several years the data spans, |charts| plots the
   :guilabel:`mean` value of sales from each individual date of the
   month:

   .. figure:: /images/charts/charts-binning-by-day.png
      :figwidth: 680px
      :alt: Charts binning by day example

Bin Numeric Fields
------------------

|charts| can also bin numeric fields from a continuous set into groups
of a specified size. This

To use binning for numeric fields:

1. Drag a numeric field (signified by the number sign icon in the
   :guilabel:`Fields` section of the Chart Builder) to a
   :guilabel:`category` :ref:`encoding channel <encoding-channels>`.

   By default, binning is enabled as indicated by the toggle stating
   :guilabel:`Binning On`.

#. Enter the desired bin size in the :guilabel:`Bin Size` input.

To disable binning, toggle the :guilabel:`Binning` setting
to off. In this case, each individual value from the field is added
to the visualization, rather than being grouped into bins.

.. example::

   The following chart visualizes historical sales data for an office
   supply store. Every sale is represented by a document in the
   ``supplySales`` collection. Each sale document contains a
   ``customer`` object, which contains information on the customer
   purchasing the item(s).

   The following chart applies binning to the ``customer.age`` field.
   The ``age`` field contains continuous numeric data and is
   binned by decade. Each ``age`` value is placed into the
   appropriate bin and |charts-short| counts the number of ages in each
   bin to provide a high-level overview of the age distrubution of
   store customers.

   .. figure:: /images/charts/charts-numeric-binning.png
      :figwidth: 680px
      :alt: Charts numeric binning example

Empty Bins
----------

When binning is enabled, |charts-short| displays entries for
empty bins within the minimum and maximum data range a chart displays.

.. admonition: Exception
   :class: note

   |charts-short| doesn't display empty bins if including them results
   in more than 5000 unique bins on a chart.

The value |charts-short| uses for empty bins depends on the
aggregation function you choose:

.. list-table::
   :header-rows: 1
   :widths: 2 1

   * - Aggregation Function
     - Inferred Value

   * - ``count`` or ``distinct``
     - ``0``

   * - All Other Functions
     - ``null``

|charts-short| displays bins with ``null`` values differently based on
chart type:

.. list-table::
   :header-rows: 1
   :widths: 1 2

   * - Chart Type
     - How |charts-short| Displays ``null`` Bins

   * - :ref:`column-bar-chart-ref`
     - Bars with a height of ``0``. |charts-short| doesn't display data
       labels for ``null`` bins, even if enabled.

   * - :ref:`line-area-chart-ref`
     - Linear interpolation, with no data marker on the ``null`` bins.
       |charts-short| doesn't display data labels for ``null`` bins,
       even if enabled.
