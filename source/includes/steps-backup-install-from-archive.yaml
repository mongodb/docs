title: Download the latest version of the Backup Agent archive.
stepnum: 1
ref: download
pre: |
  On a system shell, issue one of the following commands, depending on your operating system:
# Is there a preferred directory to which to download and install the Backup Agent ???
action:
  - pre: |
      On Linux:
    language: sh
    code: |
      curl -OL https://mms.mongodb.com/download/agent/backup/mongodb-mms-backup-agent-latest.linux_x86_64.tar.gz
  - pre: |
      On Mac OSX:
    language: sh
    code: |
      curl -OL https://mms.mongodb.com/download/agent/backup/mongodb-mms-backup-agent-latest.osx_x86_64.tar.gz
---
title: Install the Backup Agent.
stepnum: 2
ref: extract
pre: |
  To install the agent, extract the archive by issuing one of the
  following commands, depending on your operating system:
action:
  - pre: |
      On Linux:
    language: sh
    code: |
      tar -xf mongodb-mms-backup-agent-latest.linux_x86_64.tar.gz
  - pre: |
      On Mac OSX:
    language: sh
    code: |
      tar -xf mongodb-mms-backup-agent-latest.osx_x86_64.tar.gz
post: |
  The Backup Agent is installed.
---
title: Retrieve the API key for your MMS group.
stepnum: 3
ref: retrieve
content: |

  To retrieve the key, do the following.

  #. Open MMS and select the :guilabel:`Settings` tab and then the
     :guilabel:`Backup Agent` page.

  #. Click your operating system (either :guilabel:`Other Linux` or
     :guilabel:`Mac OSX`).

  #. MMS displays a procedure that includes a step to set your API key
     (``apiKey=``). The step displays the actual API key used by
     your MMS group. Copy the key.

---
title: Configure the ``local.config`` file with the API key.
stepnum: 4
ref: configure
content: |

  #. In the directory where you installed the Mongitoring Agent, locate
     and open the ``local.config`` file.

  #. Enter your API key as the value for the ``apiKey`` setting.

  #. Save and close the file.
---
title: Configure the agent to use a proxy (optional).
stepnum: 5
ref: proxy
action:
  pre: |
    If the agent will connect to MMS via a proxy server, you must specify
    the server in the ``http_proxy`` environment variable. To specify the
    server, use the ``export`` command, as in the following example:
  language: sh
  code: |
    export http_proxy="http://proxy.example.com:9000"
# todo: The above content of this step can be borrowed from steps-shared-agent-install.yaml.
#       The post content below is not borrowed.
post: |
  To connect through a proxy, you must install the agent from a
  ``.tar.gz`` file, *not* from a ``.deb`` or ``.rpm`` file.
---
title: Start the Backup Agent.
stepnum: 6
ref: start
action:
  pre: |
    Issue the following command:
  language: sh
  code: |
    nohup ./mongodb-mms-backup-agent >> backup-agent.log 2>&1 &
...
