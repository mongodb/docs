==================
FAQ: MongoDB Agent
==================

This addresses common questions about the MongoDB Agent.

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. _mongodb-agent-faq-general:

General
-------

.. _mongodb-agent-faq-general-what-is-it:

What is the MongoDB Agent?
~~~~~~~~~~~~~~~~~~~~~~~~~~

The MongoDB Agent can help you manage your MongoDB instances. Today,
you need to install multiple software agents to manage your instances.
When we release the MongoDB Agent, you can update to  this single
binary on any server. Each Agent can back up, monitor, and/or manage
instances. The choice is yours!

If you use any of the existing three Agents, |mms| will prompt you to
update to the new MongoDB Agent. We explain the different possible
update paths later in this document.

.. _mongodb-agent-faq-general-when-is-the-launch:

When will you launch MongoDB Agent in |mms|?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. cond:: cloud

   Between mid-April and May 2019, we plan to release the MongoDB
   Agent. As it does today, |mms| gives you the option to update Agents
   on your schedule. If you do not update to the MongoDB Agent, you can
   remain on the final version of the three separate Agents. These
   Agents will not receive bug fixes or new features. MongoDB
   encourages you to update as soon as possible after release. Once you
   choose to update, you must update all clusters in the project. Once
   updated, the |mms| interface changes to the new flow and content for
   the MongoDB Agent.

.. cond:: onprem

   Between May and June 2019 for |onprem| 4.1, we plan to release the
   MongoDB Agent. As it does today, |mms| gives you the option to
   update Agents on your schedule. If you do not update to the MongoDB
   Agent, you can remain on the final version of the three separate
   Agents. These Agents will not receive bug fixes or new features.
   MongoDB encourages you to update as soon as possible after release.
   Once you choose to update, you must update all clusters in the
   project. Once updated, the |mms| interface changes to the new flow
   and content for the MongoDB Agent.


When must I switch to the MongoDB Agent?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The best time would be when we make it available in |mms|. You can
remain on the three Agents without bug fixes or new features.

Can I update per cluster or per node?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

No. Updates to MongoDB Agent must be done for all clusters in a project
simultaneously.

Will the |mms| UI change?
~~~~~~~~~~~~~~~~~~~~~~~~~

Yes. In areas like the Agent(s) and Servers tabs, some wording will
change but nothing dramatic.

Will the |mms| API support the MongoDB Agent?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Yes.

Can I programmatically upgrade to MongoDB Agent via the API?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Yes.

Will the new installer use a different filename?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

No. It will remain ``mms-automation`` to make the update easier.

I have a PEM Key File and Password(s) set for my Automation, Monitoring or Backup Agents? Howâ€™s that going to work?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When you update to MongoDB Agent, these settings are preserved. If you
have set a |pem| Key File and Password in the :guilabel:`Security` >
:guilabel:`Authentication & TLS/SSL` section of |mms|, it uses the
current Automation Agent |pem| key file and Password as the MongoDB
Agent |pem| Key File and Password.

Any existing Monitoring and Backup |pem| Key File and password(s) are
exported into the new custom configuration section for Monitoring and
Backup functions of the MongoDB Agent page. A warning displays at the
:guilabel:`Configure Cloud Manager Agents` section
(:guilabel:`Security` > :guilabel:`Authentication & TLS/SSL`)
that those values are being overridden with values from the custom
configuration section.

.. _mongodb-agent-faq-monitoring-agent-only:

I only use the Monitoring Agent, what does this mean for me?
------------------------------------------------------------

Rest assured, you will be supported with MongoDB Agent. In general, the
update flow proceeds as follows:

#. When the MongoDB Agent is available, you see the usual banner
   notification that your Monitoring Agent is out of date.

#. When you are ready to update, click :guilabel:`Update` in the
   banner. A workflow that guides you through the update process
   starts.

   a. First, you read a brief explanation of what MongoDB Agent is with
      a link to relevant documentation.

   #. Second, you can enter any custom Monitoring configuration options
      you require for your |mms| project.

   #. Third, you can download and install the new MongoDB Agent. |mms|
      verifies that it has been installed correctly on the list of known
      servers.

      .. note::

         Previous authentication methods continue to work and MongoDB
         authentication information are entered in the same locations
         in the User Interface. (Monitoring user settings under the
         :guilabel:`Monitoring Settings` menu option of the
         :icon:`ellipsis-h` menu.)

#. Once the MongoDB Agent is installed on a server, it enables the
   Monitoring function where it existed as a standalone Agent before.

#. The MongoDB Agent also puts the old Monitoring Agents into standby
   mode and no longer shows them in the UI.

#. The old standalone Monitoring Agents can no longer monitor
   instances. You can stop and remove them when ready.

All done! From this point forward, the MongoDB Agent can update itself
once you :guilabel:`Confirm and Deploy` a new version. You no longer
need to download the binary each time a new version is available!

.. _mongodb-agent-faq-monitoring-and-backup-agents-only:

I only use the Monitoring and Backup Agents, what does this mean for me?
------------------------------------------------------------------------

Rest assured, you will be supported with MongoDB Agent. In general, the
update flow proceeds as follows:

#. When the MongoDB Agent is available, you see the usual banner
   notification that your Monitoring and Backup Agents are out of date.

#. When you are ready to update, click :guilabel:`Update` in the
   banner. A workflow that guides you through the update process
   starts.

   a. First, you read a brief explanation of what MongoDB Agent is with
      a link to relevant documentation.

   #. Second, you can enter any custom Monitoring and Backup
      configuration options you require for your |mms| project.

   #. Third, you can download and install the new MongoDB Agent. |mms|
      verifies that it has been installed correctly on the  list of
      known servers.

      .. note::

         Previous authentication methods continue to work and MongoDB
         authentication information are entered in the same locations
         in the User Interface. (Monitoring user settings are found via
         the :guilabel:`Monitoring Settings` menu option in the
         :icon:`ellipsis-h` menu. Backup user settings are found on the
         :guilabel:`Backup` screen under :guilabel:`Options` >
         :icon:`ellipsis-h` > :guilabel:`Edit Credentials`.)

#. Once the MongoDB Agent is installed on a server, it enables the
   Monitoring and Backup functions where they existed as a standalone
   Agents before.

#. The MongoDB Agent puts the old Monitoring and Backup Agents into
   standby mode and no longer shows them in the UI.

The old standalone Monitoring Agents can no longer monitor instances.
You can stop and remove them when ready.

All done! From this point forward, the MongoDB Agent can update itself
once you Confirm and Deploy a new version. You no longer need to
download the binary each time a new version is available!

.. _mongodb-agent-faq-three-agents:

My clusters are already managed using all 3 Agents, what will happen?
---------------------------------------------------------------------

Step right onto Easy Street! The update flow proceeds as follows:

#. When the MongoDB Agent is available, you see the usual banner
   notification that your Agents are out of date.

#. When you are ready to update, click :guilabel:`Update` in the
   banner. A workflow that guides you through the update process
   starts.

   #. First, you read a brief explanation of what MongoDB Agent is with
      a link to relevant documentation.

   #. Second, you see a list your current servers and you can update
      all of them to MongoDB Agent with the click of a single button.
      As a part of this update process the MongoDB Agent:

      - Stops any Monitoring and Backup Agents.

      - Enables its Monitoring and Backup functions on the servers
        where Monitoring and/or Backup were running as an Agent.

      - Removes the stopped Monitoring and Backup Agent binaries.

      - Unlocks the ``mms-monitoring-agent`` or ``mms-backup-agent``
        users in your MongoDB instances so you can delete them, if
        desired. The MongoDB Agent uses the ``mms-automation`` user for
        all MongoDB Agent-enabled functions to connect to your
        instances.

All done! From this point forward, the MongoDB Agent works as a single
process managing all three functions: Automation, Monitoring and Backup.

What about the three MongoDB Agent Users?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

MongoDB is consolidating the three MongoDB users that the Automation
Agent currently uses (``mms-automation``, ``mms-monitoring-agent``,
``mms-backup-agent``) into one user. This user, ``mms-automation``, is
granted all needed permissions for all functions. MongoDB is not
removing the old MongoDB users in case you use those users for
something else. However, |mms| will unlock these users in its interface
as part of the update so you can delete them.

I mostly manage my clusters with the Automation Agent but I have Standalone Backup and Monitoring agents, what does this mean for me?
-------------------------------------------------------------------------------------------------------------------------------------

You get both update flows: one for anything standalone as explained in
the previous sections:

:ref:`I only use the Monitoring Agent, what does this mean for me? <mongodb-agent-faq-monitoring-agent-only>` or

:ref:`I only use the Monitoring and Backup Agents, what does this mean for me? <mongodb-agent-faq-monitoring-and-backup-agents-only>`

For those servers where Automation manages Monitoring/Backup Agents,
you follow the
:ref:`My clusters are already managed using all 3 Agents, what will happen? <mongodb-agent-faq-three-agents>`
section.
