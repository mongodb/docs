===================================
Configure Monitoring Agent for LDAP
===================================

.. default-domain:: mongodb

Overview
--------

If your MongoDB deployment enforces access control, the Monitoring
Agent must authenticate to MongoDB as a user with the proper access.

LDAP is a standard protocol for accessing user credential data.
Starting in version 2.6, MongoDB Enterprise provides an ``LDAP (plain)``
authentication mechanism that allows clients to authenticate to MongoDB
deployments using LDAP. Monitoring Agents support authenticating to
MongoDB instances using LDAP.

If your MongoDB deployment uses LDAP to authenticate users, to
authenticate the Monitoring Agent, create a user in the ``$external``
database with the appropriate roles in MongoDB.

.. include:: /includes/extracts/note-manage-agent-auth-with-automation-ldap.rst

Considerations
--------------

You must configure LDAP authentication separately for the Monitoring
Agent and for the Backup Agent.

You can configure LDAP authentication when adding a host or later by
editing the host.

Prerequisites
-------------

.. include:: /includes/fact-auth-monitoring-requirements.rst

Create User in MongoDB
----------------------

To monitor MongoDB 2.6 instances that are using LDAP authentication,
add a user to the ``$external`` database in MongoDB with the
appropriate roles. The ``$external`` database allows :program:`mongod`
to consult an external source (e.g. LDAP) to authenticate.

.. code-block:: javascript

   db.getSiblingDB("$external").createUser(
       {
         user : "<username>",
         roles: [ { role: "clusterMonitor", db: "admin" } ]
       }
   )

See :ref:`Access Control for MongoDB 2.6
<access-control-monitoring-agent-2.6>` for more information on the
required access.

Host Settings
-------------

.. include:: /includes/fact-access-control-host-settings.rst
