.. _multi-cluster-quick-start-ref:

=========================
Multi-Cluster Quick Start
=========================

.. default-domain:: mongodb

.. meta::
   :keywords: multicluster
   :keywords: multi-cluster

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. _multi-cluster-services-tools-ref:

Use the quick start to deploy a MongoDB replica set across three |k8s| 
member clusters, using |gke| and |istio| service mesh.

Services and Tools
------------------

The quick start relies on the following 
services, tools, and their documentation:

- |k8s| clusters. The quick start uses |gke| to provision multiple
  |k8s| clusters. Each |k8s| member cluster hosts a MongoDB replica set
  deployment and represents a data center that serves your application.

- :github:`MongoDB Enterprise Kubernetes Operator repository
  </mongodb/mongodb-enterprise-kubernetes>` with configuration
  files that the |k8s-op-short| needs to deploy a |k8s| cluster.

- :mdb-github:`MongoDB Helm Charts for Kubernetes </helm-charts>` with
  charts for |multi-clusters|.

- |istio| service mesh. 

  - The quick start uses |istio| to facilitate
    `DNS resolution
    <https://istio.io/latest/docs/ops/configuration/traffic-management/dns-proxy/>`__
    for MongoDB replica sets deployed in different |k8s| clusters. You
    can use another service mesh solution as long as you ensure that
    cross-cluster service FQDNs are resolvable.

  - Documentation from |istio| to `Install Multicluster <https://istio.io/latest/docs/setup/install/multicluster/>`__.

  - :github:`install_istio_separate_network script </mongodb/mongodb-enterprise-kubernetes/blob/master/tools/multicluster/install_istio_separate_network.sh>`
    that is based on Istio documentation and provides an example
    installation that uses the `multi-primary mode on different networks
    <https://istio.io/latest/docs/setup/install/multicluster/multi-primary_multi-network/>`__.
    If you use another service mesh solution, create your own script for
    configuring separate networks to facilitate DNS resolution.

- :github:`multi-cluster kubeconfig creator </mongodb/mongodb-enterprise-kubernetes/blob/master/tools/multicluster/main.go>`
  tool that performs the following actions:

  - Creates a single ``mongodb`` namespace in the central cluster and
    each member cluster.
  - Creates Service Accounts, Roles, and RoleBindings in the central
    cluster and each member cluster.
  - Puts Service Account token secrets from each member cluster into a
    single ``kubeconfig`` file and saves the file in the central cluster.
    This enables authorized access from the |k8s-op-short| installed in
    the central cluster to the member clusters.

:ref:`multi-cluster-quick-start-prereqs`
  Set up |gke| clusters, install tools, set the deployment's scope, and
  check connectivity across member clusters.

:ref:`multi-cluster-quick-start-procedure`
  Deploy |multi-clusters|.


.. class:: hidden

   .. toctree::
      :titlesonly:


      /multi-cluster-quick-start-prerequisites
      /multi-cluster-quick-start-procedure

