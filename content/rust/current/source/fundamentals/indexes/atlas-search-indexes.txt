.. _rust-atlas-search-indexes:

========================================
MongoDB Search and Vector Search Indexes
========================================

.. facet::
   :name: genre
   :values: reference

.. meta::
   :keywords: code example, full text, atlas deployment, text search, embeddings
   :description: Learn to create and manage MongoDB Search indexes for fast, full-text searches on data in an Atlas cluster using the Rust driver.

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Overview
--------

In this guide, you can learn how to create and manage **{+search+} and
{+vector-search+} indexes**. These indexes allow you to use the following
features:

- :atlas:`{+search+} </atlas-search/>`: Perform fast, full-text
  searches

- :ref:`{+vector-search+} <rust-vector-search>`: Perform
  semantic (similarity) searches on vector embeddings

{+search+} and {+vector-search+} indexes specify which fields to index,
specify how these fields are indexed, and set other optional
configurations.

This guide explains how to perform the following actions to manage your
{+search+} and {+vector-search+} indexes:

- :ref:`rust-create-model`
- :ref:`rust-create-search-index`
- :ref:`rust-create-search-indexes`
- :ref:`rust-list-search-index`
- :ref:`rust-update-search-index`
- :ref:`rust-drop-search-index`

.. note:: Sample Data

   The examples in this guide use the ``embedded_movies`` collection
   in the ``sample_mflix`` database, which is one of the Atlas sample
   datasets. For instructions on importing the Atlas sample data, see
   :atlas:`Load Sample Data </sample-data>` in the Atlas documentation.

.. _rust-create-model:

Create a Search Index Model
---------------------------

To create a {+search+} index, you must first build a ``SearchIndexModel`` instance
that sets your index specifications. To begin building a ``SearchIndexModel`` instance,
call the ``SearchIndexModel::builder()`` method.

.. note:: Instantiating Models
   
   The {+driver-short+} implements the Builder design pattern for the
   creation of some struct types, including ``SearchIndexModel``. You
   can use the ``builder()`` method to construct an instance of each type
   by chaining option builder methods.

The {+driver-short+} provides the following ``SearchIndexModel`` builder methods:

.. list-table::
   :header-rows: 1
   :widths: 25 25 50

   * - Builder Method
     - Parameter Type
     - Description

   * - ``definition()``
     - ``Document``
     - Specifies the index definition. If you omit this setting, the
       driver creates a {+search+} index with dynamic mappings.

   * - ``name()``
     - ``String``
     - Sets the index name. If you omit this setting, the
       driver sets the name to ``default``.

   * - ``index_type()``
     - ``SearchIndexType``
     - Sets the index type. If you omit this setting, the
       driver creates a {+search+} index by default.

To learn more about {+search+} field mappings, see :atlas:`Define Field Mappings
</atlas-search/define-field-mappings/>` in the Atlas documentation.

To learn more about defining {+vector-search+} indexes, see
:atlas:`How to Index Fields for Vector Search
</atlas-vector-search/vector-search-type/>` in the Atlas documentation.

Example Models
~~~~~~~~~~~~~~

The following example creates a ``SearchIndexModel`` instance to provide
specifications for an index named ``search_idx``. The code specifies static
mappings of the ``title`` and ``released`` fields:

.. literalinclude:: /includes/fundamentals/code-snippets/indexes/atlas-indexes.rs
   :start-after: begin-as-model
   :end-before: end-as-model
   :language: rust
   :dedent:

The following example creates a ``SearchIndexModel`` instance to provide
specifications for an index named ``vs_idx``. The code specifies the
embedding path as  ``plot_embedding``, indexes ``1536`` dimensions, and
uses the ``"euclidean"`` vector similarity function:

.. literalinclude:: /includes/fundamentals/code-snippets/indexes/atlas-indexes.rs
   :start-after: begin-avs-model
   :end-before: end-avs-model
   :language: rust
   :dedent:

.. _rust-create-search-index:

Create a Search Index
---------------------

You can create a {+search+} or {+vector-search+} index on a collection by
calling the ``create_search_index()`` method on a ``Collection``
instance. This method accepts an index model as a parameter, specified
in a ``SearchIndexModel`` instance.

Example
~~~~~~~

The following example creates a {+search+} index on the
``embedded_movies`` collection. The code creates a ``SearchIndexModel``
that sets the index name and enables dynamic mapping. Then, the code
passes the ``SearchIndexModel`` instance to the ``create_search_index()``
method to create the {+search+} index:

.. io-code-block::
   :copyable: true

   .. input:: /includes/fundamentals/code-snippets/indexes/atlas-indexes.rs
      :start-after: begin-atlas-create-one
      :end-before: end-atlas-create-one
      :language: rust
      :emphasize-lines: 6
      :dedent:

   .. output::
      :language: console
      :visible: false

      Created MongoDB Search index:
      "example_index"

.. _rust-create-search-indexes:

Create Multiple Search Indexes
------------------------------

You can create multiple {+search+} and Vector Search indexes
by calling the ``create_search_indexes()`` method on a ``Collection``
instance. This method accepts a vector of ``SearchIndexModel`` instances
as a parameter.

Example
~~~~~~~

This example performs the following actions:

1. Creates a ``SearchIndexModel`` instance that specifies a 
   {+search+} index named ``as_idx``

#. Creates a ``SearchIndexModel`` instance that specifies a {+vector-search+}
   index named ``vs_idx``

#. Passes a ``vec`` of both ``SearchIndexModel`` instances to
   the ``create_search_indexes()`` method

#. Creates the {+search+} and {+vector-search+} indexes on the
   ``embedded_movies`` collection

.. io-code-block::
   :copyable: true

   .. input:: /includes/fundamentals/code-snippets/indexes/atlas-indexes.rs
      :start-after: begin-atlas-create-many
      :end-before: end-atlas-create-many
      :language: rust
      :emphasize-lines: 20
      :dedent:

   .. output::
      :language: console
      :visible: false

      Created MongoDB Search indexes:
      ["as_idx", "vs_idx"]

.. _rust-list-search-index:

List Search Indexes
-------------------

You can access information about a collection's existing {+search+}
and {+vector-search+} indexes by calling the ``list_search_indexes()``
method on the collection.

Example
~~~~~~~

The following example accesses information about the {+search+} and
{+vector-search+} indexes created in the :ref:`rust-create-search-indexes`
section of this page. The code calls the ``list_search_indexes()``
method and prints a list of the {+search+} and {+vector-search+} indexes
on the collection:

.. io-code-block::
   :copyable: true

   .. input:: /includes/fundamentals/code-snippets/indexes/atlas-indexes.rs
      :start-after: begin-atlas-list
      :end-before: end-atlas-list
      :language: rust
      :dedent:

   .. output::
      :language: console
      :visible: false

      { "id": "...", "name": "as_idx", "status": "READY", "queryable":
      true, "latestDefinitionVersion": {...}, "latestDefinition": {
      "mappings": { "dynamic": true } }, "statusDetail": [...] }

      { "id": "...", "name": "vs_idx", "type": "vectorSearch", "status":
      "READY", "queryable": true, ..., "latestDefinition": { "fields": [{
      "type": "vector", "path": "plot_embedding", "numDimensions": 1536,
      "similarity": "euclidean" }] }, "statusDetail": [...] }

.. tip:: 

   To learn more about iterating through a cursor, see the :ref:`rust-cursor-guide` guide.

.. _rust-update-search-index:

Update a Search Index
---------------------

You can update a {+search+} or {+vector-search+} index by calling the
``update_search_index()`` method on a ``Collection`` instance. This
method accepts the following parameters:

- Name of the index to update
- Modified index definition document

Example
~~~~~~~

The following example updates the Vector Search index named ``vs_index``
created in the :ref:`rust-create-search-indexes` section of this page. The code
creates a new index definition document that instructs the index to use
``"dotProduct"`` as the vector similarity function. Then, the code calls
the ``update_search_index()`` method to update the index:

.. literalinclude:: /includes/fundamentals/code-snippets/indexes/atlas-indexes.rs
   :start-after: begin-atlas-update
   :end-before: end-atlas-update
   :language: rust
   :emphasize-lines: 10
   :dedent:

.. _rust-drop-search-index:

Delete a Search Index
---------------------

You can delete a {+search+} or {+vector-search+} index by calling the
``delete_search_index()`` method on a ``Collection`` instance. This
method accepts the name of the index to delete as a parameter.

Example
~~~~~~~

The following example deletes the {+search+} index named ``example_index``
created in the :ref:`rust-create-search-index` section of this page. The code
passes the index name to the ``delete_search_index()`` method to delete the index:

.. literalinclude:: /includes/fundamentals/code-snippets/indexes/atlas-indexes.rs
   :start-after: begin-atlas-drop
   :end-before: end-atlas-drop
   :language: rust
   :dedent:
   
Additional Information
----------------------

To learn about other indexes you can create by using the {+driver-short+}, see the
:ref:`rust-indexes` guide.

To learn more about {+search+}, see the following Atlas documentation:

- :atlas:`{+search+} Best Practices </atlas-search/best-practices/>`
- :atlas:`Tune {+search+} Performance </atlas-search/performance/>`
- :atlas:`{+search+} M0, M2, and M5 Limitations </atlas-search/limitations/>`
- :atlas:`FAQ: {+search+} </atlas-search/faq/>`

To learn more about {+vector-search+}, see the following Atlas documentation:

- :atlas:`Improve Vector Search Performance </atlas-vector-search/tune-vector-search/>`
- :atlas:`{+vector-search+} Quick Start </atlas-vector-search/tutorials/vector-search-quick-start/>`
- :atlas:`How to Measure the Accuracy of Your Query Results </atlas-vector-search/evaluate-results/>`

API Documentation
~~~~~~~~~~~~~~~~~

To learn more about the methods and types mentioned in this
guide, see the following API documentation:

- `create_search_index() <{+api+}/struct.Collection.html#method.create_search_index>`__
- `SearchIndexModel <{+api+}/struct.SearchIndexModel.html>`__
- `SearchIndexType <{+api+}/enum.SearchIndexType.html>`__
- `create_search_indexes() <{+api+}/struct.Collection.html#method.create_search_indexes>`__
- `list_search_indexes() <{+api+}/struct.Collection.html#method.list_search_indexes>`__
- `update_search_index() <{+api+}/struct.Collection.html#method.create_search_index>`__
- `drop_search_index() <{+api+}/struct.Collection.html#method.create_search_index>`__
