---
level: 4
ref: install-helm-charts
title: "Add the :mdb-github:`MongoDB Helm Charts for Kubernetes </helm-charts>` repository to Helm."
content: |

  .. code-block:: sh

     helm repo add mongodb https://mongodb.github.io/helm-charts

---
title: "Customize your Helm Chart before upgrading it."
level: 4
optional: true
ref: helm-master-customize-chart
content: |

  To learn about optional |k8s-op-short| installation settings, see
  :ref:`Operator Helm Installation Settings <meko-op-install-settings-helm>`.
---
title: "{{method}}"
level: 4
ref: helm-master-install
replacement:
  k8sonline: |

    Install :mdb-github:`MongoDB Helm Charts for Kubernetes </helm-charts>`.
    The following command installs the |k8s-crds| and the |k8s-op-short|
    in the current namespace named ``default``. By default, the
    |k8s-op-short| uses the ``default`` namespace.

    .. code-block:: sh

       helm install enterprise-operator mongodb/enterprise-operator

    The following command installs the |k8s-op-short|  in the ``mongodb``
    namespace with the optional ``--create-namespace`` option.

    .. code-block:: sh

       helm install enterprise-operator mongodb/enterprise-operator \
         --namespace mongodb \
         --create-namespace

    To learn about optional |k8s-op-short| installation settings, see
    :ref:`Operator Helm Installation Settings <meko-op-install-settings-helm>`.

  k8soffline: |

    Install :mdb-github:`MongoDB Helm Charts for Kubernetes </helm-charts>`
    and set the value of ``registry.pullPolicy`` to ``IfNotPresent``.
    To learn about optional |k8s-op-short| installation settings, see
    :ref:`Operator Helm Installation Settings <meko-op-install-settings-helm>`.

    .. code-block:: sh

       helm install enterprise-operator mongodb/enterprise-operator \
         --set registry.pullPolicy='IfNotPresent'

  osonline: |

    Install :mdb-github:`MongoDB Helm Charts for Kubernetes </helm-charts>`:

    .. code-block:: sh

       helm install enterprise-operator mongodb/enterprise-operator \
         --values https://raw.githubusercontent.com/mongodb/helm-charts/main/charts/enterprise-operator/values-openshift.yaml

    Use the :github-raw:`values-openshift.yaml </mongodb/helm-charts/main/charts/enterprise-operator/values-openshift.yaml>`
    settings. To learn about optional |k8s-op-short| installation settings,
    see :ref:`Operator Helm Installation Settings <meko-op-install-settings-helm>`.

  osoffline: |

    Install :mdb-github:`MongoDB Helm Charts for Kubernetes </helm-charts>`:

    .. code-block:: sh

       helm install enterprise-operator mongodb/enterprise-operator \
         --set registry.pullPolicy='IfNotPresent' \
         --set registry.imagePullSecrets='<openshift-pull-secret>' \
         --values https://raw.githubusercontent.com/mongodb/helm-charts/main/charts/enterprise-operator/values-openshift.yaml

    Use the :github-raw:`values-openshift.yaml </mongodb/helm-charts/main/charts/enterprise-operator/values-openshift.yaml>`
    settings, ``registry.pullPolicy=IfNotPresent``, and
    ``registry.imagePullSecrets=<openshift-pull-secret>``. To learn
    about optional |k8s-op-short| installation settings, see
    :ref:`Operator Helm Installation Settings <meko-op-install-settings-helm>`.

  k8sonlineupgrade: |

    Invoke the following ``helm`` command:

    .. code-block:: sh

        helm upgrade enterprise-operator mongodb/enterprise-operator

  k8sofflineupgrade: |

    Invoke the following ``helm upgrade`` command.
    Use the ``registry.pullPolicy=IfNotPresent`` setting. To learn
    about optional |k8s-op-short| installation settings, see
    :ref:`Operator Helm Installation Settings <meko-op-install-settings-helm>`.

    .. code-block:: sh

       helm upgrade enterprise-operator mongodb/enterprise-operator \
         --set registry.pullPolicy='IfNotPresent'

  osonlineupgrade: |

    Invoke the following ``helm upgrade`` command.
    Use :github-raw:`values-openshift.yaml </mongodb/helm-charts/main/charts/enterprise-operator/values-openshift.yaml>` settings. To learn
    about optional |k8s-op-short| installation settings, see
    :ref:`Operator Helm Installation Settings<meko-op-install-settings-helm>`.

    .. code-block:: sh

       helm upgrade enterprise-operator mongodb/enterprise-operator \
         --values https://raw.githubusercontent.com/mongodb/helm-charts/main/charts/enterprise-operator/values-openshift.yaml

  osofflineupgrade: |


    Invoke the following ``helm upgrade`` command:

    .. code-block:: sh

       helm upgrade enterprise-operator mongodb/enterprise-operator \
           --set registry.pullPolicy='IfNotPresent' \
           --set registry.imagePullSecrets='<openshift-pull-secret>' \
           --values https://raw.githubusercontent.com/mongodb/helm-charts/main/charts/enterprise-operator/values-openshift.yaml

    Use the :github-raw:`values-openshift.yaml </mongodb/helm-charts/main/charts/enterprise-operator/values-openshift.yaml>`
    settings, ``registry.pullPolicy=IfNotPresent``, and
    ``registry.imagePullSecrets=<openshift-pull-secret>``. To learn
    about optional |k8s-op-short| installation settings, see
    :ref:`Operator Helm Installation Settings <meko-op-install-settings-helm>`.

---
title: "Connect to the internet."
level: 4
ref: helm-master-connect-internet
---
title: "Disconnect from the internet."
level: 4
ref: helm-master-disconnect-internet

---
title: "Export the |k8s-op-short| images as ``.tar`` archive files:"
level: 4
ref: helm-master-archive-files
replacement:
  versions: |
    .. include:: /includes/install/replace-op-and-om-versions.rst

  quayarchive: |

    .. code-block:: sh

       docker save quay.io/mongodb/mongodb-enterprise-operator:<op-version> -o mongodb-enterprise-operator.tar; \
       docker save quay.io/mongodb/mongodb-enterprise-database:<db-version> -o mongodb-enterprise-database.tar; \
       docker save quay.io/mongodb/mongodb-enterprise-ops-manager:<om-version> -o mongodb-enterprise-ops-manager.tar; \
       docker save quay.io/mongodb/mongodb-enterprise-appdb:{+appdb-agent-version+} -o mongodb-enterprise-appdb.tar; \
       docker save quay.io/mongodb/mongodb-enterprise-init-ops-manager:{+ops-manager-init-version+} -o mongodb-enterprise-init-ops-manager.tar; \
       docker save quay.io/mongodb/mongodb-enterprise-init-appdb:{+appdb-init-version+} -o mongodb-enterprise-init-appdb.tar;
       docker save quay.io/mongodb/mongodb-enterprise-init-database:{+database-init-version+} -o mongodb-enterprise-init-database.tar;

  rharchive: |

    .. code-block:: sh

       docker save registry.connect.redhat.com/mongodb/mongodb-enterprise-operator:<op-version> -o mongodb-enterprise-operator.tar; \
       docker save registry.connect.redhat.com/mongodb/mongodb-enterprise-database:<db-version> -o mongodb-enterprise-database.tar; \
       docker save registry.connect.redhat.com/mongodb/mongodb-enterprise-ops-manager:<om-version> -o mongodb-enterprise-ops-manager.tar; \
       docker save registry.connect.redhat.com/mongodb/mongodb-enterprise-appdb:{+appdb-agent-version+} -o mongodb-enterprise-appdb.tar; \
       docker save registry.connect.redhat.com/mongodb/mongodb-enterprise-init-ops-manager:{+ops-manager-init-version+} -o mongodb-enterprise-init-ops-manager.tar; \
       docker save registry.connect.redhat.com/mongodb/mongodb-enterprise-init-appdb:{+appdb-init-version+} -o mongodb-enterprise-init-appdb.tar;
       docker save registry.connect.redhat.com/mongodb/mongodb-enterprise-init-database:{+database-init-version+} -o mongodb-enterprise-init-database.tar;

---
title: "Copy these ``.tar`` files to the host running the
             |k8s| ``docker`` daemon."
level: 4
ref: helm-master-copy-tar
---
title: "Import the ``.tar`` files into ``docker``."
level: 4
ref: helm-master-import-tar
replacement:

  quayimport: |

    .. code-block:: sh

       docker load -i mongodb-enterprise-operator.tar; \
       docker load -i mongodb-enterprise-database.tar; \
       docker load -i mongodb-enterprise-ops-manager.tar; \
       docker load -i mongodb-enterprise-appdb.tar; \
       docker load -i mongodb-enterprise-init-ops-manager.tar; \
       docker load -i mongodb-enterprise-init-appdb.tar; \
       docker load -i mongodb-enterprise-init-database.tar;

  rhimport: |

    .. code-block:: sh

       docker load -i mongodb-enterprise-operator.tar; \
       docker load -i mongodb-enterprise-database.tar; \
       docker load -i mongodb-enterprise-ops-manager.tar; \
       docker load -i mongodb-enterprise-appdb.tar; \
       docker load -i mongodb-enterprise-init-ops-manager.tar; \
       docker load -i mongodb-enterprise-init-appdb.tar; \
       docker load -i mongodb-enterprise-init-database.tar;

---
title: "Use ``docker`` to request the files."
level: 4
ref: helm-master-docker-request
replacement:
  quaypull: |

    .. code-block:: sh

      docker pull quay.io/mongodb/mongodb-enterprise-operator:<op-version>; \
      docker pull quay.io/mongodb/mongodb-enterprise-database:<db-version>; \
      docker pull quay.io/mongodb/mongodb-enterprise-ops-manager:<om-version>; \
      docker pull quay.io/mongodb/mongodb-enterprise-appdb:{+appdb-agent-version+}; \
      docker pull quay.io/mongodb/mongodb-enterprise-init-ops-manager:{+ops-manager-init-version+}; \
      docker pull quay.io/mongodb/mongodb-enterprise-init-appdb:{+appdb-init-version+}; \
      docker pull quay.io/mongodb/mongodb-enterprise-init-database:{+database-init-version+};

  rhpull: |

    .. code-block:: sh

      docker pull registry.connect.redhat.com/mongodb/mongodb-enterprise-operator:<op-version>; \
      docker pull registry.connect.redhat.com/mongodb/mongodb-enterprise-database:<db-version>; \
      docker pull registry.connect.redhat.com/mongodb/mongodb-enterprise-ops-manager:<om-version>; \
      docker pull registry.connect.redhat.com/mongodb/mongodb-enterprise-appdb:{+appdb-agent-version+}; \
      docker pull registry.connect.redhat.com/mongodb/mongodb-enterprise-init-ops-manager:{+ops-manager-init-version+}; \
      docker pull registry.connect.redhat.com/mongodb/mongodb-enterprise-init-appdb:{+appdb-init-version+}; \
      docker pull registry.connect.redhat.com/mongodb/mongodb-enterprise-init-database:{+database-init-version+};

  versions: |

    .. include:: /includes/install/replace-op-and-om-versions.rst
...
