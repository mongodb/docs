stepnum: 1
level: 4
source:
  file: steps-source-deployment-page.yaml
  ref: click-deployment-processes-topology
---
title: "Click the :guilabel:`...` ellipsis for the Replica Set."
stepnum: 2
level: 4
ref: select-convert-to-sharded-cluster
content: |
  
  From the menu, select :guilabel:`Convert to Sharded Cluster`.

---
title: "Provide Details for your New Sharded Cluster."
stepnum: 3
ref: complete-fields
content: |

  Configure the following settings in the 
  :guilabel:`Provide details for your new sharded cluster`
  dialog:

  .. list-table::
     :widths: 30 70
     :header-rows: 1
 
     * - Field
       - Action
 
     * - :guilabel:`Cluster Name`
       - Specify the name of your new cluster. You cannot change this
         value after this step.
 
     * - :guilabel:`CSRS Name`
       - Specify the name of the Config Server Replica Set. Only
         required if the replica set deployment runs MongoDB 3.2 or 
         later. You cannot change this value after this step.
 
     * - :guilabel:`Config Servers`
       - Specify the :guilabel:`Host Name` and :guilabel:`Port` of
         each configuration server :binary:`~bin.mongod` process.
         You can configure the database path and logfile path in the
         next step.

         |mms| fixes each :binary:`~bin.mongod`
         data path to ``/data`` and log file path to
         ``/data/mongodb.log``. Each configuration server
         :binary:`~bin.mongod` must have exclusive use of these 
         paths on its specified host. The |mms| Automation Agent must 
         have file system permission to read, write, and execute all 
         files and folders in these directories. 
 
         Click :guilabel:`Add a Config Server` to add a new
         configuration server.
         Click the :icon:`trash-alt` button to remove a config server.
         You must deploy at least one configuration server.
 
     * - :guilabel:`MongoS`
       - Specify the :guilabel:`Host Name` and :guilabel:`Port`
         of each :binary:`~bin.mongos` process. You can configure the
         logfile path in the next step.

         |mms| fixes the :binary:`~bin.mongos` log file path to
         ``/data/mongodb.log``. The :binary:`~bin.mongos` must have 
         exclusive use of this path on the specified host. The 
         |mms| Automation Agent must have file system permission to 
         read, write, and execute all files and folders in these 
         directories. 
 
         Click :guilabel:`Add a MongoS` to add a new
         configuration server.
         Click the :icon:`trash-alt` button to remove a 
         :binary:`~bin.mongos`.
         You must deploy at least one :binary:`~bin.mongos`.

---
title: "Click :guilabel:`Convert`."
stepnum: 4
level: 4
ref: click-next
---
title: "Configure Cluster-Wide Settings."
stepnum: 5
level: 4
ref: balance-deployment
content: |

  The :guilabel:`Cluster Configuration` section contains the following 
  cluster-wide configuration settings. Settings marked with an 
  :guilabel:`*` asterisk in the  |mms| UI are **required**. 

  .. list-table::
     :header-rows: 1
     :widths: 40 60

     * - Setting
       - Description

     * .. include:: /includes/extracts/deploy-sharded-shard-name.rst

     * .. include:: /includes/extracts/deploy-sharded-process-name.rst

     * .. include:: /includes/extracts/deploy-sharded-version.rst

     * .. include:: /includes/extracts/deploy-data-directory.rst

     * .. include:: /includes/extracts/deploy-sharded-log-file.rst
---
title: "Configure Each Shard in Your Cluster."
stepnum: 6
level: 4
ref: configure-cluster-members-shards
source:
  file: steps-edit-sharded-cluster-deployment.yaml
  ref: configure-cluster-members-shards
---
title: "Configure Each Configuration Server in Your Cluster."
stepnum: 7
level: 4
ref: configure-cluster-members-servers
source:
  file: steps-deploy-sharded-cluster.yaml
  ref: configure-cluster-members-configuration-servers
---
title: "Configure Each ``mongos`` in Your Cluster."
stepnum: 8
level: 4
ref: configure-cluster-members-mongos
source:
  file: steps-edit-sharded-cluster-deployment.yaml
  ref: configure-cluster-members-mongos
---
title: "Configure Each Replica Set in Your Cluster."
stepnum: 9
level: 4
ref: configure-cluster-replication
source:
  file: steps-deploy-sharded-cluster.yaml
  ref: configure-cluster-replication
---
title: "Configure your |mms| Managed Indexes."
stepnum: 10
level: 4
ref: set-index
source:
  file: steps-deploy-sharded-cluster.yaml
  ref: set-index
---
title: "Set any Advanced Configuration Options for your MongoDB sharded cluster."
stepnum: 11
level: 4
ref: set-advanced
source:
  file: steps-deploy-sharded-cluster.yaml
  ref: set-advanced
---
title: "Click :guilabel:`Save`."
stepnum: 12
level: 4
ref: click-save
---
stepnum: 13
level: 4
source:
  file: steps-source-deployment-page.yaml
  ref: review-deployment
---
stepnum: 14
level: 4
source:
  file: steps-source-deployment-page.yaml
  ref: confirm-deployment
---
title: "Modify your Application to Connect to the ``mongos`` Processes Instead of the Replica Set."
stepnum: 15
level: 4
ref: modify-app
content: |
  From the |mms| UI, click the :icon:`ellipsis-h` icon, then
  click :guilabel:`Connect to this instance`. The 
  :guilabel:`Connect to your Deployment` dialog provides the hostname
  and port of a :binary:`~bin.mongos` in the cluster.

  For complete documentation on connecting to an |mms| deployment,
  see :doc:`/tutorial/connect-to-mongodb`
...