.. _atlasfederatedauth-custom-resource:

======================================
``AtlasFederatedAuth`` Custom Resource
======================================

.. meta::
   :description: Configure federated authentication for Atlas organizations using the `AtlasFederatedAuth` custom resource with role mappings and domain restrictions.

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

The ``AtlasFederatedAuth`` custom resource configures
:ref:`federated authentication <atlas-federated-authentication>` 
for your |service| organization.

.. include:: /includes/fact-ak8so-federated-auth.rst

.. include:: /includes/fact-ak8so-crds.rst

To use this resource, you must have an existing identity 
provider (|idp|) linked to your |service| organization. 
To learn more, see :ref:`ak8so-federated-auth`.

Examples
--------

.. include:: /includes/fact-atlasfederatedauth-example.rst

.. code-block::

   apiVersion: atlas.mongodb.com/v1
   kind: AtlasFederatedAuth
   metadata:
     name: atlas-default-federated-auth
     namespace: mongodb-atlas-system
   spec:
     enabled: true
     dataAccessIdentityProviders:
       - 32b6e34b3d91647abb20e7b8
       - 42d8v92k5a34184rnv93f0c1
     connectionSecretRef:
       name: my-org-secret
       namespace: mongodb-atlas-system
     domainAllowList:
       - my-org-domain.com
     domainRestrictionEnabled: true
     ssoDebugEnabled: false
     postAuthRoleGrants:
       - ORG_MEMBER
     roleMappings:
       - externalGroupName: org-admin
         roleAssignments:
           - role: ORG_OWNER
       - externalGroupName: dev-team
         roleAssignments:
           - role: ORG_GROUP_CREATOR
           - projectName: dev-project
             role: GROUP_OWNER
   status:
     conditions:
       - type: Ready
         status: True
       - type: RolesReady
         status: True
       - type: UsersReady
         status: True

.. note::

   The preceding example includes the ``status`` section,
   which describes the update process. To learn more, 
   see :ref:`ak8so-create-update-process`.


.. _atlasfederatedauth-parameters:

Parameters
----------

.. include:: /includes/manual-crds/atlas-federated-auth.rst
