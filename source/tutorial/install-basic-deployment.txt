:orphan:

=============================================================
Install a Basic Production Deployment on RHEL or Amazon Linux
=============================================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. note::

   For an evaluation tutorial that involves only a single server, see
   :doc:`/tutorial/install-simple-test-deployment`.

Overview
--------

If you have not yet read the :doc:`Introduction </introduction>`, please do so
now. The introduction describes the |onprem| components.

This tutorial installs a minimally viable |onprem| deployment to servers that
run either **RHEL 6+** or **Amazon Linux**. The deployment provides full
monitoring, automation, and backup functionality.

The deployment uses three servers. On the first, |onprem| runs without
the Backup Daemon enabled. On the second, |onprem| runs with the Backup
Daemon enabled. The |onprem| Application Database and the
Backup Database run as three-member :term:`replica
sets <replica set>`, each with two data-bearing members and an arbiter
spread across the three servers.

The replica sets provide redundancy for your application and backup data in
case of failure. The deployment does not provide high
availability and cannot continue to accept writes to a backing database
that loses a replica set member.

To install |onprem| using a different configuration or operating system,
see :doc:`/installation`.

The following diagram shows the deployment.

.. include:: /images/opsmanager-medium.rst

Prerequisites
-------------

Hardware Requirements
+++++++++++++++++++++

The servers must meet the :ref:`hardware-requirements` described on the
:doc:`/core/requirements` page. When a server hosts multiple components, you
must sum the requirements for each component to determine the requirements for
the server.

.. warning::

   Failure to configure servers according to the :doc:`/core/requirements`,
   including the requirement to read the :manual:`MongoDB Production Notes
   </administration/production-notes>`, can lead to production failure.

The size of the Backup Database depends on whether you store :term:`snapshots
<snapshot>` in the Backup Database or on your :doc:`file system
<manage-filestore-storage>`.

Permissions and Networking Requirements
+++++++++++++++++++++++++++++++++++++++

You must have root access on the servers on which you will install |onprem|.

Firewall rules must allow the following:

- An ``ssh`` port, usually port ``22``, must provide access to system
  administrators.

- Port ``8080`` of the |onprem| server, **server 1**, must allow users to
  connect to |onprem|.

- The three servers must be able to connect with each other on all MongoDB
  ports.

Procedures
----------

The following procedures prepare the servers, install the databases, and
install |onprem|. Perform the procedures in sequence.

.. _basic-deployment-prepare-servers:

Prepare Each Server
+++++++++++++++++++

Provision servers that meet the :ref:`hardware-requirements` described on the
:doc:`/core/requirements` page.

Then prepare each server as follows:

.. include:: /includes/steps/prepare-servers-basic-install.rst

Install the |onprem| Application Database
+++++++++++++++++++++++++++++++++++++++++

Install the |onprem| Application Database as a three-member replica set.

.. note::

   |onprem| cannot deploy its own backing databases. You must install those
   databases manually.

.. include:: /includes/steps/install-basic-application-database.rst

Install the Backup Database
+++++++++++++++++++++++++++

Install the Backup Database as a three-member replica set.

.. include:: /includes/steps/install-basic-backup-database.rst

Install |onprem|
++++++++++++++++

Install |onprem| on **server 1** and **server 2**.

.. include:: /includes/steps/install-basic-application.rst

Next Steps
----------

To set up a replica set for a test environment, see :doc:`/tutorial/test-new-deployment`.
The tutorial populates the replica set with test data, registers a user, and installs
the Monitoring and Backup Agents on a client machine in order to monitor the test replica set.
