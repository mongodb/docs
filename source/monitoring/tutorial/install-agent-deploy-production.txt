=========================================
Deploy the Monitoring Agent in Production
=========================================

.. default-domain:: mongodb

Overview
--------

For production deployments of |monitoring|, you will want to daemonize
the agent process and ensure that it restarts following a system restart.
Your operating system likely has a preferred method for managing daemon
processes.

Prerequisites
-------------

If your datacenter requires that you route outbound
https connections via a proxy, you  must use a version of Python greater than
2.6.1.

Considerations
--------------

You must configure the networking rules of your deployment so that:

- the Monitoring Agent can connect to all :program:`mongod` and
  :program:`mongos` instances that you want to monitor.

.. only:: saas

   - the Monitoring agent can connect to ``mms.mongodb.com`` on port 443
     (i.e. ``https``.)

.. only:: hosted

   - the Monitoring agent can connect to |monitoring| server on port 443
     (i.e. ``https``.)

The |monitoring| server does not make *any* outbound connections to the agents
or to MongoDB instances. If :ref:`Exposed DB Host Check is enabled,
<exposed-db-host-check>` the |monitoring| server will attempt to connect to
your servers occasionally as part of a vulnerability check.

Ensure all :program:`mongod` and :program:`mongos` are not accessible to hosts
outside your deployment.

Procedure
---------

.. include:: /includes/steps/monitoring-deploy-production.rst

Next Steps
----------

Once the agent is running and configured to your satisfaction, see
:doc:`/monitoring/configuring` for documentation on configuring
|monitoring| for your deployment. Also see :doc:`/monitoring/usage`
for more information about the |monitoring| interface.
