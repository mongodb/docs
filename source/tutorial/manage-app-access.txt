===============================
Application Access to |service|
===============================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

To grant applications access to an organization or project using only
the :doc:`API </api>`, you can create an |api| Key for that
application. |api| Keys:

- Have two parts: a Public Key and a Private Key. These serve the same
  function as a username and User |api| Key when making |api| requests
  to |service|.

- Cannot be used to log into |service| through the user interface.

- Must be granted roles as you would Users to make sure the |api| Keys
  can call |api| endpoints without errors.

- Can belong to one organization, but may be granted access to
  any number of projects in that organization.

.. _about-org-api-keys:

Manage Application Access to an Organization
--------------------------------------------

.. admonition:: Required Permissions
   :class: note

   To perform any of the following actions, you must have the
   :authrole:`Organization Owner` role.

.. _create-org-api-key:

Create an |api| Key in an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the organization that you
   want to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys`.

#. Select :guilabel:`Create API Key` from the :guilabel:`Manage`
   button menu.

#. From the :guilabel:`API Key Information` step of the
   :guilabel:`Add API Key` page, enter a description for the new |api|
   Key in the :guilabel:`Description` box.

#. Select the :ref:`new role or roles <organization-roles>` for the
   |api| Key from the :guilabel:`Organization Permissions` menu.

#. Click :guilabel:`Next`.

#. From the :guilabel:`Private Key & Whitelist` step of the
   :guilabel:`Add API Key` page, click :guilabel:`Add Whitelist Entry`.

#. Enter an |ipv4| address from which you want |service| to
   accept |api| requests for this |api| Key.

   You can also click :guilabel:`Use Current IP Address` if the host
   you are using to access |service| also will make |api| requests
   using this |api| Key.

#. Click :guilabel:`Save`.

.. admonition:: Copy the Private Key Before Leaving this Page
   :class: warning

   The :guilabel:`Private Key` is only shown once: *on this page*.
   Click the :guilabel:`Copy` button to add the Private Key to the
   clipboard. Save and secure this Private Key as you would any other
   password.

.. _view-org-api-key:

View the Details of an |api| Key in an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the organization that you
   want to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. From the ellipsis menu to the right of the |api| Key, click
   :guilabel:`View Details`. 

The :guilabel:`<Public Key> API Key Details` modal displays:

- The obfuscated :guilabel:`Private Key`
- The date the Key was last used
- The date the Key was created
- The |ipv4| addresses on which the key is whitelisted
- The projects to which the Key has been granted access

.. _change-org-api-key-roles:

Change an |api| Key in an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

You can change the roles, description, or whitelist of an |api| Key in 
an Organization.

1. From the :guilabel:`Context` menu, select the organization that you
   want to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. From the ellipsis menu to the right of the |api| Key you want to
   change, click :guilabel:`Edit`.

#. From the :guilabel:`API Key Information` step of the
   :guilabel:`Add API Key` page, you can change the description of  
   the |api| Key in the :guilabel:`Description` box.

#. You can change existing or add new :ref:`roles <organization-roles>`
   to the |api| Key from the :guilabel:`Organization Permissions` menu.

#. Click :guilabel:`Next`.

#. From the :guilabel:`Private Key & Whitelist` step of the
   :guilabel:`Add API Key` page, you can add or remove an |ipaddr| 
   address to the whitelist.

   - To add an |ipaddr| address from which you want |service| to accept
     |api| requests for this |api| Key, click
     :guilabel:`Add Whitelist Entry` and type an |ipv4| address.

     You can also click :guilabel:`Use Current IP Address` if the host
     you are using to access |service| also will make |api| requests
     using this |api| Key.

   - To remove a whitelisted |ipaddr| address, click :icon:`trash-alt`
     to the right of the whitelisted |ipaddr| address.

#. Click :guilabel:`Save`.

.. _delete-org-api-key:

Delete an |api| Key from an Organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the organization that you
   want to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. Click :icon:`trash-alt` to the right of the |api| Key that you want 
   to delete.

#. Click :guilabel:`Delete` to confirm that you want to delete this
   |api| Key or :guilabel:`Cancel` to leave the key in the
   Organization.

   Removing an |api| Key from an Organization also removes that key
   from any projects to which the key was granted access.

.. _about-project-api-keys:

Manage Application Access to a Project
--------------------------------------

.. admonition:: Required Permissions
   :class: note

   To perform any of the following actions, you must have either the
   :authrole:`Project User Admin` role.

.. _create-project-api-key:

Create an |api| Key for a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the project that you want
   to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys`.

#. Select :guilabel:`Create API Key` from the :guilabel:`Manage`
   button menu.

#. From the :guilabel:`API Key Information` step of the
   :guilabel:`Add API Key` page, enter a description for the new |api|
   Key in the :guilabel:`Description` box.

#. Select the :ref:`new role or roles <project-roles>` for the
   |api| Key from the :guilabel:`Group Permissions` menu.

#. Click :guilabel:`Next`.

#. From the :guilabel:`Private Key & Whitelist` step of the
   :guilabel:`Add API Key` page, click :guilabel:`Add Whitelist Entry`.

#. Enter an |ipv4| address from which you want |service| to accept
   |api| requests for this |api| Key.

   You can also click :guilabel:`Use Current IP Address` if the host
   you are using to access |service| also will make |api| requests 
   using this |api| Key.

#. Click :guilabel:`Save`.

.. admonition:: Copy the Private Key Before Leaving this Page
   :class: warning

   The :guilabel:`Private Key` is only shown once: *on this page*.
   Click the :guilabel:`Copy` button to add the Private Key to the
   clipboard. Save and secure this Private Key as you would any other
   password.

.. _view-project-api-key:

View the Details of an |api| Key in a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the project that you want
   to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. From the ellipsis menu to the right of the |api| Key, click
   :guilabel:`View Details`. 

The :guilabel:`<Public Key> API Key Details` modal displays the
obfuscated :guilabel:`Private Key`, the date the key was last used, the
date it was created, and the |ipv4| addresses on which the key is
whitelisted.

.. _change-project-api-key-roles:

Change an |api| Key's Roles in a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the project that you want
   to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. From the ellipsis menu to the right of the |api| Key, click
   :guilabel:`Edit Permissions`.

#. Select the :ref:`new role or roles <project-roles>` for the
   |api| Key from the menu.

#. Click on the checkmark to save.

.. _delete-project-api-key:

Delete an |api| Key from a Project
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. From the :guilabel:`Context` menu, select the project that you want
   to view.

#. Click :guilabel:`Access`.

#. Click the tab for :guilabel:`API Keys` to see the available keys.

#. Click :icon:`trash-alt` to the right of the |api| Key.


