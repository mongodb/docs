.. _5.3.0-changelog:

5.3.0 Changelog
---------------

Sharding
~~~~~~~~

- :issue:`SERVER-34322` Best effort ssv to recipient shard will never succeed for the first time
- :issue:`SERVER-45149` replSetStepDown command in txn_two_phase_commit_failover.js should not timeout
- :issue:`SERVER-57766` Omit shardingStatistics.resharding section when resharding hasn't been run on the cluster
- :issue:`SERVER-58036` TTL monitor can delete documents during chunk migration's and resharding's critical sections
- :issue:`SERVER-58275` Deduplicate code to make a noop write to participants in ShardingDDLCoordinators
- :issue:`SERVER-58622` DDL coordinator handle write concern error incorrectly when removing coordinator document
- :issue:`SERVER-58701` Enable Feature flag for PM-2423
- :issue:`SERVER-59053` VectorClock is not gossiped in sessions started by a direct-to-shard command
- :issue:`SERVER-59832` Prevent writes to orphan documents
- :issue:`SERVER-60109` Ensure vector clock is recovered on step-up
- :issue:`SERVER-60624` txn_commit_optimizations_for_read_only_shards.js pauses replication on coordinator and can leave transaction stuck in prepare
- :issue:`SERVER-61003` ReadConcernMajorityNotAvailableYet errors from ShardRegistry must be retried
- :issue:`SERVER-61105` The sessions migration logic during moveChunk pollutes the logs
- :issue:`SERVER-61249` refine_collection_shard_key_basic.js relies on a best-effort refresh that might not happen in case of failover
- :issue:`SERVER-61444` Resharding uses of bumpCollectionVersionAndChangeMetadataInTxn are not idempotent
- :issue:`SERVER-61478` Create fsm workload to check that no change stream events are generated due to writes on orphan documents
- :issue:`SERVER-61533` Make the balancer defragmentation policy resilient to non-retryable errors
- :issue:`SERVER-61584` Remove BalancerChunkMerger class
- :issue:`SERVER-61628` Do not reschedule range deletion task when numDeleted < numDocsToRemovePerBatch
- :issue:`SERVER-61637` Review range deleter batching policy
- :issue:`SERVER-61735` Add a new timing log step in MigrationDestinationManager to track the time waiting for critical section release
- :issue:`SERVER-61755` Migration recovery should handle refined shard key
- :issue:`SERVER-61760` The new implementation of CollMod should rely on the AllowMigrations to stop/resume migrations
- :issue:`SERVER-61767` Optimizing the new way of filtering writes over orphan documents
- :issue:`SERVER-61840` create_index_background_partial_filter.js and create_index_background_wildcard.js should not run on _with_balancer suites
- :issue:`SERVER-61847` Handle direct updates/deletes to shards that modify orphan docs
- :issue:`SERVER-61880` Remove TODOs to create a single defragmentation thread client
- :issue:`SERVER-61938` ConfigureCollectionAutoSplit should check maxChunkSize in MB
- :issue:`SERVER-61940` Make balancer_defragmentation_merge_chunks test config stepdowns
- :issue:`SERVER-61945` Resharding collection cloning may fail with NamespaceNotSharded when "nearest" read preference chooses secondary
- :issue:`SERVER-61950` ReshardingOplogFetcher waits on network request completing without interruption, potentially preventing shard step-up from ever completing
- :issue:`SERVER-61968` Fix the fCV-code that enables the long names support on the createCollection path
- :issue:`SERVER-61969` Simplify exact_shard_key_target.js so that it does not depend on orphan writing
- :issue:`SERVER-61976` [Resharding] Shards can error while refreshing their shard version following step-up, stalling the resharding operation
- :issue:`SERVER-62036` Failures in preCacheMongosRoutingInfo() will cause mongos to fail startup
- :issue:`SERVER-62065` Upgrade path from 3.6 to 4.0 can leave chunk entries without history on the shards
- :issue:`SERVER-62072` _configsvrReshardCollection may return without having waited for unsetting "reshardingFields" to replicate to majority
- :issue:`SERVER-62128` Do not assume fCV stability while filtering orphan documents in update/delete ops
- :issue:`SERVER-62149` Reuse ShardKeyPattern object from collection metadata in the write path
- :issue:`SERVER-62171` Add logs to output of runConcurrentMoveChunk in sharding_statistics_server_status.js
- :issue:`SERVER-62178` Resharding can fail with NamespaceNotSharded if recipient primary fails over before creating temporary resharding collection
- :issue:`SERVER-62207` ReshardCollection with small maxTimeMS can crash the shard due to incorrect BSON object lifetime
- :issue:`SERVER-62233` Make SessionCatalogMigrationSource handleWriteHistory filter out oplogs outside of the chunkRange with OpType 'n'
- :issue:`SERVER-62245` MigrationRecovery must not assume that only one migration needs to be recovered
- :issue:`SERVER-62281` Ensure drain of migrations pending recovery on fCV upgrade/downgrade
- :issue:`SERVER-62282` Migration recovery should be retried until success
- :issue:`SERVER-62296` MoveChunk should recover any unfinished migration before starting a new one
- :issue:`SERVER-62315` Cache the sharding ownership filter in the update/delete stage
- :issue:`SERVER-62332` RefineCollectionShardKeyCoordinator doesn't disallow migrations while it's executing
- :issue:`SERVER-62343` Create Feature flag for PM-2664
- :issue:`SERVER-62418` Drain recoverable ReshardCollectionCoordinators on fCV downgrade

Replication
~~~~~~~~~~~

- :issue:`SERVER-54374` Race between signalOplogWaiters and StorageEngine::loadCatalog
- :issue:`SERVER-56756` Primary cannot stepDown when experiencing disk failures
- :issue:`SERVER-60053` More info logs during replication startup sequence
- :issue:`SERVER-62151` Restarting the node could trigger rollback which closes the client connection and fail x509_cluster_auth_rollover.js

Query
~~~~~

- :issue:`SERVER-56932` Make constant folding optimization throw a special kind of error
- :issue:`SERVER-58750` Investigate whether InternalPlans::indexScan() executor always scans forward
- :issue:`SERVER-59754` Incorrect logging of queryHash/planCacheKey for operations that share the same $lookup shape
- :issue:`SERVER-61962` Rename db/exec/delete.h/.cpp to delete_stage.h/.cpp
- :issue:`SERVER-62230` Forward port new exhaust cursor tests to the master branch

Write Operations
~~~~~~~~~~~~~~~~

:issue:`SERVER-14669` Updates/deletes on sharded collections shouldn't affect orphan documents

Storage
~~~~~~~

- :issue:`SERVER-30846` Run dbCheck as background workload in FSM tests
- :issue:`SERVER-62350` replace usage of read_before_oldest with reset_snapshot

Operations
~~~~~~~~~~

- :issue:`SERVER-21070` Add option to gather collection stats
- :issue:`SERVER-61491` Log stacktraces to file
- :issue:`SERVER-61574` CSFLE: Create shared library on Windows and add to evergreen.
- :issue:`SERVER-61595` CSFLE: investigate how gdb interacts with static library

Build and Packaging
~~~~~~~~~~~~~~~~~~~

- :issue:`SERVER-50465` Package tests not run on ARM hosts
- :issue:`SERVER-61480` Improve efficiency of change stream pre-image loading 
- :issue:`SERVER-61885` Add showExpandedEvents flag
- :issue:`SERVER-61892` Replace documentKey paths cache with document key from the oplog
- :issue:`SERVER-61894` Support the 'showRawUpdateDescription' option in change stream specs
- :issue:`SERVER-61959` Backport MSVS 2022 support into vendored SCons

Internals
~~~~~~~~~

- :issue:`SERVER-27209` BSONObj::getStringField() does not handle embedded null bytes correctly
- :issue:`SERVER-42505` Periodically check if KMIP key is in the Active State
- :issue:`SERVER-42971` ThreadClient should restore original thread name on destruction
- :issue:`SERVER-49015` Automatically install db-contrib-tool
- :issue:`SERVER-49230` Evaluate upgrade of ZStandard to 1.4.9+
- :issue:`SERVER-50081` Support validation repair mode with duplicates on unique indexes
- :issue:`SERVER-51218` "resmoke.py run --help" doesn't show options' default values
- :issue:`SERVER-51456` Database Profiler outputs incorrect value of property "keysDeleted"  for a remove operation when a write conflict occurs
- :issue:`SERVER-51842` Fix duplicate localThresholdMs (localThreshold) server parameters
- :issue:`SERVER-51851` Create Feature flag for Selective Backup and Restore
- :issue:`SERVER-51983` Create feature flag for Bucket unpacking with sorting
- :issue:`SERVER-52297` Enable feature flag for Filling missing values based on surrounding values
- :issue:`SERVER-52373` Enable feature flag for KMIP Activate
- :issue:`SERVER-52991` Complete TODO listed in SERVER-32198
- :issue:`SERVER-53993` Attach client strand before releasing the opCtx in AsyncCommandExecution tests
- :issue:`SERVER-54592` Enable Feature flag for PM-2189
- :issue:`SERVER-54900` Blocking networking calls can delay sync-source resolution indefinitely
- :issue:`SERVER-55030` Remove mutexes that serialize secondary and majority read operations
- :issue:`SERVER-55043` canonicalizeBSONType() should be implemented as a lookup table
- :issue:`SERVER-55055` Add cumulative metric for the total refreshed connections
- :issue:`SERVER-55816` Investigate negative timeouts in connection pool
- :issue:`SERVER-56146` Incorrect commitQuorum error message
- :issue:`SERVER-56346` Update certificate definitions to match MacOS 10.15+ requirements
- :issue:`SERVER-56387` Check optionalBool-typed IDL fields for backward compatibility
- :issue:`SERVER-56578` Create Feature flag for PM-2290
- :issue:`SERVER-56972` Architecture Guide updates for PM-2311
- :issue:`SERVER-56974` Enable Feature flag for PM-2311
- :issue:`SERVER-57122` Make RecoveryUnit decorable and use it for uncommited collections and collection catalog updates
- :issue:`SERVER-57188` Remove mongos binVersion check in retryable_write_error_labels.js
- :issue:`SERVER-57312` Pin transitive Python dependencies and use the pinned file for installation in Evergreen
- :issue:`SERVER-57383` Include merge sort in sharded aggregation explain output
- :issue:`SERVER-57411` Enable Feature flag for PM-2321
- :issue:`SERVER-57416` Create Feature flag for PM-2323
- :issue:`SERVER-57516` RWC defaults pollutes the logs with duplicate "Refreshed RWC defaults" messages
- :issue:`SERVER-57546` Increase test-specific timeouts for roles lock acquisition
- :issue:`SERVER-57814` Create Feature flag for PM-2333
- :issue:`SERVER-57962` Create Feature flag for PM-2346
- :issue:`SERVER-58035` Remove db.runCommandWithMetadata from mongo shell
- :issue:`SERVER-58134` Map agg comparison predicates on time-series collections to bucket-level fields
- :issue:`SERVER-58151` Architecture Guide updates for Remove Faulty Mongos From Cluster Topology
- :issue:`SERVER-58153` Enable Feature flag for Remove Faulty Mongos From Cluster Topology
- :issue:`SERVER-58257` Add better diagnostics to predictive_connpool.js
- :issue:`SERVER-58310` ThreadPoolTaskExecutor is memory unsafe when task cancellation occurs around the same time an exhaust network response is received
- :issue:`SERVER-58358` Datasize command does not validate the syntax and can cause major performance degradation
- :issue:`SERVER-58410` Discontinue writing to appliedThrough/minValid as part of secondary batch application
- :issue:`SERVER-58426` Add planning logic for $lookup
- :issue:`SERVER-58436` Implement spilling HashAgg
- :issue:`SERVER-58437` Implement pushdown logic for $lookup
- :issue:`SERVER-58505` Add metric to serverStatus for number of load balanced connections
- :issue:`SERVER-58506` Command to expose settability for Server Parameters
- :issue:`SERVER-58518` Report progress of collection defragmentation through balancerCollectionStatus command
- :issue:`SERVER-58530` Remove unused code related to nReturnedSoFar()
- :issue:`SERVER-58672` Create featureFlagPerShardCursor
- :issue:`SERVER-58692` Introduce cluster-wide pre-image expiration parameter
- :issue:`SERVER-58694` Implement writing of pre-images for transactional update/replace/delete operations
- :issue:`SERVER-58865` Remove obsolete restriction on capped collection objects
- :issue:`SERVER-58875` Implement missing optimizations for $set* expressions
- :issue:`SERVER-58920` Enable multiversion testing of rewrite_state_change_errors.js
- :issue:`SERVER-59002` Create Feature flag for PM-2449
- :issue:`SERVER-59163` Enable partial indexes on time-series collections
- :issue:`SERVER-59220` Connectivity probes in ocsp_server_refresh.js should use fresh shells
- :issue:`SERVER-59241` Allow mongosymb.py to stream from stdin.
- :issue:`SERVER-59260` Create Feature flag for PM-2466
- :issue:`SERVER-59290` Re-evaluate sync source after incrementing config version
- :issue:`SERVER-59382` Enforce non-critical facets not entering ActiveFault state
- :issue:`SERVER-59384` Should provide ability to perform periodic DNS health checks
- :issue:`SERVER-59386` Should provide the ability to perform periodic LDAP health checks
- :issue:`SERVER-59390` Should provide the ability to perform periodic health checks against config server
- :issue:`SERVER-59391` Should fault if LDAP facets are enabled, but the server feature is not configured.
- :issue:`SERVER-59395` Setup integration test for DNS failure scenario
- :issue:`SERVER-59409` Race between reconfig replication and stepup can cause RSM to be stuck in reporting ReplicaSetNoPrimary
- :issue:`SERVER-59521` Remove TODO linked to SERVER-47602
- :issue:`SERVER-59657` Add ErrorExtraInfo for the WriteConflictException and use in transaction_participant.cpp updateSessionEntry()
- :issue:`SERVER-59682` Recover SBE plans from the new plan cache
- :issue:`SERVER-59689` Prevent setting fCV < 5.3 in case of ongoing defragmentation
- :issue:`SERVER-59696` Include SBE plan cache as part of cache size metric
- :issue:`SERVER-59700` Add programming support for tracepoints
- :issue:`SERVER-59772` Enable setWindowFields in transactions or with readConcern snapshot
- :issue:`SERVER-59779` Call asCluster() before replSetFreeze in ReplSetTest
- :issue:`SERVER-59813` Allow IDL server parameters with "none" type for set_at
- :issue:`SERVER-59839` ShardServerProcessInterface::getCollectionOptions returns format differently from non-sharded versions
- :issue:`SERVER-59912` Initial no-op scaffolding of the Ldap health checker
- :issue:`SERVER-59951` Make object form of the '_id' group-by expression work to handle multiple group-by keys.
- :issue:`SERVER-59958` Extend multi-collection locking to the AutoGetCollectionForRead/Command classes
- :issue:`SERVER-59960` Ensure CompileCtx::root is set before accessing it
- :issue:`SERVER-60059` Add a mongo packaged_task 
- :issue:`SERVER-60063` Log server discovery times
- :issue:`SERVER-60079` Common health observer code to incorporate generic patterns from Ldap observer
- :issue:`SERVER-60112` Audit server commands for accepted numeric types and accept int32 where necessary
- :issue:`SERVER-60117` Try removing ... exception handler in ASIOSession constructor
- :issue:`SERVER-60123` Support using clusterKey {_id : 1} for shardKey in a sharded collection
- :issue:`SERVER-60176` Delta-updates should only validate the diff for storage
- :issue:`SERVER-60184` Create Feature flag for PM-2550
- :issue:`SERVER-60197` Support $group pushdown to SBE when $match stage with $or exists in a pipeline
- :issue:`SERVER-60210` Create a future git tag evergreen variant
- :issue:`SERVER-60235` Extend&develop performance tests for change streams with pre-/post-images enabled
- :issue:`SERVER-60240` Ensure pre-/post-images are available after a resharding operation
- :issue:`SERVER-60241` Grant access to the pre-images collection for root user
- :issue:`SERVER-60251` Add tests for change stream pre-images/post-images with retryable writes
- :issue:`SERVER-60254` Implement $group pushdown when sub-planning is involved
- :issue:`SERVER-60298` Explain can include ICU collation keys encoded as strings, which can be invalid UTF-8
- :issue:`SERVER-60300` Support pushdown of sugared $group stages
- :issue:`SERVER-60311` Add execution stats etc for pushed down $group
- :issue:`SERVER-60316` FaultManager should start with periodic checks disabled
- :issue:`SERVER-60331` External sorter can use more memory than the configured maximum
- :issue:`SERVER-60349` Make IDL compatibility checker allow addition of fields with type 'optionalBool' 
- :issue:`SERVER-60356` Performance test for File Copy Based Initial Sync
- :issue:`SERVER-60390` Replace incorrect assertion in AtomicWord with is_always_lock_free from TODO C++17
- :issue:`SERVER-60412` Host memory limit check does not honor cgroups v2 
- :issue:`SERVER-60421` raise the log level in topology_state_machine.cpp
- :issue:`SERVER-60447` Complete TODO listed in SERVER-60202
- :issue:`SERVER-60479` Implement split chunks routine Phase III
- :issue:`SERVER-60500` Implement linear interpolation window function
- :issue:`SERVER-60524` [Retryability] Make retryable internal transactions retryable across data placement changes
- :issue:`SERVER-60533` Distinct preceded by sharded collection drop fails with "database not found"
- :issue:`SERVER-60587` Implement FaultFacet
- :issue:`SERVER-60596` Replace boost::optional::get() with boost::optional::value in DensifyValue to avoid undefined behavior
- :issue:`SERVER-60598` Investigate optimizing repetitive sorts from $densify and $fill
- :issue:`SERVER-60657` Create Feature flag for PM-2584
- :issue:`SERVER-60672` Simpler pushdown when timeseries collection has no mixed-schema buckets
- :issue:`SERVER-60694` Create DDL coordinator for collMod command
- :issue:`SERVER-60728` Improved MDB crash recovery testing
- :issue:`SERVER-60733` Test create collection after drop collection 
- :issue:`SERVER-60817` setDefaultRWConcern accepts invalid write concern options
- :issue:`SERVER-60832` Code Coverage variant not generating coverage data
- :issue:`SERVER-60846` Remove double severity in favor of discrete type
- :issue:`SERVER-60848` Log which engine was used for processing a query
- :issue:`SERVER-60876` Run testing under WT stress configuration
- :issue:`SERVER-60891` Ensure Ninja compile tasks run on suggested builders
- :issue:`SERVER-60911` Update fCV references for secondary indexes on time-series measurements when kLatest is 5.3
- :issue:`SERVER-60917` [Retryability] Make transaction participants throw RetryableTransactionInProgress if a retry arrives while the transaction has not been committed or aborted
- :issue:`SERVER-60939` Fix disabled Query Opt tests failing due to changing latest release to 5.2
- :issue:`SERVER-60944` Change interface for updateWithSuppliedFacet and update
- :issue:`SERVER-60959` Insert to a Time-Series getting error collection ErrorCodes::TimeseriesBucketCleared
- :issue:`SERVER-60974` Multiversion suites are overwritting receiveChunkWaitForRangeDeleterTimeoutMS
- :issue:`SERVER-61000` Coverity analysis defect 121043: Uninitialized pointer field
- :issue:`SERVER-61005` rs.initiate() fails with "Invariant failure" under specific startup options
- :issue:`SERVER-61009` Make createIndex a no-op on a cluster key if the collection exists
- :issue:`SERVER-61011` Evaluate RecordId size limit for clustered collections
- :issue:`SERVER-61020` Add negative test case for NIST GCM vectors
- :issue:`SERVER-61068` Add evergreen task for scale 1 normalized TPC-H benchmark
- :issue:`SERVER-61069` socket_disconnect_kills.js doesn't check that operations fail with network error
- :issue:`SERVER-61085` [Upgrade/downgrade] Do not persist txnRetryCounter if value is default
- :issue:`SERVER-61088` [Upgrade/downgrade] Make transaction participants check if txnRetryCounter is supported during startTransaction and have mongos use it
- :issue:`SERVER-61090` [Upgrade/downgrade] Make setFCV wait for all TransactionCoordinators of internal transactions to be cleaned up
- :issue:`SERVER-61091` [Upgrade/downgrade] Test that there cannot be in-progress transactions in child sessions when fCV is about to be set to fully downgraded
- :issue:`SERVER-61107` Serialize concurrent accesses to Socket in TCPResetAfterConnectionIsSilentlySwallowed
- :issue:`SERVER-61130` Create backup cursor on donor primary
- :issue:`SERVER-61131` Store backup cursor results and set state to "learned filenames"
- :issue:`SERVER-61132` Keep backup cursor alive until file copy finishes
- :issue:`SERVER-61133` Copy donor files to temp directory
- :issue:`SERVER-61154` Wrong default minSnapshotHistoryWindowInSeconds in sharding architecture guide
- :issue:`SERVER-61184` Compound 2dsphere indexes can generate a massive number of index keys per document
- :issue:`SERVER-61185` Use prefix_search for unique index lookup
- :issue:`SERVER-61203` Add record metadata and history in validate output when corruption is detected
- :issue:`SERVER-61220` Integration test for Progress monitor
- :issue:`SERVER-61241` Add a test to ensure plan cache size serverStatus metric is decreased when an entry is evicted
- :issue:`SERVER-61260` Support collations on clustered collections
- :issue:`SERVER-61277` Allow concurrent writes on capped clustered collections
- :issue:`SERVER-61278` Guard clustered capped collections behind the enableTestCommands parameter
- :issue:`SERVER-61285` Capped parameter for the create command is currently stable
- :issue:`SERVER-61287` IDL compatibility checker mishandles enterprise module
- :issue:`SERVER-61297` Complete TODO listed in SERVER-44644
- :issue:`SERVER-61300` Investigate memory usage of exact-topN operators for in memory storage engine in jstests/aggregation/spill_to_disk.js
- :issue:`SERVER-61315` Ldap health check executor should support aborted tasks
- :issue:`SERVER-61354` Audit log creates empty file and rotates when one does not exist
- :issue:`SERVER-61367` Incorrect tag for shard split feature flag test
- :issue:`SERVER-61368` FaultManager test suite should use real thread pool
- :issue:`SERVER-61383` Refactor expired pre-image purging job to perform range-deletion
- :issue:`SERVER-61385` Migrate most callers of legacy 'DBClientBase::query()' API to modern 'find()' API
- :issue:`SERVER-61391` clustered_collection_passthrough is not running with generated tasks
- :issue:`SERVER-61420` Create MatchExpression visitor to set paramId on tree nodes
- :issue:`SERVER-61425` Split donor monitors recipient for split acceptance
- :issue:`SERVER-61426` Legacy mongo shell sends authenticate command with database "admin" for X.509
- :issue:`SERVER-61442` Verify that $hinted writes on cluster key result in bounded collscans
- :issue:`SERVER-61447` Investigate skipping argument expression evaluation in $group for $first/firstN once accumulator has necessary values
- :issue:`SERVER-61463` Create javascript library for adding and removing entries from config.shards
- :issue:`SERVER-61472` Coverity analysis defect 121149: Uninitialized scalar variable
- :issue:`SERVER-61474` Ban directoryPerDb and directoryForIndexes with Merge
- :issue:`SERVER-61488` Enable $linearFill without a flag guard
- :issue:`SERVER-61501` Create sharding suite where collections are clustered by default
- :issue:`SERVER-61505` Remove checks in initial sync code that check the sync source wireVersion for resumable initial sync feature compatibility
- :issue:`SERVER-61529` Ldap tests should wait for connection reaper to be terminated
- :issue:`SERVER-61551` IDL compatibility checker should check chained structs
- :issue:`SERVER-61558` Rename configureCollectionAutosplitter command
- :issue:`SERVER-61583` Add restart test for retryable internal transactions for findAndModify
- :issue:`SERVER-61588` Incorrect header comment for CatalogCache::onStaleDatabaseVersion
- :issue:`SERVER-61592` Querying with ms precision does not return expected results (TS collection) 
- :issue:`SERVER-61608` Unreachable code in topology_coordinator.cpp
- :issue:`SERVER-61616` Restrict Command execution in SecurityToken mode
- :issue:`SERVER-61617` Limit actionType/matchType combinations in SecurityToken mode
- :issue:`SERVER-61630` Serialize a string sbe::value::RecordId to KeyString
- :issue:`SERVER-61635` Validate that the defragmentation algorithm is fairly executed across collections
- :issue:`SERVER-61654` Implement the Last point on timeseries optimization use case 1
- :issue:`SERVER-61662` SCons configure checks should always run with verbosity
- :issue:`SERVER-61663` Dynamically split concurrency_metrics and concurrency_replication_metrics into smaller tasks
- :issue:`SERVER-61686` Adding a JS test file to backports_required_for_multiversion_tests.yml doesn't disable all multiversion tests.
- :issue:`SERVER-61696` Make change stream pre- and post- image tests multiversion testing compatible
- :issue:`SERVER-61699` Failure to rotate audit log on startup does not cause node startup to fail
- :issue:`SERVER-61703` Complete TODO listed in SERVER-53642
- :issue:`SERVER-61709` Introduce implicitly replicated namespaces
- :issue:`SERVER-61726` Synchronise the execution of the defragmentation VS autosplit on every collection.
- :issue:`SERVER-61727` Implement the "move and merge chunks" phase of the Collection Chunks defragmentation algorithm
- :issue:`SERVER-61732` Prevent threads spawned outside ThreadContextTest from updating test counters
- :issue:`SERVER-61737` Make a deep copy of RuntimeEnvironment for SBE plans to cache
- :issue:`SERVER-61741` Add evergreen task for scale 1 of the denormalized TPC-H benchmark
- :issue:`SERVER-61744` Handle a new WiredTiger system log component hierarchy in LOGV2
- :issue:`SERVER-61754` dbCheck should not hold a strong collection lock during batches
- :issue:`SERVER-61757` Add a dbCheck command option to customize the batch size
- :issue:`SERVER-61772` Implement tenant access blocking for the split service
- :issue:`SERVER-61773` Enable WT stable timestamp rule
- :issue:`SERVER-61795` Incorrect Usage of Javascript Comparison to Compare Arrays and Objects
- :issue:`SERVER-61817` Complete TODO listed in SERVER-58759
- :issue:`SERVER-61819` Fix bug in SBE around capped collections and (new) yielding
- :issue:`SERVER-61821` Retire usage of OwnedPointerMap
- :issue:`SERVER-61835` Fix how SBE plan cache deals with ShardFilterer
- :issue:`SERVER-61836` The TimestampMonitor must ignore killOp interruptions and retry/continue
- :issue:`SERVER-61839` $elemMatch w/ positional $ project SBE bug
- :issue:`SERVER-61844` Allow mongos and mongoq to have different startup initialization
- :issue:`SERVER-61846` Prevent redact from throwing BSONObjectTooLarge
- :issue:`SERVER-61852` dbCheck should tryLock the collection with backoff
- :issue:`SERVER-61854` Move collmod_convert_to_unique_violation_count.js to core
- :issue:`SERVER-61861` dns_container_tester.js - wait for dnsmasq startup
- :issue:`SERVER-61868` $max accumulator with collation might produce incorrect result for NaN
- :issue:`SERVER-61870` Retry loading oplog entries on CappedPositionLost in retryable_internal_transaction_test.js
- :issue:`SERVER-61872` Fix thread pool starvation in FaultManager
- :issue:`SERVER-61873` LDAP health observer runtime params
- :issue:`SERVER-61877` Remove catalog consistency verification from dbCheck
- :issue:`SERVER-61879` Refreshes to recover migrations must never join ongoing refreshes
- :issue:`SERVER-61882` Update fCV constants to recognize 5.3 as latest
- :issue:`SERVER-61891` Add document key to the insert oplog entry
- :issue:`SERVER-61900` Coverity analysis defect 121221: Parse warning
- :issue:`SERVER-61901` Coverity analysis defect 121224: Uninitialized scalar variable
- :issue:`SERVER-61902` Coverity analysis defect 121189: Not restoring ostream format
- :issue:`SERVER-61904` Coverity analysis defect 121223: Wrapper object use after free
- :issue:`SERVER-61911` Remove consistency check exception for 'system.preimages' collection
- :issue:`SERVER-61913` Investigate tracking deletes for unique index conversion
- :issue:`SERVER-61914` add fault facet details to FaultImpl::toBSON
- :issue:`SERVER-61916` Ensure all no-op entries are inserted before the recipient reads opLog in the unit test OplogApplierResumesFromLastNoOpOplogEntry
- :issue:`SERVER-61921` Link failure in noSSL mode in FaultManager
- :issue:`SERVER-61923` Shell's consistency checker can mask an error
- :issue:`SERVER-61926` clean up geo_circle1.js
- :issue:`SERVER-61929` Add additional SConstruct architecture checks
- :issue:`SERVER-61930` Individual health observers should return an error if a timeout period elapses when doing a single health check
- :issue:`SERVER-61931` Allow ClusterManager role to operate against system.buckets.* collections
- :issue:`SERVER-61932` Returns all duplicates from concurrent writes during collMod converting to unique index
- :issue:`SERVER-61934` Race between creating new opCtx and killing opCtx's before switching out the storage engine
- :issue:`SERVER-61939` Explore bounding clustered collection scans more tightly
- :issue:`SERVER-61941` $sortArray comparator does not satisfy "Compare" requirement with -1 sort
- :issue:`SERVER-61946` Remove requires_fcv_51 tag from internal sessions multiversion tests
- :issue:`SERVER-61947` health check interval should be propery of the health observer
- :issue:`SERVER-61954` Improve decoding performance for BSONColumn
- :issue:`SERVER-61955` Expose dbCheck as a generally available command
- :issue:`SERVER-61956` fix data race when accessing the state machine's state
- :issue:`SERVER-61958` Make a mocked health observer class that takes in failpoint data
- :issue:`SERVER-61964` FCBIS needs to handle transient error when opening backup cursor
- :issue:`SERVER-61965` Coverity analysis defect 121236: Unchecked return value
- :issue:`SERVER-61974` Call quickExit() in mongoauditdecrypt before returning from main()
- :issue:`SERVER-61977` Concurrent rollback and stepUp can cause a node to fetch from a timestamp before lastApplied once it has stepped down. 
- :issue:`SERVER-61979` extend _parallelShellRunCommand() to support additional result validation
- :issue:`SERVER-61980` collMod does not consider unique option in no-op hidden parameter request processing
- :issue:`SERVER-61983` Create TenantNamespace class
- :issue:`SERVER-61984` Create TenantDatabase class
- :issue:`SERVER-61986` Add TenantNamespace to Collection object
- :issue:`SERVER-61987` Change DatabaseHolder's map to be keyed by TenantDatabase
- :issue:`SERVER-61988` Change CollectionCatalog maps that are keyed by db name to be keyed by TenantDatabase
- :issue:`SERVER-61989` balancer_defragmentation_merge_chunks should recreate collection between tests
- :issue:`SERVER-61993` BSONColumnBuilder::skip need to close interleaved mode if reference obj contain empty subobjects
- :issue:`SERVER-61996` Improve performance of DocumentStorage::appendField
- :issue:`SERVER-61997` Object with only empty sub object should not start subobj compression in BSONColumn
- :issue:`SERVER-62000` Do not generate "unique" field in oplog if collMod "unique" parameter is a no-op
- :issue:`SERVER-62003` Null-equality on 'fullDocument' is not rewritten correctly for change stream 'delete' events
- :issue:`SERVER-62004` Add unittest coverage for storage engine API changes
- :issue:`SERVER-62016` Write concern accepts embedded replica set tagset
- :issue:`SERVER-62018` ReplSetConfig supports an optional splitConfig subdocument
- :issue:`SERVER-62019` Remove flag guard from $linearFill
- :issue:`SERVER-62020` [Retryability] Make retryable write statements executed with or without internal transactions retryable whether or not internal transactions are involved on retries
- :issue:`SERVER-62021` Allow replacement of local replica set config
- :issue:`SERVER-62022` Reduce dbCheck info logging in production, log start and stop 
- :issue:`SERVER-62023` Improve dbCheck observability
- :issue:`SERVER-62024` Enable new yielding behavior for find/getMore operations by default
- :issue:`SERVER-62031` Complete TODO listed in SERVER-58962
- :issue:`SERVER-62037` Fix replica set definition in the system perf yaml file for linux-1-node-15gbwtcache
- :issue:`SERVER-62038` Tag file copy based initial sync tests with requires_fcv_52
- :issue:`SERVER-62039` Include TenantID in Javascript scope identifier
- :issue:`SERVER-62041` Add a maximum batch execution time to dbCheck
- :issue:`SERVER-62045` Add basic jstest coverage for $bucketAuto for the exact topN accumulators
- :issue:`SERVER-62046` Remove ActionType::emptycapped from Builtin Roles
- :issue:`SERVER-62047` [Retryability] Enforce txnNumber ordering in a session in the presence of retryable internal transactions
- :issue:`SERVER-62049` Add debugging aids for some of the new SBE types
- :issue:`SERVER-62050` Remove _opCtx from AutoGetDb and instead pass in an opCtx to AutoGetDb::ensureDbExists()
- :issue:`SERVER-62051` Increase file handle limit in Windows CRT
- :issue:`SERVER-62052` Usage of BSONColumn in the validate command can run out-of-memory
- :issue:`SERVER-62053` Add retry for errors in AWS server-side conversation
- :issue:`SERVER-62055` Enable tests in clustered_collection_passthrough that try to recreate the clustered index
- :issue:`SERVER-62060` Skip stepdown tests for tenant_migration_disallowed_on_config_server jstest
- :issue:`SERVER-62064` Serialize resharding with other DDL operations on stepup
- :issue:`SERVER-62067` migrate ParsedCollModIndexRequest::indexHidden away from BSONElement
- :issue:`SERVER-62068` migrate ParsedCollModIndexRequest::indexExpireAfterSeconds away from BSONElement
- :issue:`SERVER-62069` remove ParsedCollModIndexRequest::indexObj
- :issue:`SERVER-62070` clean up geo_nearwithin.js
- :issue:`SERVER-62073` Make agg_graph_lookup more robust
- :issue:`SERVER-62080` Make read and write concern configurable for internal transaction API
- :issue:`SERVER-62081` Exhaustively test change stream rewrites against null-equality predicates
- :issue:`SERVER-62084` Serializer for FaultFacetType is broken
- :issue:`SERVER-62085` Use more bits for hashedMultikeyMetadataPaths in validation
- :issue:`SERVER-62086` Update HashAggStage's default maximum memory usage to the bigger value comparable to the DocumentSourceGroup's
- :issue:`SERVER-62091` Set small range deleter batch size in disable_resumable_range_deleter.js
- :issue:`SERVER-62092` clean up and relocate geo_array1.js
- :issue:`SERVER-62094` Incorrect memory usage calculation in $top/$bottom/$topN/$bottomN window functions due to Document field caching
- :issue:`SERVER-62095` Update phase transitions for balancer defragmentation policy
- :issue:`SERVER-62096` /proc/<id>/smaps is not available
- :issue:`SERVER-62097` Generated tasks should inherit timeouts from build variants
- :issue:`SERVER-62098` Guard healthCheckContexts with mutex in fault_manager.cpp
- :issue:`SERVER-62101` Aggregation can run lock-free and expects a ViewCatalog access separate from the AutoGet*MaybeLockFree to always return a valid ViewCatalog -- not guaranteed
- :issue:`SERVER-62112` Re-add handleRIDRangeMinMax inside planner_access.cpp
- :issue:`SERVER-62113` Ignore IndexBuildAborted errors when building indexes in find_flip_sbe_enabled.js
- :issue:`SERVER-62126` Disable the rollback resumable index build test on the slow variant
- :issue:`SERVER-62127` Exclude test scripts that record change stream pre-images from initial sync testing
- :issue:`SERVER-62133` Fix multiversion issue in change_stream_pre_image_lookup_whole_db_whole_cluster.js
- :issue:`SERVER-62134` Ensure Phase 3 is executed before ending defragmentation
- :issue:`SERVER-62140` Reduce resmoke job factor for multi_stmt_txn_jscore_passthrough_with_migration on RHEL 8.0 inMemory
- :issue:`SERVER-62146` [SBE] Fix use-after-free bug with $arrayElemAt, $first, and $last
- :issue:`SERVER-62148` Move changeStreamPreAndPostImages collection option tests from timeseries to changeStream test file
- :issue:`SERVER-62153` max_time_ms_repl_targeting.js should succeed if the test step succeeds at least once
- :issue:`SERVER-62157` Explicitly link rpc_test to auth
- :issue:`SERVER-62158` Fix or suppress novel UBSAN reports when building with the v4 clang
- :issue:`SERVER-62160` Remove TODO listed in SERVER-62061
- :issue:`SERVER-62161` Complete TODO listed in SERVER-60459
- :issue:`SERVER-62167` Coverity analysis defect 121257: Uninitialized scalar field
- :issue:`SERVER-62168` Use --oplogMinRetentionHours in tenant_migration_multi_writes.js to prevent the oplog from being truncated
- :issue:`SERVER-62169` ViewCatalog::resolveView should handle when time-series bucket collection does not exist
- :issue:`SERVER-62170` Increase initial sync logging level in FCBIS tests
- :issue:`SERVER-62173` Applying dropIndexes oplog entry can get BackgroundOperationInProgressForNamespace if fCV not upgraded
- :issue:`SERVER-62174` FaultManager to support dynamic configuration of health check intervals
- :issue:`SERVER-62179` Roundtrip BSONColumn in the validate command after verifying no corruption is present
- :issue:`SERVER-62180` Enable signal processing (or red/green) checks for Google Microbenchmark
- :issue:`SERVER-62181` JStests including multiple parallel migrations with failpoints shouldn't be run in the config server stepdown suites
- :issue:`SERVER-62185` Ensure TenantMigrationRecipentService Fetcher instance survives future completion
- :issue:`SERVER-62186` Update fCV reference for dropping an index while having a separate index build on the same collection
- :issue:`SERVER-62187` Modify 'originalSpec' to be part of the unstable API for listIndexes
- :issue:`SERVER-62191` Analog to burn_in_tests for running any user-specified test
- :issue:`SERVER-62192` Handle feature flag disabled for implicit sharding accessed collection
- :issue:`SERVER-62194` Add multiple collection locking capability to AutoGetCollection
- :issue:`SERVER-62195` Refactor usage of non-standard Array.sort
- :issue:`SERVER-62197` Remove extra state mutex lock.
- :issue:`SERVER-62198` Fix Shutdown error with Progress Monitor
- :issue:`SERVER-62200` Do not run cached_plan_trial_does_not_discard_work.js in parallel with fsyncLock tests
- :issue:`SERVER-62202` Log ID 5936504 should contain observer type as string
- :issue:`SERVER-62203` change the thread name "Health checks progress monitor" to "FaultManagerProgressMonitor"
- :issue:`SERVER-62204` do not schedule health check if observer is not enabled
- :issue:`SERVER-62208` Handle upgrade/downgrade scenario for collMod DDL coordinator
- :issue:`SERVER-62210` Fix dbCheck progress meter handling of dropped and recreated collections
- :issue:`SERVER-62212` Support writeConcern for dbCheck
- :issue:`SERVER-62214` Use explicit read concern in InitialSyncer and CollectionCloner
- :issue:`SERVER-62215` Improve the error message for logRotate command
- :issue:`SERVER-62216` When abortTenantIndexBuilds failed to abort during a tenant migration, we should wait for the createIndex to finish before continuing the MTM
- :issue:`SERVER-62217` inject_tenant_prefix.js override may not wait for newly elected primary after tenant migration commits
- :issue:`SERVER-62225` FTSSpec::fixSpec() attempts to convert number outside the range of representable values of type 'int'
- :issue:`SERVER-62226` Disable dbcheck_no_history_on_secondary.js on EFT
- :issue:`SERVER-62229` Fix invariant when applying index build entries while recoverFromOplogAsStandalone=true
- :issue:`SERVER-62234` Add support for MSVS 2022 builds in C++17 and C++20 mode
- :issue:`SERVER-62235` Add experimental MSVS builders to the master waterfall
- :issue:`SERVER-62239` Put tenantId on opCtx if passed as $tenant
- :issue:`SERVER-62240` Enable sharding for CRUD_clustered_collection.js
- :issue:`SERVER-62241` Prohibit using arbitrary cluster key
- :issue:`SERVER-62242` $indexOfArray does not work with duplicate values in array
- :issue:`SERVER-62243` Wait for vector clock document majority-commit without timeout
- :issue:`SERVER-62247` Avoid making copies of the vector in TargetedWriteBatch::getWrites()
- :issue:`SERVER-62248` Add requires_fcv_51 tag to load_balanced_server_status_metrics.js
- :issue:`SERVER-62251` Extend ServerParameter class to support cluster-wide server parameters
- :issue:`SERVER-62255` Create base ClusterServerParameter class
- :issue:`SERVER-62268` Handle balancer configuration refresh in balancer_defragmentation_merge_chunks.js
- :issue:`SERVER-62277` Performance regression from dbstats due to occupied disk space calculation
- :issue:`SERVER-62283` Temporary workaround of the problem in SERVER-61281
- :issue:`SERVER-62285` validate cachedir add push failure debug messages
- :issue:`SERVER-62286` Fix disabled Repl tests failing due to changing latest release to 5.3
- :issue:`SERVER-62289` Fix disabled Security tests failing due to changing latest release to 5.3
- :issue:`SERVER-62290` Fix disabled Query Optimization tests failing due to changing latest release to 5.3
- :issue:`SERVER-62292` Add Task to Commit Queue to Ensure only Public SERVER Tickets are Referenced
- :issue:`SERVER-62293` Race between recipientForgetMigration cmd and TenantMigrationRecipientService future chain restart on errors machinery.
- :issue:`SERVER-62312` Enable feature flag in 4.4 backport and other housekeeping
- :issue:`SERVER-62314` Fix unreliable testing intermediate state in file_copy_based_initial_syncer_test.cpp
- :issue:`SERVER-62319` Fix hidden_index.js in multiversion suite
- :issue:`SERVER-62321` Increase kActiveFaultDuration for fault manager test suite.
- :issue:`SERVER-62322` Consistent validity treatment of empty objects (i.e., {})
- :issue:`SERVER-62324` Failure to build mongo::unique_function uses with MSVS 2022 in C++20 mode
- :issue:`SERVER-62333` MurmurHash3 getblock/putblock can overflow
- :issue:`SERVER-62334` Regression following SERVER-46399
- :issue:`SERVER-62336` Tolerate SnapshotTooOld errors in dbCheck testing
- :issue:`SERVER-62340` Tenant Migration can lead to leakage of "TenantMigrationBlockerAsync" threads.
- :issue:`SERVER-62347` Fix disabled clustered_collection.js test due to changing latest release to 5.3
- :issue:`SERVER-62349` Disable featureFlagRequireTenantId for the all feature flags required evergreen tests
- :issue:`SERVER-62351` Make plan executor creation aware of multiple collections
- :issue:`SERVER-62352` Fix disabled Serverless tests failing due to changing latest release to 5.3
- :issue:`SERVER-62360` Handle reconfiguring the WiredTiger LOGV2 component hierarchy
- :issue:`SERVER-62361` Complete TODO listed in SERVER-52247
- :issue:`SERVER-62364` Add correctness tests for arbitrary value in $fill
- :issue:`SERVER-62365` Support a timeout for the shard split operation
- :issue:`SERVER-62368` Range deleter must honor rangeDeleterBatchDelayMS
- :issue:`SERVER-62371` Syntax error on rare code path in ldap_mongos_health_checking.js
- :issue:`SERVER-62373` LDAP health check integration test should assert stats
- :issue:`SERVER-62378` Remove improperly merged lines from unit test
- :issue:`SERVER-62379` Fix deadlock between ReplicationCoordinator and BackgroundSync on stepUp
- :issue:`SERVER-62380` Wait for majority commit point to be advanced on each node before starting rollback test in rollback_set_fcv.js
- :issue:`SERVER-62381` CSFLE: remove shared library dependency to libsasl2
- :issue:`SERVER-62382` Several Amazon Linux 2 tests on the 5.0, 5.1, 5.2 and master waterfalls are not running
- :issue:`SERVER-62383` Use durable_timestamp instead of commit_timestamp for set_timestamp
- :issue:`SERVER-62386` Coverity analysis defect 121298: Parse warning
- :issue:`SERVER-62387` Coverity analysis defect 121302: Parse warning
- :issue:`SERVER-62388` Coverity analysis defect 121318: Parse warning
- :issue:`SERVER-62389` Allow waitAfterCommandFinishesExecution failpoint to match on command comment
- :issue:`SERVER-62391` Add "tid" field to oplog entries
- :issue:`SERVER-62392` Prevent timeseries lookup jstests from running in unsupported multiversion environments
- :issue:`SERVER-62394` Follow up work for SERVER-61131
- :issue:`SERVER-62397` Robustify exact_top_n_feature_flag.js
- :issue:`SERVER-62399` Use of v3 tooclhain virtualenv is a python2 environment
- :issue:`SERVER-62400` Add $_passthroughToShard parameter to AggregateCommandRequest
- :issue:`SERVER-62404` Simplify mutex locking in fault_manager.cpp
- :issue:`SERVER-62406` Create new ActionType for use of $tenant parameter
- :issue:`SERVER-62419` recover_multiple_migrations_on_stepup.js fails when executed in config server stepdown suite
- :issue:`SERVER-62422` Consolidate WriteConcernOptions parsing logic
- :issue:`SERVER-62423` Fix replsetinitiate_works_with_keyfile_profile_verbose_options.js to work on ephemeralForTest
- :issue:`SERVER-62424` _configsvrRemoveShard must wait for majority before returning
- :issue:`SERVER-62426` Backup cursor indicates which files are required to copy for selective backups
- :issue:`SERVER-62429` Add CollectionUUIDMismatch error code and corresponding ErrorExtraInfo
- :issue:`SERVER-62430` Set resmoke_jobs_max=1 in Enterprise Windows DEBUG (Unoptimized) build variant

