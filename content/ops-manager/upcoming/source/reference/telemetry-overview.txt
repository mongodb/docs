.. _om-telemetry-overview:

=========
Telemetry
=========

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Telemetry collection gathers usage information about your |onprem|
installation and sends it to MongoDB. |onprem| enables collecting and
sending telemetry data by default.

.. important::

   This feature is available starting in |onprem| 8.0.17 and 7.0.20.

|onprem| performs the initial telemetry data collection seven days 
after you install or upgrade to |onprem| 8.0.17 or later in the 8.0 
series, or 7.0.20 or later in the 7.0 series. You can 
disable telemetry from the |onprem| UI or by using the telemetry API.

About Telemetry
---------------

Telemetry is an automated, anonymous usage report that |onprem|
generates and sends to MongoDB once a week.

Telemetry describes:

- How you configure and run your |onprem| installation.
- The MongoDB deployments that |onprem| manages.

Telemetry does not include data that |onprem| can use to uniquely
identify you or your organization.

Telemetry Purpose and Usage
---------------------------

MongoDB uses telemetry data to understand how customers configure and
use |onprem| and the MongoDB deployments that it manages. This
information helps MongoDB:

- Identify the most common deployment patterns.
- Understand the size and topology of managed deployments.
- See which backup mechanisms and infrastructures are most common.

MongoDB uses these insights to prioritize product improvements that
benefit the most customers.

Telemetry Data Collected
------------------------

Telemetry data describes your |onprem| installation and each MongoDB
deployment that |onprem| manages.

Installation-Level Data
~~~~~~~~~~~~~~~~~~~~~~~

Telemetry includes information about your |onprem| installation, such
as:

- A static, unique identifier for the |onprem| installation.
- The |onprem| version.
- The operating systems that run on the |onprem| hosts.
- The number of |onprem| instances in this installation.
- The number of AppDB nodes.
- The number of backup daemons running.
- The authentication method that |onprem| uses.
- The infrastructure type that hosts |onprem|.
- CPU cores and memory provisioned for each |onprem| host.
- The number of projects and organizations that exist in this installation.

Deployment-Level Data
~~~~~~~~~~~~~~~~~~~~~

Telemetry also includes information about each MongoDB deployment that
|onprem| manages, such as:

- A static, unique identifier for the deployment.
- The MongoDB version or versions that the deployment uses.
- The deployment type.
- The number of nodes and, for sharded clusters, the number of shards.
- The total data size for the deployment, not including local metadata.
- The MongoDB edition used by the deployment.
- Whether |tls| is enabled.
- The authentication method that the deployment uses.

For the complete field list and types, see the telemetry response
schema in :ref:`Retrieve Telemetry Data <om-get-telemetry-collection-details>`.

When Telemetry Runs
-------------------

If telemetry is enabled, |onprem| schedules a recurring job that
collects and sends telemetry data once every seven days.

When you install or upgrade to |onprem| 8.0.17 or later in the 8.0 
series, or 7.0.20 or later in the 7.0 series, |onprem| enables 
telemetry by default and waits seven days before it sends the first telemetry 
snapshot. This grace period gives you time to review and, if needed, disable
telemetry before any data is sent.

|onprem| uses persisting identifiers for telemetry across
restarts and upgrades. If you reinstall |onprem|, it generates new
identifiers.

View Telemetry Data
-------------------

You can view the telemetry data that |onprem| plans to send before it is sent.

Use the Diagnostics Output
~~~~~~~~~~~~~~~~~~~~~~~~~~

|onprem| includes telemetry data in its diagnostics output. The
diagnostics output contains internal diagnostic information about
your |onprem| installation, including the telemetry payload.

To review telemetry data:

.. procedure::
   :style: normal

   .. step:: Open the |onprem| Config page 

      From the |onprem| UI, go to :guilabel:`Admin` > 
      :guilabel:`General` > :guilabel:`Ops Manager Config`.

   .. step:: Download the diagnostics output

      On the :guilabel:`Permissions` tab, in the :guilabel:`Details` section, 
      click :guilabel:`Download` next to :guilabel:`Current Collected Data`. 

   .. step:: Review the telemetry data

      Extract the diagnostics output and locate the telemetry data in 
      the archive.

Only a subset of the diagnostics data is sent as telemetry. Review the
telemetry subset in the archive to see the data values that |onprem|
plans to send in the next telemetry snapshot.

Use the Telemetry API
~~~~~~~~~~~~~~~~~~~~~

You can also use the telemetry API to view the telemetry status and
payload that |onprem| plans to send.

The :ref:`Retrieve Telemetry Data <om-get-telemetry-collection-details>` 
endpoint returns:

- A flag that indicates if telemetry is enabled.
- The date and time when |onprem| last sent telemetry successfully.
- The date and time when |onprem| schedules the next telemetry job.
- The telemetry data object for the next snapshot.

Control Telemetry Collection
----------------------------

You can enable or disable telemetry collection for your |onprem|
installation at any time. 

.. important::

   Telemetry is either fully enabled or fully disabled. You cannot enable 
   or disable individual telemetry fields.

Use the UI
~~~~~~~~~~

Administrators can configure telemetry from the |onprem| UI. 

.. procedure::  
   :style: normal  

   .. step:: Open the |onprem| Config page 

      From the |onprem| UI, go to :guilabel:`Admin` > 
      :guilabel:`General` > :guilabel:`Ops Manager Config`.

   .. step:: Open the Permissions tab

      Click the :guilabel:`Permissions` tab to view the 
      :guilabel:`Usage Information Collection` setting.

   .. step:: Enable or disable telemetry

      Use the :guilabel:`Usage Information Collection` control to enable or  
      disable telemetry.

If you disable telemetry, |onprem| stops sending telemetry snapshots
starting with the next scheduled run.

Use the API
~~~~~~~~~~~

You can also control telemetry collection by using the telemetry API.

The :ref:`Toggle Telemetry Status <om-patch-toggle-telemetry-status>`
endpoint lets you:

- Enable telemetry by setting the ``enabled`` field to ``true``.
- Disable telemetry by setting the ``enabled`` field to ``false``.

Network and Connectivity
------------------------

Telemetry requires that your |onprem| hosts can reach the MongoDB
telemetry ingestion endpoint.

.. note::

   |onprem| installations that run in air-gapped environments or
   behind restrictive firewalls might be unable to send telemetry
   data, even if telemetry is enabled.

MongoDB stores ingested telemetry in an internal system and uses it in
aggregate form to improve |onprem| and related products.
