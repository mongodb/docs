title: Download and run the latest version of the Backup Agent installation binary.
stepnum: 1
edition:
  - cloud
ref: download-saas
action:
  - pre: |
      To download the installation binary, use the following URL:
    language: sh
    code: |
      https://cloud.mongodb.com/download/agent/backup/mongodb-mms-backup-agent-latest.windows_x86_64.msi
post: |
  During installation, the installer prompts you to specify the folder
  for storing configuration and log files. It is strongly advised that
  you encrypt or restrict access to this folder.
---
title: "Download and run the latest version of the Backup Agent installation binary."
stepnum: 1
edition:
  - onprem
ref: download-hosted
action:
  - pre: |
      To download the installation binary, use the following URL:

    language: sh
    code: |
      //<OpsManagerHost:Port>/download/agent/backup/mongodb-mms-backup-agent-latest.windows_x86_64.msi
    post: |
      .. note::
         Replace ``<OpsManagerHost:Port>`` with the hostname and port
         of your |onprem| installation.

post: |
  During installation, the installer prompts you to specify the folder
  for storing configuration and log files. It is strongly advised that
  you encrypt or restrict access to this folder.
---
title: "Generate an agent API key or retrieve an existing agent API key for your |mms| group." 
stepnum: 2
ref: retrieve-backup-mms-api-key
pre: |
      a. Click :guilabel:`+ Generate Key`.

      .. note::

         The button appears only if the current user is the group owner and
         the group either has no api keys or only the original key.

      b. Enter your password and click :guilabel:`Verify`.
  
      c. Click :guilabel:`+ Generate Key` again.

      .. include:: /includes/extracts/agent-api-key-admonition.rst

      To retrieve an existing API key, go to the :guilabel:`Agent API Keys`
      tab. To navigate to the tab, select :guilabel:`Deployment`  view, then
      click the :guilabel:`Agents` tab and then the :guilabel:`Agent API
      Keys` tab.
---
stepnum: 3
source:
  file: steps-backup-agent-install-from-archive.yaml
  ref: configure-backup-mms-api-key
---
title: "Edit the ``local.config`` file to include the hostname of the Backup server."
stepnum: 4
ref: hostname
content: |
  In the Backup Agent installation directory, open the ``local.config`` file and
  set the ``mothership`` property to hostname of the Backup server.
---
title: "Start the Backup Agent."
stepnum: 5
ref: start-backup-agent-windows
content: |
  In Windows ``Control Panel``, open ``Administrative Tools``, and then
  open ``Services``.

  In the list of services, select the ``MongoDB Backup Agent`` service. Select
  the ``Action`` menu and select ``Start``.
...
