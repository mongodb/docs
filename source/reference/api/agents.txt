======
Agents
======

Operations
----------

.. code-block:: none

   GET /api/public/v1.0/groups/GROUP-ID/agents

Returns links to the three types of agents.

.. code-block:: none

   GET /api/public/v1.0/groups/GROUP-ID/agents/TYPE

Get all agents of the specified ``TYPE``. You can specify
``MONITORING``, ``BACKUP``, or ``AUTOMATION``, as in:

.. code-block:: none

   GET /api/public/v1.0/groups/GROUP-ID/agents/MONITORING
   GET /api/public/v1.0/groups/GROUP-ID/agents/BACKUP
   GET /api/public/v1.0/groups/GROUP-ID/agents/AUTOMATION

Sample Entity
-------------

Monitoring Agent
~~~~~~~~~~~~~~~~

.. code-block:: json

   {
     "links": [
       {
         "href": "https://mms.mongodb.com/api/public/v1.0/groups/xxxxxxxxxxxxxxxxxxxxxx/agents/MONITORING?null&pageNum=1&itemsPerPage=100",
         "rel": "self"
       }
     ],
     "results": [
       {
         "confCount": 59,
         "hostname": "example",
         "isManaged": true,
         "lastConf": "2015-06-18T14:21:42Z",
         "lastPing": "2015-06-18T14:21:42Z",
         "pingCount": 6,
         "stateName": "ACTIVE",
         "typeName": "MONITORING"
       }
     ],
     "totalCount": 1
   }

Backup Agent
~~~~~~~~~~~~

.. code-block:: json

   {
     "links": [
       {
         "href": "https://mms.mongodb.com/api/public/v1.0/groups/xxxxxxxxxxxxxxxxxxxxxx/agents/BACKUP?null&pageNum=1&itemsPerPage=100",
         "rel": "self"
       }
     ],
     "results": [
       {
         "confCount": 12,
         "hostname": "example",
         "isManaged": true,
         "lastConf": "2015-06-18T14:26:29Z",
         "stateName": "ACTIVE",
         "typeName": "BACKUP"
       }
     ],
     "totalCount": 1
   }

Automation Agent
~~~~~~~~~~~~~~~~

.. code-block:: json

   {
     "links": [
       {
         "href": "https://mms.mongodb.com/api/public/v1.0/groups/xxxxxxxxxxxxxxxxxxxxxx/agents/AUTOMATION?null&pageNum=1&itemsPerPage=100",
         "rel": "self"
       }
     ],
     "results": [
       {
         "confCount": 141,
         "hostname": "example-1",
         "lastConf": "2015-06-18T14:27:42Z",
         "stateName": "ACTIVE",
         "typeName": "AUTOMATION"
       },
       {
         "confCount": 353,
         "hostname": "example",
         "lastConf": "2015-06-18T14:27:37Z",
         "stateName": "ACTIVE",
         "typeName": "AUTOMATION"
       }
     ],
     "totalCount": 2
   }

Entity Fields
-------------

.. list-table::
   :widths: 10 10 80
   :header-rows: 1

   * - Name
     - Type
     - Description
   * - ``typeName``
     - string
     - Specifies the type of agent, can be ``MONITORING``, ``BACKUP``, or ``AUTOMATION``.
   * - ``hostname``
     - string
     - Primary hostname. A host typically may have aliases, so the primary 
       is the best available name as decided by |mms|.
   * - ``confCount``
     - integer
     - Number of configuration calls.
   * - ``lastConf``
     - timestamp
     - Date and time of last configuration call.
   * - ``stateName``
     - string
     - The current state of the agent. ``stateName`` can return the following
       values:
    
       - ``ACTIVE``: the agent is active and operating
       - ``STANDBY``: the agent is on standby
       - ``NO_PROCESSES``: the agent is not managing,
         monitoring, or backing up any processes.
    
   * - ``pingCount``
     - integer
     - **Only applicable to Monitoring agents**. The number of pings that
       the Monitoring agent has sent to the ``hostname`` URL.
   * - ``isManaged``
     - Boolean
     - **Only applicable to Monitoring and Backup agents**. Specifies whether
       or not |mms| manages the agent.
   * - ``lastPing``
     - timestamp
     - **Only applicable to Monitoring agents**. Time of most recent
       ping.
   * - ``tag``
     - string
     - **Only applicable to Backup agents**. The agent's tag, if there is one.

Links
-----

.. list-table::
   :widths: 10 90
   :header-rows: 1

   * - Relation
     - Description
   * - ``self``
     - Me
   * - ``group``
     - The group the agents belong to
   * - ``monitoringAgents``
     - Links to all monitoring agents.
   * - ``backupAgents``
     - Links to all backup agents.
   * - ``automationAgents``
     - Links to all automation agents.

Examples
--------

Get All Monitoring Agents in a Group
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. code-block:: none

   curl -u "username:apiKey" --digest -i "https://mms.mongodb.com/api/public/v1.0/gorups/xxxxxxxxxxxxxxxxxxxxxxxx/alertConfigs"
   
   HTTP/1.1 200 OK
   
   {
     "links": [
       {
         "href": "https://mms.mongodb.com/api/public/v1.0/groups/xxxxxxxxxxxxxxxxxxxxxx/agents/MONITORING?null&pageNum=1&itemsPerPage=100",
         "rel": "self"
       }
     ],
     "results": [
       {
         "confCount": 59,
         "hostname": "example",
         "isManaged": true,
         "lastConf": "2015-06-18T14:21:42Z",
         "lastPing": "2015-06-18T14:21:42Z",
         "pingCount": 6,
         "stateName": "ACTIVE",
         "typeName": "MONITORING"
       }
     ],
     "totalCount": 1
   }
