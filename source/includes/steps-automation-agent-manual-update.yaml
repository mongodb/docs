title: "*Recommended*. Take a full backup of the |mms| database before beginning the upgrade procedure."
stepnum: 1
ref: full-backup
---
title: "Shut down the Automation Agent."
stepnum: 2
ref: shutdown-agent
content: |

  a. Click the :guilabel:`Start` button.

  b. Click :guilabel:`Administrative Tools`.

  c. Click :guilabel:`Services`.

  d. Right-click on the :guilabel:`MMS Automation Agent` and select
     :guilabel:`Stop`.
---
title: "Download the latest agent."
stepnum: 3
ref: download-agent
pre: |
  From a `PowerShell <https://msdn.microsoft.com/en-us/powershell/>`__
  prompt, issue the following command:
action:
  language: ps1
  copyable: true
  code: |
    $client = new-object System.Net.WebClient
    $client.DownloadFile("https://cloud.mongodb.com/download/agent/automation/mongodb-mms-automation-agent-latest.windows_x86_64.msi","C:\Temp\mongodb-mms-automation-agent-latest.windows_x86_64.msi")
edition:
  - cloud
---
title: "Download the latest agent."
stepnum: 3
ref: download-agent
pre: |

  From a `PowerShell <https://msdn.microsoft.com/en-us/powershell/>`__
  prompt, issue the following command, where ``<OpsManagerHost>`` is
  the hostname of your |onprem| installation (for example,
  ``onprem.example.net``):

action:
  language: ps1
  copyable: true
  code: |
    $client = new-object System.Net.WebClient
    $client.DownloadFile("https://<OpsManagerHost>:<Port>/download/agent/automation/mongodb-mms-automation-agent-latest.windows_x86_64.msi,"C:\Temp\mongodb-mms-automation-agent-latest.windows_x86_64.msi")
  post: |
    The protocol can be ``http:`` or ``https:`` depending upon whether
    or not you have :doc:`configured SSL connections to |onprem|
    </tutorial/configure-ssl-connection-to-web-interface>`.
edition:
  - onprem
---
title: "Install the Automation Agent"
stepnum: 4
ref: install-automation-agent
content: |
  a. After the MSI downloads, double-click
     ``mongodb-mms-automation-agent-<version>.windows_x86_64.msi``

  #. If a security warning appears, click :guilabel:`Run`.

  #. Verify that the :guilabel:`Destination Folder`
     and :guilabel:`Configuration/Log Folder` paths are correct.

  #. At the :guilabel:`Key Type` and the following key values steps,
     verify the provided values.

  #. At the :guilabel:`Automation Paths` step, verify the provided
     paths.

  #. At the :guilabel:`Windows Firewall Configuration` step, click your
     preferred firewall configuration.

     If you click :guilabel:`Configure firewall rules allowing access
     from only the specified IP addresses.`, type the necessary IP
     addresses into the provided box.

  #. (Conditional) Windows enables `Stealth Mode <https://technet.microsoft.com/en-us/library/dd448557(v=ws.10).aspx>`__
     for the Windows Firewall by default. If you have not disabled it on
     the MongoDB host on which you are installing the Automation Agent,
     you are asked to disable it. Stealth Mode significantly degrades
     the performance and capability of the Automation Agent.
     Click :guilabel:`Disable Stealth Mode`.

  #. (Conditional) Windows does not enable `Disk Performance Counters <https://blogs.technet.microsoft.com/askcore/2012/03/16/windows-performance-monitor-disk-counters-explained/>`__
     by default. If you had not enabled Disk Performance Counters for
     the MongoDB host, click :guilabel:`Enable Disk Performance
     Counters`. The Automation Agent uses these counters for
     some of its hardware monitoring activities.

  #. Click :guilabel:`Install`.

  #. Click :guilabel:`Finish` once installation is complete.
---
title: "Login to |cloud|."
stepnum: 5
ref: login
edition:
  - cloud
---
title: "Login to |onprem|."
stepnum: 5
ref: login
edition:
  - onprem
---
title: "Verify the Automation Agent is running."
stepnum: 6
ref: verify-automation-agent
content: |

  The :guilabel:`Deployment` page should display after login.

  a. Click on the stacked box icon next to `Servers`.

  b. Verify that the Automation Agent is showing the correct
     version.
---
title: "Repeat installation procedure for each MongoDB host."
stepnum: 7
ref: repeat
...
