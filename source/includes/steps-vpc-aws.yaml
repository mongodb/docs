---
title: "In |aws|, enable :guilabel:`DNS hostnames` and :guilabel:`DNS resolution`."
level: 4
ref: enable-dns-resolution-aws
content: |

  a. Log in to your |aws| account.

  #. Go to the `VPC dashboard <https://console.aws.amazon.com/vpc>`_.

  #. Open your list of |vpc| resources.

  #. Select the |vpc| you want to peer with.

  #. Enable :guilabel:`DNS hostnames` and :guilabel:`DNS resolution`.

     These settings ensure that when your application connects to the
     cluster within the :ref:`VPC <security-vpc>` it uses private IP
     addresses.

---
ref: nav-to-peering-connection
inherit:
  file: steps-source-project-nav.yaml
  ref: project-nav-peering-connection
title: "In |service|, add a new network peering connection for your project."
stepnum: 2
---
ref: configure-peering-connection
level: 4
stepnum: 3
title: "In |service|, configure your network peering connection."
content: |

  a. In the :guilabel:`Peering Connection` modal, select
     :guilabel:`AWS` and click :guilabel:`Next`. |service| displays the
     :guilabel:`Peering Connection` modal.

  #. Fill out the fields in the :guilabel:`Your Application VPC`
     section.

     .. list-table::
        :header-rows: 1
        :widths: 35 65

        * - Field
          - Description

        * - :guilabel:`Account ID`

          - Unique number that identifies the |aws| Account ID of the
            owner of the peer |vpc|.

            To find your :guilabel:`AWS Account ID`, click
            :guilabel:`Learn More`.

        * - :guilabel:`VPC ID`

          - Unique string that starts with ``vpc-`` that identifies the
            peer |vpc|.

            To find your :guilabel:`VPC ID`, click
            :guilabel:`Learn More`.

        * - :guilabel:`VPC CIDR`

          - |aws| |vpc| |cidr| block or subset of the network in which
            your application runs. This range cannot overlap with your
            :guilabel:`Atlas CIDR Block` or any other Network Peering
            connection :guilabel:`VPC CIDR`.

            The |cidr| block must be in one of the following
            :rfc:`private networks <rfc1918#section-3>`:

            .. include:: /includes/list-tables/aws-vpc-ranges.rst

            To include this |vpc| |cidr| block in your IP access list,
            click :guilabel:`Add this CIDR block to my IP whitelist`.
            You can choose to add the :ref:`Security Group associated
            <add-to-access-list>` with the |aws| |vpc|.

            To learn more about |cidr| blocks, see
            :rfc:`RFC 4632 <4632>`.

        * - :guilabel:`Application VPC Region`

          - |aws| region where the |aws| |vpc| resides.

  #. Fill out the fields in the :guilabel:`Your Atlas VPC` section.

     .. list-table::
        :header-rows: 1
        :widths: 35 65

        * - Field
          - Description

        * - :guilabel:`Atlas VPC Region`

          - |aws| region where the |service| |vpc| resides. |service|
            creates a |vpc| for the |service| project in your chosen
            region if that region has no ``M10`` or greater clusters or
            |vpc| peering connections.

            Clear :guilabel:`Same as application VPC region` to select
            a region different from where your application's |vpc|
            resides.

        * - :guilabel:`VPC CIDR`

          - .. include:: /includes/fact-vpc-cidr-block.rst

  #. Click :guilabel:`Initiate Peering`.

  #. Wait for approval of peering connection request.

     The owner of the peer |vpc| must approve the |vpc| peering
     connection request. Ensure that the owner approves the request.

     |service| provides instructions for approving the connection
     request.

     .. important:: Requests expire after 7 days.

---
ref: configure-peering-connection-aws
level: 4
stepnum: 3
title: "In |aws|, update your VPC's route table."
content: |

  a. In the :guilabel:`VPC Dashboard`, click
     :guilabel:`Route Tables`.

  #. Select the Route Table for your |vpc|.

  #. Click the :guilabel:`Routes` tab.

  #. Click :guilabel:`Edit Routes`.

  #. Click :guilabel:`Add route`.

  #. Add the |service| |vpc|\'s |cidr| block to the
     :guilabel:`Destination` column.

  #. Add the AWS Peering Connection ID to the
     :guilabel:`Target` column.

     This value uses a prefix of ``pcx-``.

  #. Click :guilabel:`Save`.

     .. include:: /includes/fact-vpc-peering-connections-max.rst

     Once set up, you can edit or terminate |vpc| peering
     connection from the :guilabel:`Peering` table.

...
