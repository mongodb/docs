====================
Manage System Alerts
====================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Overview
--------

System alerts are internal health checks that monitor the health of |onprem|
itself, including the health of backing databases, 
:term:`Backup Daemons <Backup Daemon>`, and backed-up 
:term:`deployments <deployment>`. |onprem| runs health checks every five
minutes.

To view the list of system alerts:

#. Click the :guilabel:`Admin` link at the top of the |onprem| :abbr:`UI (user interface)`.

#. Click the :guilabel:`Alerts` tab.

#. Click the :guilabel:`Open Alerts` link under :guilabel:`System Alerts`.

Disabled system alerts are grayed out.

If you have the :ref:`global-owner-role` or :ref:`global-monitoring-admin-role`
roles, you can :ref:`modify notification settings <edit-system-alert-notification>`
or :ref:`disable <disable-system-alert>` a system alert.

System Alerts
-------------

When enabled and the trigger condition is met, |onprem| sends an alert to the
specified recipients using the specified medium for that alert. By default,
|onprem| enables *all* alerts and sends alerts via *email* to |onprem|
Administrators. 

|onprem| provides the following system alerts:

.. alert:: Blockstore space used exceeds threshold

   Sent when the disk space the :term:`blockstore <Backup Blockstore Database>` 
   uses exceeds the configured
   :setting:`threshold <mms.alerts.OutsideSpaceUsedThreshold.maximumSpaceUsedPercent>` 
   setting. The default threshold is 85% of the total disk capacity
   on which the blockstore is stored, but you can change the
   :setting:`mms.alerts.OutsideSpaceUsedThreshold.maximumSpaceUsedPercent`
   value in the |onprem| configuration.

.. alert:: Blockstore has a running balancer

   Sent when the blockstore is running behind a load balancer.

.. alert:: Detected startup warnings on a database backing the system

   Sent when the MongoDB :term:`process` hosting a 
   :ref:`backing database <backing-database>` contains 
   ``startupWarnings`` in its log files.
   
   Check the logs on the server running the MongoDB process.

.. alert:: Detected a problem connecting to a database backing the system

   Sent when |onprem| cannot connect to a backing database and run
   the ping command.

.. alert:: Backup Daemon free head space percentage is below 10

   Sent when the disk partition on which the local copy of a backed-up
   replica set is stored has less than 10 percent of free space remaining.

   Follow the :ref:`edit-system-alert-notification` procedure to change this
   percentage.

.. alert:: Backup Daemon free head space is below 1 GB

   Sent when the disk partition on which the local copy of a backed-up
   replica set is stored has less than 1 GB of free space remaining.

   Follow the :ref:`edit-system-alert-notification` procedure to change this
   space limit.

.. alert:: Backup Daemon is down

   Sent when the Backup Daemon has not pinged |onprem| for more than
   15 minutes.

.. alert:: Backup was not moved successfully

   Sent when you try to move a backup job to a new Backup Daemon and
   that move failed. The backup job continues to run on its original Backup
   Daemon.
   
   For more information on moving jobs, see :ref:`jobs-page`.

.. alert:: Backup oplog TTL was resized

   Sent when the Backup Daemon has fallen so far behind in applying
   :term:`oplog` entries that |onprem| has extended the period of time it
   stores the oplog entries. By default, |onprem| stores oplog entries in the
   :ref:`Oplog Store <oplog-stores-page>` for 24 hours. 

   If the Daemon has not yet applied an oplog entry an hour before its
   expiration, |onprem| extends the storage period for another three hours.
   |onprem| can continue to extend the storage period up to seven days.

   If you receive this alert:

   #. Check that your Backup Daemon is running.
   
   #. Check that your Backup Daemon runs on sufficiently performant hardware
      to apply oplog entries in a timely manner.

.. .. alert:: Failed integrity check
..
..    Sent when snapshots are potentially corrupt. |onprem| performs
..    a periodic integrity check of a snapshot to make sure that it is
..    complete in the blockstore. If that validation fails, the alert is
..    triggered. Another result of an integrity failure is that |onprem| no
..    longer uses past snapshots to optimize creation of future ones,
..    which ensures future snapshots are complete.
..
..    If you receive this alert, contact MongoDB Support.

.. _edit-system-alert-notification:

Modify Notification Settings for a System Alert
-----------------------------------------------

.. include:: /includes/steps/system-alerts-edit.rst

.. _disable-system-alert:

Disable a System Alert
----------------------

.. include:: /includes/steps/system-alerts-disable.rst
