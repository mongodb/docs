=========================================
Command Limitations in Free Tier Clusters
=========================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: onecol

Atlas ``M0`` Free Tier and ``M2``/``M5`` shared starter clusters do not
support all functionality available to other clusters.

.. important::
    
   ``M0`` Free Tier and ``M2``/``M5`` shared starter clusters do not support
   read or write operations on the ``admin`` database.
   
For complete documentation on ``M0``/``M2``/``M5`` limitations, see
:ref:`atlas-free-tier`.

Commands With Special Behavior
------------------------------

The following commands exhibit special behavior in ``M0`` Free Tier
and ``M2``/``M5`` shared starter clusters:
 
.. list-table::
   :header-rows: 1
   :widths: 50 50

   * - Command
     - Description

   * - `aggregate <https://docs.mongodb.com/manual/reference/command/aggregate/>`_

     - The following limitations apply:

       * The ``maxTimeMs`` parameter cannot exceed 600 seconds. 
       * The ``allowDiskUsage`` parameter is ignored.

   * - `count <https://docs.mongodb.com/manual/reference/command/count/>`_

     - The following limitations apply:

       * The ``$where`` operator is not supported. 
       * When run against the ``local`` database, you can execute 
         ``count`` only on the ``system.replset`` and ``oplog.rs`` 
         collections.

   * - `distinct <https://docs.mongodb.com/manual/reference/command/distinct/>`_

     - The ``$where`` operator is not supported.

   * - `find <https://docs.mongodb.com/manual/reference/command/find/>`_

     - The following limitations apply:

       * The ``$where`` operator is not supported.
       * In the ``local`` database, you can run ``find`` only on the
         ``oplog.rs`` collection. When querying the ``oplog.rs`` collection,
         if you specify a condition on the ``ns`` field, you must specify an
         equality condition, such as ``ns: "test.foo"``. You cannot use
         ``$regex`` or any other operator with the ``ns`` field.  

   * - `getParameter <https://docs.mongodb.com/manual/reference/command/getParameter/>`_ 
   
     - Can be executed in a Free Tier cluster in only two variations:

       * ``{getParameter: 1, authSchemaVersion: 1}``
       * ``{getParameter: 1, authenticationMechanisms: 1}``

   * - `killOp <https://docs.mongodb.com/manual/reference/method/db.killOp/>`_

     - All MongoDB users associated with a Free Tier account can execute
       the ``killOp`` command to terminate operations by all other MongoDB
       users associated with the same account.

   * - `serverStatus <https://docs.mongodb.com/manual/reference/command/serverStatus/>`_

     - * The data returned by the following sections is not meaningful:

         * ``asserts``
         * ``extra_info``
         * ``mem``
         * ``opcountersRepl``

       * The following sections are not supported:

         * ``backgroundFlushing``
         * ``dur``
         * ``encryptionAtRest``
         * ``security``
         * ``advisoryHostFQDNs``
         * ``tcmalloc``
         * ``oplog``
         * ``rangeDeleter``
         * ``logicalSessionRecordCache``

       * The ``metrics`` field is replaced with the following:

         .. code-block:: none

            "metrics": {
               "connectionPool": {
                   "totalCreated": [total-created-number]
               },
            "bytesInWrites": [current-bytes-in-writes-value-since-last-check]
            }

Unsupported Commands
--------------------

The following commands are not supported by ``M0`` Free Tier and
``M2``/``M5`` shared starter clusters: 

.. note::

   The commands available for clusters of all other instance sizes, M10
   and larger, correspond to the privileges defined for the built-in 
   MongoDB roles used by |service|. See :ref:`Atlas User Privileges
   <atlas-user-privileges>` for more information.

.. list-table::


   * - | ``applyOps``

       | ``appendOplogNote``

       | ``authenticate``

       | ``authSchemaUpgrade``

       | ``checkShardingIndex``

       | ``cleanupOrphaned``

       | ``clone``

       | ``cloneCollection``

       | ``cloneCollectionAsCapped``

       | ``compact``

       | ``connPoolSync``

       | ``copydb``

       | ``copydbgetnonce``

       | ``copydbsaslstart``

       | ``createRole``

       | ``createUser``

       | ``currentOpCtx``

       | ``dataSize``

       | ``dbHash``

       | ``diagLogging``

       | ``dropAllRolesFromDatabase``

       | ``dropAllUsersFromDatabase``

       | ``dropRole``

       | ``eval``

       | ``forcerror``

       | ``fsync``

       | ``fsyncUnlock``

       | ``getDiagnosticData``

       | ``getPrevError``

     - | ``getShardMap``

       | ``getShardVersion``

       | ``grantPrivilegesToRole``

       | ``grantRolesToRole``

       | ``grantRolesToUser``

       | ``handshake``

       | ``invalidateUserCache``

       | ``lockInfo``

       | ``logRotate``

       | ``mapreduce``

       | ``mapreduce.shardedfinish``

       | ``parallelCollectionScan``

       | ``planCacheClear``

       | ``planCacheClearFilters``

       | ``planCacheListFilters``

       | ``planCacheListPlans``

       | ``planCacheListQueryShapes``

       | ``planCacheSetFilter``

       | ``reIndex``

       | ``revokeRolesFromUser``

       | ``repairCursor``

       | ``repairDatabase``

       | ``replSetDeclareElectionWinner``

       | ``replSetElect``

       | ``replSetFreeze``

       | ``replSetFresh``

       | ``replSetGetConfig``
 
       | ``replSetGetRBID``

       | ``replSetGetStatus`` 
       
     - | ``replSetHeartbeat``

       | ``replSetInitiate``

       | ``replSetMaintenance``

       | ``replSetReconfig``

       | ``replSetRequestVotes``

       | ``replSetStepDown``

       | ``replSetStepUp``

       | ``replSetSyncFrom``

       | ``replSetUpdatePosition``

       | ``resetError``

       | ``resync``

       | ``revokePrivilegesFromRole``

       | ``revokeRolesFromRole``

       | ``setFeatureCompatibilityVersion``

       | ``setLogLevel``

       | ``setParameter``

       | ``setProfilingLevel``

       | ``shutdown``

       | ``updateRole``

       | ``updateUser``

       | ``validate``

       | ``_migrateClone``

       | ``_recvChunkAbort``

       | ``_recvChunkCommit``

       | ``_recvChunkStart``

       | ``_recvChunkStatus``

       | ``_transferMods``
