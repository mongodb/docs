ref: fts-facet-tutorial-step1
level: 4
stepnum: 1
inherit:
  file: steps-fts-tutorial-run-query.yaml
  ref: connect-to-database-deployment-fts
---
ref: fts-facet-tutorial-step2
level: 4
stepnum: 2
inherit:
  file: steps-fts-tutorial-run-query.yaml
  ref: use-sample-mflix
---
ref: fts-facet-tutorial-step3
level: 4
stepnum: 3
title: "Run an |fts| facet query that groups the genre and year fields
       into buckets."
content: |
  The following query searches for movies released :ref:`near 
  <near-ref>` November 11, 1921. It specifies a ``pivot`` distance from 
  ``origin`` of approximately three months. It requests metadata on the 
  ``genres`` and ``year`` field. The query requests a count of the: 
  
  - Number of movies in each genre in the ``genres`` string array field
  - Number of movies in the years 1910 to 1939, inclusive
  
  .. io-code-block:: 
     :copyable: true 

     .. input:: /includes/fts-tutorial/facet/tutorial-shell.js
        :language: js
        :dedent:

     .. output::
        :language: json
        :visible: true
        
        { 
          "count" : { 
            "lowerBound" : NumberLong(23026) 
          }, 
          "facet" : { 
            "genresFacet" : { 
              "buckets" : [ 
                { "_id" : "Drama", "count" : NumberLong(13527) }, 
                { "_id" : "Comedy", "count" : NumberLong(6922) }, 
                { "_id" : "Romance", "count" : NumberLong(3615) }, 
                { "_id" : "Crime", "count" : NumberLong(2649) }, 
                { "_id" : "Thriller", "count" : NumberLong(2603) }, 
                { "_id" : "Action", "count" : NumberLong(2505) }, 
                { "_id" : "Documentary", "count" : NumberLong(2041) }, 
                { "_id" : "Adventure", "count" : NumberLong(2016) }, 
                { "_id" : "Horror", "count" : NumberLong(1662) }, 
                { "_id" : "Biography", "count" : NumberLong(1373) } 
              ] 
            }, 
            "yearFacet" : { 
              "buckets" : [ 
                { "_id" : 1910, "count" : NumberLong(23) }, 
                { "_id" : 1920, "count" : NumberLong(89) }, 
                { "_id" : 1930, "count" : NumberLong(308) }
              ] 
            } 
          } 
        }

...
