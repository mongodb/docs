.. _atlasnetworkcontainer-custom-resource:

=========================================
``AtlasNetworkContainer`` Custom Resource
=========================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. include:: /includes/subresource-deprecation.rst

The ``AtlasNetworkContainer`` custom resource defines a :ref:`network
container <ak8so-network-peering>` for a |service|
project. You create |vpc| peering connections between network
containers and the networks hosting your applications.

.. include:: /includes/fact-ak8so-crds.rst

|ak8so| does one of the following actions using the |service| 
:oas-bump-atlas-tag:`Network Peering API Resource <network-peering>`:
   
- Creates a new network container.
- Updates an existing network container.

Examples
--------

The following examples illustrate configurations for
``AtlasNetworkContainer`` CRDs.

- The basic example configuration defines a resource that you manage
  with the same |ak8so| instance with which you manage its parent
  {+service+} project.

- The :ref:`Independent CRD <ak8so-independent-crd>` example
  configures the same network container as the basic example,
  but for a {+service+} project that you manage outside of the |ak8so|
  instance with which you manage the network container.

.. _atlasnetworkcontainer-example-basic:

Basic Example
~~~~~~~~~~~~~

The following shows an ``AtlasNetworkContainer`` custom resource for a
container named ``my-atlas-nc`` that allows you to create a |vpc|
peering connection between {+service+} and {+aws+} within the
``my-project`` project. To manage this resource in the same |ak8so|
instance as its parent {+service+} project, you must identify the
project with ``projectRef`` instead of ``externalProjectRef``.

.. code-block::

   apiVersion: atlas.mongodb.com/v1
   kind: AtlasNetworkContainer
   metadata:
     name: my-atlas-nc
   spec:
     projectRef:
       name: my-project
       namespace: my-operator-namespace
     provider: AWS
     id: 66e2f2b7e69a89b66b621571
     cidrBlock: 10.11.0.0/16
     region: US_EAST_1
   
Independent CRD Example
~~~~~~~~~~~~~~~~~~~~~~~

The following example shows an ``AtlasNetworkContainer``
:ref:`independent CRD <ak8so-independent-crd>` that enables |vpc|
peering under the same parameters enabled by the :ref:`Basic Example
<atlasnetworkcontainer-example-basic>`. To enable independent
operation, you must use an ``externalProjectRef`` instead of a
``projectRef``, and you must supply a ``connectionSecret`` directly
since this resource can't inherit API credentials from its parent
project.

.. code-block::

   apiVersion: atlas.mongodb.com/v1
   kind: AtlasNetworkContainer
   metadata:
     name: my-atlas-nc
   spec:
     externalProjectRef:
       projectId: 66e2f2b621571b7e69a89b66
     connectionSecret:
       name: atlas-connection-secret
     provider: AWS
     id: 66e2f2b7e69a89b66b621571
     cidrBlock: 10.11.0.0/16
     region: US_EAST_1

Parameters
----------

.. include:: /includes/manual-crds/atlas-network-container.rst
