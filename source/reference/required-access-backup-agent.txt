.. _required-permissions-mms-backup:

================================
Required Access for Backup Agent
================================

.. default-domain:: mongodb

If your MongoDB deployment enforces access control, the MMS Backup
Agent must authenticate to MongoDB as a user with the proper access. To
authenticate, create a user with the appropriate roles in MongoDB.

MongoDB user roles are separate from |MMS| :doc:`user roles
</reference/user-roles>`.

Considerations
--------------

.. include:: /includes/fact-backup-agent-access-sharded-cluster.rst

.. only:: classic or cloud

   .. include:: /includes/fact-auth-backup-requirements.rst

MongoDB 2.6
-----------

.. _access-control-backup-2.6.4:

2.6.4 and After
~~~~~~~~~~~~~~~

To backup MongoDB instances running 2.6.4 and later, the Backup Agent
must authenticate as a user with the following role:

.. list-table::
   :header-rows: 1

   * - Required Role
     - 
   * - :authrole:`backup` role on the ``admin`` database
     -

.. _access-control-backup-2.6.3:

2.6.0 through 2.6.3
~~~~~~~~~~~~~~~~~~~

To backup MongoDB 2.6.0 through 2.6.3 instances, the Backup Agent must
be able to authenticate to with the following roles:

.. list-table::
   :header-rows: 1

   * - Required Role
     - 
   * - :authrole:`clusterAdmin` role on the ``admin`` database
     -
   * - :authrole:`readAnyDatabase` role on the ``admin`` database
     -
   * - :authrole:`userAdminAnyDatabase` role on the ``admin`` database
     -
   * - :authrole:`readWrite` role on the ``admin`` database
     -
   * - :authrole:`readWrite` role on the ``local`` database
     -

.. _access-control-backup-2.4:

MongoDB 2.4
-----------

To backup MongoDB 2.4 instances, the Backup Agent must be able to
authenticate to the database with a user that has specified ``roles``
and ``otherDBRoles``. Specifically, the user must have the following
roles:

.. list-table::
   :header-rows: 1

   * - Required Role
     - 
   * - :authrole:`clusterAdmin` role on the ``admin`` database
     -
   * - :authrole:`readAnyDatabase` role on the ``admin`` database
     -
   * - :authrole:`userAdminAnyDatabase` role on the ``admin`` database
     -

And the following ``otherDBRoles``:

.. list-table::
   :header-rows: 1

   * - Required Role
     - 
   * - :authrole:`readWrite` role on the ``local`` database
     -
   * - :authrole:`readWrite` role on the ``admin`` database
     -

Authentication Mechanisms
-------------------------

To authenticate, create the user in MongoDB with the appropriate
access. The authentication method that the MongoDB deployment uses
determines how to create the user as well as determine any additional
agent configuration:

- For MONGODB-CR (MongoDB Challenge-Response) authentication, see
  :doc:`/tutorial/configure-backup-agent-for-cr`.

- For LDAP authentication, see
  :doc:`/tutorial/configure-backup-agent-for-ldap`.

- For Kerberos authentication, see
  :doc:`/tutorial/configure-backup-agent-for-kerberos`.
