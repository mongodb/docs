.. _monitor-cluster-metrics:

===========================
View {+Deployment+} Metrics
===========================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

|service| collects and displays metrics for your servers, databases,
and MongoDB processes. 

.. include:: /includes/fact-cluster-metrics.rst

.. note::

   The number of servers that |service| displays on the 
   :guilabel:`Metrics` page at any given time depends on the browser 
   screen size. Use the :guilabel:`Toggle Members` section to control 
   which servers |service| displays. Hover over the ``S`` and ``P`` 
   icons to find out which servers they represent.

View Metrics
------------

You can view metrics in the following ways:

:ref:`Project Overview <view-all-cluster-metrics>`
   The :guilabel:`Overview` tab displays all the 
   {+database-deployments+} in an 
   |service| :ref:`project <projects>` and features core metrics per 
   {+database-deployment+}.

:ref:`Atlas {+Serverless-Instances+} <view-serverless-metrics>`
   View the metrics for a specific {+serverless-instance+} in an 
   |service| :ref:`project <projects>`.

:ref:`Atlas Replica Sets <view-replica-set-metrics>`
   View the metrics for a specific replica set in an |service| 
   :ref:`project <projects>`.

:ref:`Atlas Sharded Clusters <view-sharded-cluster-metrics>`
   View the metrics for a specific sharded cluster in an |service|
   :ref:`project <projects>`.

:ref:`MongoDB Processes <view-mongodb-process-metrics>`
   View the metrics for a specific MongoDB process in an 
   |service| cluster.

:ref:`Real-Time Performance <view-real-time-metrics>`
   View real-time performance metrics for a specific |service| 
   {+database-deployment+} in a :ref:`project <projects>`.

:ref:`Atlas Search <view-atlas-search-metrics>`
   View |fts| metrics for |service| clusters with at least one active 
   |fts| index.

Important Metrics
-----------------

You can monitor the following metrics to quickly gauge the health of 
your {+database-deployment+}.

.. list-table::
   :widths: 30 70
   :header-rows: 1
        
   * - Chart

     - Description
  
   * - :guilabel:`Connections`

     - Number that indicates the total active connections to the 
       {+database-deployment+}.
       
       .. include:: /includes/fact-connections.rst

       To learn more, see :ref:`Fix Connection Issues 
       <connection-alerts>` and :ref:`Fix Lost Primary <no-primary>`.

   * - :guilabel:`Disk IOPS`
  
     - Number that indicates the input operations per second.

       .. include:: /includes/fact-disk-iops.rst

       To learn more, see :ref:`Fix IOPS Issues <disk-io-util>` and 
       :ref:`Fix Lost Primary <no-primary>`.

   * - :guilabel:`Disk Usage`
  
     - Number that indicates the total bytes of used disk space for the 
       cluster.

       .. include:: /includes/fact-disk-usage.rst

       To learn more, see :ref:`Fix Storage Issues <disk-space-used>`.

   * - :guilabel:`Query Targeting`
    
     - Number that indicates the efficiency of read operations run on   
       MongoDB.
       
       Monitor query targeting metrics to identify inefficent queries.

       To learn more, see :ref:`Fix Query Issues 
       <query-targeting-resolution>`.

   * - :guilabel:`Normalized System CPU`

     - Number that indicates CPU usage of all processes on the node, 
       scaled to a range of 0-100% by dividing by the number of CPU 
       cores.

       .. include:: /includes/fact-system-cpu.rst

       To learn more, see :ref:`Fix IOPS Issues <disk-io-util>`, 
       :ref:`Fix Lost Primary <no-primary>`, and :ref:`Fix CPU Usage 
       Issues <system-cpu>`.

   * - :guilabel:`Oplog GB/Hour`
     
     - Number that indicates the average rate in gigabytes of 
       :term:`oplog` data that the primary generates per hour.

       .. include:: /includes/fact-oplog-gb-hour.rst

       To learn more, see :ref:`Fix Oplog Issues 
       <replication-oplog-alerts>`.

   * - :guilabel:`Util %`

     - Percentage of time that requests are issued to and serviced 
       by disk. This metric includes requests from any process, not 
       just MongoDB processes.
         
       .. include:: /includes/fact-util-percent.rst
  
       To learn more, see :ref:`Fix IOPS Issues <disk-io-util>`.

.. _monitoring-storage-granularity:

Monitoring Data Storage Granularity
-----------------------------------

|service| stores metrics data at increasing granularity levels. For each
increasing granularity level, |service| computes the metrics data based
on the averages from the previous granularity level. The length of
retention depends on the granularity. |service| computes the metrics 
data based on the averages from the previous granularity level.

.. example::

   After 48 hours' worth of data is collected, each group of
   60 minutes is compacted into a single unit of an hour. After 63 days,
   each group of 24 hours is compacted into a single unit of a day.

Metrics data is gathered at a 1-minute granularity. |service| retains
different granularities of metric data for different periods of time:

.. list-table::
   :header-rows: 1

   * - Data Period
     - Duration of Retention

   * - 1 minute
     - 48 hours

   * - 5 minutes
     - 48 hours

   * - 1 hour
     - 63 days

   * - 1 day
     - Forever

|service| retains all database-specific statistics. MongoDB log data is
retained at a maximum rate of 2000 lines per 2 minutes.

{+Free-Cluster+} and {+Shared-Cluster+} Monitoring Considerations
-----------------------------------------------------------------

- ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+} support a subset of
  the metrics and charts available. For complete documentation on
  the limitations of ``M0/M2/M5`` {+clusters+},
  see :ref:`atlas-free-tier`.
  
- .. include:: /includes/fact-free-tier-monitoring-pause.rst

{+Serverless-Instance+} Monitoring Considerations
-------------------------------------------------

- {+Serverless-instances+} support a subset of the metrics and charts 
  available. For complete documentation on
  the limitations of {+serverless-instances+},
  see :doc:`/reference/serverless-instance-limitations/`.

.. toctree::
   :titlesonly:
   :hidden:

   /view-all-cluster-metrics
   /view-serverless-metrics
   /view-replica-set-metrics
   /view-sharded-cluster-metrics
   /view-mongodb-process-metrics
   /view-real-time-metrics
   /view-atlas-search-metrics
   /review-available-metrics
