:noprevnext:

.. _install-k8s:

=========================
Install the |k8s-op-full|
=========================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. include:: /includes/styles/corrections.rst

.. tabs::

   tabs:
     - id: vank8s
       name: Kubernetes
       content: |

          .. tabs::

                tabs:
                  - id: kubectl
                    name: Online using kubectl
                    content: |


                  - id: helmonline
                    name: Online using Helm
                    content: |


                  - id: helmoffline
                    name: Offline using Helm and Docker
                    content: |


     - id: openshift
       name: OpenShift
       content: |

          .. tabs::

                tabs:
                  - id: os
                    name: Online using oc
                    content: |
                      

                  - id: os-helm-online
                    name: Online using Helm
                    content: |
                      

                  - id: os-helm-offline
                    name: Offline using Helm and Docker
                    content: |
          

Use the |k8s-op-full| to deploy:

- Ops Manager resources
- MongoDB standalone, replica set, and sharded cluster resources

.. include:: /includes/admonitions/note-k8s-supported-in-om4.rst

To deploy MongoDB resources with the |k8s-op-short|, you need an
|onprem| instance. Deploy this instance to |k8s| using the Operator or
outside |k8s| using
:opsmgr:`traditional installation methods </installation>`. The
Operator uses |onprem| |api| methods to deploy  then manage MongoDB
resources.

.. note::

   This tutorial presumes some knowledge of |k8s|, but does link to
   relevant |k8s| documentation where possible. If you are unfamiliar
   with |k8s|, please review that documentation first.

.. _k8s-prerequisites:

Prerequisites
-------------

.. include:: /includes/install-common-prereqs.rst

.. tabs::

   hidden: true
  
   tabs:

     - id: openshift
       name: OpenShift
       content: |
       
         .. include:: /includes/install-openshift-prereqs.rst


Considerations
--------------

|k8s| Compatibility
~~~~~~~~~~~~~~~~~~~

|k8s-op-full| is compatible with |k8s| v1.13 or later.


Docker Container Details
~~~~~~~~~~~~~~~~~~~~~~~~

MongoDB builds the container images from the latest builds of the
following operating systems:

.. list-table::
   :header-rows: 1
   :widths: 50 50

   * - If you get your |k8s-op-short| from...
     - ...the Container uses

   * - `quay.io <https://quay.io/repository/mongodb/mongodb-enterprise-operator?tag=latest&tab=tags>`__
       or :gh:`GitHub </mongodb/mongodb-enterprise-kubernetes>`
     - `Ubuntu 16.04 <https://www.ubuntu.com/containers>`__

   * - `OpenShift <https://access.redhat.com/containers/?tab=tags#/registry.connect.redhat.com/mongodb/enterprise-operator>`__
     - `Red Hat Enterprise Linux 7 <https://www.redhat.com/en/topics/containers>`__

MongoDB, Inc. updates all packages on these images before releasing
them every three weeks.

Only One Operator per Namespace
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The |k8s-op-full| can only exist in one |k8s-ns|. Your deployment can
have:

- One cluster-wide |k8s-op-short| or
- Multiple Kubernetes Operators in their own namespaces

Do not try to deploy more than one Kubernetes Operator in the same
namespace as another Operator. Multiple Operators cannot coordinate
with one another within the same namespace.

.. _default namespace: https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/#viewing-namespaces

.. _install-k8s-operator:

Install the |k8s-op-full|
-------------------------

.. tabs::
   
   hidden: true

   tabs:

     - id: vank8s
       name: Kubernetes
       content: |

          .. tabs::

                hidden: true

                tabs:
                  - id: kubectl
                    name: Online using kubectl
                    content: |

                      .. include:: /includes/same-namespace-kubectl.rst

                      .. include:: /includes/steps/install-kubectl.rst

                  - id: helmonline
                    name: Online using Helm
                    content: |

                      .. include:: /includes/install-vanilla-k8s-online-helm.rst

                  - id: helmoffline
                    name: Offline using Helm and Docker
                    content: |

                      .. include:: /includes/install-vanilla-k8s-offline-helm.rst

     - id: openshift
       name: OpenShift
       content: |

          .. tabs::
          
                hidden: true

                tabs:
                  - id: os
                    name: Online using oc
                    content: |
                      
                      .. include:: /includes/same-namespace-oc.rst

                      .. include:: /includes/steps/install-oc.rst

                  - id: os-helm-online
                    name: Online using Helm
                    content: |
                      
                      .. include:: /includes/install-os-online-helm.rst

                  - id: os-helm-offline
                    name: Offline using Helm and Docker
                    content: |
                      
                      .. include:: /includes/install-os-offline-helm.rst

.. include:: /includes/troubleshoot-k8s.rst

Next Steps
----------

After installing the |k8s-op-full|, you can:

- :doc:`Create an instance of Ops Manager </tutorial/deploy-om-container>`

- :doc:`Configure the Kubernetes Operator to deploy MongoDB resources </configure-k8s-operator-for-mdb-resources>`
