:orphan:

===================================
Configure Monitoring Agent for LDAP
===================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. include:: /includes/legacy-agents/fact-monitoring-agent-deprecated.rst

.. include:: /includes/extracts/intro-configure-monitoring-agent-ldap.rst

.. include:: /includes/extracts/note-manage-agent-auth-with-automation-ldap.rst

Considerations
--------------

You must configure LDAP authentication separately for each agent.
See :doc:`/tutorial/configure-backup-agent-for-ldap` for
configuration instructions for the Backup Agent.

You can configure LDAP authentication when adding a host or by editing
an existing host. See
:doc:`/tutorial/enable-ldap-authentication-for-group` for instructions.

There are additional authentication configuration requirements for
|mms| Monitoring when using MongoDB 2.4 with authentication. See
:doc:`/reference/required-access-monitoring-agent` for more information.

Procedures
----------

Create User in MongoDB
~~~~~~~~~~~~~~~~~~~~~~

To monitor MongoDB 2.6+ instances that are using LDAP authentication,
add a user that possess the required roles to the ``$external`` database
in MongoDB. The ``$external`` database allows :program:`mongod` to
consult an external source, such as an LDAP server, to authenticate.

Use the following commands to create the users from a 
|mongo| shell connected to your MongoDB deployment:

.. code-block:: javascript

   db.getSiblingDB("$external").createUser(
       {
         user : "<username>",
         roles: [ { role: "clusterMonitor", db: "admin" } ]
       }
   )

See :doc:`/reference/required-access-monitoring-agent` for more information on the required access.

Host Settings
~~~~~~~~~~~~~

.. include:: /includes/fact-access-control-host-settings.rst
