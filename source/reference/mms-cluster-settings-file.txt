.. _mms-cluster-settings-file: 

==========================
Cluster Configuration File
==========================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. _mms-cluster-settings-file-overview:

Overview 
--------

The ``mcli`` command requires cluster configuration 
settings for creating or updating a |cloud| or |mms-full| 
cluster. The configuration properties can be provided 
through a ``.yaml`` or ``.json`` file. The following sections 
describe the :ref:`mms-config-props` that are required for 
creating or updating a cluster and provide a 
:ref:`mms-sample-config-file` that you can copy and modify. 

.. _mms-config-props:

Configuration Properties
------------------------

The following sections contain the: 

- Cluster-wide configuration properties
- Replica set member configuration properties

Cluster-Wide Settings 
~~~~~~~~~~~~~~~~~~~~~

The configuration file for creating or updating a |cloud| or 
|mms-full| cluster must contain the following cluster-wide settings:

.. list-table:: 
   :header-rows: 1 
   :widths: 20 10 70 

   * - Field 
     - Type 
     - Description 

   * - ``featureCompatibilityVersion``
     - string
     - The :manual:`Feature Compatibility Version 
       </reference/command/setFeatureCompatibilityVersion#dbcmd.setFeatureCompatibilityVersion>` 
       of the deployment. 

   * - ``name``
     - string
     - The name of the cluster.

   * - ``processes``
     - object
     - The settings for the MongoDB process. Each object contain 
       settings for one instance of the :manual:`mongod 
       </reference/program/mongod/#bin.mongod>` process.

   * - ``version``
     - string
     - The version of the :manual:`mongod 
       </reference/program/mongod/#bin.mongod>` process to deploy.

Replica Set Member Settings 
~~~~~~~~~~~~~~~~~~~~~~~~~~~

The configuration file for creating or updating a |cloud| or 
|mms-full| cluster can contain the following settings for each 
replica set member:

.. list-table:: 
   :header-rows: 1 
   :widths: 20 10 60 10

   * - Field 
     - Type 
     - Description 
     - Required?

   * - ``buildIndexes``
     - boolean 
     - The flag that indicates whether to direct the :manual:`mongod 
       </reference/program/mongod/#bin.mongod>` to build indexes. 
       Value can be ``true`` or ``false``. 

       This setting corresponds to the :manual:`buildIndexes 
       </reference/replica-configuration/#rsconf.members[n].buildIndexes>` 
       :manual:`mongod </reference/program/mongod/#bin.mongod>` replica set 
       configuration option. 
     - no

   * - ``dbPath``
     - string
     - The directory where the :manual:`mongod 
       </reference/program/mongod/#bin.mongod>` instance stores its 
       data. This cannot be modified after deployment.
     - yes

   * - ``delay`` 
     - int 
     - The number of seconds behind the primary member that 
       this member should lag. This setting corresponds to the 
       :manual:`slaveDelay 
       </reference/replica-configuration/#rsconf.members[n].slaveDelay>` 
       :manual:`mongod </reference/program/mongod/#bin.mongod>` replica set 
       configuration option.
     - no

   * - ``hostname``
     - string
     - The name of the host to add to the replica set. This is the 
       host on which |mms| deploys the :manual:`mongod 
       </reference/program/mongod/#bin.mongod>` process.
     - yes

   * - ``logPath``
     - string
     - The location and name of the log file for the :manual:`mongod 
       </reference/program/mongod/#bin.mongod>` process 
       on the host.
     - yes

   * - ``port``
     - integer
     - The port for the replica set memeber. The :manual:`mongod 
       </reference/program/mongod/#bin.mongod>` process 
       must have exclusive access to the specified port. 
     - yes

   * - ``priority``
     - integer
     - The :manual:`priority 
       </reference/replica-configuration/#rsconf.members[n].priority>` 
       of the replica set memeber during elections. Value 
       can be: 

       - ``0`` 
       - ``1``

       Non-voting members must have a priority of ``0``. Replica 
       set members with a priority of ``0`` cannot become the primary 
       and cannot trigger elections. 
     - yes

   * - ``votes``
     - integer
     - The number that indicates whether the replica set member 
       votes in the election. Value can be: 

       - ``0`` if the replica set member cannot vote
       - ``1`` if the replica set memeber can vote

       To learn more about ``votes``, see :manual:`votes 
       </reference/replica-configuration/#rsconf.members[n].votes>`.
     - yes

.. _mms-sample-config-file:

Sample Configuration File 
-------------------------

.. tabs:: 

   .. tab:: YAML 
      :tabid: yaml 

      .. code-block:: text 

         name: "myCluster"
         version: 4.2.2
         featureCompatibilityVersion: 4.2
         processes:
             - hostname: host0
               dbPath: /data/cluster_2/rs1
               logPath: /data/cluster_2/rs1/mongodb.log
               priority: 1
               votes: 1
               port: 29010
             - hostname: host1
               dbPath: /data/cluster_2/rs2
               logPath: /data/cluster_2/rs2/mongodb.log
               priority: 1
               votes: 1
               port: 29020
             - hostname: host2
               dbPath: /data/cluster_2/rs3
               logPath: /data/cluster_2/rs3/mongodb.log
               priority: 1
               votes: 1
               port: 29030

   .. tab:: JSON 
      :tabid: json 

      .. code-block:: json 

         {
             "name": "myCluster",
             "version": "4.2.2",
             "featureCompatibilityVersion": "4.2",
             "processes": [
              {
                 "hostname": "host0",
                 "dbPath": "/data/cluster_3/rs1",
                 "logPath": "/data/cluster_3/rs1/mongodb.log",
                 "priority": 1,
                 "votes": 1,
                 "port": 30010
              },
              {
                 "hostname": "host1",
                 "dbPath": "/data/cluster_3/rs2",
                 "logPath": "/data/cluster_3/rs2/mongodb.log",
                 "priority": 1,
                 "votes": 1,
                 "port": 30020
              },
              {
                 "hostname": "host2",
                 "dbPath": "/data/cluster_3/rs3",
                 "logPath": "/data/cluster_3/rs3/mongodb.log",
                 "priority": 1,
                 "votes": 1,
                 "port": 30030
              }
            ]
         }
