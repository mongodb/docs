stepnum: 1
level: 4
title: "Click :guilabel:`{+Old-Backup+}` in the left navigation."
ref: select-backup-tab-overview-page
content: |

  .. figure:: /images/continuous-backup-btn.png
     :scale: 50%
     :alt: {+Old-Backup+} button
---
stepnum: 2
level: 4
title: "Choose the cluster to restore."
ref: choose-cluster
content: |

  The :guilabel:`Overview` tab on the :guilabel:`{+Old-Backup+}`
  page lists the project's clusters.

  - If backup is enabled for the cluster, the :guilabel:`Status` is
    :guilabel:`Active`.

  - If backup is disabled for the cluster, the :guilabel:`Status` is
    :guilabel:`Inactive`.

  To begin restoring a cluster either:

  - Hover over the :guilabel:`Active` status of the cluster and click
    :guilabel:`Restore or Download` *or*

  - From the :icon:`ellipsis-h` menu next to the cluster select
    :guilabel:`Restore`.

---
stepnum: 3
level: 4
title: "Select the restore point."
ref: select-shard-pit
content: |

  a. Choose the point from which you want to restore your backup.

     .. list-table::
        :widths: 20 40 40
        :header-rows: 1

        * - Restore Type

          - Description

          - Action

        * - :guilabel:`Snapshot`

          - Allows you to choose one stored snapshot.

          - Select an existing snapshot to restore.

        * - :guilabel:`Point In Time`

          - Creates a custom snapshot that includes all operations up
            to but not including the selected time. By default, the
            Oplog Store stores 24 hours of data.

            For example, if you select ``12:00``, the last operation in the
            restore is ``11:59:59`` or earlier. 

            :gold:`IMPORTANT:` Consider the following 
            {+PIT-Restore+} Timeframe Limits: 

            - You cannot perform a {+pit-restore+} that covers any
              time prior to the latest backup resync.

            - For sharded clusters running |fcv| 4.0 or earlier, you
              must enable cluster checkpoints to perform a |pit|
              restore on a sharded cluster. If no checkpoints that
              include your date and time are available, |service|
              asks you to :guilabel:`choose another point in time`.

            - For sharded clusters running |fcv| 4.2 or later, you
              can restore from any point in time within the duration
              of the oplog.

          - Select a :guilabel:`Date` and :guilabel:`Time`.

        * - :guilabel:`Oplog Timestamp`

          - :gold:`IMPORTANT:` You can't choose :guilabel:`Oplog Timestamp` for
            Sharded Clusters running |fcv| 4.0 or earlier. You can only choose 
            :guilabel:`Oplog Timestamp` as the backup point objective for
            Replica Sets and Sharded Clusters running |fcv| 4.2.

            Creates a custom snapshot that includes all operations up
            to and including the entered Oplog timestamp. The Oplog
            Timestamp is represented as two fields:

            .. list-table::
               :widths: 20 80

               * - :guilabel:`Timestamp`
                 - |epoch-time|

               * - :guilabel:`Increment`
                 - Order of operation applied in that second as a
                   32-bit ordinal.

          - Type an Oplog :guilabel:`Timestamp` and
            :guilabel:`Increment`.

            Run a query against :data:`local.oplog.rs` on your
            replica set to find the desired timestamp.

  b. Click :guilabel:`Next`.

  .. Cannot go under Step 3a because it generates this error:
  .. WARNING: The "topic" directive may not be used within topics or
  .. body elements.

  .. include:: /includes/fact-find-latest-oplog-entry.rst

---
title: "Choose to restore the files to another cluster."
stepnum: 4
level: 4
ref: select-restore-method
content: |

  a. Click :guilabel:`Choose Cluster to Restore to`.

  b. Complete the following fields:

     .. list-table::
        :widths: 30 70
        :header-rows: 1

        * - Field
          - Action

        * - :guilabel:`Project`
          - Select a project to which you want to restore the
            snapshot.

        * - :guilabel:`Cluster to Restore to`
          - Select a cluster to which you want to restore
            the snapshot.

            |service| *must* manage the target replica set.

            :red:`WARNING:` Automation removes all existing data from the
            cluster. All backup data and snapshots for the
            existing cluster are preserved.

  b. Click :guilabel:`Restore`.

     |service| notes how much storage space the restore requires.
---
title: "Click :guilabel:`Restore`."
stepnum: 5
level: 4
ref: click-restore
---
title: "Use your preferred archive utility to extract the archive and access the data files."
level: 4
ref: extract-archive
content: |

  |service| compresses the snapshot into a ``.tar.gz`` file. This
  archive includes the snapshot and the |mongod| logs.

  a. Extract the files in the archive.

     .. example::

        The following command uses the ``tar`` utility to extract a ``tar``archive with ``gzip`` compression.

        .. code-block:: shell

           tar -xvzf ~/Downloads/mongodb-snapshots/my-cluster-snapshot.tar.gz

  #. Access the data files by starting a :binary:`~bin.mongod` instance 
     on the host and pointing it at the extract directory using the
     :option:`--dbpath <mongod.--dbpath>` option. To learn more, see
     :manual:`Start mongod Processes 
     </tutorial/manage-mongodb-processes/#start-mongod-processes>`.

     .. example::

        The following command starts a :binary:`~bin.mongod` instance using
        the extracted data file directory:

        .. code-block:: shell

           mongod --dbpath ~/Downloads/mongodb-snapshots/my-cluster-snapshot/
  
...
