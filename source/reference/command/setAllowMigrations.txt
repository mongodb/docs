==================
setAllowMigrations
==================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Definition
----------

.. dbcommand:: setAllowMigrations

   .. versionadded:: 5.1.2
   
   Prevents the start of new :ref:`automatic migrations 
   <sharding-chunk-migration-automatic>` on a collection, prevents 
   in-flight :ref:`manual migrations <sharding-chunk-migration-manual>` 
   from committing, and excludes the collection from new balancer 
   rounds.

   The command has the following syntax:

   .. code-block:: javascript

      db.adminCommand( {
        setAllowMigrations: "<db>.<collection>", 
        allowMigrations: <true|false>
      } )

   The command takes the following parameters:

   .. list-table::
      :header-rows: 1
      :widths: 20 20 60

      * - Field
        - Type
        - Description

      * - :ref:`setAllowMigrations <setAllowMigrations-cmd-coll>`

        - ``string``
        
        - .. _setAllowMigrations-cmd-coll:
          
          The collection to modify.

      * - :ref:`allowMigrations <setAllowMigrations-cmd-flag>`

        - ``boolean``

        - .. _setAllowMigrations-cmd-flag:
        
          If ``false``:

          - MongoDB prevents new :ref:`automatic migrations 
            <sharding-chunk-migration-automatic>` on the collection
          - in-flight :ref:`manual migrations 
            <sharding-chunk-migration-manual>` will not be committed
          - the collection will be excluded from new balancer rounds

          If ``true``: 
          
          - MongoDB allows new :ref:`automatic migrations 
            <sharding-chunk-migration-automatic>` on the collection
          - in-flight :ref:`manual migrations 
            <sharding-chunk-migration-manual>` will be committed
          - the collection will be included in new balancer rounds

Behavior
--------

:dbcommand:`setAllowMigrations` requires the same privileges as 
:authaction:`moveChunk`.

Example
-------

This operation prevents migrations on the ``store.inventory``
collection:

.. code-block:: javascript

   db.adminCommand( {
      setAllowMigrations: "store.inventory",
      allowMigrations: false
   } )
