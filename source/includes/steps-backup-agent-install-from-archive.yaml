title: "Log in to the |application|."
stepnum: 1
ref: login
---
title: "Navigate to Agent Downloads."
stepnum: 2
ref: downloads-and-settings
content: |

  a. Click :guilabel:`Deployment`.
  #. Click :guilabel:`Agents`.
  #. Click :guilabel:`Downloads & Settings`.

  .. tabs::

     hidden: true

     tabs:
       - id: rhel-centos-suse
         name: RHEL/CentOS/SUSE (x86_64)
         content: |

           c. Click :guilabel:`RHEL/CentOS 7.X, SUSE12 - TAR`.

       - id: rhel-centos-power
         name: RHEL/CentOS (ppc64le)
         content: |

           c. Click :guilabel:`RHEL/CentOS 7.X Power (ppc64le) - TAR`.

       - id: ubuntu-power
         name: Ubuntu (ppc64le)
         content: |

           c. Click :guilabel:`Ubuntu 16.X Power (ppc64le) - TAR`.

       - id: other
         name: Other Linux
         content: |

           c. Click :guilabel:`Other Linux - TAR`.
---
title: "Download the latest version of the Backup Agent archive."
stepnum: 3
edition:
  - cloud
ref: download-saas
content: |

  From a system shell on the host that will run the Backup Agent, issue
  a ``curl`` command to download the archive for your platform:
  
  .. tabs::

     hidden: true

     tabs:
       - id: rhel-centos-suse
         name: RHEL/CentOS/SUSE (x86_64)
         content: |

           .. code-block:: shell

              curl -OL https://cloud.mongodb.com/download/agent/backup/mongodb-mms-backup-agent-{+bagent-version+}.rhel7_x86_64.tar.gz

       - id: rhel-centos-power
         name: RHEL/CentOS (ppc64le)
         content: |

           .. code-block:: shell

              curl -OL https://cloud.mongodb.com/download/agent/backup/mongodb-mms-backup-agent-{+bagent-version+}.rhel7_ppc64le.tar.gz

       - id: ubuntu-power
         name: Ubuntu (ppc64le)
         content: |

           .. code-block:: shell
              
              curl -OL https://cloud.mongodb.com/download/agent/backup/mongodb-mms-backup-agent-{+bagent-version+}.ubuntu1604_ppc64le.tar.gz

       - id: other
         name: Other Linux
         content: |

           .. code-block:: shell

              curl -OL https://cloud.mongodb.com/download/agent/backup/mongodb-mms-backup-agent-{+bagent-version+}.linux_x86_64.tar.gz

---
title: "Download the latest version of the Backup Agent archive."
stepnum: 3
edition:
  - onprem
ref: download-hosted
content: |

  From a system shell on the host that will run the Backup Agent, issue
  a ``curl`` command to download the archive for your platform:
  
  .. tabs::

     hidden: true

     tabs:
       - id: rhel-centos-suse
         name: RHEL/CentOS/SUSE (x86_64)
         content: |

           .. code-block:: shell

              curl -OL https://{+opsmgr-url+}/download/agent/backup/mongodb-mms-backup-agent-{+bagent-version+}.rhel7_x86_64.tar.gz

       - id: rhel-centos-power
         name: RHEL/CentOS (ppc64le)
         content: |

           .. code-block:: shell

              curl -OL https://{+opsmgr-url+}/download/agent/backup/mongodb-mms-backup-agent-{+bagent-version+}.rhel7_ppc64le.tar.gz

       - id: ubuntu-power
         name: Ubuntu (ppc64le)
         content: |

           .. code-block:: shell
              
              curl -OL https://{+opsmgr-url+}/download/agent/backup/mongodb-mms-backup-agent-{+bagent-version+}.ubuntu1604_ppc64le.tar.gz

       - id: other
         name: Other Linux
         content: |

           .. code-block:: shell

              curl -OL https://{+opsmgr-url+}/download/agent/backup/mongodb-mms-backup-agent-{+bagent-version+}.linux_x86_64.tar.gz

post: |

  .. note::

     Replace ``{+opsmgr-url+}`` with the hostname and port of your
     |application|.

---
title: "Extract the Backup Agent."
stepnum: 4
ref: extract
content: |

  You can install the Backup Agent in any directory. You can move
  the archive to another directory before extracting.

  .. tabs::

     hidden: true

     tabs:
       - id: rhel-centos-suse
         name: RHEL/CentOS/SUSE
         content: |

           .. code-block:: shell

              tar -xvzf mongodb-mms-backup-agent-{bagent-version}.rhel7_x86_64.tar.gz

       - id: rhel-centos-power
         name: RHEL/CentOS (ppc64le)
         content: |

           .. code-block:: shell
              
              tar -xvzf mongodb-mms-backup-agent-{bagent-version}.rhel7_ppc641e.tar.gz

       - id: ubuntu-power
         name: Ubuntu (ppc64le)
         content: |

           .. code-block:: shell
              
              tar -xvzf mongodb-mms-backup-agent-{bagent-version}.ppc64le.ubuntu1604.tar.gz

       - id: other
         name: Other Linux
         content: |

           .. code-block:: shell

              tar -xvzf mongodb-mms-backup-agent-{bagent-version}.linux_x86_64.tar.gz

post: |

  When the command completes, the Backup Agent is installed.

---
title: "Change into the extracted binary directory."
stepnum: 5
ref: change-directory
content: |

  Change into the directory that was created after extracting the
  Backup Agent binary:

  .. tabs::

     hidden: true

     tabs:
       - id: rhel-centos-suse
         name: RHEL/CentOS/SUSE (x86_64)
         content: |

           .. code-block:: shell

              cd mongodb-mms-backup-agent-{+bagent-version+}.rhel7_x86_64

       - id: rhel-centos-power
         name: RHEL/CentOS (ppc64le)
         content: |

           .. code-block:: shell

              cd mongodb-mms-backup-agent-{+bagent-version+}.rhel7_ppc64le

       - id: ubuntu-power
         name: Ubuntu (ppc64le)
         content: |

           .. code-block:: shell
              
              cd mongodb-mms-backup-agent-{+bagent-version+}.ubuntu1604_ppc64le

       - id: other
         name: Other Linux
         content: |

           .. code-block:: shell

              cd mongodb-mms-backup-agent-{+bagent-version+}.linux_x86_64
---
title: "Edit the ``local.config`` file."
stepnum: 6
ref: configure-backup-mms-api-key
content: |

  In the directory where you installed the Backup Agent, edit the
  ``local.config`` file.

  Update the following configuration keys:

  .. list-table::
     :header-rows: 1
     :widths: 20 80

     * - Key
       - Change
     * - ``mmsGroupId``
       - Set to your ``ProjectID``.
     * - ``mmsApiKey``
       - Set to the project's :term:`agent API key`.
     * - ``mothership``
       - Set to the Backup Server |url| displayed in the modal.

---
stepnum: 7
source:
  file: steps-source-install-agent.yaml
  ref: proxy
replacement:
  agentname: "Backup"
  httpProxy: ":bsetting:`httpProxy`"
  configfile: "<install-directory>/local.config"
---
stepnum: 8
title: "Start the Backup Agent."
ref: start-backup
action:
  pre: |
    Issue the following command:
  language: sh
  code: |
    nohup ./mongodb-mms-backup-agent \
      --config=local.config \
      >> backup-agent.log 2>&1 &
...
