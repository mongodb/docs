.. This page is hidden from the TOC and from Google/Marian search indexing.

:orphan:

.. meta::
   :robots: noindex, nosnippet

.. _pa-autopilot:

======================================
Autopilot Mode for Performance Advisor
======================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Autopilot mode for Performance Advisor periodically checks for index
recommendations and automatically creates indexes deemed to have a high
impact on cluster performance.

.. _autopilot-limitations:

Autopilot Mode Availability
---------------------------

You can enable autopilot mode for your cluster if all of
the following criteria are met:

- Your cluster is running MongoDB 4.4.

- Your cluster is between tiers ``M10`` and ``M30`` (inclusive).

- Your cluster is **not** a sharded cluster.

How Autopilot Mode Creates Indexes
----------------------------------

Autopilot mode prioritizes creating indexes with the highest
:guilabel:`Impact` score. :guilabel:`Impact` is the estimated
performance improvement that the index would bring. To learn more about
the :guilabel:`Impact` score and how the Performance Advisor ranks
indexes, see :ref:`pa-index-ranking`.

Performance Advisor does not show individual index recommendations by
default. Instead, Performance Advisor shows the number of index
recommendations per impact level (high and medium). To view the
individual indexes that the autopilot would create, click
:guilabel:`View Recommendations`. Only high impact indexes are
created automatically.

Enable Autopilot Mode
---------------------

Autopilot mode is off by default. You can enable autopilot mode for
your cluster through either the |service| UI or |service| |api|.

.. tabs::

   tabs:
     - id: ui
       name: Atlas UI
       content: |

         To enable autopilot mode for your cluster:

         1. Open :guilabel:`Performance Advisor`.

         #. In the :guilabel:`Create Indexes` panel, toggle
            :guilabel:`Autopilot Mode` to on.

         Alternatively, if you click :guilabel:`View Recommendations`, you can
         enable autopilot mode from the individual recommendations view.

         Once you enable autopilot mode, |service| immediately begins creating
         high impact indexes if they are suggested.

     - id: api
       name: Atlas API
       content: |

         To create a new cluster with autopilot mode enabled, submit a
         request to the :ref:`Create One Cluster
         <create-one-cluster-ref>` endpoint.

         To enable autopilot mode on an existing cluster, submit a
         request to the :ref:`Modify One Cluster
         <modify-one-cluster-ref>` endpoint.

         The request body must set the
         ``autoScaling.autoIndexingEnabled`` field to ``true``.

         The following example request creates a new single region
         cluster with autopilot mode enabled:

         .. code-block:: sh
            :emphasize-lines: 8-11

            curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" --digest \
            --header "Content-Type: application/json" \
            --include \
            --request POST "https://cloud.mongodb.com/api/atlas/v1.0/groups/{GROUP-ID}/clusters?pretty=true" \
            --data '
               {
                  "name": "SingleRegionCluster",
                  "autoScaling": {
                     "autoIndexingEnabled": true
                  }
                  "diskSizeGB": 100,
                  "numShards": 1,
                  "providerSettings": {
                  "providerName": "AWS",
                  "diskIOPS": 300,
                  "instanceSizeName": "M40",
                  "regionName": "US_EAST_1"
                  },
                  "clusterType" : "REPLICASET",
                  "replicationFactor": 3,
                  "replicationSpecs": [{
                  "numShards": 1,
                  "regionsConfig": {
                     "US_EAST_1": {
                        "analyticsNodes": 0,
                        "electableNodes": 3,
                        "priority": 7,
                        "readOnlyNodes": 0
                     }
                  },
                  "zoneName": "Zone 1"
                  }],
                  "backupEnabled": false,
                  "providerBackupEnabled" : true,
                  "autoScaling": {
                  "diskGBEnabled": true
                  }
               }'

Review Automatically Created Indexes
------------------------------------

|service| sends an email alert when an index is automatically created.
You can view automatically created indexes from the Data Explorer
:ref:`Indexes <data-explorer-indexes>` view. Data Explorer shows indexes
created by autopilot mode with the :guilabel:`Auto-Created` property.

Drop Automatically Created Indexes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

You can drop auto-created indexes as you would any other index. To drop
an auto-created index, click the :guilabel:`Drop Index` button. If you
drop an auto-created index, autopilot mode will not recreate that index.
However, that index may still appear as a recommendation in the
Performance Advisor.
