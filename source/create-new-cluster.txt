.. _create-new-cluster:

================
Create a Cluster
================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

|service|-managed MongoDB deployments, or "clusters", can be either a
:term:`replica set` or a :term:`sharded cluster`.

.. include:: /includes/fact-free-tier-paid-tier.rst

Create a Cluster
----------------

Before creating a cluster, check that you have the correct organization and
project selected. Click the :guilabel:`Context` drop down in the top left
corner to select a specific organization or project. For more information on
creating and managing organizations and projects, see
:doc:`/tutorial/manage-organizations` and :doc:`/tutorial/manage-projects`.

.. include:: /includes/extracts/fact-vpc-per-project.rst

|service| Configuration Options
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::

   * - :ref:`Cluster Name <create-cluster-name>`

     - The name of your cluster

   * - :ref:`MongoDB Version <create-cluster-version>`

     - The MongoDB version of the cluster

   * - :ref:`Cloud Provider and Region <create-cluster-cloud-provider-region>`

     - The Cloud Provider and region where |service| deploys cluster.

       For clusters with :guilabel:`Instance Size` of ``M10`` or greater, you
       can specify additional regions to distribute your cluster across for
       high availability or local reads.

   * - :ref:`Instance Size <create-cluster-instance>`

     - The instance size of the cluster.

   * - :ref:`Replication Factor <create-cluster-replication>`

     - The number of replica set nodes in the cluster. For sharded clusters,
       the number of replica set nodes in each shard.

       Only available for clusters with an :guilabel:`Instance Size` of
       ``M10`` or larger. Clusters with an :guilabel:`Instance Size` smaller
       than ``M10`` have a fixed replication factor of 3

   * - :ref:`Do you want a sharded cluster? <create-cluster-sharding>`

     - Deploys a sharded cluster. Only available for clusters with an
       :guilabel:`Instance Size` of ``M10`` or larger.

   * - :ref:`Number of shards <scale-cluster-shardNum>`

     - Configure the number of shards in the sharded cluster. This field
       appears only if the deployment is a sharded cluster.

   * - :ref:`Do you want to enable backup? <create-cluster-backups>`

     - Enables backup for the cluster. Only available for clusters with an
       :guilabel:`Instance Size` of ``M10`` or larger.

   * - :ref:`Admin Username & Password <create-cluster-security>`

     - Create the MongoDB administrative user for the cluster. Only visible if
       no other MongoDB users exist for the |service| project.

   * - :ref:`Enter your payment information and deploy <create-cluster-payment>`

     - Enter your payment information and deploy your cluster.

   * - :ref:`Connect to your cluster <create-cluster-connect>`

     - Connect to your new cluster.

Walkthrough
~~~~~~~~~~~

The following sections provide a walkthrough of the cluster creation process,
as well as complete documentation for each of the |service| cluster
configuration options.

.. _create-cluster-open-dialog:

A. Open the :guilabel:`Build Your New Cluster` modal
++++++++++++++++++++++++++++++++++++++++++++++++++++

.. container:: admonition

   Go to the :guilabel:`Clusters` view and click the :guilabel:`Add New
   Cluster` or :guilabel:`Build a New Cluster` button to display the
   :guilabel:`Build Your New Cluster` modal. As you build your cluster,
   |service| displays the associated costs.

.. _create-cluster-name:

B. Enter the :guilabel:`Cluster Name`
+++++++++++++++++++++++++++++++++++++

.. container:: admonition

   This is the cluster name as it appears in |service|. You cannot change the
   cluster name once |service| deploys the cluster.

.. _create-cluster-version:

C. Select the :guilabel:`MongoDB Version` of the cluster
++++++++++++++++++++++++++++++++++++++++++++++++++++++++

.. container:: admonition

   The MongoDB version [#version]_ for your cluster. |service| always deploys
   the cluster with the latest stable release of the specified version.

   .. include:: /includes/extracts/fact-mongodb-version-create-a-cluster.rst

.. _create-cluster-cloud-provider-region:

D. Select the :guilabel:`Cloud Provider and Region` of the cluster
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

.. container:: admonition

   The cloud provider and region, or physical location, of your MongoDB
   cluster. The choice of cloud provider and region affects the configuration
   options for the available instance sizes, network latency for clients
   accessing your cluster, and the :doc:`cost of running the cluster
   </billing>`.

   .. include:: /includes/extracts/cluster-option-clusterProviderRegionOnly.rst

.. _create-cluster-instance:

E. Select the :guilabel:`Instance Size` of the cluster
++++++++++++++++++++++++++++++++++++++++++++++++++++++

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterInstance.rst

   .. admonition:: Free Tier
      :class: note

      To deploy a |service| ``M0`` Free Tier cluster, you must select the
      ``M0`` instance size. If the ``M0`` option is greyed out, check that:

      - The :guilabel:`MongoDB Version` is ``MongoDB 3.4 with Wired Tiger``,
      - The :guilabel:`Cloud Provider` is ``Amazon Web Services``,
      - The :guilabel:`Region` is ``N. Virginia (us-east-1)``, and
      - There is not already an ``M0`` Free Tier cluster in the |service| project.

.. _create-cluster-replication:

F. Select the replication factor of the cluster
+++++++++++++++++++++++++++++++++++++++++++++++

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterReplication.rst

.. _create-cluster-sharding:

G. Deploy a sharded cluster
+++++++++++++++++++++++++++

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterSharding.rst

.. _create-cluster-shardNum:

H. Configure the number of shards
+++++++++++++++++++++++++++++++++

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterShardingNum.rst

.. _create-cluster-backups:

H. Enable Backup for the cluster
++++++++++++++++++++++++++++++++

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterBackup.rst

.. _create-cluster-security:

I. Configure your MongoDB :guilabel:`Admin Username & Password`
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

.. container:: admonition

   .. include:: /includes/extracts/cluster-option-clusterSecurity.rst

.. _create-cluster-payment:

J. Enter your payment information
+++++++++++++++++++++++++++++++++

.. container:: admonition

   Click :guilabel:`Confirm & Deploy` to enter payment information. For
   |service| ``M0`` Free Tier cluster, |service| does not require payment
   information to deploy the cluster.

.. _create-cluster-connect:

K. Connect to your cluster
++++++++++++++++++++++++++

.. container:: admonition

   Once |service| deploys your cluster, click :guilabel:`Connect` on the
   cluster to open the :guilabel:`Connect` dialog. Follow the instructions to
   connect to your cluster. See :doc:`connect-to-cluster` for more information.


Terminate a Cluster
-------------------

To terminate an |service| cluster, do the following:

1. Click :guilabel:`Clusters`.

#. For the cluster you wish to terminate, click on the :guilabel:`...`
   button.

#. Click :guilabel:`Terminate`.

|service| executes the terminate operation after completing any in-progress
deployment changes.

|service| bills for the hours that the cluster was active. See :doc:`/billing`
for more information on |service| billing.

.. warning::

   Terminating a cluster also deletes any backup snapshots for that cluster.
   See :ref:`retention-policy`.


Next Steps
----------

To continue setting up the cluster, see:

- :doc:`Set up security </setup-cluster-security>`.

- :doc:`Connect to the cluster </connect-to-cluster>`.

To change the cluster configuration after deployment, see
:doc:`scale-cluster`.

.. seealso:: :doc:`/tutorial/view-all-clusters`

.. [#version]

   .. include:: /includes/note-enterprise-not-supported.rst

.. include:: /includes/footnote-databearing.rst
