===========================
Create a User Administrator
===========================

.. default-domain:: mongodb

Overview
--------

The user administrator controls the creation of users and assignment of
privileges. In keeping with the policy of :term:`least privilege`, this user
should have no authority outside user management. In a MongoDB deployment,
create the user administrator as the first user. Then let this user create all
other users.

To support creation of user administrators, MongoDB provides the
:authrole:`userAdmin` and :authrole:`userAdminAnyDatabase` roles, both of
which grant :ref:`actions <security-user-actions>` specific to user
management. A user with either of these roles can grant any privilege to any
user, including *itself*. The user administrator should have *no other roles*
and should only administer users and privileges.

The :authrole:`userAdmin` and :authrole:`userAdminAnyDatabase` roles confer
**no additional access** beyond user management. A user administrator cannot,
for example, read or write data without first conferring itself additional
privileges.

.. important:: The :authrole:`userAdminAnyDatabase` user can grant itself or
   any other user full access to the entire MongoDB instance. Carefully
   control the credentials to log in as this user.

.. _localhost-exception:

Localhost Exception
-------------------

The localhost exception lets you connect *with* administrative access to an
authentication-enabled :program:`mongod` or :program:`mongos` prior to
creating your first user on the ``admin`` database. The exception applies *if*
there are no users on the ``admin`` database.

To use the exception, connect to the :program:`mongod` or :program:`mongos`
from a client running on the same system.

The bypass exists to support bootstrapping new deployments. You can run the
:program:`mongod` or :program:`mongos` with authentication before creating
your first user.

To disable the localhost bypass, set the
:parameter:`enableLocalhostAuthBypass` parameter using :setting:`setParameter`
during startup:

.. code-block:: javascript

   mongod --setParameter enableLocalhostAuthBypass=0

Prerequisites
-------------

.. include:: /includes/access-create-user.rst

A user with either the :authrole:`userAdmin` or
:authrole:`userAdminAnyDatabase` role, or authenticated using the
:ref:`localhost exception <localhost-exception>`, has those actions.

Procedure
---------

.. include:: /includes/steps/add-user-administrator.rst
