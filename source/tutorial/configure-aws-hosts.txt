:orphan:

====================================
Optional: Configure Amazon AWS Hosts
====================================

Configure Storage for MongoDB
-----------------------------

*If you are not using AWS, skip this step and continue to the next
step.*

If using an AWS EBS volume for MongoDB storage, create and
attach the volume to your EC2 instance. Once the volume is
successfully attached, issue the following command to determine the
name of the new EBS volume: ::

   sudo fdisk -l

Create a filesystem on this volume using the name you found in the
previous, command, using the following form: ::

   sudo mkfs -t ext4 /dev/xvd<letter>

Replace ``<letter>`` with the identifier for the volume, as in the
following example: ::

   sudo mkfs -t ext4 /dev/xvdf

You only need to create a filesystem the first time you initiate
the drive.

Create a directory to use as the mount point: ::

   sudo mkdir /mnt/ebs-mount-dir

Mount the volume with a command that resembles the following: ::

   sudo mount /dev/xvd<letter> /mnt/ebs-mount-dir

Replace ``<letter>`` with the identifier for the volume, as in the
following example: ::

   sudo mount /dev/xvdf /mnt/ebs-mount-dir

Configure Linux Kernel Runtime Parameters
-----------------------------------------

Set Linux Kernel parameters. All users must complete this step to
ensure optimal performance. Begin by using the following commands
to change the parameters of running instance: ::

   sudo /sbin/sysctl -w net.core.netdev_max_backlog=30000
   sudo /sbin/sysctl -w net.core.wmem_max=16777216
   sudo /sbin/sysctl -w net.core.rmem_max=16777216

Edit the ``/etc/sysctl.conf`` file and append the lines below to
ensure that these parameters are always applied following a system
reboot: ::

   net.core.netdev_max_backlog = 30000
   net.core.wmem_max = 16777216
   net.core.rmem_max = 16777216
