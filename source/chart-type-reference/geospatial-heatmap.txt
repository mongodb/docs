==================
Geospatial Heatmap
==================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Overview
--------

Geospatial heatmap charts are useful for displaying how
geographical areas of a map compare to one another based on a given
criterion.

.. note::

   Heatmap charts can use a maximum of 10,000 documents. If you
   create a heatmap with a collection of more than 10,000
   documents, turn on :ref:`Sample Mode <charts-sample-mode>` or use a
   :ref:`filter <charts-filter-documents>`. Otherwise, your chart may
   use incomplete or misleading data.

To create a geospatial heatmap chart:

1. On the chart editing screen, select :guilabel:`Geospatial` from
   the :guilabel:`Chart Type` dropdown menu.

#. Select :guilabel:`Heatmap` from the three available geospatial
   chart types.

Encoding Channels
-----------------

Coordinates
~~~~~~~~~~~

A :guilabel:`geopoint` encoding channel which defines the map
area of the chart. See the :ref:`Geopoint <geopoint>` reference page
for more information about what types of data you can use in this
channel.

Intensity
~~~~~~~~~

.. include:: /includes/intensity-definition.rst

In geospatial heatmaps, values are aggregated within the radius
specified in the :doc:`customization </customize-charts>` tab.
Radius is measured in pixels, and defaults to ``30``. For example:
if ten data points exist within the specified radius, the color
displayed is based on the aggregated value of those ten data points.

.. note::

   Intensity shading is local to the map's current view. The most
   intense color is displayed for the most extreme aggregated values
   currently visible on the map, even if there are points outside the
   current view that are more extreme.

Example
-------

The following chart is based on AirBnB data for the Seattle area. It
shows rental rate hot spots in a geospatial heatmap.

.. figure:: /images/charts/seattle-airbnb-geospatial-heatmap.png
   :figwidth: 760px
   :alt: Geospatial heatmap example

The :guilabel:`Coordinates` channel uses the ``location`` database
field, which contains arrays of latitude-longitude pairs. The
:guilabel:`Intensity` field uses the ``monthly_price`` database field,
which contains monthly rental rates for each property in the database.
