.. facet::
   :name: programming_language
   :values: c, csharp, go, java, javascript/typescript, kotlin, php, python, ruby, scala, shell

.. include:: /includes/java-sync-links.rst
.. include:: /includes/java-async-links.rst

.. _read-operations-query-document:
.. _read-operations-queries:

===============
Query Documents
===============

.. meta::
   :description: MongoDB Manual: how to query documents and top-level fields, perform equality match, query with query operators, and specify compound query conditions.
   :keywords: code example, compass, java sync, java async, reactive streams, motor, atlas, drivers, node.js, kotlin coroutine

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1

.. dismissible-skills-card::
   :skill: Query Optimization
   :url: https://learn.mongodb.com/skills?openTab=query

To query documents, specify a :term:`query predicate` that indicates which
documents to return. An empty query predicate ``{ }`` returns all documents in the collection.

You can query documents in MongoDB with the following methods:

.. |atlas-ref| replace:: :ref:`query-documents-atlas-ui`

.. include:: /includes/fact-methods.rst

.. include:: /includes/language-selector-instructions.rst

.. tabs-selector:: drivers

.. |query_operations| replace:: query operations

.. include:: /includes/driver-examples/driver-example-query-intro.rst

.. include:: /includes/driver-examples/driver-example-query-6.rst

Select All Documents in a Collection
------------------------------------

.. include:: /includes/driver-examples/driver-example-query-find-method.rst

.. include:: /includes/driver-examples/driver-example-query-7.rst

This operation uses a query predicate of ``{}``, which corresponds to
the following SQL statement:

.. code-block:: sql

   SELECT * FROM inventory

.. tabs-drivers::

   tabs:
     - id: shell
       content: |
         For more information, see :method:`~db.collection.find()`.

     - id: compass
       content: |
         For more information, see :ref:`Query Bar <compass-query-bar>`.

     - id: c
       content: |
         For more information, see
         `mongoc_collection_find_with_opts <https://mongoc.org/libmongoc/current/mongoc_collection_find_with_opts.html>`__.
      
     - id: python
       content: |
         For more information, see
         :py:meth:`~pymongo.collection.Collection.find`.

     - id: motor
       content: |
         For more information, see
         :py:meth:`~pymongo.asynchronous.collection.AsyncCollection.find`.

     - id: java-sync
       content: |
         For more information, see
         com.mongodb.client.MongoCollection.find_.

     - id: java-async
       content: |
         For more information, see
         `com.mongodb.reactivestreams.client.MongoCollection.find
         <http://mongodb.github.io/mongo-java-driver-reactivestreams/1.6/javadoc/com/mongodb/reactivestreams/client/MongoCollection.html#find()>`_.

     - id: kotlin-coroutine
       content: |
         For more information, see
         `MongoCollection.find()
         <{+java-api-docs+}/mongodb-driver-kotlin-coroutine/mongodb-driver-kotlin-coroutine/com.mongodb.kotlin.client.coroutine/-mongo-collection/find.html>`__.

     - id: nodejs
       content: |
         For more information, see :node-api:`find() <Collection.html#find>`.

     - id: php
       content: |
         For more information, see
         :phpmethod:`find() <phpmethod.MongoDB\\Collection::find()>`.

     - id: ruby
       content: |
         For more information, see
         :ruby-api:`find()<Collection.html#find-instance_method>`.

     - id: scala
       content: |
         For more information, see
         :scala-api:`collection.find()<find[C](filter:org.mongodb.scala.bson.conversions.Bson)(implicite:org.mongodb.scala.bson.DefaultHelper.DefaultsTo[C,TResult],implicitct:scala.reflect.ClassTag[C]):org.mongodb.scala.FindObservable[C]>`.

     - id: csharp
       content: |
         For more information, see
         :csharp-api:`Find() <M_MongoDB_Driver_MongoCollection_1_Find>`.

     - id: go
       content: |
         For more information, see
         :go-api:`Collection.Find <mongo#Collection.Find>`.

.. _read-operations-query-argument:

Specify Equality Condition
--------------------------

.. include:: /includes/extracts/filter-equality.rst

The following example selects all documents from the ``inventory`` collection
where ``status`` equals ``"D"``:

.. include:: /includes/driver-examples/driver-example-query-9.rst

This operation uses a query predicate of ``{ status: "D" }``, which
corresponds to the following SQL statement:

.. code-block:: sql

   SELECT * FROM inventory WHERE status = "D"

Specify Conditions Using Query Operators
----------------------------------------

.. include:: /includes/extracts/filter-query-operators.rst

The following example retrieves all documents from the ``inventory``
collection where ``status`` equals either ``"A"`` or ``"D"``:

.. include:: /includes/driver-examples/driver-example-query-10.rst

.. note::

   Although you can use the :query:`$or` operator for this query,
   use the :query:`$in` operator instead of :query:`$or`
   when performing equality checks on the same field.

The operation uses a query predicate of
``{ status: { $in: [ "A", "D" ] } }``, which corresponds to the
following SQL statement:

.. code-block:: sql

   SELECT * FROM inventory WHERE status in ("A", "D")

For the complete list of MongoDB query operators, see
:ref:`query-predicates-ref`.

Specify ``AND`` Conditions
--------------------------

A compound query can specify conditions for more than one field in the
collection's documents. Implicitly, a logical ``AND`` conjunction
connects the clauses of a compound query so that the query selects the
documents in the collection that match all the conditions.

The following example retrieves all documents in the ``inventory``
collection where the ``status`` equals ``"A"`` **and** ``qty`` is less
than (:query:`$lt`) ``30``:

.. include:: /includes/driver-examples/driver-example-query-11.rst

The operation uses a query predicate of
``{ status: "A", qty: { $lt: 30 } }``, which corresponds to the
following SQL statement:

.. code-block:: sql

   SELECT * FROM inventory WHERE status = "A" AND qty < 30

See :ref:`comparison operators <query-selectors-comparison>` for other
MongoDB comparison operators.

Specify ``OR`` Conditions
--------------------------

Use the :query:`$or` operator to specify a compound query
that joins each clause with a logical ``OR`` conjunction. The
query selects documents that match at least one
condition.

The following example retrieves all documents in the collection where
the ``status`` equals ``"A"`` **or** ``qty`` is less than
(:query:`$lt`) ``30``:

.. include:: /includes/driver-examples/driver-example-query-12.rst

The operation uses a query predicate of
``{ $or: [ { status: 'A' }, { qty: { $lt: 30 } } ] }``, which
corresponds to the following SQL statement:

.. code-block:: sql

   SELECT * FROM inventory WHERE status = "A" OR qty < 30

.. note::

   Queries with :ref:`comparison operators
   <query-selectors-comparison>` are subject to :ref:`type-bracketing`.

Specify ``AND`` as well as ``OR`` Conditions
--------------------------------------------

In the following example, the compound query document selects all
documents in the collection where the ``status`` equals ``"A"``
**and** *either* ``qty`` is less than (:query:`$lt`) ``30`` *or*
``item`` starts with the character ``p``:

.. include:: /includes/driver-examples/driver-example-query-13.rst

The operation uses a query predicate of:

.. code-block:: javascript
   
   {
      status: 'A',
      $or: [
        { qty: { $lt: 30 } }, { item: { $regex: '^p' } }
      ]
   }
   
which corresponds to the following SQL statement:

.. code-block:: sql

   SELECT * FROM inventory WHERE status = "A" AND ( qty < 30 OR item LIKE "p%")

.. note::

   MongoDB supports regular expressions :query:`$regex` queries to
   perform string pattern matches.

.. _query-documents-atlas-ui:

Query Documents with {+atlas+}
------------------------------------------

This example uses the :atlas:`sample movies dataset 
</sample-data/sample-mflix/>`. To load the sample dataset 
into your {+atlas+} deployment, see :atlas:`Load Sample Data 
</sample-data/#std-label-load-sample-data>`.

To project fields for a query in {+atlas+}, follow these
steps:

.. procedure:: 
   :style: normal

   .. include:: /includes/atlas-nav/steps-db-deployments-page.rst

   .. step:: Navigate to the collection

      .. include:: /includes/steps-nav-atlas-sample-movies.rst

   .. step:: Specify the :guilabel:`Filter` field

      .. include:: /includes/steps-specify-query-filter.rst

      .. code-block:: javascript

         { year: 1924 }

   .. step:: Click :guilabel:`Apply`

      The query returns all documents
      in the ``sample_mflix.movies`` collection where the ``year``
      field matches ``1924``.

Additional Query Tutorials
--------------------------

For more query examples, see:

- :doc:`/tutorial/query-embedded-documents`
- :doc:`/tutorial/query-arrays`
- :doc:`/tutorial/query-array-of-documents`
- :doc:`/tutorial/project-fields-from-query-results`
- :doc:`/tutorial/query-for-null-fields`

Behavior
--------

Cursor
~~~~~~

.. tabs-drivers::

   tabs:
     - id: shell
       content: |
         The :method:`db.collection.find()` method
         returns a :doc:`cursor </tutorial/iterate-a-cursor>` to the matching
         documents.

     - id: compass
       content: |
         The :guilabel:`Find` operation opens a
         :doc:`cursor </tutorial/iterate-a-cursor>` to the matching
         documents of the collection based on the find query.

         For more information on sampling, see the
         :ref:`Compass FAQ <compass-faq>`.

     - id: c
       content: |
         The `mongoc_collection_find_with_opts <https://mongoc.org/libmongoc/current/mongoc_collection_find_with_opts.html>`__ 
         method returns a :doc:`cursor </tutorial/iterate-a-cursor>` to the
         matching documents.

     - id: python
       content: |
         The :py:meth:`pymongo.collection.Collection.find` method
         returns a :doc:`cursor </tutorial/iterate-a-cursor>` to the
         matching documents. See the PyMongo documentation for
         `iterating over a cursor <https://pymongo.readthedocs.io/en/stable/tutorial.html#querying-for-more-than-one-document>`__.

     - id: motor
       content: |
         The :py:meth:`pymongo.asynchronous.collection.AsyncCollection.find`
         method returns a :doc:`cursor </tutorial/iterate-a-cursor>` to the
         matching documents.

     - id: java-sync
       content: |
         The com.mongodb.client.MongoCollection.find_ method returns an
         instance of the com.mongodb.client.FindIterable_ interface.

     - id: java-async
       content: |
         `com.mongodb.reactivestreams.client.MongoCollection.find
         <http://mongodb.github.io/mongo-java-driver-reactivestreams/1.6/javadoc/com/mongodb/reactivestreams/client/MongoCollection.html#find()>`_
         returns an instance of the `com.mongodb.reactivestreams.client.FindPublisher <http://mongodb.github.io/mongo-java-driver-reactivestreams/1.6/javadoc/com/mongodb/reactivestreams/client/FindPublisher.html>`_
         interface.

     - id: kotlin-coroutine
       content: |
         The `MongoCollection.find()
         <{+java-api-docs+}/mongodb-driver-kotlin-coroutine/mongodb-driver-kotlin-coroutine/com.mongodb.kotlin.client.coroutine/-mongo-collection/find.html>`__ method returns an
         instance of the
         `FindFlow <{+java-api-docs+}/mongodb-driver-kotlin-coroutine/mongodb-driver-kotlin-coroutine/com.mongodb.kotlin.client.coroutine/-find-flow/index.html>`__
         class.

     - id: nodejs
       content: |
         The :node-api:`Collection.find() <Collection.html#find>` method
         returns a :node-api:`cursor <Cursor.html>`.

     - id: php
       content: |
         The :phpmethod:`MongoDB\\Collection::find() <phpmethod.MongoDB\\Collection::find()>`
         method returns a :doc:`cursor </tutorial/iterate-a-cursor>` to
         the matching documents. See the MongoDB PHP Library
         documentation for
         :ref:`iterating over a cursor <php-cursors-iterate>`.

     - id: ruby
       content: |
         The :ruby-api:`Mongo::Collection#find()<Collection.html#find-instance_method>`
         method returns a :ruby-api:`CollectionView<Collection/View.html>`,
         which is an ``Enumerable``. A :ruby-api:`Cursor<Cursor.html>` is
         created when the ``View`` is enumerated; for example, by calling
         ``#to_a()`` or ``#each()``. You can also get an ``Enumerator`` by calling
         ``#to_enum()`` on the ``View``. See the Ruby driver API documentation
         for `iterating over a cursor
         <https://www.mongodb.com/docs/ruby-driver/current/api/Mongo/Cursor.html#each-instance_method>`__.

     - id: scala
       content: |
         The :scala-api:`collection.find()<find[C](filter:org.mongodb.scala.bson.conversions.Bson)(implicite:org.mongodb.scala.bson.DefaultHelper.DefaultsTo[C,TResult],implicitct:scala.reflect.ClassTag[C]):org.mongodb.scala.FindObservable[C]>`
         method returns the find `Observable <http://mongodb.github.io/mongo-scala-driver/2.1/reference/observables/>`_.

     - id: csharp
       content: |
         The :csharp-api:`MongoCollection.Find() <M_MongoDB_Driver_MongoCollection_1_Find>`
         method returns a :doc:`cursor </tutorial/iterate-a-cursor>` to
         the matching documents. See the MongoDB C# driver
         documentation for `iterating over a cursor <https://www.mongodb.com/docs/drivers/csharp/v2.19/fundamentals/crud/read-operations/retrieve/#find-multiple-documents>`_.

     - id: go
       content: |

          The :go-api:`Collection.Find <mongo#Collection.Find>`
          function returns a :go-api:`Cursor <mongo#Cursor>` to the
          matching documents. See the :go-api:`Cursor <mongo#Cursor>`
          documentation for more information.

Concurrent Updates While Using a Cursor
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/fact-concurrent-updates-cursor.rst

Read Isolation
~~~~~~~~~~~~~~

For reads to :ref:`replica sets <replication>` and replica set
:ref:`shards <sharding-background>`, read concern lets clients choose an
isolation level for their reads. For more information, see
:doc:`/reference/read-concern`.

Query Result Format
~~~~~~~~~~~~~~~~~~~

When you run a find operation with a MongoDB driver or ``mongosh``,
MongoDB returns a :ref:`cursor <cursors>` that manages query results. Query
results are not returned as an array of documents.

To learn how to iterate through documents in a cursor, see your
:driver:`driver's documentation </>`. If you are using ``mongosh``, see
:ref:`read-operations-cursors`.

Additional Methods and Options
------------------------------

.. tabs-drivers::

   .. tab::
      :tabid: shell

      You can also read documents from a collection with:

      - The :method:`db.collection.findOne` method
      - The :pipeline:`$match` pipeline stage in an 
        :ref:`aggregation pipeline <aggregation-pipeline>`

      .. note::

         The :method:`db.collection.findOne()` method performs the same 
         operation as :method:`db.collection.find()` with a limit of 1.

   .. tab::
      :tabid: compass
      
      MongoDB Compass also accepts the 
      following query bar options:

      .. list-table::
        :widths: 25 75

        * - :compass:`Project </query/project>`
          - Specify which fields to return in the resulting data.

        * - :compass:`Sort </query/sort>`
          - Specify the sort order of the returned documents.

        * - :compass:`Skip </query/skip>`
          - Specify the first n-number of documents to skip before returning the result set.

        * - :compass:`Limit </query/limit>`
          - Specify the maximum number of documents to return.

   .. tab::
      :tabid: c

      You can also read documents from a collection with:

      - `mongoc_find_and_modify_opts_t <https://mongoc.org/libmongoc/current/mongoc_find_and_modify_opts_t.html>`__

   .. tab::
      :tabid: python

      You can also read documents from a collection with:

      - :py:meth:`pymongo.collection.Collection.find_one`
      - The :pipeline:`$match` pipeline stage in an 
        :ref:`aggregation pipeline <aggregation-pipeline>`. See the
        `PyMongo Aggregation Examples <https://pymongo.readthedocs.io/en/stable/examples/aggregation.html>`_.
        
      .. note::

         The :py:meth:`pymongo.collection.Collection.find_one`
         method performs the same operation as the 
         the :py:meth:`pymongo.collection.Collection.find` method
         with a limit of 1.

   .. tab::
      :tabid: motor

      You can also read documents from a collection with:

      - :py:meth:`pymongo.asynchronous.collection.AsyncCollection.find_one`
      - The :pipeline:`$match` pipeline stage in an 
        :ref:`aggregation pipeline <aggregation-pipeline>`
        
      .. note::

         The :py:meth:`pymongo.asynchronous.collection.AsyncCollection.find_one`
         method performs the same operation as
         :py:meth:`pymongo.asynchronous.collection.AsyncCollection.find`
         with a limit of 1.

   .. tab::
      :tabid: java-sync

      You can also read documents from a collection with the :pipeline:`$match`
      pipeline stage in an :ref:`aggregation pipeline <aggregation-pipeline>`. For more information, see the
      `Java Synchronous Driver Aggregation Examples`_.

   .. tab::
      :tabid: java-async
      
      You can also read documents from a collection with the :pipeline:`$match`
      pipeline stage in an :ref:`aggregation pipeline <aggregation-pipeline>`. For more information, see the
      `Java Asynchronous Driver Aggregation Examples`_.

   .. tab::
      :tabid: kotlin-coroutine

      You can also read documents from a collection with the :pipeline:`$match`
      pipeline stage in an :ref:`aggregation pipeline <aggregation-pipeline>`. For more information, see the
      :driver:`Kotlin Coroutine Driver Find Operation Examples
      </kotlin/coroutine/current/fundamentals/crud/read-operations/retrieve/>`.

   .. tab::
      :tabid: nodejs

      You can also read documents from a collection with:

      - :node-api:`Collection.findOne() <Collection.html#findOne>`
      - The :pipeline:`$match` pipeline stage in an 
        :ref:`aggregation pipeline <aggregation-pipeline>`. For more information, see the
        :node-docs:`aggregation tutorial<tutorials/aggregation/>`.
      
      .. note::

         The :node-api:`Collection.findOne() <Collection.html#findOne>`
         method performs the same operation as
         :node-api:`Collection.find() <Collection.html#find>`
         with a limit of 1.

   .. tab::
      :tabid: php

      You can also read documents from a collection with:

      - :phpmethod:`MongoDB\\Collection::findOne() <phpmethod.MongoDB\\Collection::findOne()>`
      - The :pipeline:`$match` pipeline stage in an 
        :ref:`aggregation pipeline <aggregation-pipeline>`. For more information, see the
        :ref:`aggregation example <php-aggregation>`.

      .. note::

         The :phpmethod:`MongoDB\\Collection::findOne() <phpmethod.MongoDB\\Collection::findOne()>`
         method performs the same operation as
         :phpmethod:`MongoDB\\Collection::find() <phpmethod.MongoDB\\Collection::find()>`
         with a limit of 1.

   .. tab::
      :tabid: ruby

      You can also read documents from a collection with the :pipeline:`$match`
      pipeline stage in an :ref:`aggregation pipeline <aggregation-pipeline>`. For more information, see the
      :ruby:`aggregation examples </tutorials/ruby-driver-aggregation/>`.

   .. tab::
      :tabid: scala

      You can also read documents from a collection with the :pipeline:`$match`
      pipeline stage in an :ref:`aggregation pipeline <aggregation-pipeline>`. For more information, see the
      :scala-api:`aggregate method <aggregate[C](pipeline:Seq[org.mongodb.scala.bson.conversions.Bson])(implicite:org.mongodb.scala.bson.DefaultHelper.DefaultsTo[C,TResult],implicitct:scala.reflect.ClassTag[C]):org.mongodb.scala.AggregateObservable[C]>`.

   .. tab::
      :tabid: csharp

      You can also read documents from a collection with:

      - :csharp-api:`MongoCollection.FindOne() <M_MongoDB_Driver_MongoCollection_1_FindOne_1>`
      - The :pipeline:`$match` pipeline stage in an 
        :ref:`aggregation pipeline <aggregation-pipeline>`. For more information, see the
        `LINQ documentation <https://www.mongodb.com/docs/drivers/csharp/current/fundamentals/linq/>`__.

      .. note::

         The :csharp-api:`MongoCollection.FindOne() <M_MongoDB_Driver_MongoCollection_1_FindOne_1>`
         method performs the same operation as
         :csharp-api:`MongoCollection.Find() <M_MongoDB_Driver_MongoCollection_1_Find>`
         with a limit of 1.

   .. tab::
      :tabid: go

      You can also read documents from a collection with:

      - :go-api:`Collection.FindOne <mongo#Collection.FindOne>`
      - The :pipeline:`$match` pipeline stage in an 
        :ref:`aggregation pipeline <aggregation-pipeline>`. For more information, see
        :go-api:`Collection.Aggregate<mongo#Collection.Aggregate>`.

.. toctree::
   :titlesonly:
   :hidden:

   Embedded Documents </tutorial/query-embedded-documents>
   Arrays </tutorial/query-arrays>
   Arrays of Embedded Documents </tutorial/query-array-of-documents>
   Project Results </tutorial/project-fields-from-query-results>
   Null or Missing Fields </tutorial/query-for-null-fields>
   Timeouts </tutorial/query-documents/specify-query-timeout>
   Long-Running Snapshots </tutorial/long-running-queries>
