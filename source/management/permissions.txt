===========================
Authentication Requirements
===========================

.. contents:: Settings Page
   :backlinks: none
   :local:

.. default-domain:: mongodb

If authentication is enabled, |mms| requires elevated privileges to collect
complete data from MongoDB 2.4 instances. If authentication is not enabled on
your MongoDB instance, this requirement does not apply.

All user accounts must be defined on the admin database.

.. only:: saas

   .. include:: /includes/fact-auth-backup-requirements.rst

MMS Monitoring
~~~~~~~~~~~~~~

MMS uses a monitoring agent to provide periodic status for hosted and on prem
MongoDB databases.

Basic MMS monitoring requires authenticated users to have these roles:

- :authrole:`clusterAdmin`
- :authrole:`readAnyDatabase`

To create a user account on the admin database for MMS monitoring, use an
operation that resembles the following example:

.. code-block:: javascript

   use admin
   db.addUser( { user: "agent",
                 pwd: "Moon1234",
                 roles: [ "clusterAdmin",
                          "readAnyDatabase"
                        ]
               } )

MMS Monitoring with Database Profiling
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:ref:`Profiling <database-profiler>` captures in-progress read and write
operations, cursor operations, and database command information about the
database.

MMS monitoring with database profiling requires authenticated users to have
these roles:

- :authrole:`clusterAdmin`
- :authrole:`readAnyDatabase`
- :authrole:`dbAdminAnyDatabase`

To create a user account on the admin database for MMS monitoring with database
profiling, use an operation that resembles the following example:

.. code-block:: javascript

   use admin
   db.addUser( { user: "agent",
                 pwd: "Moon1234",
                 roles: [ "clusterAdmin",
                          "readAnyDatabase",
                          "dbAdminAnyDatabase"
                        ]
               } )

MMS Monitoring *without* ``dbStats``
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Monitoring without :dbcommand:`dbStats` will generate monitoring statistics
without database storage, records, indexes, and other statistics.

MMS monitoring *without* database profiling requires authenticated users to
have the :authrole:`clusterAdmin` role.

To create a user account on the admin database for MMS monitoring *without*
``dbstats``, use an operation that resembles the following example:

.. code-block:: javascript

   use admin
   db.addUser( { user: "agent",
                 pwd: "Moon1234",
                 roles: [ "clusterAdmin"
                        ]
               } )

MMS Backup
~~~~~~~~~~

MMS backup requires authenticated users to have these roles:

- :authrole:`clusterAdmin`
- :authrole:`readAnyDatabase`
- :authrole:`userAdminAnyDatabase`

To create a user account on the admin database for a hosted MongoDB deployment,
use an operation that resembles the following example:

.. code-block:: javascript

   use admin
   db.addUser( { user: "agent",
                 pwd: "Moon1234",
                 roles: [ "clusterAdmin",
                          "readAnyDatabase",
                          "userAdminAnyDatabase"
                        ]
                 } )
