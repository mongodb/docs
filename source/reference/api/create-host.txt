=============
Create a Host
=============

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. include:: /includes/fact-groups-projects-synonyms.rst

.. only:: cloud

    .. include:: /includes/api-cm-base-url.rst

.. only:: onprem

    .. include:: /includes/api-ops-base-url.rst

Start monitoring a new MongoDB process. The Monitoring Agent will start
monitoring the MongoDB process on the hostname and port you specify. |mms|
knows only the information that you provided. Thus, the document returned
in the response document will include blank values while |mms| discovers
the missing values.

Syntax
------

.. code-block:: none

   POST /api/public/v1.0/groups/{GROUP-ID}/hosts

Request Path Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :header-rows: 1

   * - Parameter
     - Required/Optional
     - Description

   * - ``groupId``
     - Required
     - ID of the group that owns this MongoDB process.

Request Query Parameters
~~~~~~~~~~~~~~~~~~~~~~~~

This endpoint does not use HTTP request query parameters.

Request Body Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
      :widths: 10 10 80
      :header-rows: 1

      * - Name
        - Type
        - Description

      * - ``hostname``
        - string
        - Primary hostname. A MongoDB process typically has several aliases, so the primary is
          the best available name as decided by |mms|.

      * - ``port``
        - number
        - Port that MongoDB process (``mongod`` or ``mongos``) listens on.

      * - ``username``
        - string
        - Username for connecting to this MongoDB process. Only present when the
          ``authMechanismName`` is ``MONGODB_CR``.

      * - ``password``
        - string
        - Password for connecting to this MongoDB process. If the process's ``authMechanismName``
          is ``MONGODB_CR``, then you must include this field when creating the
          process or updating its credentials. However, it will never be exposed when
          a host entity is returned.

      * - ``sslEnabled``
        - boolean
        - Is SSL enabled for this MongoDB process? Must be ``true`` if the
          ``authMechanismName`` is ``MONGODB_X509``.

      * - ``logsEnabled``
        - boolean
        - Is |mms| collecting logs for this MongoDB process?

      * - ``alertsEnabled``
        - boolean
        - Are alerts enabled for this MongoDB process?

      * - ``profilerEnabled``
        - boolean
        - Is |mms| collecting profile information from this MongoDB process?

      * - ``muninPort``
        - number
        - What port should be used to collect Munin stats from this MongoDB process?

      * - ``authMechanismName``
        - string
        - The authentication mechanism used to connect to this MongoDB process. Possible values
          are:
          
          .. include:: /includes/possibleValues-api-authMechanismName.rst

Response Elements
-----------------

.. include:: /includes/extracts/api-hosts-response-elements.rst

Example Request
---------------

.. only:: cloud

   .. code-block:: none

      curl -u "username:apiKey" -H "Content-Type: application/json" --digest -X POST "https://cloud.mongodb.com/api/public/v1.0/groups/5196d3628d022db4cbc26d9e/hosts" --data '
      {
        "hostname": "localhost",
        "port": 27017
      }'

.. only:: onprem

   .. code-block:: none

      curl -u "username:apiKey" -H "Content-Type: application/json" --digest -X POST "https://<ops-manager-host>/api/public/v1.0/groups/5196d3628d022db4cbc26d9e/hosts" --data '
      {
        "hostname": "localhost",
        "port": 27017
      }'

Example Response
----------------

.. code-block:: none

   HTTP/1.1 201 Created

   {
     "id" : "4059580c20c4581872ef24d0b8f5dca0",
     "groupId" : "5196d3628d022db4cbc26d9e",
     "hostname" : "localhost",
     "port" : 27017,
     "hasStartupWarnings" : false,
     "sslEnabled" : false,
     "logsEnabled" : false,
     "created" : "2014-04-22T19:56:50Z",
     "hostEnabled" : true,
     "journalingEnabled" : false,
     "alertsEnabled" : true,
     "hidden" : false,
     "muninEnabled" : false,
     "profilerEnabled" : false,
     "lowUlimit" : false,
     "authMechanismName" : "NONE",
     "links" : [ ... ]
   }
