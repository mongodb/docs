==========================================
Install the Monitoring Agent on UNIX/Linux
==========================================

.. contents::
   :local:
   :backlinks: none


.. index:: requirements; full
.. _mms-requirements:

.. only:: html

   Consider the following screencast of the MMS Agent installation process.

   .. raw:: html

      <iframe width="420" height="315" src="//www.youtube.com/embed/5qdK0F1f4jw" frameborder="0" allowfullscreen></iframe>

.. only:: latex

   Consider the `screencast of the MMS Agent installation process
   <http://www.youtube.com/watch?v=5qdK0F1f4jw>`_.

Process
-------

1. Install Monitoring agent :ref:`requirements <requirements-agent-linux>`.

   - ``setuptools`` to install Python packages.
   - ``pymongo``, the Python driver for MongoDB that the agent depends
     upon.

2. :ref:`Download and install the Monitoring agent <download-monitoring-agent-linux>`.

3. :ref:`Start the Monitoring agent <start-mms-agent-linux>`

4. :doc:`Configure hosts in MMS </monitoring/tutorial/monitor-hosts-with-mms>`.

.. _requirements-agent-linux:

Requirements
------------

.. start-requirements-content

The |monitoring| agent has several requirements and
prerequisites. Before you install the |monitoring| agent, please
ensure that the following are true:

- All MongoDB instances (i.e. ``mongod`` and ``mongos``) must be
  version 1.6 or newer.

- The system where you run the Monitoring agent must have Python 2.4
  or greater.

  .. note::

     The Monitoring agent does not provide support the PyPy implementation
     of Python, and does not support the Python 3.x series of Python.

- The system must have have Python's
  `setuptools <http://pypi.python.org/pypi/setuptools>`_ available.

- Install the latest version of PyMongo, the Python driver for MongoDB
  to run the agent.

See :doc:`/monitoring/tutorial/install-pymongo` for complete
instructions on installing PyMongo and its Python dependencies.

.. index:: troubleshooting; proxies

.. important:: Users whose datacenter requires that they proxy
   outbound connections through a gateway have additional
   requirements. See ":ref:`Working with Proxies
   <troubleshooting-proxies>`" for more information.

The ``README`` file distributed with the agent provides more
information.

.. end-requirements-content

.. index:: installation; UNIX/Linux

Install Monitoring Agent Software
---------------------------------

.. _download-monitoring-agent-linux:

.. start-install-content

Download the Monitoring Agent
`````````````````````````````

.. include:: /includes/install-saas-registration.rst

If you have not downloaded the Monitoring agent already, you can click
the "Settings" link immediately after you sign into MMS, and then
select :guilabel:`Monitoring Agent` from the left-hand list to
download an up-to-date agent specifically configured for your account.

You can run the agent on any system that can connect to the MongoDB
instances you want to monitor. As long as it can connect to each
instance, you may use a single agent to do all the monitoring. Do be
sure that the agent can make outgoing connections via HTTPS on port
``443``.

.. note::

   The Monitoring agent has some resource requirements and should run
   on a separate system to avoid impacting ``mongod`` or ``mongos``
   performance. To monitor five or fewer nodes, you can safely deploy
   on an AWS "micro instance".  Running PyMongo with the native
   extensions, which requires GCC, provides significant performance
   improvements.

.. _start-mms-agent-linux:

Start the Monitoring Agent
``````````````````````````

Unzip the archive and then run the agent with the following command:

.. code-block:: sh

   python agent.py

This starts two processes: a parent to monitor the agent daemon and
perform automatic upgrades and a child process to collect data.

.. warning:: If your MongoDB instance has thousands of databases or
   collections, you should disable database statistics
   collection. See ":ref:`Database and Collection statistics
   <db-stats-warning>`" for more information.

.. end-install-content

Next Steps
----------

Now that you have installed the Monitoring agent software, you can
:doc:`deploy the Monitoring agent in production
</monitoring/tutorial/deploy-mms-in-production>`.
