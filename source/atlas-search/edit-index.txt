.. facet::
   :name: programming_language
   :values: c, cpp, csharp, java, javascript/typescript, python, shell

.. _ref-edit-index:

==========================
Edit an Atlas Search Index
==========================

.. default-domain:: mongodb

.. meta:: 
   :keywords: code example, java sync, node.js, atlas ui, atlas api, atlas cli
   :description: Learn how to modify your Atlas Search index definition through the Atlas UI, Atlas Search API, or Atlas CLI.

.. facet::
   :name: genre
   :values: tutorial

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

You can change the :ref:`index definition <ref-index-definitions>`
of an existing |fts| index. You cannot rename an index; if you need to
change an index's name, you must create a new index and delete the old
one.

Required Access 
---------------

.. include:: /includes/fact-fts-required-roles.rst

.. _ref-edit-index-programmatically:

Edit an |fts| Index
-------------------

You can edit an |fts| index in the {+atlas-ui+}, or programmatically by
using {+mongosh+}, the {+atlas-cli+}, the |api|, or a supported
:driver:`MongoDB Driver </>` in your preferred language. 

.. |command-type| replace:: edit
.. |compatibility-table| replace:: :ref:`fts-index-supported-drivers`
.. |search-type| replace:: |fts|

.. include:: /includes/fact-search-commands-cluster-tier.rst

You must have at least the 
:atlasrole:`atlasAdmin` role or ``dbAdmin`` access to
the database that contains the indexes.  To learn more, 
see :ref:`atlas-user-privileges` or :ref:`atlas-specific-privileges`.

----------

.. |arrow| unicode:: U+27A4

|arrow| Use the **Select your language** drop-down menu to set the 
language of the example in this section.

----------

.. tabs-selector:: drivers

.. tabs-drivers::

   .. tab::
      :tabid: atlas-cli

      .. include:: /includes/extracts/atlas-clusters-search-indexes-update.rst
   
   .. tab::
      :tabid: atlas-api

      To edit an |fts| index through the |api|:
      
      .. procedure::
         :style: normal
         
         .. step:: Send a ``PATCH`` request.
            
            Send a ``PATCH`` request with either the unique ID or name 
            of the |fts| index that you wish to modify to the 
            ``search/indexes/`` endpoint.

            .. code-block:: sh

               curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" --digest \
               --header "Accept: application/json" \
               --header "Content-Type: application/json" \
               --include \
               --request PATCH "https://cloud.mongodb.com/api/atlas/v2/groups/{groupId}/clusters/{clusterName}/search/indexes/{indexId}" \
               --data '
                 {
                   "definition":
                   {
                     "analyzer": "lucene.<analyzer>",
                     "analyzers": [
                       {
                         "charFilters": [ ... ],
                         "name": "string",
                         "tokenFilters": [ ... ],
                         "tokenizer": { ... }
                       }
                     ],
                     "mappings": {
                       "dynamic": true | false,
                       "fields": {
                         "property1": {},
                         ...
                       }
                     },
                     "searchAnalyzer": "lucene.<analyzer>",
                     "storedSource": {
                       "include | exclude": [...]
                     },
                     "synonyms": [
                       {
                         "analyzer": "lucene.<analyzer>",
                         "name": "string",
                         "source": {
                           "collection": "string"
                         }
                       }
                     ]
                   }  
                 }'
            
            To learn more about the syntax and parameters for either 
            endpoint, see :oas-atlas-op:`Update One By Name 
            </updateAtlasSearchIndexByName>` and
            :oas-atlas-op:`Update One By ID </updateAtlasSearchIndex>`.

         .. step:: Review the response.

   .. tab::
      :tabid: atlas-ui

      .. include:: /includes/steps-edit-fts-index.rst
   
   .. tab::
      :tabid: shell

      .. include:: /includes/steps-fts-edit-index-shell.rst

   .. tab::
      :tabid: nodejs

      .. include:: /includes/steps-fts-edit-index-node.rst
   
   .. tab::
      :tabid: csharp

      .. include:: /includes/steps-fts-edit-index-csharp.rst

   .. tab::
      :tabid: java-sync

      To edit an |fts| index on a collection using the :driver:`Java
      Driver </java/sync/current/fundamentals/indexes/#atlas-search-indexes>`,
      construct a document that modifies the search index settings, and
      then pass the document to the ``updateSearchIndex()`` method. You
      must have :driver:`Java Driver </java/sync/current/>` v4.11.0 or
      higher. 

      .. include:: /includes/steps-fts-edit-index-java.txt

      .. seealso:: 
      
         :driver:`Atlas Search Indexes </java/sync/current/fundamentals/indexes/#atlas-search-indexes>`

   .. tab::
      :tabid: cpp

      .. include:: /includes/steps-fts-edit-index-cpp.rst
      
   .. tab::
      :tabid: c

      .. include:: /includes/steps-fts-edit-index-c.rst

   .. tab::
      :tabid: python

      .. include:: /includes/steps-fts-edit-index-python.rst

.. note::

   While your new index is building, different nodes may update at
   varying speeds. During this period, you may experience mixed query
   results, reflecting both the new index definition and the previous
   index definition. You can view the index that is serving queries
   in the :ref:`index status details <queryable-index>` page.
