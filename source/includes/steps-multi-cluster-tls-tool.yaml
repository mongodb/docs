---
stepnum: 1
level: 4
ref: clone-k8s-tls
inherit:
  file: steps-multi-cluster-source.yaml
  ref: clone-k8s-repo-multi-cluster
---
stepnum: 2
level: 4
ref: run-config-tool-tls
title: "Run the :github:`multi-cluster TLS </mongodb/mongodb-enterprise-kubernetes/blob/master/tools/multicluster/tls.go>` tool."
content: |

  a. Change to the directory to which you cloned the repository.
  #. Run the :github:`multi-cluster TLS </mongodb/mongodb-enterprise-kubernetes/blob/master/tools/multicluster/tls.go>`
     tool. Specify the following parameters to the tool:

     - The |certauth| key and root certificate for your organization, if you have
       the |certauth| root certificate. If you don't have a |certauth|
       root certificate, specify the Common Name (CN) and the
       :github:`multi-cluster TLS </mongodb/mongodb-enterprise-kubernetes/blob/master/tools/multicluster/tls.go>`
       tool generates a self-signed |certauth| key and root certificate.
     - The MongoDB multi-cluster resource name.
     - The central cluster name and namespace.
     - The country, state, and name of the organization for the |csr|.

     The following example shows how to run the tool if you have a |certauth|
     key and root certificate:

     .. code-block:: sh

        go run public/tools/multicluster/tls.go \
           -resource-name="multi-replica-set" \
           -central-cluster="${MDB_CENTRAL_CLUSTER_FULL_NAME}" \
           -central-cluster-namespace="mongodb" \
           -ca-key={PATH TO CA ROOT KEY} \
           -ca-crt={PATH TO CA ROOT CERT} \
           -country={ORG CERT COUNTRY} \
           -state={ORG CERT STATE} \
           -organization={ORG}

     The following example shows how to run the tool if you don't have
     a |certauth| key and root certificate. In this case, use the ``common-name``
     parameter to specify the Common Name (CN) of the self-signed |certauth|
     root certificate that the tool will generate:
     
     .. code-block:: sh

        go run public/tools/multicluster/tls.go \
           -resource-name="multi-replica-set" \
           -central-cluster="${MDB_CENTRAL_CLUSTER_FULL_NAME}" \
           -central-cluster-namespace="mongodb" \
           -common-name={ORG CERT COMMON NAME} \
           -country={ORG CERT COUNTRY} \
           -state={ORG CERT STATE} \
           -organization={ORG}

---

stepnum: 3
level: 4
ref: verify-mc-resources-tls
inherit:
  file: steps-multi-cluster-source.yaml
  ref: verify-mdb-resources-mc

...
