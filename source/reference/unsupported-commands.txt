=============================================
Unsupported Commands in ``M0/M2/M5`` Clusters
=============================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: onecol

Atlas ``M0`` Free Tier and ``M2``/``M5`` shared starter clusters do not
support all functionality available to other clusters.

.. important::

   ``M0`` Free Tier and ``M2``/``M5`` shared starter clusters do not
   support read or write operations on the ``admin`` database.

For complete documentation on ``M0``/``M2``/``M5`` limitations, see
:ref:`atlas-free-tier`.

Commands With Special Behavior
------------------------------

The following commands exhibit special behavior in ``M0`` Free Tier
and ``M2``/``M5`` shared starter clusters:

.. list-table::
   :header-rows: 1
   :widths: 30 70

   * - Command
     - Description

   * - :manual:`aggregate </reference/command/aggregate>`

     - The following limitations apply:

       * The ``maxTimeMs`` parameter cannot exceed 600 seconds.
       * The ``allowDiskUsage`` parameter is ignored.

   * - :manual:`count </reference/command/count>`

     - The following limitations apply:

       * The ``$where`` operator is not supported.
       * When run against the ``local`` database, you can execute
         ``count`` only on the ``system.replset`` and ``oplog.rs``
         collections.

   * - :manual:`distinct </reference/command/distinct>`

     - The ``$where`` operator is not supported.

   * - `enableFreeMonitoring <https://docs.mongodb.com/manual/reference/method/db.enableFreeMonitoring/index.html>`_

     - Unsupported.

   * - :manual:`find </reference/command/find>`

     - The following limitations apply:

       * The ``$where`` operator is not supported.
       * In the ``local`` database, you can run ``find`` only on the
         ``oplog.rs`` collection. When querying the ``oplog.rs``
         collection, if you specify a condition on the ``ns`` field,
         you must specify an equality condition, such as ``ns:
         "test.foo"``. You cannot use ``$regex`` or any other operator
         with the ``ns`` field.

   * - :manual:`getParameter </reference/command/getParameter>`

     - Can be executed in a Free Tier cluster in only two variations:

       * ``{getParameter: 1, authSchemaVersion: 1}``
       * ``{getParameter: 1, authenticationMechanisms: 1}``

   * - :manual:`killOp </reference/method/db.killOp>`

     - All MongoDB users associated with a Free Tier account can
       execute the ``killOp`` command to terminate operations by all
       other MongoDB users associated with the same account.

   * - :manual:`serverStatus </reference/command/serverStatus>`

     - Returns only the following fields:

       .. code-block:: json
          :copyable: false

          {
            "operationTime" : Timestamp(<int>, 1),
            "ok" : 0,
            "$clusterTime" : {
              "clusterTime" : Timestamp(<int>, 1),
              "signature" : {
                "hash" : BinData(0,"<string>"),
                "keyId" : NumberLong("<string>")
              }
            },
            "metrics" : {
              "atlas" : {
                "connectionPool" : {
                  "totalCreated" : NumberLong(<long>)
                },
                "bytesInWrites" : NumberLong(<long>)
              }
            }
          }

   * - :manual:`usersInfo </reference/command/usersInfo>`

     - This command can only be called with arguments:

       .. code-block:: json

          {user: <MYUSER>, db: 'admin'}

Unsupported Commands
--------------------

The following commands are not supported by ``M0`` Free Tier and
``M2``/``M5`` shared starter clusters:

.. note::

   The commands available for clusters of all other tiers, M10
   and larger, correspond to the privileges defined for the built-in
   MongoDB roles used by |service|. See :ref:`Atlas User Privileges
   <atlas-user-privileges>` for more information.

.. list-table::


   * - | ``applyOps``

       | ``appendOplogNote``

       | ``authenticate``

       | ``authSchemaUpgrade``

       | ``checkShardingIndex``

       | ``cleanupOrphaned``

       | ``clone``

       | ``cloneCollection``

       | ``cloneCollectionAsCapped``

       | ``compact``

       | ``connPoolSync``

       | ``copydb``

       | ``copydbgetnonce``

       | ``copydbsaslstart``

       | ``createRole``

       | ``createUser``

       | ``currentOpCtx``

       | ``dataSize``

       | ``dbHash``

       | ``diagLogging``

       | ``dropAllRolesFromDatabase``

       | ``dropAllUsersFromDatabase``

       | ``dropRole``

       | ``eval``

       | ``forcerror``

       | ``fsync``

       | ``fsyncUnlock``

       | ``getDiagnosticData``

       | ``getPrevError``

     - | ``getShardMap``

       | ``getShardVersion``

       | ``grantPrivilegesToRole``

       | ``grantRolesToRole``

       | ``grantRolesToUser``

       | ``handshake``

       | ``invalidateUserCache``

       | ``lockInfo``

       | ``logRotate``

       | ``mapreduce``

       | ``mapreduce.shardedfinish``

       | ``parallelCollectionScan``

       | ``planCacheClear``

       | ``planCacheClearFilters``

       | ``planCacheListFilters``

       | ``planCacheListPlans``

       | ``planCacheListQueryShapes``

       | ``planCacheSetFilter``

       | ``reIndex``

       | ``revokeRolesFromUser``

       | ``repairCursor``

       | ``repairDatabase``

       | ``replSetDeclareElectionWinner``

       | ``replSetElect``

       | ``replSetFreeze``

       | ``replSetFresh``

       | ``replSetGetConfig``

       | ``replSetGetRBID``

       | ``replSetGetStatus``

     - | ``replSetHeartbeat``

       | ``replSetInitiate``

       | ``replSetMaintenance``

       | ``replSetReconfig``

       | ``replSetRequestVotes``

       | ``replSetStepDown``

       | ``replSetStepUp``

       | ``replSetSyncFrom``

       | ``replSetUpdatePosition``

       | ``resetError``

       | ``resync``

       | ``revokePrivilegesFromRole``

       | ``revokeRolesFromRole``

       | ``setFeatureCompatibilityVersion``

       | ``setLogLevel``

       | ``setParameter``

       | ``setProfilingLevel``

       | ``shutdown``

       | ``updateRole``

       | ``updateUser``

       | ``validate``

       | ``_migrateClone``

       | ``_recvChunkAbort``

       | ``_recvChunkCommit``

       | ``_recvChunkStart``

       | ``_recvChunkStatus``

       | ``_transferMods``

.. admonition:: Limitation for ``mongorestore``
   :class: note

   As free and shared tier clusters don't support
   :manual:`applyOps </reference/command/applyOps>`, they don't
   support the :manual:`--oplogReplay </reference/program/mongorestore#cmdoption-mongorestore-oplogreplay>`
   option for :manual:`mongorestore </reference/program/mongorestore>`
   either.

Aggregation Pipeline
--------------------

.. include:: /includes/fact-planCacheStats-not-supported.rst
