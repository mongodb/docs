.. _meko-op-install-settings-helm:

===================================
|k8s-op| Helm Installation Settings
===================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecols

To provide optional settings, edit the Helm **values** |yaml| file that
corresponds to your deployment type in the directory where you cloned
the |k8s-op-short| repository:

- Vanilla |k8s|: **helm_chart/values.yaml**
- OpenShift: **helm_chart/values-openshift.yaml**

If the setting that you want to add doesn't exist in the **values**
|yaml| file, add its key and value:

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      registry:
        appDb: quay.io/mongodb

.. tip::

    Alternatively, you can pass these values as options when you apply the
    Helm Chart:

    .. tabs::

       .. tab:: Kubernetes
          :tabid: k8s

          .. code-block:: sh

             helm upgrade <chart-name> helm_chart \
                  --values helm_chart/values.yaml \
                  --set namespace=<testNamespace>

       .. tab:: OpenShift
          :tabid: os

          .. code-block:: sh

             helm upgrade <chart-name> helm_chart \
                  --values helm_chart/values-openshift.yaml \
                  --set namespace=<testNamespace>

appDb.name
----------

Name of the Application Database image.

The default value is **mongodb-enterprise-appdb**.

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      appDb:
        name: mongodb-enterprise-appdb
        version: {+appdb-agent-version+}

.. _registry-appdb-version:

appDb.version
-------------

.. include:: /includes/op-setting-descs/appdb-agent-version.rst

.. example::

   .. code-block:: yaml
      :emphasize-lines: 3

      appDb:
        name: mongodb-enterprise-appdb
        version: {+appdb-agent-version+}

database.name
-------------

Name of the {+mdb-ent-db+} image.

The default value is **mongodb-enterprise-database**.

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      database:
        name: mongodb-enterprise-database
        version: 2.0.0

.. _helm-database-version:

database.version
----------------

.. include:: /includes/op-setting-descs/database-version.rst

.. example::

   .. code-block:: yaml
      :emphasize-lines: 3

      database:
        name: mongodb-enterprise-database
        version: {+mdb-ent-db-version+}

initAppDb.name
--------------

Name of the ``initContainer`` image that contains the Application
Database start-up scripts and the readiness probe.

The default value is **mongodb-enterprise-init-appdb**.

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      database:
        name: mongodb-enterprise-init-appdb
        version: {+appdb-init-version+}

initAppDb.version
-----------------

.. include:: /includes/op-setting-descs/init-appdb-version.rst

.. example::

   .. code-block:: yaml
      :emphasize-lines: 3

      database:
        name: mongodb-enterprise-init-appdb
        version: {+appdb-init-version+}

initDatabase.name
-----------------

Name of the ``initContainer`` image that contains the {+mdbagent+}
start-up scripts and the readiness probe.

The default value is **mongodb-enterprise-init-database**.

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      database:
        name: mongodb-enterprise-init-database
        version: {+database-init-version+}

initDatabase.version
--------------------

.. include:: /includes/op-setting-descs/init-database-version.rst

.. example::

   .. code-block:: yaml
      :emphasize-lines: 3

      database:
        name: mongodb-enterprise-init-database
        version: {+database-init-version+}

initOpsManager.name
-------------------

Version of the ``initContainer`` image that contains the |onprem| 
start-up scripts and the readiness probe.

The default value is **mongodb-enterprise-init-ops-manager**.

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      database:
        name: mongodb-enterprise-init-ops-manager
        version: {+ops-manager-init-version+}

initOpsManager.version
----------------------

.. include:: /includes/op-setting-descs/init-ops-manager-version.rst

.. example::

   .. code-block:: yaml
      :emphasize-lines: 3

      database:
        name: mongodb-enterprise-init-ops-manager
        version: {+ops-manager-init-version+}

managedSecurityContext
----------------------

.. include:: /includes/op-setting-descs/managed-security-context.rst

.. tabs::

   .. tab:: Kubernetes
      :tabid: k8s
   
      The default value is **false**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 3

            # Set this to true if your cluster is managing SecurityContext for you.
            # If running OpenShift (Cloud, Minishift, etc.), set this to true.
            managedSecurityContext: false

   .. tab:: OpenShift
      :tabid: os
   
      The default value is **true**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 3

            # Set this to true if your cluster is managing SecurityContext for you.
            # If running OpenShift (Cloud, Minishift, etc.), set this to true.
            managedSecurityContext: true

namespace
---------

.. include:: /includes/op-setting-descs/namespace.rst

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      # Name of the Namespace to use
      namespace: mongodb

needsCAInfrastructure
---------------------

Flag that determines whether |k8s| creates a |k8s-cr| that allows the
|k8s-op-short| to sign |tls| certificates using the
:k8sdocs:`certificates.k8s.io </tasks/tls/managing-tls-in-a-cluster/>` 
API.

.. example::

   .. code-block:: yaml
      :emphasize-lines: 1

      needsCAInfrastructure: true

The default value is **true**.

operator.deployment_name
------------------------

Name of the |k8s-op-short| container.

The default value is **mongodb-enterprise-operator**.

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      operator:
        deployment_name: mongodb-enterprise-operator

operator.env
------------

.. include:: /includes/op-setting-descs/operator-env.rst

.. example::

   .. code-block:: yaml
      :emphasize-lines: 4

      operator:
        # Execution environment for the operator, dev or prod.
        # Use dev for more verbose logging
        env: prod

operator.name
-------------

Name that |k8s| assigns to |k8s-op-short| objects, such as Deployments,
ServiceAccounts, Roles, and Pods.

This value also corresponds to the name of the container registry where
the |k8s-op-short| is located.

The default value is **mongodb-enterprise-operator**.

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      operator:
        name: mongodb-enterprise-operator

operator.version
----------------

Version of the |k8s-op-short| that you want to deploy.

The default value is **{+version+}**.

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      operator:
        version: {+version+}

operator.watchNamespace
-----------------------

.. include:: /includes/op-setting-descs/watch-namespace.rst

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      operator:
        watchNamespace: *

operator.watchedResources
-------------------------

.. include:: /includes/op-setting-descs/operator-watchedresources.rst

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      operator:
        watchedResources:
          - mongodbusers
          - mongodb 
          - opsmanagers

opsManager.name
---------------

Name of the |onprem| image.

The default value is **mongodb-enterprise-ops-manager**.

.. example::

   .. code-block:: yaml
      :emphasize-lines: 2

      opsManager:
        name: mongodb-enterprise-ops-manager

registry.appDb
--------------

.. include:: /includes/op-setting-descs/appdb-image-repository.rst

.. tabs::

   .. tab:: Kubernetes
      :tabid: k8s
   
      The default value is **quay.io/mongodb**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 2

            registry:
              appDb: quay.io/mongodb

   .. tab:: OpenShift
      :tabid: os
   
      The default value is **registry.connect.redhat.com/mongodb**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 2

            registry:
              appDb: registry.connect.redhat.com/mongodb

registry.imagePullSecrets
-------------------------

.. include:: /includes/op-setting-descs/registry-imagepullsecrets.rst

.. example::

   .. code-block:: yaml
      :emphasize-lines: 3

      registry:
      # The pull secret must be specified
        imagePullSecrets: <openshift-pull-secret>

registry.initAppDb
------------------

.. include:: /includes/op-setting-descs/init-appdb-image-repository.rst

.. tabs::

   .. tab:: Kubernetes
      :tabid: k8s
   
      The default value is **quay.io/mongodb**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 2

            registry:
              initAppDb: quay.io/mongodb

   .. tab:: OpenShift
      :tabid: os
   
      The default value is **registry.connect.redhat.com/mongodb**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 2

            registry:
              initAppDb: registry.connect.redhat.com/mongodb

registry.initOpsManager
-----------------------

.. include:: /includes/op-setting-descs/init-ops-manager-image-repository.rst

.. tabs::

   .. tab:: Kubernetes
      :tabid: k8s
   
      The default value is **quay.io/mongodb**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 2

            registry:
              initOpsManager: quay.io/mongodb

   .. tab:: OpenShift
      :tabid: os
   
      The default value is **registry.connect.redhat.com/mongodb**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 2

            registry:
              initOpsManager: registry.connect.redhat.com/mongodb

registry.operator
-----------------

.. include:: /includes/op-setting-descs/registry-operator.rst

.. tabs::

   .. tab:: Kubernetes
      :tabid: k8s
   
      The default value is **quay.io/mongodb**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 2

            registry:
              operator: quay.io/mongodb

   .. tab:: OpenShift
      :tabid: os
   
      The default value is **registry.connect.redhat.com/mongodb**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 2

            registry:
              operator: registry.connect.redhat.com/mongodb

registry.opsManager
-------------------

.. include:: /includes/op-setting-descs/ops-manager-image-repository.rst

.. tabs::

   .. tab:: Kubernetes
      :tabid: k8s
   
      The default value is **quay.io/mongodb**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 2

            registry:
              opsManager: quay.io/mongodb

   .. tab:: OpenShift
      :tabid: os
   
      The default value is **registry.connect.redhat.com/mongodb**.

      .. example::

         .. code-block:: yaml
            :emphasize-lines: 2

            registry:
              opsManager: registry.connect.redhat.com/mongodb

subresourceEnabled
------------------

Flag that indicates whether subresources can be defined in the
|k8s-op-short| |k8s-crd|.

Set this setting to **false** if installing the |k8s-op-short|
CustomResourceDefinition fails on an OpenShift 3.11 cluster.

The default value is **true**.

.. example::

    .. code-block:: yaml
      :emphasize-lines: 1

      subresourceEnabled: true
