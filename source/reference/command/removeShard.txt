===========
removeShard
===========

.. default-domain:: mongodb

.. dbcommand:: removeShard

   Removes a shard from a :term:`sharded cluster`. When you run
   :dbcommand:`removeShard`, MongoDB first moves the shard's chunks to
   other shards in the cluster. Then MongoDB removes the shard.

   To run the command you must have administrative access. Either run
   :dbcommand:`removeShard` from the admin database or run it with the
   :method:`sh._adminCommand` command.

   The command takes the following form:

   .. code-block:: javascript

      use admin
      db.runCommand( { removeShard : "<shardName>" } )

Behavior
--------

When you run :dbcommand:`removeShard`, the command returns immediately,
with the following message:

.. code-block:: javascript

   {
       "msg" : "draining started successfully",
       "state" : "started",
       "shard" : "bristol01",
       "ok" : 1
   }

The balancer migrates chunks from shard ``bristol01``.
This process happens slowly to avoid placing undue load on the overall
cluster.

If you run the command again, you'll see the following progress output:

.. code-block:: javascript

   {
       "msg" : "draining ongoing",
       "state" : "ongoing",
       "remaining" : {
           "chunks" : 23,
           "dbs" : 1
       },
       "ok" : 1
   }

The ``remaining`` :term:`document` specifies how many chunks and databases
remain on the shard. Use :method:`db.printShardingStatus()` to list the
databases that you must move from the shard.

Each database in a sharded cluster has a primary shard. If the shard you
want to remove is also the primary of one of the cluster's databases, then
you must manually move the database to a new shard. This can be done only
after the shard is empty. See the :dbcommand:`movePrimary` command for details.

After removing all chunks and databases from the shard, if you issue the
command again it returns:

.. code-block:: javascript

   {
       "msg" : "removeshard completed successfully",
       "state" : "completed",
       "shard" : "bristol01",
       "ok" : 1
   }
