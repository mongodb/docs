.. _atlas-billing:

=======
Billing
=======

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Billing is at the organization level while preserving visibility into
usage in each project.

|service| charges by the hour for your MongoDB clusters. |service|
tabulates costs daily and displays your current monthly costs in the
upper right corner. To view line-item charges, click the
:guilabel:`details` link to go to the invoice.

As you create or modify a cluster, you can compare the costs of different
options before applying them. |service| displays the costs, except for data
transfer, in a :guilabel:`Cluster Overview` box.

.. note::

   The :guilabel:`Cluster Overview` box does not display :ref:`data transfer
   costs <data-transfer-costs>`.

.. seealso::  |service-pricing|_

View or Download your Current or Past Invoices
----------------------------------------------

|service| invoices at the :ref:`orgainzation <organizations>` level.
Charges are typically posted the next day.

|service| displays the current charges for the |service| organization
as :guilabel:`Usage This Month:` in the top-right corner of the
organization view. Click :guilabel:`details` to view 
the :guilabel:`Billing Overview` of the organization. Alternatively,
from the |service| UI view of the organization, click 
:guilabel:`Settings`, then :guilabel:`Billing Overview`.

To view all invoices for an |service| organization:

1. In the :guilabel:`Context` dropdown, select the desired organization.

#. Click :guilabel:`Settings` in the left-hand navigation bar.

#. Click the :guilabel:`Payment History` tab.

The :guilabel:`Payment History` tab supports filtering by invoice
status. Click the :guilabel:`Status` drop-down and select the status
to filter by:

- :guilabel:`Pending` - invoices still pending payment.
- :guilabel:`Free` - invoices with a total charge of ``$0.00``.
- :guilabel:`Successful` - invoices that are paid.

To filter by invoice date, set the :guilabel:`From` or :guilabel:`To`
date inputs to the required date range. Leaving :guilabel:`From`
blank sets the lower date boundry to the organization's creation date.
Leaving :guilabel:`To` blank sets the upper date boundry to the
current date.

To view charges and payments for a specific invoice, click the link
for the invoice shown in the :guilabel:`Invoice Date` column.

To download charges and payments for a non-pending invoice, click one of
the invoice format buttons in the :guilabel:`Download As` column.

To configure the payment method and billing profile for an 
organization, or to view the most recent and pending charges for
an organization, access the organization's :ref:`billing-overview`.

.. _region-costs:

Cloud Service Provider and Region
---------------------------------

|service| supports deploying clusters onto :ref:`Amazon Web Services
<amazon-aws>`, the :ref:`Google Cloud Platform <google-gcp>`, and
:ref:`Microsoft Azure <microsoft-azure>`. The choice of cloud service provider
and region or regions for the |service| project affects the cost of running a
|service| cluster.

Multi-region cluster costs depend on the number of and location of additional
regions selected. When creating a cluster, |service| displays the
:ref:`instance size cost <instance-size-costs>` based on the
:guilabel:`Preferred Region` of the cluster. You can see the total cost of
running the cluster in the :guilabel:`Cluster Overview`.

.. _instance-size-costs:

Instance Size
-------------

|service| provides different instance sizes. Each instance size has a default
RAM capacity, storage capacity, and maximum storage speed. The cost of the
instance's per-hour charge includes these default values. |service| uses the
selected instance size when deploying all the data-bearing [#data-bearing]_
servers in your cluster.

Depending on the choice of cloud service provider, |service| provides
customization options for :ref:`instance storage capacity <storage-capacity>`
and the :ref:`speed <instance-storage-speed>` of that storage. If you add
capacity or speed, you incur additional costs on top of the base cost. For
multi-region clusters, the per-instance cost, including any selected
customizations, is relative to the :guilabel:`Preferred Region`. The
:guilabel:`Cluster Overview` box shows your overall charges.

.. _storage-capacity:
.. _instance-storage-capacity:

Storage Capacity
~~~~~~~~~~~~~~~~

|service| charges for storage capacity differently depending on whether you
use the instance default or specify a custom storage capacity. If you use the
default, storage is included in the instance's per-hour cost. If you
customize, |service| charges for the entire amount of storage, not the
difference from the default size.

For example, if the instance default is 80 GB and if you increase storage to
100 GB, the change in cost is the charge for 100 GB. If you then increase
storage to 120 GB, the change in cost is the charge for 20 GB.

.. note::

   Increasing storage capacity can change the max IOPS available
   with each :guilabel:`Custom Storage Speed`.

.. _storage-speed:
.. _instance-storage-speed:

Custom Storage Speed
~~~~~~~~~~~~~~~~~~~~

|service| measures storage speed as maximum Input/Output Operations Per Second
(IOPS). Each |service| :ref:`instance type <instance-size-costs>` offers a
default storage speed that is included in the instance's per-hour cost. The
choice of cloud service provider and instance size affects the available
storage speed customization options, as well as the cost of selecting a custom
storage speed.

:abbr:`AWS (Amazon Web Services)`
  For most instance types, you can increase storage speed from
  :guilabel:`Standard` to :guilabel:`Fast` or :guilabel:`Fastest`, which
  affects costs. Selecting a custom speed changes both :abbr:`IOPS
  (Input/Output Operations per Second)` and the type of storage used. The
  storage type changes from a general-purpose SSD to a provisioned-:abbr:`IOPS
  (Input/Output Operations per Second)` SSD. For more information on storage
  types, see
  `Amazon EBS Volume Types 
  <http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSVolumeTypes.html>`_.

:abbr:`GCP (Google Cloud Platform)`
  All instances use SSD persistent disks with fixed maximum :abbr:`IOPS
  (Input/Output Operations per Second)` based on the instance storage
  capacity. The maximum :abbr:`IOPS (Input/Output Operations per Second)`
  increases as storage capacity increases. The cost of the increased maximum
  :abbr:`IOPS (Input/Output Operations per Second)` is included in the cost of
  the increased storage capacity. For more information on the :abbr:`GCP
  (Google Cloud Platform)` persistent disks, see `Persistent Disks
  <https://cloud.google.com/compute/docs/disks/#pdspecs>`_.

:abbr:`Azure (Microsoft Azure)`
  All instances use premium SSD disks with fixed maximum :abbr:`IOPS
  (Input/Output Operations per Second)` based on the storage
  capacity. The maximum :abbr:`IOPS (Input/Output Operations per Second)`
  increases as storage capacity increases. The cost of the increased maximum
  :abbr:`IOPS (Input/Output Operations per Second)` is included in the cost of
  the increased storage capacity. For more information on the Azure Premium 
  disks, see `High-performance Premium Storage and managed disks for VMs
  <https://docs.microsoft.com/en-us/azure/storage/storage-premium-storage>`_.

.. _data-transfer-costs:

Data Transfer
-------------

|service| data transfer costs depend on the cloud service provider where you
deployed the cluster. Multi-region clusters may have higher data transfer
costs depending on the number and location of additional regions, as well as
the number of instances deployed to each region.

|service| tabulates data transfer costs daily.

:abbr:`AWS (Amazon Web Services)`
  |service| charges for data transfer between the |service| server and another
  server. Data transfer charges include traffic between cluster nodes,
  including an outgoing transfer from the source node and an incoming
  transfer to the destination node within the same AWS region. Charges for
  data transfer increase as follows, from lowest to highest:
  
  - Data transfer between the originating MongoDB |service| server and a
    server in the same AWS region.
  
  - Data transfer between the originating MongoDB |service| server and a
    server in a different AWS region.
  
  - Data transfer between the originating MongoDB |service| server and a
    server not in an AWS region.
  
:abbr:`GCP (Google Cloud Platform)`
  |service| charges for outgoing data transfers from an |service| server to
  another server. Incoming data transfers to an |service| server are free. 
  Data transfer charges for a |service| cluster are as follows, 
  from lowest to highest:
  
  - Outgoing data transfer between the originating MongoDB |service| node and:
    
    - a server that is in the same region but not in the same zone, or
    
    - a server where both the originating MongoDB |service| node and the
      destination server are in different regions in the United States of
      America.

  - Outgoing data transfer between the originating MongoDB |service| node and:
  
    - a server in a different continent, or 
    
    - a server in the same continent (excluding USA) but a different region, or
    
    - a server or machine not in a :abbr:`GCP (Google Cloud Platform)` data
      center.
 
:abbr:`Azure (Microsoft Azure)`
  |service| charges for outgoing data transfer from an |service| server to
  another server or machine *not* in the same region. Incoming data transfers
  to a |service| server are free. Data transfer charges for an |service|
  cluster depend on the geographic location of the source server.

.. _server-number-costs:

Number of Servers
-----------------

|service| charges the instance cost and data storage cost for each
data-bearing server [#data-bearing]_ in your cluster. For a replica set, the
number of data-bearing servers equals the replication factor. For a sharded
cluster, the number of data-bearing servers equals the replication factor
multiplied by the number of shards.

If you enable sharding, |service| will also run three :ref:`config servers
<sharding-config-server>` in addition to your data-bearing servers. Your
selections for instance size and data storage do not affect the costs of the
config servers. Config servers are charged at a separate rate. Their cost is
reflected in the cost of the cluster.

.. _advanced-security:

Advanced Security
-----------------

|service| supports user authentication and authorization with an LDAP
server. See :doc:`Set up User Authentication and Authorization with LDAP
<security-ldaps>` for details.  The billing rate for advanced security
incurs an increase in the hourly cost of all clusters in your |service|
project.

.. _database-auditing:

Database Auditing
-----------------

|service| supports database auditing. See :doc:`Set up Database Auditing
</database-auditing>` for details. Enabling database auditing increases
the hourly cost of all clusters in your |service| project.

Backup
------

The |service| :doc:`backup-cluster` supports 
:doc:`/backup/continuous-backups` and 
:doc:`/backup/cloud-provider-snapshots`. Each backup method has
its own cost calculations and considerations.

|service| charges for each replica set in a cluster. For a replica set
deployment, the backup costs are the cost to backup data for the replica
set. For a sharded cluster deployment, |service| sums the cost to
backup the data for each shard replica set *and* the config server
replica set.

|service| charges for the network transfer costs of restoring a 
snapshot. See :ref:`data-transfer-costs` for more information on how
|service| charges for network data.

Continuous Backups
~~~~~~~~~~~~~~~~~~

The backup cost for continuous backups is per GB per month 
(US$2.50 / GB / month) as specified on the |service-pricing|_. The monthly
rate is annualized and then divided by 365 to arrive at a Daily Backup
Rate per GB. The first 1GB of backup data is free.

Monthly backup costs are primarily based on the size per-gigabyte of 
the data to back up. This size is roughly equivalent to the uncompressed
size of all documents and all indexes for all the databases backed up. 

To retrieve the size in gigabyte of the documents and indexes for a
given database, you can issue the :manual:`db.stats()
</reference/method/db.stats>` method and sum the ``dataSize`` and
``indexSize`` fields.

.. code-block:: javascript

   db.stats(1024*1024*1024).dataSize + db.stats(1024*1024*1024).indexSize

The rate is based on your having 28 snapshots at steady state: 

- The six-hour snapshots are kept for two days; 

- The daily snapshots for one week,

- The weekly snapshots for one month,

- The monthly for one year. 

Adding that up, you get 8 + 5 + 3 + 12 = 28 snapshots. We adjust the
backup rate daily based on the following formula:

.. code-block:: none

   backupRatePerMonth = $1.25 + snapshotAtSteadyState/28 * $1.25

Changing the snapshot frequency or retention period affects the
base rate per GB. See :ref:`modify-backup-schedule` and
:ref:`retention-policy` for more information.

.. example::

   For a three-member replica set with 30GB of data, |service| charges
   US$72.50 each month (using the default backup rate).

   ``(30GB - 1GB) × US$2.50 = US$72.50``

.. example::

   A sharded cluster with 3 shards contains 90GB of data, with each shard
   containing 30GB of data each. The config server replica set
   contains 5GB of data.

   For this sharded cluster, |service| charges US$227.50 per month
   (using the deafault backup rate).

   ``((30GB - 1GB) × US$2.50) × 3) + ((5GB - 1GB) × US$2.50) = US$227.50``

Cloud Provider Snapshots
~~~~~~~~~~~~~~~~~~~~~~~~

.. tabs::

     tabs:
  
     - id: azure
       name: Azure
       content: |
   
         The backup cost for cloud provider snapshots is the *total* size
         of all snapshots per GB per month. The rate per GB depends on the region
         of the cluster. For multi-region clusters, the rate per GB depends on 
         the cluster's preferred region.
   
         .. example::
   
            For a three member replica set deployed to the Azure ``useast2``
            region (Virginia, USA) with three snapshots of 10, 20, and 30GB
            respectively, |service| charges US$20.40.
   
            ``(10GB * US$0.34) + (20GB * US$0.34) + (30GB * US$0.34)``
   
            **note**: The US$0.34 rate per GB is specific to the 
            :ref:`Azure <windows-azure>` ``useast2`` region at the time of 
            writing. |service| displays the most current cost per GB for
            the cluster's selected region during cluster configuration.
            See :doc:`/create-new-cluster` or :doc:`scale-cluster` for
            more information on cluster configuration.
   
         When restoring a cluster using a manual download via HTTPS,
         |service| also charges per-hour that the download link remains
         active. Contact MongoDB Support for more information.
         From the |service| project or cluster view, click
         :guilabel:`Support` in the left-hand navigation bar.
  
     - id: aws
       name: AWS
       content: |
  
         The backup cost for Cloud Provider Snapshots is the 
         *total* size of all snapshots per GB per month. The rate per
         GB depends on the region of the cluster. For multi-region
         clusters, the snapshot storage location depends on the location
         of the replica set member targeted for snapshots. The rate
         per GB therefore depends on the region of the targeted replica
         set member at the time of the snapshot.
  
         :abbr:`AWS (Amazon Web Services)` Cloud Provider Snapshots
         supports incremental snapshots, where a new snapshot saves
         only the data that changed after your most recent snapshot.
         For example, a cluster with ``10GB`` of data and 3 snapshots
         may require less than ``30GB`` of total snapshot storage
         depending on how data changed between snapshots.

         If the existing snapshot storage volume becomes invalid,
         |service| creates a new snapshot storage volume in the same
         region as the cluster's current primary and takes a full-copy
         snapshot. |service| continues using that primary and its
         :abbr:`AWS (Amazon Web Services)` region for snapshots
         and snapshot storage. This may result in a higher invoice for 
         the few days required to re-establish incremental snapshots. 
         The cost per GB for snapshot storage may also change 
         depending on the region of the new snapshot target.
         For more information on how |service| manages snapshot
         storage, see :ref:`backup-cloud-provider`.
  
         When restoring a cluster using a manual download via HTTPS,
         |service| also charges per-hour that the download link remains
         active. Contact MongoDB Support for more information.
         From the |service| project or cluster view, click
         :guilabel:`Support` in the left-hand navigation bar.

If you have questions on Cloud Provider Snapshot backup sizing and
pricing, please contact |service| support by clicking
:guilabel:`Support` from the left-hand navigation of the |service| UI.

Lowering the Monthly Rate
~~~~~~~~~~~~~~~~~~~~~~~~~

:ref:`backup-continuous`
  Lowering snapshot frequency or lowering snapshot retention lowers the
  cost per gigabyte. Increasing the snapshot frequency or the snapshot
  retention increases the cost per gigabyte. To modify the snapshot
  frequency or retention for a cluster, see 
  :ref:`modify-backup-schedule`.

:ref:`backup-cloud-provider`
  The cost of backups is dependent on the region of the replica set
  member targeted for snapshots. Modifying the
  region configuration for your cluster may reduce the cost per
  gigabyte for snapshot storage. You can change regions by 
  :ref:`scaling the cluster <scale-cluster-region>`.

|bic|
-----

If |bic| is enabled for your cluster:

- The billing rate for the |bic| will be described in the Cluster UI as
  a daily uplift on the cost of the associated cluster.

- |bic| has a sustained-usage pricing. That is, the daily rate is
  charged only up to a maximum for the month.

.. _sitch-for-atlas:

Stitch for Atlas
----------------

|stitch-docs| applications may incur data transfer and compute costs for
each application in a project. If you have Stitch applications in your
organization, your invoice includes these costs as a line item. See
`Stitch Billing <https://docs.mongodb.com/stitch/billing/>`_ for more information.

.. _billing-overview:

Billing Overview
----------------

Billing is at the organization level. All projects within an organization share
the same billing settings.

To view and edit billing information, select the organization, click 
:guilabel:`Settings`, then click the :guilabel:`Billing Overview` tab.

Payment Method
~~~~~~~~~~~~~~

Use the :guilabel:`Edit Payment Method` dialog to edit the following information
for your organization:

- :guilabel:`Billing Address` associated with the credit card.

  .. note::

     |service| uses the :guilabel:`Invoice Address` defined in your
     :guilabel:`Billing Profile`, if any, if you select
     :guilabel:`Same as Invoice Address`.

- :guilabel:`Credit Card` information.

- The :guilabel:`VAT Tax ID Number` if required. See :ref:`VAT ID Number
  <vat-id-number>` for more   information.

  .. include:: /includes/vat-clarification.rst

- :guilabel:`Coupon or Activation Code` allows you to enter the activation
  code that you received from our sales team. For details see: :ref:`Apply Prepaid
  Credit <apply-credit>`

Billing Profile
~~~~~~~~~~~~~~~

Use the :guilabel:`Edit Billing Profile` dialog to edit the following
information for your organization:

- :guilabel:`Billing Email Address` for the organization. |service| emails
  the organization's invoices to this address. If the address is not set,
  invoices are emailed to all members of the organization.

- An optional :guilabel:`Invoice Address` that is separate from the
  :guilabel:`Billing Address` set in the :guilabel:`Payment Method`.

- The :guilabel:`VAT Tax ID Number` for the organization if required.
  See :ref:`VAT ID Number <vat-id-number>` for more information.

.. include:: /includes/vat-clarification.rst

.. _vat-id-number:

VAT ID Number
~~~~~~~~~~~~~

If your organization's billing or invoice address is in a country that
is a member of the European Union, add your :abbr:`VAT (Value Added
Tax)` ID number on the :guilabel:`Payment Method` or the
:guilabel:`Billing Profile` dialog.

|service| only displays the :guilabel:`VAT Tax ID Number` field beneath
the address entry if you select a country other than the United States.

.. include:: /includes/vat-clarification.rst

Retry a Failed Payment
~~~~~~~~~~~~~~~~~~~~~~

If you receive notification of a failed payment, click :guilabel:`Settings`,
then :guilabel:`Billing Overview`, and check that your :guilabel:`Payment
Method` is correct.

To retry the payment, click :guilabel:`Settings`, then :guilabel:`Payment
History`. On the line for the failed payment, click :guilabel:`Retry`.

.. include:: /includes/footnote-databearing.rst

.. _apply-credit:

Apply Prepaid Credit
~~~~~~~~~~~~~~~~~~~~

When you buy prepaid credits from our sales team, we send you an email message
containing an activation code. To apply the code to your account:

#. Select your organization from the :guilabel:`Context` drop-down list at the
   top of the left column of the screen.

#. Click :guilabel:`Settings`.

#. Click the :guilabel:`Billing Overview` tab on the settings screen.

#. Click :guilabel:`Apply Credit` and enter the activation code.

You can also add the activation code on the :guilabel:`Edit Payment Method`
dialog box by clicking on the :guilabel:`Edit` button next to
:guilabel:`Payment Method`.

.. note::

   - If you do not add your activation code within the first 30 days of use, we
     will charge the credit card associated with the account. Credit card charges
     are non-refundable.

   - If you believe you've lost your activation code, create a support ticket.

   - If you do not have prepaid credits and would prefer to pay this
     way, please contact our sales team at:
     `https://www.mongodb.com/lp/contact/sales
     <https://www.mongodb.com/lp/contact/sales?jmp=docs>`_.

