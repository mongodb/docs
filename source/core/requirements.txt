============================
|onprem| System Requirements
============================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

This guide describes the hardware, software, and networking requirements for the
servers that run the :doc:`Ops Manager components </core/system-overview>`.

.. important::
   Before deploying servers, use the :doc:`/core/installation-checklist` to
   plan your configuration.

For requirements for the MongoDB instances running as the |onprem|
Application Database and the Backup Database, see
:doc:`/tutorial/prepare-backing-mongodb-instances`.

.. _hardware-requirements:

Hardware Requirements
---------------------

Each server must meet the total *RAM* and *disk capacity*
requirements for all |onprem| components that it hosts: 

- |onprem| application
- |onprem| application databases
- Backup Daemon application and head database
- Backup Blockstore databases 

.. example::

   You want to host both the |onprem| application and a :term:`Backup Daemon`
   on one server. This |onprem| configuration will manage and monitor 300
   MongoDB hosts and back up 200 hosts. The total disk capacity of all
   databases being backed up is 4 TB. The total requirements would be:

   - |onprem| application needs 15 GB of RAM. 
   - The Backup Daemon also needs:
   
     - 15 GB of RAM and 
     - 2.5 times the 4 TB of backed up databases in disk capacity. 

   This example server would require a minimum of 30 GB of RAM and 10 TB of
   disk capacity.

.. warning::
   Each server that hosts a MongoDB instance **must** comply with the
   :manual:`Production Notes </administration/production-notes>` in the 
   MongoDB manual. MongoDB instances in |onprem| include:

   - The |onprem| Application Database,
   - Each |onprem| Backup Daemon :term:`head database`, and 
   - Each snapshot store (blockstore, s3 blockstore and file system store).
   
   Failure to configure servers according to the production notes can lead to
   production failure.

.. _application-hardware-requirements:

|onprem| Hardware Requirements
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Every server that runs the |onprem| application must meet the following hardware
requirements:

.. list-table::
   :header-rows: 1

   * - Number of Monitored Hosts
     - CPU Cores
     - RAM

   * - Up to 400 monitored hosts
     - 4+
     - 15 GB

   * - Up to 2,000 monitored hosts
     - 8+
     - 15 GB

   * - More than 2,000 hosts
     - Contact MongoDB Account Executive
     - Contact MongoDB Account Executive

.. _mms-application-database-specifications:

|onprem| Application Database Hardware Requirements
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The :ref:`Ops Manager Application Database <mms-application-database>`
runs as a three-member :term:`replica set` that runs on dedicated servers.

Every server that hosts the |onprem| Application Database must meet the
following hardware requirements:

.. list-table::
   :widths: 20 30 50
   :header-rows: 1

   * - Number of 
       Monitored Hosts
     - RAM
     - Disk Capacity
     
   * - Up to 400
     - 8 GB RAM plus the RAM required for |onprem| application
     - 200 GB plus:
      
       - 35 MB per monitored host for WiredTiger-based databases
       - 250 MB per monitored host for MMAPv1-based databases

   * - Up to 2,000
     - 15 GB RAM plus the RAM required for |onprem| application
     - 500 GB plus:
     
       - 35 MB per monitored host for WiredTiger-based databases
       - 250 MB per monitored host for MMAPv1-based databases

   * - More than 2,000
     - Contact your MongoDB Account Executive
     - Contact your MongoDB Account Executive

For the best performance, use SSDs to store your |onprem| application databases.

For the differences between WiredTiger and MMAPv1 storage engines, see
:manual:`the types of storage engines </core/storage-engines/>` in the MongoDB
manual.

Disk capacity estimates are *approximate*. The needed disk capacity can
increase *or* decrease due to the number of databases being monitored.

.. important::
   During the upgrade to |onprem| 3.4, your |onprem| application database could
   increase to twice its current size. Make sure you have sufficient free disk
   capacity on the disk partitions that store your application database so the
   upgrade can complete.

   **EXAMPLE:**

   If your application database is 50 GB as a replica set, you need to have at
   least another 50 GB on each server hosting a replica set before upgrading
   to |onprem| 3.4.

.. _backup-hardware-requirements:

Backup Daemon Hardware Requirements
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. important::
   Before getting started with Backup, *contact your MongoDB Account
   Executive* to help estimate the storage requirements for your Backup Daemon
   server.

Each server on which you activate the :term:`Backup Daemon` must meet the
following requirements plus the :ref:`requirements for Ops
Manager <application-hardware-requirements>`. 

The Backup Daemon creates :term:`head databases <head database>` that
replicate data for each replica set assigned to the Daemon. Typically,
each server on which you activate the Backup Daemon needs to store
2.0 to 2.5 times the sum of the size on disk of all the backed-up replica
sets. 

Specifically, each server must have:

- The disk capacity and write capacity to maintain each head database,
  **plus**

- The disk capacity to store an additional copy of the data for each head
  database to support :term:`point-in-time restores
  <point-in-time restore>`.

Each server that hosts an active Backup Daemon has the following hardware
requirements.

.. list-table::
   :header-rows: 1
   :widths: 20, 40, 40

   * - Number of Hosts
     - CPU Cores
     - RAM

   * - Up to 200
     - 4+ × 2 GHz+
     - 15 GB additional RAM

Contact your MongoDB Account Executive to determine disk capacity and
throughput requirements.

.. _backup-database-specifications:

Backup Database Hardware Requirements
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If you use |onprem| Backup, you must provision servers for the Backup
Database. 

Server requirements for the Backup Database vary, depending on
whether you use a Blockstore database or file system storage to store 
your :term:`snapshots <snapshot>`. The Backup
Database always holds :term:`oplog` data.

If you store snapshots in the Backup Database, its servers typically must
have enough capacity to store 2 to 3 times the total backed-up production
data size. Snapshots are compressed and de-duplicated at the block level
in the :term:`Blockstore <Backup Blockstore Database>`. 

Your specific requirements depend on your data compressibility and change
rate. **Contact your MongoDB Account Manager** to help estimate
the use case and workload-dependent storage requirements for your Backup
Database servers.

If you store snapshots in the Backup Database, each data-bearing member
must meet the following requirements:

.. list-table::
   :widths: 20 80
   :header-rows: 1

   * - CPU Cores
     - RAM

   * - 4 × 2 GHz+ 
     - 8 GB of RAM per TB of Blockstore disk to provide
       good snapshot and restore speed. |onprem| defines 1 TB of
       Blockstore as 1024\ :sup:`4` bytes.

Contact your MongoDB Account Executive to determine disk capacity and
throughput requirements.

If you will **not** store snapshots in the Backup Database, each data-bearing
member must meet the following requirements:

.. list-table::
   :widths: 20 80
   :header-rows: 1

   * - CPU Cores
     - Disk Capacity
     
   * - 4 × 2 GHz+
     - The size of your oplogs compressed for the 
       :ref:`configured point in time window <edit-snapshot-schedule>`. 
       The default is 24 hours.

.. _network-requirements:

Network Requirements
--------------------

Accessible Ports
~~~~~~~~~~~~~~~~

The |mms| application must be able to connect to users and |mms|
agents over or Secure HTTP (HTTPS). |mms| agents must be able to
connect to MongoDB client MongoDB databases.

Though |mms| only requires open HTTP(S) and MongoDB network ports to
connect with users and to databases, what ports are opened on a
firewall depend upon what capabilities are enabled: encryption,
authentication and monitoring.

This page defines which systems need to connect to which ports on
other systems.

.. include:: /includes/extracts/firewall-configuration.rst

.. include:: /includes/requirements-hostnames.rst

.. _software-requirements:

Software Requirements
---------------------

Servers that run |onprem| components must meet the software requirements
described here.

.. _ops-manager-operating-system:

|onprem| Operating System
~~~~~~~~~~~~~~~~~~~~~~~~~

Servers that run |onprem| must run on a 64-bit version of one of the
following operating systems:

- CentOS 6 or later

- Red Hat Enterprise Linux 6 or later

- SUSE 11 or Later

- Amazon Linux :abbr:`AMI (Amazon Machine Image)` (latest version only)

- Ubuntu 12.04 or later

- Microsoft Windows Server 2008 R2 or later

MongoDB Version for |onprem| Application Database and Backup Database
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. versionchanged:: 3.4
   If you deploy |onprem| 3.4, the |onprem| Application and Backing Databases must run
   MongoDB 3.0.8 or later.

If you deploy |onprem| 2.0 or earlier, the |onprem| Application and Backup
Databases can run MongoDB version 2.6 or later with the following revisions:

- If you are running MongoDB version 2.6, you must run MongoDB revision
  2.6.6 or later.
- If you are running MongoDB version 3.0, you must run MongoDB revision
  3.0.6 or later.
- If you are running MongoDB version 3.2 or later, you can run any
  revision of those versions.

For more information on MongoDB version numbers, see 
:ref:`release-version-numbers` in the MongoDB Manual.

.. important::

   This requirement is for the MongoDB instances that serve as the |onprem|
   Application Database and the Backup Database. This requirement is **not**
   for the MongoDB deployments that |onprem| can manage. For the minimum
   MongoDB versions required for MongoDB deployments for management, see
   :doc:`/reference/mongodb-compatibility/`.

.. _onprem-config-ulimits:

Ulimits Requirements
~~~~~~~~~~~~~~~~~~~~

For ulimit requirements for the servers that run MongoDB (i.e., the Backup
Daemon servers and the servers that host the |onprem| Application Database
or the Backup Database), see all of the following:

- :manual:`MongoDB Production Notes </administration/production-notes>`

- :manual:`MongoDB Ulimit Settings </reference/ulimit>` in the MongoDB manual

The |onprem| package automatically raises the following ulimits:

- open files

- max user processes

- virtual memory

.. include:: /includes/rhel-ulimit-conf-file.rst

.. _smtp-software-requirements:

SMTP
~~~~

|onprem| requires email for fundamental server functionality such as
password reset and alerts. Many Linux server-oriented distributions
include a local SMTP server by default, for example, Postfix, Exim, or
Sendmail. You also may configure |onprem| to send mail via third party
providers, including Gmail and Sendgrid.

.. _snmp-software-requirements:

SNMP
~~~~

If your environment includes SNMP, you can configure an SMNP trap receiver
with periodic heartbeat traps to monitor the internal health of |onprem|.
|onprem| uses SNMP v2c. For more information, see :ref:`Configure SNMP
Heartbeat Support <snmp-heartbeat-configure>`.

.. _client-web-browsers:

Client Web Browsers
~~~~~~~~~~~~~~~~~~~

.. IMPORTANT: The https://www.mongodb.com/subscription/downloads/ops-manager page
   links to this section.

Clients should use |onprem|\-supported browsers and will display a
warning on non-supported browsers. |onprem| supports the following
browsers:

.. include:: /includes/list-supported-browsers.rst
