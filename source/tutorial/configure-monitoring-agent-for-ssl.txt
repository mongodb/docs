==================================
Configure Monitoring Agent for SSL
==================================

.. default-domain:: mongodb

Overview
--------

|mms| supports SSL for encrypting the following connections made by
Monitoring Agents:

- Connections between the Monitoring Agents and MongoDB instances.

- Connections between the Monitoring Agents and |mms|.

Prerequisite
------------

To configure the agent to use SSL, you must have a trusted CA
certificate that signed the MongoDB instance's certificate.

Procedures
----------

Connections between Agents and MongoDB Instances
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To use SSL for the Monitoring Agent's connection to a MongoDB host, specify
the host's SSL settings when :doc:`adding the host
</tutorial/add-hosts-to-monitoring>` or by :doc:`editing the host's settings
</tutorial/enable-ssl-for-a-group>`.

.. only:: onprem

   .. note::

      In |onprem| 1.8 and later, |onprem| can manage SSL for you if you
      using Automation for the deployment. With Automation, |mms|
      prompts you for the certificates to use to connect to the
      deployment when you enable SSL and then configures the agents
      appropriately. See: :doc:`/tutorial/enable-ssl-for-a-group` for
      more information.

.. only:: cloud

   .. note::
   
      |mms| can manage SSL for you if you are using Automation for the
      deployment. With Automation, |mms| prompts you for the
      certificates to use to connect to the deployment, when you enable
      SSL and then configures the agents appropriately. See:
      :doc:`/tutorial/enable-ssl-for-a-group` for more information.

.. include:: /includes/steps/monitoring-agent-configure-ssl.rst

.. note::

   For additional information on SSL settings, including client
   certificate support, see :ref:`monitoring-agent-ssl-settings`.

Connections between Agents and |mms|
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. only:: classic or cloud

   The Monitoring Agents always use SSL when connecting to |mms|.

.. only:: onprem

   To ensure that the Monitoring Agents use SSL when connecting to
   |onprem|, Configure |onprem| to use SSL for all connections. The
   :doc:`/tutorial/configure-ssl-connection-to-web-interface` tutorial
   describes how to set up |onprem| to run over HTTPS.

   Starting with |onprem| 1.4, the Monitoring Agent validates the SSL
   certificate of the |onprem| by default.

   If you are not using a certificate signed by a trusted 3rd party,
   you must configure the Monitoring Agent to trust |onprem|.

   To specify a self-signed certificate for |onprem| that the
   Monitoring Agent should trust:

   .. include:: /includes/steps/on-prem-monitoring-agent-configure-trust.rst
