.. This page is hidden from the TOC and from Google/Marian search indexing.

:orphan:

.. meta::
   :robots: noindex, nosnippet

.. _pa-autopilot:

===========================================
Auto-Index Creation for Performance Advisor
===========================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Auto-index creation for Performance Advisor periodically checks for
index recommendations and automatically creates indexes deemed to have
a high impact on cluster performance.

.. _autopilot-limitations:

Auto-Index Creation Availability
--------------------------------

You can enable auto-index creation if your cluster meets all of
the following criteria:

- Runs MongoDB 4.4 or later.

- Uses tiers ``M10`` and ``M30`` (inclusive).

- Does not run as a sharded cluster.

How Auto-Index Creation Creates Indexes
---------------------------------------

Auto-index creation prioritizes creating indexes with the highest
:guilabel:`Impact` score. |service| defines *impact* as the estimated
performance improvement that the index would bring.

To learn more about the :guilabel:`Impact` score and how the
Performance Advisor ranks indexes, see :ref:`pa-index-ranking`.

Performance Advisor doesn't show individual index recommendations by
default. Performance Advisor shows the number of index recommendations
per impact level (high and medium). To view the individual indexes that
the auto-index creation would create, click
:guilabel:`View Recommendations`. |service| only creates high-impact
indexes automatically.

Enable Auto-Index Creation
--------------------------

Auto-index creation defaults to *off*. You can enable auto-index
creation for your cluster through either the |service| console or
{+atlas-admin-api+}.

.. tabs::

   .. tab:: Atlas Console
      :tabid: ui

      To enable auto-index creation for your cluster:

      1. Open :guilabel:`Performance Advisor`.

      #. In the :guilabel:`Create Indexes` panel, toggle
         :guilabel:`Auto-Index Creation` to on.

      If you click :guilabel:`View Recommendations`, you can enable
      auto-index creation from the individual recommendations view.

      Once you enable auto-index creation, |service| begins creating
      high-impact indexes if |service| suggests them.

   .. tab:: {+atlas-admin-api+}
      :tabid: api

      To create a new cluster with auto-index creation enabled, send a request to the :ref:`Create One Cluster <create-one-cluster-ref>`
      endpoint.

      To enable auto-index creation on an existing cluster, send a
      request to the :ref:`Modify One Cluster <modify-one-cluster-ref>`
      endpoint.

      The request body must set the
      ``autoScaling.autoIndexingEnabled`` field to ``true``.

      The following example request creates a new single region
      cluster with auto-index creation enabled:

      .. code-block:: sh
         :emphasize-lines: 8-11

         curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" --digest \
              --header "Content-Type: application/json" \
              --include \
              --request POST "https://cloud.mongodb.com/api/atlas/v1.0/groups/{GROUP-ID}/clusters?pretty=true" \
              --data '
                {
                  "name": "SingleRegionCluster",
                  "autoScaling": {
                    "autoIndexingEnabled": true
                  }
                  "diskSizeGB": 100,
                  "numShards": 1,
                  "providerSettings": {
                  "providerName": "AWS",
                  "diskIOPS": 300,
                  "instanceSizeName": "M40",
                  "regionName": "US_EAST_1"
                  },
                  "clusterType" : "REPLICASET",
                  "replicationFactor": 3,
                  "replicationSpecs": [{
                    "numShards": 1,
                    "regionsConfig": {
                      "US_EAST_1": {
                        "analyticsNodes": 0,
                        "electableNodes": 3,
                        "priority": 7,
                        "readOnlyNodes": 0
                      }
                    },
                    "zoneName": "Zone 1"
                  }],
                  "backupEnabled": false,
                  "providerBackupEnabled" : true,
                  "autoScaling": {
                  "diskGBEnabled": true
                  }
                }'

Review Automatically Created Indexes
------------------------------------

|service| sends an email alert when it creates an index automatically.
You can view automatically created indexes from the {+atlas-ui+}
:ref:`Indexes <atlas-ui-indexes>` view. The {+atlas-ui+} shows
indexes that auto-index creation generated with the
:guilabel:`Auto-Created` property.

Drop Automatically Created Indexes
----------------------------------

You can drop auto-created indexes as you would any other index. To drop
an auto-created index, click :guilabel:`Drop Index`. If you drop an
auto-created index, auto-index creation doesn't recreate that index.
Performance Advisor may still recommend that index.
