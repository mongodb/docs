.. _atlas-free-tier:

=======================================================
|service| M0 ({+Free-Cluster+}), M2, and M5 Limitations
=======================================================

.. default-domain:: mongodb

.. _shared-limits-config:

Configuration Limitations
-------------------------

The following table lists the configuration limitations of |service|
``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+}:

.. list-table::
   :widths: 30 70
   :header-rows: 1
   :stub-columns: 1

   * - Configuration Option
     - Limitation

   * - Cloud Service Provider and Region
     - ``M0``  {+free-clusters+} and ``M2/M5`` {+shared-clusters+} are only
       deployable in a subset of regions on |aws|, |gcp|, and Azure.
       For more information on which cloud provider regions support
       {+free-clusters+} and {+shared-clusters+}, see:

       - :ref:`Amazon Web Services (AWS) <amazon-aws>`
       - :ref:`Google Cloud Platform (GCP) <google-gcp>`
       - :ref:`Microsoft Azure <microsoft-azure>`

   * - MongoDB Version and Storage Engine
     - |service| uses MongoDB 4.4 for ``M0/M2/M5`` clusters.

   * - MongoDB Version Upgrade
     - You can't upgrade the MongoDB version that ``M0/M2/M5`` clusters
       run.

       |service| upgrades ``M0/M2/M5`` clusters to the
       newest MongoDB version after several patch versions become
       available for that version. To learn more about how MongoDB
       versions its software, see
       :manual:`MongoDB Versioning </reference/versioning>`.

   * - Cluster Tier
     - You must select the ``M0`` cluster tier to deploy a {+free-cluster+}.

   * - Cluster Memory
     - You cannot configure memory for ``M0`` {+free-clusters+} or ``M2/M5``
       {+shared-clusters+}.

   * - Cluster Storage
     - You cannot configure storage size for ``M0`` {+free-clusters+} or
       ``M2/M5`` {+shared-clusters+}.

   * - Replication Factor
     - Replication Factor is set to ``3 Nodes`` and cannot be modified
       for ``M0`` {+free-clusters+} or ``M2/M5`` {+shared-clusters+}.

   * - Replica Set Tags
     - ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+} are not
       configured with pre-defined
       :ref:`replica set tags <replica-set-tags>`.

   * - Do You Want A Sharded Cluster
     - You cannot deploy a ``M0`` {+free-cluster+} or ``M2/M5`` shared
       cluster as a Sharded Cluster.

   * - Do You Want To Enable Backup
     - You cannot enable backups on ``M0`` {+free-clusters+}.

       .. seealso:: 
       
          Backup Alternative: |mongodump|

          .. include:: /includes/fact-mongodump-for-backup.rst

   * - Test Failovers
     - You cannot perform primary failover testing on ``M0`` {+free-clusters+}
       or ``M2/M5`` {+shared-clusters+}.

   * - Database Auditing
     - You cannot configure
       :doc:`database auditing </database-auditing>` on ``M0`` Free
       Tier or ``M2/M5`` {+shared-clusters+}.

   * - Encryption at Rest using your Key Management
     - You cannot configure :ref:`security-kms-encryption` on
       ``M0`` {+free-clusters+} or ``M2/M5`` {+shared-clusters+}.

   * - Network Peering Connections
     - You cannot configure :doc:`/security-vpc-peering` on
       ``M0`` {+free-clusters+} or ``M2/M5`` {+shared-clusters+}.

   * - Access Tracking
     - You cannot view the database access history for ``M0`` Free
       Tier, or ``M2/M5`` {+shared-clusters+}.

   * - Configure TLS Certificate Root 
     - You cannot modify the |certauth| that MongoDB |service| clusters 
       use through the API for ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+}.

.. _shared-limits-ops:

Operational Limitations
-----------------------

The following table lists the operational limitations of |service|
``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+}:

.. list-table::
   :widths: 30 70
   :header-rows: 1
   :stub-columns: 1

   * - Operation
     - Limitation

   * - :manual:`Aggregation </aggregation>`
     - |service| {+free-clusters+} and {+shared-clusters+} do not support the
       ``allowDiskUse`` option for the
       :manual:`aggregation command </reference/command/aggregate>`
       or its
       :manual:`helper method </reference/method/db.collection.aggregate>`.

       On {+free-clusters+} and {+shared-clusters+}, aggregation fields that represent
       database and collection names (such as :manual:`$merge
       </reference/operator/aggregation/merge/>` into and
       :manual:`$out </reference/operator/aggregation/out/>` values) cannot
       accept :manual:`expressions
       </meta/aggregation-quick-reference/#aggregation-expressions>` as values.

       On {+free-clusters+} and {+shared-clusters+}, aggregation pipelines are restricted
       to 50 stages.

   * - |api| Access
     - While you can create an ``M0`` {+free-cluster+} using the 
       :doc:`/reference/api/clusters` |api| resource, you cannot 
       modify an ``M0`` {+free-cluster+} using the 
       :doc:`/reference/api/clusters` |api| resource. A subset of |api| 
       endpoints support ``M2`` and ``M5`` {+shared-clusters+}.

       .. note::
       
          You can create an ``M0`` {+free-cluster+} using the
          :doc:`/reference/api/clusters` |api| resource. You can create 
          only one ``M0`` {+free-cluster+} per project.

   * - |service| Alerts
     - ``M0/M2/M5`` clusters can only trigger alerts configured with
       one of the following
       :doc:`alert conditions </reference/alert-conditions>`:

       - Connections
       - Logical Size
       - Network
       - Opscounter

   * - |service| Monitoring
     - The :guilabel:`Metrics` view of an ``M0`` {+free-cluster+} or
       ``M2/M5`` {+shared-cluster+} only displays the following metrics:

       - Connections
       - Logical Size
       - Network
       - Opscounter

       For more information on these metrics, see
       :ref:`Real Time Metrics <real-time-metrics-status-tab>`.

   * - Authentication
     
     - ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+} support only the 
       following authentication methods:
      
       - Password (SCRAM-SHA1)
       - X.509 Certificates
       - AWS IAM

   * - Auto-Expand Storage
     - ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+} do not provide
       automatically scaling storage.

   * - |bson| Nested Object Depth
     - ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+}
       can't store documents with more than 50 nested levels.

   * - Build Index with Rolling Build
     - ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+} do not provide
       the ability to :manual:`build indexes with a rolling build
       </tutorial/build-indexes-on-replica-sets/>`.

   * - Cluster Persistence
     - |service| may deactivate idle ``M0`` {+free-clusters+} as per
       the :website:`Terms of Service </cloud-terms-and-conditions>`.

   * - Connections
     - ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+} are allowed a
       maximum of 500 connections.

   * - Cursors
     - {+Free-clusters+} and {+shared-clusters+} cannot use the :manual:`noTimeout
       cursor option </reference/method/cursor.addOption/#flags>`.

   * - Custom Roles
     - Changes to :doc:`custom roles </security-add-mongodb-roles>`
       might take up to 30 seconds to deploy in ``M0`` {+free-clusters+} and
       ``M2/M5`` {+shared-clusters+}.

   * - Database and Collections
     - ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+} have a maximum
       of 100 databases and 500 collections total.

   * - Database Commands
     - Certain database commands are unsupported or behave
       differently in an ``M0`` {+free-cluster+}. To learn more, see
       :doc:`Command Limitations in {+Free-Clusters+} </unsupported-commands>`.

       Please contact |service| support for any questions or comments
       related to restricted commands.

   * - Database Logs
     - ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+} do not provide
       downloadable logs.

   * - Data Recovery
     - .. include:: //includes/fact-backup-shared-tier-limitations.rst

   * - Data Transfer Limits

     - ``M0/M2/M5`` clusters limit the total data transferred into or
       out of the cluster in a rolling seven-day period. This varies by
       cluster tier as follows:

       - ``M0``: 10 GB in and 10 GB out per period

       - ``M2``: 20 GB in and 20 GB out per period

       - ``M5``: 50 GB in and 50 GB out per period

       |service| throttles the network speed of clusters which
       exceed the posted limits.

   * - JavaScript
     - ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+} do not support
       server-side JavaScript.

       .. example::

          :manual:`$where </reference/operator/query/where>` and
          :manual:`map-reduce </core/map-reduce>` are not supported.

   * - Namespaces and Database Names
     - ``M0`` {+free-cluster+} and ``M2/M5`` {+shared-cluster+} namespaces are
       limited to 95 bytes. Database names are limited to 38 bytes.

   * - Number of {+Free-Clusters+}
     - You can deploy at most *one* ``M0`` {+free-cluster+} per
       |service| project.

   * - Performance Advisor
     - ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+} do not provide
       access to the :doc:`Performance Advisor </performance-advisor>`.
  
   * - Query Utilization
     - The percentage of time that a query is running over any five
       minute period must remain under 100% on ``M0`` {+free-clusters+} and
       ``M2/M5`` {+shared-clusters+}.

   * - Real-Time Performance Panel
     - ``M0`` {+free-clusters+} and ``M2/M5`` {+shared-clusters+} do not provide
       access to the :doc:`Real-Time Performance Panel </real-time-performance-panel>`.

   * - Sort in Memory
     - ``M0/M2/M5`` sort in memory limit is 32 MB.

   * - Throughput
     - Maximum operations:

       - ``M0``: 100 per second
       - ``M2``: 200 per second
       - ``M5``: 500 per second

   * - Automatic Pause of Idle Clusters
     - |service| automatically pauses ``M0`` clusters after 60 days of
       inactivity where there are zero connections to the cluster. You
       can :ref:`resume <resume-cluster>` the cluster at any time. 

.. _shared-limits-drivers:

Driver Minimum Requirements
---------------------------

.. list-table::
   :widths: 30 70
   :header-rows: 1
   :stub-columns: 1

   * - Driver
     - Description

   * - Drivers that use a |jre| or |jdk|
     - Due to an issue with |tls| 1.3 support in the Java |jdk|
       (`JDK-8236039 <https://bugs.openjdk.java.net/browse/JDK-8236039>`__), upgrade the |jdk| that supports the
       driver you use to connect to |service|.

       Minimum versions of the |jdk| include:

       .. list-table::
          :widths: 40 60
          :stub-columns: 1

          * - 14u-cpu
            - `JDK-8249107 <https://bugs.openjdk.java.net/browse/JDK-8249107>`__
          * - 14.0.2
            - `JDK-8247954 <https://bugs.openjdk.java.net/browse/JDK-8247954>`__
          * - 13.0.3
            - `JDK-8241515 <https://bugs.openjdk.java.net/browse/JDK-8241515>`__
          * - 11.0.8-oracle
            - `JDK-8238504 <https://bugs.openjdk.java.net/browse/JDK-8238504>`__
          * - 11.0.7
            - `JDK-8237387 <https://bugs.openjdk.java.net/browse/JDK-8237387>`__
          * - 8u261
            - `JDK-8243759 <https://bugs.openjdk.java.net/browse/JDK-8243759>`__
          * - emb-8u261
            - `JDK-8247097 <https://bugs.openjdk.java.net/browse/JDK-8247097>`__

       To check if other Java-based languages, libraries, and drivers
       support the change to |tls| 1.3, refer to their
       documentation:

       - `MongoDB Java, Reactive Streams, and Scala Drivers <https://mongodb.github.io/mongo-java-driver/>`__
       - `Scala <https://docs.scala-lang.org/overviews/jdk-compatibility/overview.html>`__
       - `Kafka <https://kafka.apache.org/documentation/#java>`__
