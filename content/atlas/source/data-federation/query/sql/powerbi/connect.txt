.. _sql-connect-powerbi:

====================================
Connect from Power BI
====================================

.. meta::
   :description: Connect Atlas SQL to Power BI using the Power BI Connector, enabling direct queries for up-to-date data access.

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol
      
This page describes how to connect to either an {+service+} {+fdi+} or an on-premises
{+MongoDB-Enterprise+} database with Power BI.

Prerequisites
-------------

- `Power BI Desktop <https://learn.microsoft.com/en-us/power-bi/fundamentals/desktop-get-the-desktop/>`__ 64 bit. Microsoft
  updates and releases Power BI monthly, and |service| supports only
  the latest version of Power BI Desktop.

- Windows operating system. To learn the Windows OS versions that
  Power BI Desktop supports, see `Power BI System Requirements
  <https://www.microsoft.com/en-us/download/details.aspx?id=58494>`__.

.. _connect-powerbi:

Procedure
---------

Follow these steps to enable the {+sql-interface+} and connect with Power BI.

.. procedure::
   :style:  normal
   
   .. step:: Ensure you have enabled the {+sql-interface+} for your cluster.
      
      See :ref:`<sql-get-started-quick>` for detailed instructions on enabling the 
      |service| {+sql-interface+}.

      See `On-Premise set up
      <https://www.mongodb.com/docs/atlas/data-federation/query/connect-with-sql-composable/?deployment-type=self&sql-driver=power-bi&os=windows>`__
      for detailed instructions on how to enable the {+sql-interface+} for EA databases.

   .. step:: Download the MongoDB ODBC Driver.

      Download the installer for the latest `MongoDB ODBC Driver <https://www.mongodb.com/try/download/odbc-driver/>`__.
      See :bic:`<odbc-driver>` for more details on the MongoDB ODBC Driver.

      .. note::
         
         To use :ref:`<direct-query-mode>`, you must install MongoDB ODBC Driver version 1.2 or later.

   .. step:: Download and install `the Power Bi connector file <https://www.mongodb.com/try/download/power-bi-connector/>`__.

      .. note:: 
         The certified MongoDB Power BI Connector ships with Power BI Desktop and 
         can be used for both {+service+} and EA database connections. If your version of Power 
         BI Desktop already has the MongoDB Atlas SQL connector, you can skip this step. 
         To use a different version than the one bundled with Power BI Desktop, complete this step.

   
      Move the connector file to the following directory path: 
      
      ``C:\Users\<user>\Documents\Power BI Desktop\Custom Connectors``.

      Create this folder if it doesn't already exist.

   .. step:: Connect from Power BI Desktop.

      a. Open Power BI Desktop.

      #. Select :guilabel:`Get data` from the :guilabel:`Home` menu.

      #. Find and select the :guilabel:`MongoDB Atlas SQL` connector.
            
         i. Type ``mongo`` in the search bar to find the new connector.
         #. Select :guilabel:`MongoDB Atlas SQL`.
         #. Click :guilabel:`Connect`.

      #. Enter the URI and the database name and click :guilabel:`OK`.

         The :guilabel:`MongoDB URI` is the URL is the from the previous step.

         You can also enter a SQL query in the :guilabel:`Native query` field. Power BI
         uses the SQL query as the direct source for the data.

      #. Enter your Atlas :guilabel:`User name` and :guilabel:`Password` and click :guilabel:`Connect`.

         By default, a user can access all {+clusters+} and {+fdi+}s in projects to which
         they have access. If you restricted access to specific {+clusters+} and {+fdi+}s,
         you can grant access to the new {+fdi+} in the Edit User menu. To learn more, see
         :ref:`Configure Database Users <modify-mongodb-users>`.

.. _direct-query-mode:

Direct Query
------------

Direct Query is a connection mode available with the MongoDB Power BI connector version
1.2 and later. To use Direct Query, you must install `MongoDB ODBC Driver
<https://www.mongodb.com/try/download/odbc-driver/>`__ version 1.2 or later.

Direct Query is alternative to the standard Import Mode, and allows you to query your
database directly. This guarantees up-to-date data but may take longer to return results.

Direct Query does not support some actions. If you try to perform an unsupported
action, Power BI prompts you to switch to Import Mode.
