==================================
Configure Multiple Snapshot Stores
==================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Overview
--------

Additional Snapshot Stores can be deployed to one or more data centers if existing stores have reached capacity. 

- If you use a :term:`Backup Blockstore Database` for snapshot storage, 
  then you can :ref:`add new blockstores <add-blockstore>`.

- If you use a file system store for snapshot storage, then you can 
  :ref:`add new file system stores <add-filestore>`.

You can bind specific |onprem| :term:`groups <group>` to specific snapshot
stores and particular data centers. This assigns the backups of particular
MongoDB deployments to specific data centers.

Deploy snapshot stores to multiple data centers when:

- Two sets of backed up data cannot have co-located storage for
  regulatory reasons.

- You want to reduce cross-data center network traffic by keeping each
  snapshot store in the data center it backs.

This tutorial sets up two snapshot stores, one in each of two separate data
centers and attaches a separate group to each.

Prerequisites
-------------

The two |application| instances must share a single dedicated
:ref:`mms-application-database`. You can put members of the |application|
Database replica set in each data center.

.. If a :term:`Backup Blockstore Database` is used:

Each data center hosts a :term:`Backup Blockstore Database`
and requires its own :ref:`application` and 
:doc:`Backup Agent </tutorial/nav/install-backup-agent>`.

Configure each Backup Agent to use the URL for its local
|application|. You can configure each |application| to use a different
hostname, or you can use split-horizon DNS to point each agent to its
local |application|.

The |application| Database and the Backup Blockstore Databases are
MongoDB databases and can run as :term:`standalones <standalone>` or
:term:`replica sets <replica set>`. For production deployments, use
replica sets to provide database :manual:`high availability
</core/replica-set-high-availability>`.

Procedures
----------

Provision Servers in Each Data Center
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Each server must meet the cumulative hardware and software requirements
for the components it runs. See :doc:`/core/requirements`.

All servers running Backup and |application| Databases use MongoDB. They must meet the configuration requirements in the :manual:`MongoDB Production Notes </administration/production-notes>`.

Install MongoDB
~~~~~~~~~~~~~~~

Install MongoDB on the servers that host the:

- |application| Database
- Blockstore Databases

See :manual:`Install MongoDB </installation>` in the MongoDB manual to
find the correct install procedure for your operating system. 

To run replica sets for the |application| Database and Blockstore Databases, see :manual:`Deploy a Replica Set </tutorial/deploy-replica-set>` in the MongoDB manual.

Install and Start the |application|
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Install the |application| in each data center.

.. note::
   See :doc:`/tutorial/nav/install-application` for instructions for your
   operating system.

.. important::
   Each set of installation instructions for each operating system covers how
   to create a multiple instances of an |application|. These activities need
   to be completed before a

Bind Groups to Backup Resources
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/steps/configure-backup-data-locality-bind-groups.rst
