=================
Troubleshoot SNMP
=================

.. versionadded:: 2.5.3

.. admonition:: Enterprise Feature

   SNMP is only available in MongoDB Enterprise.

Overview
--------


MongoDB Enterprise can report system information into SNMP traps, to
support centralized data collection and aggregation. This document
identifies common problems you may encounter when deploying MongoDB
Enterprise with SNMP as well as possible solutions for these issues.

See :doc:`/tutorial/monitor-mongodb-with-snmp`
and :doc:`/tutorial/monitor-mongodb-windows-with-snmp` for
complete installation instructions.

Issues
------

"Failed to connect to the agentx master agent"
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The following in the :program:`mongod` logfile:

.. code-block:: none

   Warning: Failed to connect to the agentx master agent

AgentX is the SNMP agent extensibility protocol defined in Internet
`RFC 2741 <http://www.ietf.org/rfc/rfc2741.txt>`_. It explains how
to define additional data to monitor over SNMP. When MongoDB fails
to connect to the agentx master agent, use the following procedure to
ensure that the SNMP subagent can connect properly to the SNMP master.

#. Make sure the master agent is running.

#. Compare the SNMP master's configuration file with the subagent
   configuration file. Ensure that the agentx socket definition is
   the same between the two.

#. Check the SNMP configuration files to see if they specify using UNIX
   Domain Sockets. If so, confirm appropriate permissions.

"Argument not available"
~~~~~~~~~~~~~~~~~~~~~~~~

The following error at the command line:

.. code-block:: none

   Argument not available

You may have tried to invoke :program:`mongos` or one of the other
MongoDB binaries with :option:`--snmp-master` or :option:`--snmp-subagent`.
These binaries do not support SNMP.

"error starting SNMPAgent as master"
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The following line in the log file indicates
that :program:`mongod` cannot read the ``mongod.conf`` file:

.. code-block:: none

   [SNMPAgent] warning: error starting SNMPAgent as master err:1

If running on Linux, ensure ``mongod.conf`` exists in the ``/etc/snmp``
directory, and ensure that the :program:`mongod` UNIX user has
permission to read the ``mongod.conf`` file.

If running on Windows, ensure ``mongod.conf`` exists in
``C:\snmp\etc\config``.

