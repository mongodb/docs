==============================
Automation Agent Configuration
==============================

.. default-domain:: mongodb

Configuration File
------------------

The location of the Automation Agent configuration file depends on your
operating system:

- RHEL, CentOS, Amazon Linux, and Ubuntu all use a package manager to
  install the agent. The package manager creates the following agent
  configuration file::

     /etc/mongodb-mms/automation-agent.config

- OS X, Windows, and other Linux systems use either a ``tar`` or ``msi``
  file for the installation. The Automation Agent stores its configuration
  in the following file::

     <installation directory>/local.config

Settings
--------

|mms| provides default values for many of the Automation Agent
Configuration settings. However, you **must** set the
:msetting:`~mmsGroupId` and :msetting:`~mmsApiKey` values.

.. _automation-agent-connection-settings:

Connection Settings
~~~~~~~~~~~~~~~~~~~

.. msetting:: mmsGroupId

   *Type*: string

   **Required**. The ID of your |mms| group. You can find it in |mms| under the
   :guilabel:`Group Settings` page in the :guilabel:`Administration` tab.

   For example:

   .. code-block:: ini

      mmsGroupId=8zvbo2s2asigxvmpnkq5yexf

.. msetting:: mmsApiKey

   *Type*: string

   **Required**. The |mms| agent API key for the group. To retrieve the key from the |mms|
   interface, click the :guilabel:`Administration` tab, then the
   :guilabel:`Group Settings` page.

   For example:

   .. code-block:: ini

      mmsApiKey=rgdte4w7wwbnds9nceuodx9mcte2zqem

.. msetting:: mmsBaseUrl

   *Type*: string

   The URL of the |mms| Web Server.

.. only:: onprem

   Set this to the URL of your |mms| HTTP Service.
   For example:

   .. code-block:: ini

      mmsBaseUrl=http://example.com:8080

.. msetting:: logFile

   *Type*: string

   The path to which |mms| should write the automation agent's log. By
   default, the path is
   ``/var/log/mongodb-mms-automation/automation-agent.log``, but you can
   choose an alternate location if desired.

   For example:

   .. code-block:: ini
   
      logFile=/var/log/mongodb-mms-automation/automation-agent.log

.. msetting:: mmsConfigBackup

   *Type*:

   The path to the file where the Automation Agent stores a backup copy
   of the |mms| :ref:`automation configuration
   <automation-configuration-sample-entity>`, which describes the
   desired state of the deployment.

   For example:

   .. code-block:: ini

      mmsConfigBackup=/var/lib/mongodb-mms-automation/mms-cluster-config-backup.json

Logging Settings
~~~~~~~~~~~~~~~~

.. msetting:: logLevel

   *Type*: string

   The level of logging granularity. You can choose from the following
   severity levels, from most verbose to least. By default,
   :msetting:`logLevel` is ``INFO``.
   
   - ``DEBUG``
   - ``ROUTINE``
   - ``INFO``
   - ``WARN``
   - ``ERROR``
   - ``DOOM``

   For example:

   .. code-block:: ini
   
      logLevel=ROUTINE 

   Each level includes the log items covered by the following levels.
   For instance, if you choose ``DEBUG``, the Automation Agent logs all
   messages, including ``ROUTINE``, ``INFO``, ``WARN``, ``ERROR``, and
   ``DOOM``. By contrast, if you choose ``DOOM``, the Automation Agent
   only logs ``DOOM`` messages.

.. msetting:: maxLogFiles

   *Type*: integer

   The maximum number of rotate log files to retain. By default,
   :msetting:`maxLogFiles` is ``10``. You can change the value to
   retain a different number of rotated log files. For example:

   .. code-block:: ini

      maxLogFiles: 15

.. msetting:: maxLogFileSize

   *Type*: integer

   Specifies the maximum size, in bytes, that a log file can be before
   triggering log rotation. For example:

   .. code-block:: ini

      maxLogFileSize=536870912

HTTP Proxy Settings
~~~~~~~~~~~~~~~~~~~

.. msetting:: httpProxy

   *Type*: string

   To connect to the |mms| HTTP Service via a proxy, specify the URL of
   the proxy. For example:

   .. code-block:: ini

      httpProxy=http://example-proxy.com:8080
