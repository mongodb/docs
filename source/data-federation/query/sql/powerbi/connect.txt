.. _sql-connect-powerbi:

=====================
Connect from Power BI
=====================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

This page describes how to connect to a {+cluster+} with {+asql+} and
Power BI using the Power BI Connector.

Prerequisites
-------------

- An |service| {+cluster+} running MongoDB version 5.0 or later.

- `Power BI Desktop <https://learn.microsoft.com/en-us/power-bi/fundamentals/desktop-get-the-desktop/>`__ 64 bit. Microsoft
  updates and releases Power BI monthly, and |service| supports only
  the latest version of Power BI Desktop.

- Windows operating system. To learn the Windows OS versions that
  Power BI Desktop supports, see `Power BI System Requirements
  <https://www.microsoft.com/en-us/download/details.aspx?id=58494>`__.

.. _connect-powerbi:

Procedure
---------

Follow these steps to enable {+asql+} and connect with Power BI.

.. procedure::
   :style:  normal

   .. step:: Enable {+asql+}.

      .. procedure::

         .. step:: Click :guilabel:`Database` in the left navigation and find the {+cluster+} you want to connect.

         .. step:: Under :guilabel:`Atlas SQL`, click :guilabel:`Connect`.

            a. On the lower right side of the {+cluster+} card under
               :guilabel:`Atlas SQL`, click :guilabel:`Connect`. 
            b. If the :guilabel:`Introducing the Atlas SQL Interface`
               dialog box displays, click :guilabel:`Get Started`.

         .. step:: Click :guilabel:`Quick Start`

            :guilabel:`Quick Start` configures a {+fdi+} for your
            {+cluster+} with the default settings. 
            
            To set up :guilabel:`Advanced Configuration`,
            including querying across |service| data sources or
            limiting the namespaces to query, you must :ref:`Manually Create a Federated Database Instance for Atlas SQL <gst-deploy-adf>`.

         .. step:: Under :guilabel:`Create an Atlas SQL Connection for this cluster`, click :guilabel:`Create`.

         .. step:: Under :guilabel:`Select your driver`, select :guilabel:`Tableau Connector`.

            .. note::

               The connection URL for the Tableau Connector is the same
               as the connection URL for the Power BI Connector.

         .. step:: Under :guilabel:`Get Connection String`, select a database and copy the :guilabel:`URL`.

            The URL is required to connect from Power BI Desktop.

   .. step:: Download the MongoDB ODBC Driver.

      Download the installer for the latest `MongoDB ODBC Driver <https://www.mongodb.com/try/download/odbc-driver/>`__.

   .. step:: Download and install the MongoDB Atlas Power BI Connector.

      .. procedure::

         .. step:: Download `the connector file <https://www.mongodb.com/try/download/power-bi-connector/>`__. 
      
         .. step:: Move the connector file to the following directory path: ``C:\Users\Documents\Power BI Desktop\Custom Connectors``.

            Create this folder if it doesn't already exist.

   .. step:: Connect from Power BI Desktop.

      .. procedure::
   
         .. step:: Open Power BI Desktop.

         .. step:: Select :guilabel:`Get data` from the :guilabel:`Home` menu.

         .. step:: Find and select the :guilabel:`MongoDB Atlas SQL` connector.
            
            a. Type ``mongo`` in the search bar to find the new connector.
            b. Select :guilabel:`MongoDB Atlas SQL`.
            c. Click :guilabel:`Connect`.

         .. step:: Enter the URI and the database name and click :guilabel:`OK`.

            The :guilabel:`MongoDB URI` is the URL is the from the previous step.

         .. step:: Enter your Atlas :guilabel:`User name` and :guilabel:`Password` and click :guilabel:`Connect`.

            By default, a user can access all {+clusters+} and {+fdi+}s in projects to which they have access. If you restricted
            access to specific {+clusters+} and {+fdi+}s, you can grant
            access to the new {+fdi+} in the Edit User menu. To learn more, see :ref:`modify-mongodb-users`.
