=======================================
Add Existing MongoDB Processes to |mms|
=======================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Overview
--------

|mms| provides a wizard for adding your existing MongoDB deployments to
monitoring and management. The wizard prompts you to install an 
:term:`Automation Agent` if none exists, and then prompts you to 
identify the :term:`cluster <sharded cluster>`, the :term:`replica set`, 
or the :term:`standalone` to add. You can choose to add the deployment 
to :ref:`Monitoring <monitoring-functional-overview>` or to both 
:ref:`Monitoring <monitoring-functional-overview>` and 
:ref:`Automation <automation>`.

Considerations
--------------

Unique Names
~~~~~~~~~~~~

Deployments must have unique names within the projects.

.. include:: /includes/important-unique-names-deployment-items.rst

|tls-ssl|
~~~~~~~~~

If you enable |tls-ssl|, the :abbr:`FQDN (Fully Qualified Domain Name)`
for the host serving a MongoDB process must match the 
:abbr:`SAN (Subject Alternative Name)` for the |ssl| 
certificate on that host. 

Though it is possible to use one |ssl| certificate with multiple 
:abbr:`SANs (Subject Alternative Names)` or a wildcard |ssl|
certificate on each host, it is not advised. Per 
`RFC 2818, section 3.1 <https://tools.ietf.org/html/rfc2818#section-3.1>`_, 
keep the scope of SSL certificates as narrow as possible to 
prevent man-in-the-middle attacks.

Preferred Hostnames
~~~~~~~~~~~~~~~~~~~

If the MongoDB process is accessible only by specific hostname or IP
address, or if you need to specify the hostname to use for servers with
multiple aliases, set up a preferred hostname. For details, see the
:guilabel:`Preferred Hostnames` setting in :ref:`group-settings-page`.

Authentication
~~~~~~~~~~~~~~

- When adding to Monitoring:
    If your MongoDB deployment requires authentication, you must
    provide the necessary credentials for monitoring when adding the
    deployment to |mms|. For information on configuring authentication,
    see :doc:`/tutorial/edit-host-authentication-credentials`.

- When adding to Automation:
    If the |mms| project has MongoDB authentication settings enabled for
    its deployments, the MongoDB deployment to import must support the
    projects's authentication mechanism.

    If either the MongoDB deployment requires authentication or
    the |mms| project has authentication settings enabled, you must add
    an automation user with the appropriate roles to the MongoDB
    process in order to perform the import. If the |mms| project has
    authentication settings enabled, add the |mms| project's automation
    user to the MongoDB process. See
    :ref:`add-existing-mongodb-prerequisites`.

.. _automation-updated-security-settings:

Automation and Updated Security Settings Upon Import
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/fact-imported-users-to-automation.rst

.. _add-existing-mongodb-prerequisites:

Prerequisites
-------------

.. note::

   The following prerequisite applies only when adding to Automation.

.. include:: /includes/prerequisite-for-adding-existing-deployment-to-automation.rst

Add MongoDB Processes
---------------------

.. include:: /includes/steps/add-existing-mongodb-processes.rst
