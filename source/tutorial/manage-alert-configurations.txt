===========================
Manage Alert Configurations
===========================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Overview
--------

.. include:: /includes/extracts/manage-alert-configurations-overview.rst

Considerations
--------------

.. _sms-delivery-considerations:

SMS Delivery
~~~~~~~~~~~~

Many factors may affect alert delivery, including do not call lists,
caps for messages sent or delivered, delivery time of day, and message
caching.

Check with your telephone service contract for the costs associated
with receiving text messages.

If you choose SMS, |mms| sends alert text messages to all users in the
project who have a mobile number associated with their user account.

Alert Intervals
~~~~~~~~~~~~~~~

You can create multiple alert configurations with different
frequencies. The minimum frequency for an alert is 5 minutes. 

The time between re-notifications increases by the frequency amount
every alert cycle up to a maximum of 24 hours. For example, if the
frequency amount is 5 minutes, and the alert condition is first
triggered at 9am, subsequent alerts occur at 9:05am, 9:15am, 9:30am,
etc.

You can set the time to elapse before |mms| sends an alert after an
alert condition occurs. This helps eliminate false positives.

Default Alert Configurations
----------------------------

.. tabs::

   tabs:
     - id: org
       name: Organization Alerts
       content: |
         
         |mms| provides no default alerts for organizations.

     - id: project
       name: Project Alerts
       content: |

         |mms| creates the following alert configurations for a project
         automatically upon creation of the project:

         - :alert-type:`User joined the project <JOINED_GROUP>`

         .. only:: cloud

            - :alert-type:`Host is exposed to the public Internet <HOST_EXPOSED>`

         - :alert-type:`Host's SSL certificate will expire within 30 days <HOST_SSL_CERTIFICATE_STALE>`

         - :alert-type:`{+magent+} is down <MONITORING_AGENT_DOWN>`

         If you enable Backup, |mms| creates the following alert 
         configurations for the project, if they do not already exist:

         - :alert-type:`Backup oplog is behind <OPLOG_BEHIND>`

         - :alert-type:`Backup requires a resync <RESYNC_REQUIRED>`

         - :alert-type:`Cluster is missing an active mongos <CLUSTER_MONGOS_IS_MISSING>`

         .. only:: cloud

            If you enter a payment method, |mms| creates the following alert configuration:

            - :alert-type:`CREDIT_CARD_ABOUT_TO_EXPIRE`

.. _settings-for-mms-alert-notifications:

Default Settings for Notification Options
-----------------------------------------

.. tabs::

   hidden: true

   tabs:
     - id: org
       name: Organization Alerts
       content: |

         You can configure default settings for the following 
         notification options:

         - |mms| Organization

         - |mms| User

         - Email
      
         - SMS

         .. only:: onprem
         
            - HipChat

         - Slack

         - PagerDuty

         - Flowdock

         .. only:: onprem

            - Datadog

         - VictorOps

         - Opsgenie
         
     - id: project
       name: Project Alerts
       content: |

         You can configure default settings for the following 
         notification options:

         - |mms| Organization

         - |mms| User

         .. only:: onprem

            - SNMP Host

         - Email
      
         - SMS

         .. only:: onprem

            - HipChat

         - Slack

         - PagerDuty

         - Flowdock

         .. only:: onprem

            - Datadog

         - VictorOps

         - Opsgenie

To configure default settings for one of the above notification
options, click :guilabel:`Integrations` under :guilabel:`Projects` in 
the sidebar. Locate the notification option and enter the default 
values.

|mms| will fill in the default values automatically when a user
selects that option when creating an alert configuration. If the key,
token, or |url| that is used to send the notification becomes invalid,
|mms| will send an email to the project owner and will eventually
remove the key, token, or |url|.

.. _create-alert-configuration:

Create an Alert Configuration
-----------------------------

When you create a new alert, you can clone an existing alert.

.. tabs::

   hidden: true

   tabs:
     - id: org
       name: Organization Alerts
       content: |

         .. include:: /includes/steps/configure-org-alert.rst
         
     - id: project
       name: Project Alerts
       content: |

         .. include:: /includes/steps/configure-project-alert.rst

Delete an Alert Configuration
-----------------------------

.. tabs::

   hidden: true

   tabs:
     - id: org
       name: Organization Alerts
       content: |
         
         .. include:: /includes/steps/delete-org-alert.rst

     - id: project
       name: Project Alerts
       content: |

         .. include:: /includes/steps/delete-project-alert.rst

If you delete an alert setting, |mms| cancels active alerts related to 
the setting. A deleted alert setting does not remain visible.

Disable or Enable an Alert Configuration
----------------------------------------

.. tabs::

   hidden: true

   tabs:
     - id: org
       name: Organization Alerts
       content: |
         
         .. include:: /includes/steps/disable-org-alert.rst

     - id: project
       name: Project Alerts
       content: |

         .. include:: /includes/steps/disable-project-alert.rst

If you disable an alert setting, |mms| cancels active alerts related to 
the setting. A disabled alert setting remains visible but grayed-out 
and can be later re-enabled.

If you need to disable an alert only for a period of time, you 
can alternatively
:ref:`suspend alerts <suspend-alerts-during-maintenance-window>`.

View the History of Changes to an Alert Configuration
-----------------------------------------------------

.. tabs::

   hidden: true

   tabs:
     - id: org
       name: Organization Alerts
       content: |
         
         .. include:: /includes/steps/alert-configuration-history-org.rst

     - id: project
       name: Project Alerts
       content: |

         .. include:: /includes/steps/alert-configuration-history.rst
