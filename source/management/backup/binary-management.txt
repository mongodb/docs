====================================
MMS On-Prem Backup Binary Management
====================================

.. default-domain:: mongodb

Overview
--------

The MMS service backup daemon recreates every replica set you backup up
and applies the oplog entries sent by the backup agents. MMS 
maintains a standalone MongoDB database on disk for each backed up replica
set, also called a *head*. Each head is less than or equal to the last oplog
supplied by the backup agent. Operations require no blocking operations in 
progress, for example, snapshots, as well as sufficient resources for the
machine and daemon.

The backup daemon must use a :program:`mongod` equal or greater than the
version of any replica set it backs up. If version 2.4.9 is the latest 
revision installed on the daemon, for example, backing up a ``mongod``
with version 2.4.8 will use a 2.4.9 mongo for head. However, backing up a
2.4.10 ``mongod`` with a 2.4.9 daemon will result in an error.

The ``conf-daemon.properties`` configuration file in the 
``/opt/mongodb/mms-backup-daemon/conf`` folder 
includes two directives, ``mongodb.release.directory`` and 
``mongodb.release.autoDownload``, to manage the use and update of versions 
of these :program:`mongod` binaries.

Directives
----------

.. setting:: mongodb.release.directory

   Specify the full directory path.

   This value should point to a folder that contains every MongoDB release
   needed by the backup daemon. If you update versions manually, name the
   folders within this full directory path ``mongodb-linux-x86_64-2.4.8``,
   ``mongodb-linux-x86_64-2.6.0``, and so on. Or name folders ``mongodb248``,
   ``mongodb260``, and so on.

.. setting:: mongodb.release.autoDownload

   Specify true (active) or false (inactive).

   The ``/opt/mongodb/backup-daemon/bin`` directory includes the
   `mongodb-fetch` utility that will download the latest releases
   directly from mongodb.org. The ``mongodb.release.autoDownload`` setting
   will automatically run this utility once an hour when the service
   starts.

   If automatic downloading is a security concern, set this setting to
   ``false``. You must then place the needed mongodb releases in the
   ``mongodb.release.directory`` manually.

