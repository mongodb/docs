.. _scatter-ref:
.. _geospatial-scatter-type:

========================
Geospatial Scatter Chart
========================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Geospatial scatter charts distribute data from a data source across
geographical locations, and, optionally, color the data points based on
the database field of your choice and scale the size of data points.
The sample images in the next section demonstrate how to construct a
geospatial scatter chart to locate the neighborhoods in NYC with the most
rooms available at a specified price.

Geospatial Scatter Chart Encoding Channels
------------------------------------------

Geospatial scatter charts use the :guilabel:`Coordinates`, 
:guilabel:`Color` and :guilabel:`Size` encoding channels.

Coordinates
~~~~~~~~~~~

The :guilabel:`Coordinates` encoding channel defines the map
area of geospatial charts. The image below distributes all of the instances
of the ``location`` geopoint in the `Sample AirBnB Listings Dataset <https://docs.atlas.mongodb.com/sample-data/sample-airbnb>`_.
However, all of the circles are green and the same size since we have
not yet specified fields for the :guilabel:`Size` and :guilabel:`Color`
encoding channels.

.. note::

   |service| provides `several sample data sets <https://docs.atlas.mongodb.com/sample-data/available-sample-datasets/>`_ 
   for download.

See the :ref:`Geopoint <geopoint-channel>` reference
page for more information about what types of data you can use in this
channel. 

.. figure:: /images/charts/geospatial-scatter-coordinates-example.png
   :alt: Geospatial scatter coordinates example

Color
~~~~~

(*Optional*) The :guilabel:`Color` encoding channel changes the color of
the data points to categorize the displayed geopoints by the value of
the selected collection field. |charts| lists the colors used in a key
to the right of the chart. In the image below, the ``property_type``
distributes the property types in NYC by color. The key to the right of
the chart indicates green for guest suites and dark blue for apartments,
for example. However, all of the circles are still the same size since
we have not yet specified a field for the :guilabel:`Size` encoding
channel.

.. figure:: /images/charts/geospatial-scatter-color-example.png
   :alt: Geospatial scatter color example

Size
~~~~

(*Optional*) The :guilabel:`Size` aggregation encoding channel changes
the size of the data point markers, with larger sizes indicating larger
aggregated values. The image below uses the mean of the ``weekly_price``
collection field to aggregate all instances of the geopoint that you
chose for the :guilabel:`Coordinates` encoding channel. The key to right
of the chart indicates the aggregation value for the different circle
sizes.

.. figure:: /images/charts/geospatial-scatter-size-example.png
   :alt: Geospatial scatter size example

.. note::

   If no fields are encoded in the :guilabel:`Size` encoding channel,
   |charts-short| displays all points with the same size.

Tooltip Detail
~~~~~~~~~~~~~~

*(Optional)* The :guilabel:`Tooltip Detail` encoding channel adds
the value of the selected field to each data point's tooltip. To
view a data point tooltip, hover over that point in the chart.

In addition to the :guilabel:`Tooltip Detail` field, the tooltip also
shows other fields used to construct the chart.

For example, the following chart encodes the :guilabel:`Summary`
field as a :guilabel:`Tooltip Detail`:

.. figure:: /images/charts/geospatial-scatter-tooltip-example.png
   :alt: Geospatial scatter tooltip example

Customization Options
---------------------

The following customization options are specific to geospatial scatter
charts. For general customization options, see :ref:`customize-charts`.

.. include:: /includes/customization/auto-set-viewport.rst

Opacity
~~~~~~~

The :guilabel:`Opacity` level of a map modifies the degree to which
the chart's map data shows through the data point markers.

Geospatial scatter charts default to ``20%``.

Stroke Thickness
~~~~~~~~~~~~~~~~

You can set the :guilabel:`Stroke Thickness`, measured in pixels, of 
the map's data point markers. The default is ``2``.

Custom Color Palette
~~~~~~~~~~~~~~~~~~~~

The color palette specifies the range of colors that corresponds to
relative aggregated values in your map. Geospatial scatter charts use a 
discrete color picker.

To enable palette customization, toggle the 
:guilabel:`Custom Color Palette` switch in the :guilabel:`General` 
section.

For more information, see :ref:`Color Palette Customization
<color-palette-customization>`.

Build a Geospatial Scatter Chart
--------------------------------

To create a geospatial scatter chart:

1. On the :guilabel:`Chart Builder`, choose the data source for your
   chart.

#. Select :guilabel:`Geospatial` from
   the :guilabel:`Chart Type` list.

#. Select :guilabel:`Scatter` from the three available geospatial
   chart types.

#. Drag a geopoint field from :guilabel:`Fields` to the :guilabel:`Coordinates`
   encoding channel.
   
   |charts| distributes the data from your MongoDB collection based
   on the values of the selected geopoint field.

#. (*Optional*) Drag another collection field from the :guilabel:`Fields` to the :guilabel:`Color`
   encoding channel.

   |charts| colors the data points according to your selection.

#. (*Optional*) Drag another collection field to the :guilabel:`Size`
   encoding channel.

   |charts| aggregates document fields with matching values in the data source. 

#. Click the pencil icon above the chart to give it name.

#. Click :guilabel:`Save and Close`.


Limitations
-----------

The maximum query response size for a geospatial scatter chart is 1000 documents.
