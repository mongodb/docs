.. _choropleth-ref:

================
Choropleth Chart
================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Choropleth charts are maps that use shading to depict differences
across regions. The shading of a region (e.g. states, countries) is
based on an aggregated value and is proportional to the corresponding
value of other regions.

Unlike other geospatial charts, choropleths do not require coordinate
data in your collections. Instead you can have names of regions as
strings, so long as the region strings correspond to the names used in
a supported :ref:`Shape Scheme <choropleth-shape-scheme>`.

.. _choropleth-regions:

Regions
-------

To help define regions, |charts| provides
:ref:`Shape Schemes <choropleth-shape-scheme>`. For example, with the
:guilabel:`US States` scheme, you can define regions at a state level,
and your location field value must be one of the 50 states.

.. _choropleth-enc-channels:

Encoding Channels
-----------------

Choropleth charts use the following :ref:`encoding channels
<encoding-channels>`:

.. list-table::
   :header-rows: 1
   :widths: 20 80

   * - Encoding Channel
     - Description

   * - .. data:: Location
     - Defines the :ref:`regions <choropleth-regions>` to be shaded
       on the map. 

       The value must match (case insensitive) a region value for the
       selected :guilabel:`Shape Scheme`. For example, when using the
       :guilabel:`US States` scheme, the region of ``California``
       matches ``california`` and ``CA`` as well as ``California``.

       For a complete list of shape schemes and their expected values,
       refer to the :ref:`Shape Schemes <choropleth-shape-scheme>`
       page.

   * - .. data:: Color
     - Defines the :guilabel:`Aggregation` that determines the
       shading of the corresponding :guilabel:`Location`. You
       can customize the range of colors that corresponds to
       the relative aggregated values.

Use Cases
---------

Choropleth charts can be used to depict differences in your
selected aggregated field between geographic subregions, such as
states or countries. They are useful when you have a dataset with
clearly defined subregions compatible with one of the
:ref:`Shape Schemes <choropleth-shape-scheme>` |charts| provides.

A choropleth chart is a good choice to compare:

- Population density across US states.

- Annual rainfall across European countries.

- Number of cellphone towers across Australian states.

.. seealso::

   If you are looking for a chart to depict exact values rather than
   a high-level comparison, consider using a
   :ref:`Data Table <data-table-ref>`.

Limitation
----------

The maximum query response size for a choropleth chart is 5000 documents. 


Example
-------

The following choropleth chart visualizes the total count of
movie releases across various countries. Each document in the
collection contains an array of countries where a particular movie was
released.

.. figure:: /images/charts/choropleth-example.png

In this chart, we specify a
:ref:`Shape Scheme <choropleth-shape-scheme>` of
:guilabel:`World Countries` to divide the map into countries.

The ``countries`` array in the :guilabel:`Location` field contains
an array of elements representing each country where a movie
was released. These elements match the values expected by the
:guilabel:`World Countries` shape scheme. We unwind the array so
each movie contributes to the count for each country where it was
released.

The :guilabel:`Color` field of ``id`` is aggregated by
:guilabel:`Count`. As a result, each country is shaded based on its
number of movies released.

The custom color palatte for this chart ranges from yellow for
lower ratings to dark red for higher ratings. Based on the
visualization, we see that France, India, and Japan have relatively
high movie release counts compared with other countries.

.. seealso::

   For a complete list of choropleth :guilabel:`Shape Schemes` and
   their expected values, refer to the
   :ref:`Choropleth Regions <choropleth-regions>` page.

.. class:: hidden

   .. toctree::
      :titlesonly:

      Shape Schemes </chart-type-reference/choropleth-regions>
