.. _index-type-text:
.. _index-feature-text:

========================================
Text Indexes on Self-Managed Deployments
========================================

.. default-domain:: mongodb

.. facet::
   :name: genre
   :values: reference

.. meta:: 
   :description: Details on when and how to use text indexes in a self-managed or on-prem MongoDB database.

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. include:: /includes/extracts/fact-text-search-legacy-atlas.rst

Text indexes support :ref:`text search queries <text-search>` on
fields with string content. Text indexes improve performance when
searching for specific words or strings. 

A collection can have only **one** text index, but that index may include
multiple fields.

To create a text index, use the following prototype:

.. include:: /includes/indexes/code-examples/create-text-index.rst

$text Query Support
-------------------

Text indexes support :query:`$text` queries on self-managed
deployments. You must create a text index to use ``$text``.

Use Cases
---------

An online shop's ``clothing`` collection has a ``description`` field that 
contains a string of text describing each item. To find clothes made of 
``"silk"``, create a text index on ``description`` and run a
``$text`` query for ``"silk"``. The search returns all documents
mentioning ``"silk"`` in ``description``.

Get Started
-----------

To learn how to create and use text indexes, see:
  
- :ref:`<create-text-index>`
- :ref:`<create-wildcard-text-index>`
- :ref:`<specify-default-text-index-language>`
- :ref:`limit-entries-scanned`

Details
-------

This section describes text index details.

Compound Text Indexes 
~~~~~~~~~~~~~~~~~~~~~

In a compound index with a text index key and other key types,
only the text index field determines whether the index references
a document. Other keys do not affect document references.

Covered Queries
~~~~~~~~~~~~~~~

.. include:: /includes/fact-text-index-covered-query.rst

``sparse`` Property 
~~~~~~~~~~~~~~~~~~~

Text indexes are always :ref:`sparse <index-type-sparse>`.
MongoDB ignores the ``sparse`` option when creating text indexes.

MongoDB does not add a text index entry for documents that lack
the text index field, have null values, or have empty arrays.

.. _text-index-storage-requirements:

Storage Requirements and Performance Costs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Text indexes have these storage and performance characteristics:

- Text indexes can consume significant RAM. They contain one
  index entry for each unique stemmed word in each indexed field
  for each document.

- Building a text index is similar to building a large
  :ref:`multikey index <index-type-multi-key>` but takes longer
  than building an ordered (scalar) index on the same data.

- When building large text indexes, ensure sufficient file
  descriptor limits. See :ref:`recommended settings <ulimit>`.

- Text indexes impact write performance because MongoDB must add
  an index entry for each unique stemmed word in each indexed
  field of new documents.

- Text indexes store individual words, not multi-word strings or
  word proximity information. Queries with multiple words run
  faster when the entire collection fits in RAM.

Learn More
----------

- To learn more about text indexes, see: 
  
  - :ref:`<control-text-search-results>`
  - :ref:`<text-index-properties>`
  - :ref:`<text-index-restrictions>`
  - :ref:`<text-index-versions>`
  
- For text search examples, see the :query:`$text reference page <$text>`.
  
- For sample ``$text`` operations in aggregation pipelines, see
  :ref:`<text-agg>`.


.. toctree::
   :titlesonly:
   :hidden:

   Create </core/indexes/index-types/index-text/create-text-index>
   Create a Wildcard </core/indexes/index-types/index-text/create-wildcard-text-index>
   Specify Language </core/indexes/index-types/index-text/specify-text-index-language>
   Assign Weights </core/indexes/index-types/index-text/control-text-search-results>
   Limit Entries </core/indexes/index-types/index-text/limit-number-of-items-scanned-for-text-search>
   Properties </core/indexes/index-types/index-text/text-index-properties>
   Restrictions </core/indexes/index-types/index-text/text-index-restrictions>
   Versions </core/indexes/index-types/index-text/text-index-versions>
