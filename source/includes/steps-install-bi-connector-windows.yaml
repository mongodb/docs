stepnum: 1
ref: download-bi-windows
level: 4
source:
  file: steps-install-bi-connector.yaml
  ref: download-bi
---
stepnum: 2
title: Install the |bi|.
ref: install-bi-windows
level: 4
content: |
  a. Run the downloaded ``.msi`` file.
  #. Follow the wizard to install the files. The binaries install into a
     ``bin`` directory inside the installation directory.
---
stepnum: 3
title: Generate your schema definition file. (Optional)
ref: generate-schema-windows
level: 4
source:
  file: steps-install-bi-connector.yaml
  ref: generate-schema
action:
  - heading: "Authentication not enabled:"
    language: ps1
    copyable: true
    code: |
      "C:\Program Files\MongoDB\Connector for BI\2.4\bin\mongodrdl.exe" --host <your.mongohost.com> `
                  --db <dbname> `
                  [--collection collname] `
                  --out schema.drdl
  - heading: "Authentication enabled:"
    language: ps1
    copyable: true
    code: |
      "C:\Program Files\MongoDB\Connector for BI\2.4\bin\mongodrdl.exe" --host <your.mongohost.com> `
                  --db <dbname> `
                  [--collection collname] `
                  --out schema.drdl  `
                  --username <username> `
                  --password <password> `
                  --authenticationDatabase <dbname>
---
stepnum: 4
ref: start-mongosqld-windows
level: 4
source:
  file: steps-install-bi-connector.yaml
  ref: start-mongosqld
action:
  - heading: "Start ``mongosqld`` manually:"
    content: |
      Using Command Line Options
      --------------------------

      .. cssclass:: copyable-code
      .. code-block:: ps1

         "C:\Program Files\MongoDB\Connector for BI\2.4\bin\mongosqld.exe"

      For the list of command line options, see
      :ref:`mongosqld-command-line-options`.

      Using a Configuration File
      --------------------------

      Using your preferred text editor, create a ``mongosqld.conf`` file.
      To review the configuration file options, see :ref:`Configuration
      File <config-format>`.

      .. cssclass:: copyable-code
      .. code-block:: ps1

         "C:\Program Files\MongoDB\Connector for BI\2.4\bin\mongosqld.exe" --config <pathToConfigFile>\mongosqld.conf

      .. note::

         All the file paths in your configuration file must be
         absolute and wrapped in single quotes. For example:

         .. code-block:: text

            systemLog:
              path: 'C:\logs\mongosqld.log'

  - heading: "Start ``mongosqld`` as a system service:"
    content: |
      The |bi-short| requires a configuration file with the
      :setting:`systemLog.path` setting specified when running as a
      system service. Using your preferred text editor, create a
      ``mongosqld.conf`` file. To review the configuration file options,
      see :ref:`Configuration File <config-format>`. For example:
      
      .. cssclass:: copyable-code
      .. code-block:: text

         systemLog:
           path: 'C:\logs\mongosqld.log'
         net:
           bindIp: "127.0.0.1"
           port: 3307

      .. note::

         All the file paths in your configuration file must be
         absolute and wrapped in single quotes. For example:

         .. code-block:: text

            systemLog:
              path: 'C:\logs\mongosqld.log'

      To install and run ``mongosqld`` as a system service, run the
      following commands:

      .. cssclass:: copyable-code
      .. code-block:: ps1

         "C:\Program Files\MongoDB\Connector for BI\2.4\bin\mongosqld.exe" install --config <pathToConfigFile>\mongosqld.conf
         net start mongosql

      Windows returns ``mongosql service installed`` if your installation
      succeeded.
---
stepnum: 5
ref: install-auth-plugin-windows
level: 4
source:
  file: steps-install-bi-connector.yaml
  ref: install-auth-plugin
---
stepnum: 6
ref: connect-to-bi-server-windows
level: 4
source:
  file: steps-install-bi-connector.yaml
  ref: connect-to-bi-server
...
