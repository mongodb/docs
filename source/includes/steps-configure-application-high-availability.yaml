title: Configure a load balancer with the pool of MMS Application Server locations.
stepnum: 1
ref: configure-load-balancer
pre: |
   Because load balancers are specific to their environment and can have
   different configurations, we don't have a recommendation for load
   balancer configurations.
---
title: Update each MMS Application Server with the load balanced URL.
stepnum: 2
ref: update-load-balanced-url
content: |
  On each Application Server, edit the ``conf-mms.properties`` file to
  configure the ``mms.centralUrl`` property to point to the load balancer URL.

  The ``conf-mms.properties`` file is located in the
  ``<install_dir>/conf/`` directory.
---
title: Update each MMS Application Server with the replication hosts information.
stepnum: 3
ref: update-replication-hosts
pre: |
  On each Application Server, edit the ``conf-mms.properties`` file to
  define the replication hosts used as the :doc:`backing MongoDB instances
  </tutorial/prepare-backing-mongodb-instances>`.
action:
  - pre: |
      Set the ``mongo.mongoUri`` property to the :manual:`connection
      string </reference/connection-string/>` of the backing instance used
      for monitoring data. For example:
    language: ini
    code: |
      mongo.mongoUri=mongodb://<mms0.example.net>:<27017>,<mms1.example.net>:<27017>,<mms2.example.net>:<27017>/?maxPoolSize=100
      mongo.replicaSet=<mmsReplSet0>
  - pre: |
      If you use |backup|, set the ``mongo.backupdb.mongoUri`` property to
      the :manual:`connection string </reference/connection-string/>` of
      the the backing instance used for backup. For example:
    language: ini
    code: |
      mongo.backupdb.mongoUri=mongodb://<mms3.example.net>:<27017>,<mms4.example.net>:<27017>,<mms5.example.net>:<27017>/?maxPoolSize=100
      mongo.backupdb.replicaSet=<mmsBackupReplSet0>
---
title: Synchronize the ``gen.key`` file across all the MMS Application Servers.
stepnum: 4
ref: sync-gen-key
pre: |
   Synchronize the ``/etc/mongodb-mms/gen.key`` file across all Application
   Servers. In MMS 1.3 and later, the MMS Application Server uses this file to
   encrypt sensitive information before storing the data in a database.
...
