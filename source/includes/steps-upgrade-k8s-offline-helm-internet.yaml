---
ref: upgrade-kubectl-cd
inherit:
  file: steps-helm-master.yaml
  ref: helm-master-cd
stepnum: 1
---
ref: upgrade-kubectl-crds
inherit:
  file: steps-install-master.yaml
  ref: install-master-crds
stepnum: 2
replacement:
  method: "Upgrade the |k8s-crds| for MongoDB deployments."
content: |

  {{kubectl}}
---
ref: upgrade-k8s-tls
stepnum: 3
inherit:
  file: steps-install-master.yaml
  ref: upgrade-to-1.7.1
replacement:
  command: |
    
    .. code-block:: sh

       kubectl patch opsmanagers/<opsmgr-resource-metadata.name> \
           --patch '{"spec": {"security": {"tls": {"ca": "<ca-configmap>"}}}}' \ 
           --type merge
---
ref: upgrade-customize-chart
inherit:
  file: steps-helm-master.yaml
  ref: helm-master-customize-chart
stepnum: 4
content: |
  {{k8sofflineupgradev161}}
---
ref: helm-k8s-offline-internet
inherit:
  file: steps-helm-master.yaml
  ref: helm-master-install
stepnum: 5
replacement:
  method: "Upgrade to the latest version of the |k8s-op-short|."
content: |
  {{k8sofflineupgradev161}}

  .. admonition:: Troubleshooting

     .. include:: /includes/facts/upgrade-error-helm.rst

     To resolve this error:

     a. Remove the old |k8s-op-short| deployment.

        .. include:: /includes/facts/k8s-remove-operator-deployment.rst

        .. include:: /includes/admonitions/remove-op-no-affect-mdb.rst

     b. Repeat the ``helm`` command to upgrade to the new version of the |k8s-op-short|.
...
