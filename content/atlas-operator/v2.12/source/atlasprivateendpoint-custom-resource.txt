.. _atlasprivateendpoint-custom-resource:

========================================
``AtlasPrivateEndpoint`` Custom Resource
========================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. include:: /includes/subresource-deprecation.rst

The ``AtlasPrivateEndpoint`` custom resource configures a
:ref:`private endpoint <private-endpoint-overview>` for a |service|
project. This allows you to connect your cloud provider to |service|
without sending information through a public network. Private
endpoints are unidirectional connections *to* |service| *from* your
virtual network.

.. include:: /includes/fact-ak8so-crds.rst

|ak8so| takes one of the following actions using the |service|
:oas-bump-atlas-tag:`Private Endpoint Service API Resource
<private-endpoint-services>`:
   
- Creates a new private endpoint service.
- Updates an existing private endpoint service.

To learn more about implementing private endpoints in |ak8so|, see
:ref:`Manage Private Endpoints <ak8so-private-endpoint>`.

Examples
--------

.. _atlasprivateendpoint-example-basic:

Basic Example
~~~~~~~~~~~~~

The following example shows an ``AtlasPrivateEndpoint`` custom resoure
that defines an |aws| private endpoint within the ``my-project`` project.

.. code-block::

   apiVersion: atlas.mongodb.com/v1
   kind: AtlasPrivateEndpoint
   metadata:
    name: my-atlas-pe1
   spec:
     projectRef:
       name: my-project
       namespace: my-operator-namespace
     provider: AWS
     region: US_EAST_1
     awsConfiguration:
       - id: vpcpe-xyz 

.. _atlasprivateendpoint-example-independent:

Independent CRD Example
~~~~~~~~~~~~~~~~~~~~~~~

The following example shows an ``AtlasPrivateEndpoint``
:ref:`independent CRD <ak8so-independent-crd>` that defines the same
private endpoint defined in the :ref:`Basic Example
<atlasprivateendpoint-example-basic>`. This custom resource definition
allows you to create this private endpoint in a project you don't
manage in the same instance of |ak8so| with which you define this
resource. To enable independent operation, you must use an
``externalProjectRef`` instead of a ``projectRef``, and you must
supply a ``connectionSecret`` directly since this resource can't
inherit API credentials from its parent project.

.. code-block::

   apiVersion: atlas.mongodb.com/v1
   kind: AtlasPrivateEndpoint
   metadata:
    name: my-atlas-pe1
   spec:
     externalProjectRef:
       projectID: 66e2f2b621571b7e69a89b66
     connectionSecret:
       name: atlas-connection-secret
     provider: AWS
     region: US_EAST_1
     awsConfiguration:
       - id: vpcpe-xyz

Parameters
----------

.. include:: /includes/manual-crds/atlas-private-endpoint.rst