.. _tutorial-monitoring:

===========================
Add Hosts to MMS Monitoring
===========================

.. default-domain:: mongodb

Overview
--------

To add hosts to MMS Monitoring, you need to seed, i.e. add manually,
one of the hosts of a replica set or a sharded cluster. Once the
Monitoring Agent has a seed host, it automatically discovers all other
nodes in the replica set or sharded cluster based on the current
replica set or cluster configuration.

Considerations
--------------

Preferred Hostnames
~~~~~~~~~~~~~~~~~~~

If the host is accessible only by specific hostname or IP address, or
you need to specify the hostname to use for servers with multiple aliases, set up a
preferred hostname. For details, see the :guilabel:`Preferred Hostnames`
setting in :doc:`/core/settings`.

.. _host-discovery-without-auth:

Host Discovery in Environments without Authentication
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Once the Monitoring Agent has a seed host it discovers all other nodes
in the replica set or sharded cluster. These clusters, and their respective
seed hosts, include:

- Master databases, after adding slave databases.

- Shard clusters, after adding ``mongos`` instances.

- Replica sets, after adding any member of the set.

Once you add these seed nodes, the Monitoring Agent will fetch this
information *from* the MMS servers. Thus, when configuring the
monitoring environment, you may need to wait for several update cycles
(e.g. 5-10 minutes) to complete the auto-discovery process and host
identification. During this period, you may see duplicate hosts in the
MMS web console. This is normal.

The Monitoring Agent fetches configuration and reports to |monitoring| every
minute, so, again, there may be a delay of several minutes before data
and host information propagate to the MMS console.

.. index:: adding hosts
   single: hosts; adding

Procedures
----------

Add Hosts
~~~~~~~~~

To add a host to |monitoring|, from the MMS console:

.. include:: /includes/steps/add-host.rst

View Logs
~~~~~~~~~

You can find immediate evidence of a working installation in the agent output
or logs.

To view the Monitoring Agent log, select the :guilabel:`Administration` tab,
then select :guilabel:`Agents`, and then click :guilabel:`view logs` for the
Monitoring Agent in the :guilabel:`Agents` table.

To view diagnostic information for a host, select the
:guilabel:`Deployment` tab, then the :guilabel:`Deployment` page, and
then click the host. Click :guilabel:`Last Ping` and :guilabel:`Daily Pings`.
Once |monitoring| has data, you can view and begin using the statistics.

.. index:: host discovery
   single: hosts; discovery

Additional Information
----------------------

:doc:`/tutorial/nav/manage-hosts`
