title: Shutdown the MMS server and take a backup of your existing configuration and logs.
stepnum: 1
ref: backup-existing
action:
  pre: |
    For example:
  language: sh
  code: |
    sudo /etc/init.d/mongodb-mms stop
    sudo cp -a <install_dir>/conf ~/mms_conf.backup
    sudo cp -a <install_dir>/logs ~/mms_logs.backup
---
title: "If you are running MMS Backup, shutdown the MMS Backup Daemon."
stepnum: 2
ref: shutdown-daemon
action:
  pre: |
    The daemon may be installed on a different server. If is *critical*
    that this is also shut down. To shut down, issue a command similar to
    the following:
  language: sh
  code: |
    sudo /etc/init.d/mongodb-mms-backup-daemon stop
---
title: Remove your existing MMS server installation entirely and extract latest release in its place.
stepnum: 3
ref: remove
action:
  pre: |
    For example:
  language: sh
  code: |
    cd <install_dir>/../
    sudo rm -rf <install_dir>
    sudo tar -zxf -C . /path/to/mongodb-mms-<version>.x86_64.tar.gz
---
title: Compare and reconcile any changes in configuration between versions.
stepnum: 4
ref: compare
action:
  pre: |
    For example:
  language: sh
  code: |
    diff -u ~/mms_conf.backup/conf-mms.properties <install_dir>/conf/conf-mms.properties
    diff -u ~/mms_conf.backup/mms.conf <install_dir>/conf/mms.conf
---
title: Edit your configuration to resolve any conflicts between the old and new versions.
stepnum: 5
ref: edit
content: |
  Make any changes as appropriate. Changes to ``mms.centralUri``, email
  addresses, and MongoDB are the most common configuration changes.
---
title: Restart the On Prem MMS server.
stepnum: 6
ref: restart
action:
  pre: |
    For example:
  language: sh
  code: |
    sudo /etc/init.d/mongodb-mms start
---
stepnum: 7
source:
  file: steps-upgrade-on-prem-with-rpm-packages.yaml
  ref: update
---
stepnum: 8
source:
  file: steps-upgrade-on-prem-with-rpm-packages.yaml
  ref: update-daemon
post: |
  See :doc:`/tutorial/nav/backup-getting-started` for more information.
...
