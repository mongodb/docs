[build]
publish = "dist"
base = "content/ruby-driver"

[build.environment]
REPO_NAME = "docs-ruby"
SECRETS_SCAN_ENABLED = "false"
MUT_COMMANDS_ENABLED = "false"

[context.production.environment]
ENV = "dotcomprd"

[context.preprd.environment]
ENV = "dotcomstg"

[context.deploy-preview.environment]
ENV = "prd"

[context.branch-deploy.environment]
ENV = "prd"

[context.preview-server.environment]
ENV = "prd"

[context.dev.environment]
ENV = "stg"

### OFFLINE REDIRECTS
### ALIAS REDIRECTS

[[redirects]]
from = "/docs/ruby-driver/:version/connect/"
to = "/docs/ruby-driver/:version/connect/mongoclient/"

[[redirects]]
from = "docs/ruby-driver/:version/monitoring/"
to = "/docs/ruby-driver/:version/monitoring/cluster-monitoring/"

[[redirects]]
from = "docs/ruby-driver/:version/security/"
to = "/docs/ruby-driver/:version/security/authentication/"

[[redirects]]
from = "docs/ruby-driver/:version/data-formats/"
to = "/docs/ruby-driver/:version/data-formats/time-series/"

### PAGE-SPECIFIC REDIRECTS
### WILDCARD REDIRECTS
### CATCH ALLS
## redirects any pages not at any of the active versions to current (makes eols technically unnecessary)


### OFFLINE REDIRECTS 
[[redirects]]
from = "/docs/ruby-driver/v2.20/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.19/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.18/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.17/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.16/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.15/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.14/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.13/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.12/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.11/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.10/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.9/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.8/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.7/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.6/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.5/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.4/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.3/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.2/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v2.0/*"
to = "/docs/ruby-driver/current/:splat"

[[redirects]]
from = "/docs/ruby-driver/v1.x/*"
to = "/docs/ruby-driver/current/:splat"


### ALIAS REDIRECTS
[[redirects]]
from = "/docs/ruby-driver/master/*"
to = "/docs/ruby-driver/upcoming/:splat"
status = 302

[[redirects]]
from = "/docs/ruby-driver/v2.21/*"
to = "/docs/ruby-driver/current/:splat"
status = 302


### PAGE-LEVEL REDIRECTS
##CURRENT


[[redirects]]
from = "/docs/ruby-driver/current/mongoid-tutorials-5.1/"
to = "/docs/mongoid/v5.2/"

[[redirects]]
from = "/docs/ruby-driver/current/mongoid-tutorials-5.2/"
to = "/docs/mongoid/v5.2/"

[[redirects]]
from = "/docs/ruby-driver/current/quick-start/"
to = "/docs/ruby-driver/current/get-started/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/5.2.0/mongoid-callbacks/"
to = "/docs/mongoid/v5.2/tutorials/mongoid-callbacks/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/5.2.0/mongoid-documents/"
to = "/docs/mongoid/v5.2/tutorials/mongoid-documents/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/5.2.0/mongoid-indexes/"
to = "/docs/mongoid/v5.2/tutorials/mongoid-indexes/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/5.2.0/mongoid-installation/"
to = "/docs/mongoid/v5.2/tutorials/mongoid-installation/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/5.2.0/mongoid-nested-attributes/"
to = "/docs/mongoid/v5.2/tutorials/mongoid-nested-attributes/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/5.2.0/mongoid-persistence/"
to = "/docs/mongoid/v5.2/tutorials/mongoid-persistence/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/5.2.0/mongoid-queries/"
to = "/docs/mongoid/v5.2/tutorials/mongoid-queries/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/5.2.0/mongoid-rails/"
to = "/docs/mongoid/v5.2/tutorials/mongoid-rails/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/5.2.0/mongoid-relations/"
to = "/docs/mongoid/v5.2/tutorials/mongoid-relations/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/5.2.0/mongoid-upgrade/"
to = "/docs/mongoid/v5.2/tutorials/mongoid-upgrade/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/5.2.0/mongoid-validation/"
to = "/docs/mongoid/v5.2/tutorials/mongoid-validation/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/client-side-encryption/"
to = "/docs/ruby-driver/current/security/in-use-encryption/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/query-cache/"
to = "/docs/ruby-driver/current/read/retrieve/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-admin-tasks/"
to = "/docs/ruby-driver/current/reference/database-tasks/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-aggregation/"
to = "/docs/ruby-driver/current/aggregation/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-authentication/"
to = "/docs/ruby-driver/current/security/authentication/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-bulk-operations/"
to = "/docs/ruby-driver/current/write/bulk-write/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-change-streams/"
to = "/docs/ruby-driver/current/read/change-streams/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-client-side-encryption/"
to = "/docs/ruby-driver/current/security/in-use-encryption/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-collations/"
to = "/docs/ruby-driver/current/read/collations/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-collection-tasks/"
to = "/docs/ruby-driver/current/databases-collection//"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-create-client/"
to = "/docs/ruby-driver/current/connect/mongoclient/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-crud-operations/"
to = "/docs/ruby-driver/current/read/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-database-tasks/"
to = "/docs/ruby-driver/current/databases-collection/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-geospatial-search/"
to = "/docs/ruby-driver/current/indexes/geospatial-search/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-gridfs/"
to = "/docs/ruby-driver/current/write/gridfs/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-monitoring/"
to = "/docs/ruby-driver/current/monitoring/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-projections/"
to = "/docs/ruby-driver/current/read/project/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-sessions/"
to = "/docs/ruby-driver/current/write/transactions/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-text-search/"
to = "/docs/ruby-driver/current/indexes/atlas-search-index/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/ruby-driver-transactions/"
to = "/docs/ruby-driver/current/write/transactions/"

[[redirects]]
from = "/docs/ruby-driver/current/tutorials/user-management/"
to = "/docs/ruby-driver/current/security/authentication/"

##upcoming
[[redirects]]
from = "/docs/ruby-driver/upcoming/release-notes/"
to = "/docs/ruby-driver/upcoming/reference/release-notes/"


### WILDCARD REDIRECTS
[[redirects]]
from = "/docs/ruby-driver/:version/compatibility/"
to = "/docs/drivers/compatibility/?driver-language=ruby&ruby-driver-framework=ruby-driver"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/compatibility/"
to = "/docs/drivers/compatibility/?driver-language=ruby&ruby-driver-framework=ruby-driver"

[[redirects]]
from = "/docs/ruby-driver/:version/contribute/"
to = "/docs/ruby-driver/:version/issues-and-help/"

[[redirects]]
from = "/docs/ruby-driver/:version/installation/"
to = "/docs/ruby-driver/:version/get-started/download-and-install/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/aggregation/"
to = "/docs/ruby-driver/:version/aggregation/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/authentication/"
to = "/docs/ruby-driver/:version/security/authentication/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/bulk-operations/"
to = "/docs/ruby-driver/:version/write/bulk-write/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/change-streams/"
to = "/docs/ruby-driver/:version/read/change-streams/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/collations/"
to = "/docs/ruby-driver/:version/read/collations/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/collection-tasks/"
to = "/docs/ruby-driver/:version/databases-collection/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/create-client/"
to = "/docs/ruby-driver/:version/connect/mongoclient/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/crud-operations/"
to = "/docs/ruby-driver/:version/read/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/database-tasks/"
to = "/docs/ruby-driver/:version/databases-collection/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/geospatial-search/"
to = "/docs/ruby-driver/:version/indexes/geospatial-index/"
force = true

[[redirects]]
from = "/docs/ruby-driver/:version/reference/gridfs/"
to = "/docs/ruby-driver/:version/write/gridfs/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/indexing/"
to = "/docs/ruby-driver/:version/indexes/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/map-reduce/"
to = "/docs/ruby-driver/:version/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/monitoring/"
to = "/docs/ruby-driver/:version/monitoring/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/projection/"
to = "/docs/ruby-driver/:version/read/project/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/query-cache/"
to = "/docs/ruby-driver/:version/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/search-indexes/"
to = "/docs/ruby-driver/:version/indexes/atlas-search-index/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/sessions/"
to = "/docs/ruby-driver/:version/write/transactions/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/text-search/"
to = "/docs/ruby-driver/:version/indexes/atlas-search-index/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/transactions/"
to = "/docs/ruby-driver/:version/write/transactions/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/user-management/"
to = "/docs/ruby-driver/:version/"

[[redirects]]
from = "/docs/ruby-driver/:version/support/"
to = "/docs/ruby-driver/:version/issues-and-help/"

[[redirects]]
from = "/docs/ruby-driver/:version/tutorials/bson/"
to = "/docs/ruby-driver/:version/data-formats/bson/"

[[redirects]]
from = "/docs/ruby-driver/:version/tutorials/quick-start/"
to = "/docs/ruby-driver/:version/get-started/"

[[redirects]]
from = "/docs/ruby-driver/:version/whats-new/"
to = "/docs/ruby-driver/:version/reference/release-notes/"

## CC
# Get Started
[[redirects]]
from = "/docs/ruby-driver/:version/get-started/download-and-install/"
to = "/docs/ruby-driver/:version/get-started/"

[[redirects]]
from = "/docs/ruby-driver/:version/get-started/create-a-deployment/"
to = "/docs/ruby-driver/:version/get-started/"

[[redirects]]
from = "/docs/ruby-driver/:version/get-started/create-a-connection-string/"
to = "/docs/ruby-driver/:version/get-started/"

[[redirects]]
from = "/docs/ruby-driver/:version/get-started/connect-to-mongodb/"
to = "/docs/ruby-driver/:version/get-started/"

[[redirects]]
from = "/docs/ruby-driver/:version/get-started/next-steps/"
to = "/docs/ruby-driver/:version/get-started/"

[[redirects]]
from = "/docs/ruby-driver/:version/connect/"
to = "/docs/ruby-driver/:version/connect/mongoclient/"

# CRUD
[[redirects]]
from = "/docs/ruby-driver/:version/crud/"
to = "/docs/ruby-driver/:version/crud/insert/"

[[redirects]]
from = "/docs/ruby-driver/:version/write/insert/"
to = "/docs/ruby-driver/:version/crud/insert/"
# Query
[[redirects]]
from = "/docs/ruby-driver/:version/read/"
to = "/docs/ruby-driver/:version/crud/query/"

[[redirects]]
from = "/docs/ruby-driver/:version/read/retrieve/"
to = "/docs/ruby-driver/:version/crud/query/find/"

[[redirects]]
from = "/docs/ruby-driver/:version/read/specify-a-query/"
to = "/docs/ruby-driver/:version/crud/query/specify-a-query/"

[[redirects]]
from = "/docs/ruby-driver/:version/read/specify-documents-to-return/"
to = "/docs/ruby-driver/:version/crud/query/specify-documents-to-return/"

[[redirects]]
from = "/docs/ruby-driver/:version/read/project/"
to = "/docs/ruby-driver/:version/crud/query/project/"

[[redirects]]
from = "/docs/ruby-driver/:version/read/"
to = "/docs/ruby-driver/:version/crud/query/"

[[redirects]]
from = "/docs/ruby-driver/:version/read/distinct/"
to = "/docs/ruby-driver/:version/crud/query/distinct/"

[[redirects]]
from = "/docs/ruby-driver/:version/read/count/"
to = "/docs/ruby-driver/:version/crud/query/count/"

[[redirects]]
from = "/docs/ruby-driver/:version/read/cursors/"
to = "/docs/ruby-driver/:version/crud/query/cursors/"
#Update
[[redirects]]
from = "/docs/ruby-driver/:version/write/update/"
to = "/docs/ruby-driver/:version/crud/update/"

[[redirects]]
from = "/docs/ruby-driver/:version/write/replace/"
to = "/docs/ruby-driver/:version/crud/replace/"
# Rest of CRUD
[[redirects]]
from = "/docs/ruby-driver/:version/write/delete/"
to = "/docs/ruby-driver/:version/crud/delete/"

[[redirects]]
from = "/docs/ruby-driver/:version/write/bulk-write/"
to = "/docs/ruby-driver/:version/crud/bulk-write/"

[[redirects]]
from = "/docs/ruby-driver/:version/write/transactions/"
to = "/docs/ruby-driver/:version/crud/transactions/"

[[redirects]]
from = "/docs/ruby-driver/:version/write/gridfs/"
to = "/docs/ruby-driver/:version/crud/gridfs/"

[[redirects]]
from = "/docs/ruby-driver/:version/read/collations/"
to = "/docs/ruby-driver/:version/crud/collations/"

[[redirects]]
from = "/docs/ruby-driver/:version/read-write-pref/"
to = "/docs/ruby-driver/:version/crud/configure-crud/"

# Post-CRUD pages
[[redirects]]
from = "/docs/ruby-driver/:version/data-formats/"
to = "/docs/ruby-driver/:version/data-formats/time-series/"

[[redirects]]
from = "/docs/ruby-driver/:version/monitoring/"
to = "/docs/ruby-driver/:version/logging-and-monitoring/monitoring/"

[[redirects]]
from = "/docs/ruby-driver/:version/logging-and-monitoring/"
to = "/docs/ruby-driver/:version/logging-and-monitoring/monitoring/"

[[redirects]]
from = "/docs/ruby-driver/:version/monitoring/cluster-monitoring/"
to = "/docs/ruby-driver/:version/logging-and-monitoring/monitoring/"

[[redirects]]
from = "/docs/ruby-driver/:version/security/"
to = "/docs/ruby-driver/:version/security/authentication/"

[[redirects]]
from = "/docs/ruby-driver/:version/connect/tls/"
to = "/docs/ruby-driver/:version/security/tls/"

[[redirects]]
from = "/docs/ruby-driver/:version/reference/"
to = "/docs/ruby-driver/:version/reference/release-notes/"

[[redirects]]
from = "/docs/ruby-driver/:version/common-errors/"
to = "/docs/ruby-driver/:version/issues-and-help/"

#Online versions: dict_keys(['upcoming', 'current'])
### CATCH ALLS (Redirects any /docs/ruby-driver/ page that would've 404ed to the version's landing page)
[[redirects]]
from = "/docs/ruby-driver/upcoming/*"
to = "/docs/ruby-driver/intermediary/upcoming/:splat"
status = 302

[[redirects]]
from = "/docs/ruby-driver/intermediary/upcoming/*"
to = "/docs/ruby-driver/upcoming"
status = 302

[[redirects]]
from = "/docs/ruby-driver/current/*"
to = "/docs/ruby-driver/intermediary/current/:splat"
status = 302

[[redirects]]
from = "/docs/ruby-driver/intermediary/current/*"
to = "/docs/ruby-driver/current"
status = 302

### CATCH ALLS (add slug to paths without slug)
[[redirects]]
from = "/docs/ruby-driver/upcoming/*"
to = "/docs/ruby-driver/upcoming/:splat"
status = 200

[[redirects]]
from = "/docs/ruby-driver/current/*"
to = "/docs/ruby-driver/current/:splat"
status = 200

[[redirects]]
from = "/docs/ruby-driver/*"
to = "/docs/ruby-driver/current/:splat"
