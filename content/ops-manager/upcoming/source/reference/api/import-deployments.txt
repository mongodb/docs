.. _om-import-deployments:

===================
Import Deployments
===================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Import existing MongoDB deployments into |mms| automation. This
set of endpoints allows you to add multiple existing MongoDB processes to both
monitoring and automation management, facilitating large-scale imports of 
existing clusters.

.. important::

   This feature is available starting in |mms| 8.0.13.

The imported deployments are added to the project's automation
configuration. The {+mdbagent+} will begin monitoring the processes
and manage them according to the automation configuration.

Prerequisites
-------------

Before you can import the deployment into |mms| automation, you must 
install the {+mdbagent+} and it must be running on all deployment 
nodes. To learn more, see :ref:`Install MongoDB Agent<automation-agent-install-steps-manage>`.

Available Endpoints
-------------------

.. list-table::
   :widths: 30 15 55
   :header-rows: 1

   * - Endpoint
     - Method
     - Description

   * - :ref:`Create Import Deployment Request <om-create-import-deployment-request>`
     - POST
     - Create a new import deployment request to add existing MongoDB processes to automation.

   * - :ref:`Get Import Deployment Requests <om-get-import-deployment-requests>`
     - GET
     - Retrieve all import deployment requests for a project.

   * - :ref:`Get Import Deployment Request Status <om-get-import-deployment-request-status>`
     - GET
     - Retrieve the status of a specific import deployment request.

   * - :ref:`Cancel Import Deployment Request <om-cancel-import-deployment-request>`
     - POST
     - Cancel an in-progress import deployment request.

   * - :ref:`Delete Import Deployment Request <om-delete-import-deployment-request>`
     - DELETE
     - Delete a failed import deployment request and clean up resources.

Import Process States
---------------------

Import deployment requests progress through several states:

.. list-table::
   :widths: 30 70
   :header-rows: 1

   * - State
     - Description

   * - ``PENDING``
     - Import request has been created and is waiting to start.

   * - ``AWAIT_SEED_HOST_CONNECTED``
     - Attempting to connect to the seed host specified in the request.

   * - ``AWAIT_HOSTS_DISCOVERED``
     - Connected to seed host and discovering all required MongoDB processes.

   * - ``AWAIT_AUTOMATION_IMPORTED``
     - All processes discovered, importing configuration into automation.

   * - ``AWAIT_GOAL_STATE``
     - Import complete, waiting for automation to reach goal state.

   * - ``SUCCESS``
     - Import completed successfully. Processes are now managed by automation.

   * - ``FAILED``
     - Import failed. Use the delete endpoint to clean up.

   * - ``CANCELLED``
     - Import was cancelled by user request.

Required Roles
--------------

All import deployment endpoints require the :authrole:`Project Automation Admin` role.

.. toctree::
   :titlesonly:

   /reference/api/import-deployments/create
   /reference/api/import-deployments/get-all
   /reference/api/import-deployments/get-status
   /reference/api/import-deployments/cancel
   /reference/api/import-deployments/delete