.. _disk-space-used:

=================
Disk Space % Used
=================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Description
-----------

``Disk Space % Used`` alerts indicate the percentage of used disk space
on a partition reaches a specified threshold.

The :alert:`Disk space % used on Data Partition
<Disk space % used on Data Partition is>` alert occurs when the
percentage of disk space used on any partition that contains the
MongoDB collection data meets or exceeds a certain threshold.
:ref:`By default <default-alert-settings>`, the threshold is 90
percent of the cluster's :doc:`configured storage size </scale-cluster>`.

The :alert:`Disk space % used on Index Partition
<Disk space % used on Index Partition is>` alert
occurs when the percentage of disk space used on any
partition that contains the MongoDB index data meets or exceeds a
certain threshold. You specify the threshold when you
:ref:`configure this alert <configure-alert-settings>`.

The :alert:`Disk space % used on Journal Partition
<Disk space % used on Journal Partition is>` alert occurs when the
percentage of disk space used on the partition that contains the
MongoDB :term:`journal` meets or exceeds a certain threshold. You
specify the threshold when you :ref:`configure this alert
<configure-alert-settings>`. This alert only occurs when
:manual:`journaling </core/journaling>` is enabled.

Possible Observations
---------------------

You can observe a high percentage of used disk space in the following
ways:

- In the cluster :doc:`metrics </monitor-cluster-metrics>`, the
  :guilabel:`Disk Usage` graph displays the used disk space in
  yellow. This indicates that the used disk space is approximately
  70 percent of the |service| cluster's :doc:`configured storage
  size </scale-cluster>`.

- |service| nodes are unhealthy, because the
  used disk space reached the cluster's
  :ref:`configured storage size <scale-cluster-instance>`.

- The cluster refuses writes and connections from the client.


Common Triggers
---------------

The following common events can trigger ``Disk Space % Used`` alerts:

- The disk is full and :ref:`Auto-Expand Storage
  <scale-cluster-storage>` is not enabled.

- Auto-Expand Storage is enabled, but the disk filled too quickly
  for |service| to expand the cluster's storage space. This
  can happen during data migration.

- Auto-Expand Storage is enabled, but |service| cannot expand the
  cluster's storage space because it has reached the maximum storage
  capacity for this instance. For more information on instance size
  limits, see the
  :ref:`Amazon Web Services <amazon-aws-configuration-options>`,
  :ref:`Google Cloud Platform <google-gcp-configuration-options>`, and
  :ref:`Microsoft Azure <microsoft-azure-configuration-options>`
  instance configuration options.

Possible Solutions
------------------

Consider the following actions to help resolve ``Disk Space % Used``
alerts through the |service| UI or API.

.. tabs::

   tabs:
     - id: UI
       name: Atlas UI
       content: |

         - :ref:`Enable Auto-Expand Storage <scale-cluster-storage>`.

           .. note::

    		  If the disk fills too quickly, |service| might not be
    		  able to expand the the cluster's storage space in time,
    		  even if Auto-Expand Storage is enabled.

         - Manually increase the :guilabel:`Storage` of this cluster
           in the :guilabel:`Cluster Tier` section of the
           :ref:`configuration page <scale-cluster-storage>`.

         - If you have reached the maximum storage capacity for this
           cluster, upgrade to a larger instance size in the
           :guilabel:`Cluster Tier` section of the :ref:`configuration
           page <scale-cluster-instance>`.

     - id: API
       name: Atlas API
       content: |

         - :doc:`Enable Auto-Expand Storage
           </reference/api/clusters-modify-one>` using the
           ``autoScaling.diskGBEnabled`` parameter.

           .. note::

    		  If the disk fills too quickly, |service| might not be
    		  able to expand the the cluster's storage space in time,
    		  even if Auto-Expand Storage is enabled.

         - :doc:`Increase the storage of this cluster
           </reference/api/clusters-modify-one>` using the
           ``diskSizeGB`` parameter.

         - If you have reached the maximum storage capacity for this
           cluster, :doc:`specify a larger instance size
           </reference/api/clusters-modify-one>` using the
           ``providerSettings.instanceSizeName`` parameter.

