.. _move-cluster:

====================================
Move a Cluster to a Different Region
====================================

.. default-domain:: mongodb

.. meta::
   :keywords: move

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Considerations
--------------

Supported in ``M10`` or Larger Tiers
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|service| supports moving ``M10`` or larger multi-region clusters to
different regions. When :doc:`scaling the cluster </scale-cluster>` to
an ``M10`` or larger cluster, you may modify the region and cloud
provider of |a-service| ``M0``, ``M2``, or ``M5`` cluster .

Preferred and Electable Nodes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Each node in the preferred and electable regions can:

- Participate in :manual:`replica set elections </core/replica-set-elections>`

- Become the :term:`primary` if the majority of replica set nodes
  are available.

Electable nodes in the cluster must total 3, 5, or 7.

Migration, Downtime and Performance Impact
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Depending on the amount of data to migrate, migrations can take a
significant amount of time. To maximize availability for a replica set,
|service| migrates one member at a time, starting with the secondary
members first and then the primary.

Migration can affect performance if your primary is already reaching
operational capacity: each newly migrated replica set member must
perform an :term:`initial sync` from the primary, adding to the
operational load. Migrations can also affect performance if
:manual:`read preferences </core/read-preference>` are set to read from
secondaries: the replica set is down one secondary during the migration.

VPC Peering (AWS Only)
~~~~~~~~~~~~~~~~~~~~~~

If you move a cluster out of a region that has a
:doc:`VPC (Virtual Private Cloud) </security-vpc-peering>` peering
connection, the moved cluster can no longer use that peering connection
to communicate with servers in the |vpc|. Any other clusters with nodes
remaining in the original region can continue to use the |vpc| peering
connection.

You can create multiple |vpc| connections for each region, including
a new |vpc| peering connection with the region to which you moved a cluster.

.. note::

   Cluster nodes moved out of a region can no longer inherit access
   rules from an |aws| security group or IP whitelisted |vpc| |cidr|
   blocks configured for the |vpc| peering connection. You must
   :ref:`add-to-access-list` for all the virtual servers residing in the
   |vpc|. Cluster nodes remaining in the region are unaffected.

Move a Single-Region Cluster
----------------------------

Use the following procedure to move nodes to an ``M10`` or larger
single-region cluster:

.. include:: /includes/steps/move-single-region-cluster.rst

Move a Multi-Region Cluster
---------------------------

Use the following procedure to move nodes to one or more regions in an
``M10`` or larger multi-region cluster:

.. include:: /includes/steps/move-multi-region-cluster.rst
