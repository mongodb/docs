ref: firewall-configuration
edition:
  - cloud
content: |
  Overview
  --------

  |mms| requires access on the ports and IP addresses described here.

  Required Outbound Access
  ------------------------

  The agents connect to |mms| on port ``443``. Whether you provision your
  servers on a cloud service provider or on your own network, configure your network
  infrastructure to allow outbound connections on port ``443``.

  If you wish to restrict outbound access on port ``443`` to specific IP
  addresses, you must keep open gtrethe following addresses and domains.

  IP Addresses for GET and POST
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

  You must keep open the following addresses on port ``443`` so that the
  agents can ``GET`` AND ``POST`` to the ``api-agents.mongodb.com`` and
  ``api-backup.mongodb.com`` servers:

  - ``54.173.82.137``

  - ``54.175.147.155``
  
  - ``52.21.89.200``

  Domain for Download of MongoDB Binaries
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

  The Automation Agents require outbound access on port ``443`` to the
  following domains, depending on your MongoDB edition, for downloading
  MongoDB binaries:

  - For the MongoDB community edition, the Automation Agents require
    outbound access on port ``443`` to download binaries from the
    ``fastdl.mongodb.org`` domain, provided by Amazon CloudFront. The IP
    ranges for CloudFront change frequently. See `the current list of IP
    ranges for CloudFront
    <http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/LocationsOfEdgeServers.html>`_.

  - If you use Automation with `MongoDB Enterprise
    <http://www.mongodb.com/products/mongodb-enterprise>`_, the
    Automation Agents require outbound access on port ``443`` to the
    ``downloads.mongodb.com`` domain in order to download the Enterprise
    binaries.

  - If you use automation with a custom build of MongoDB, the custom
    build must be available at a URL accessible to the Automation Agent.
    It could, for example, be served by a web server running inside an
    isolated network environment. The custom build's ``Git Version``
    field must be set to the output of the following command, issued on
    the target binary.

    .. code-block:: javascript

       mongod --version

  Required Inbound Access (Auto-Provisioning Only)
  ------------------------------------------------

  If you use |mms| :doc:`provisioning </tutorial/provision-cloud-servers>`,
  you must grant SSH access to the following ranges at minimum:

  - ``4.71.186.128/25``

  - ``4.35.16.128/25``

  .. important::

     MongoDB reserves the right to change these IP addresses at any time
     without user notice.

  For additional information, see :doc:`/tutorial/configure-cloud-server-settings`.

  If you do **not** use |mms| :doc:`provisioning
  </tutorial/provision-cloud-servers>`, you do not need to keep any inbound
  ports open.

  Required Ports on Your Network
  ------------------------------

  All MongoDB processes in a deployment must be accessible to all |mms|
  agents managing processes in that deployment.
  Therefore, all MongoDB ports must be open to every server that hosts an
  Automation, Monitoring or Backup Agent. For example, if you are running
  MongoDB processes on ``27000``, ``27017`` and ``27020``, then those
  three ports must be open from all servers that are hosting an
  Agent.
---
ref: firewall-configuration
edition: onprem
content: |
  Overview
  --------

  |onprem| components use the default ports and health-check endpoints
  described here.

  |http-service|
  --------------

  .. describe:: 8080

     Web server, available from browsers. The Monitoring Agent and Backup
     Agent must be able to access this port.

  .. describe:: 8090

     Provides a health-check endpoint for monitoring |onprem| components
     through a standard monitoring service, such as Zabbix or Nagios. The
     endpoint is
     disabled by default. To enable it, see :ref:`enable-debug-endpoints`.
     When enabled, you can access the endpoint at:

     .. code-block:: sh

        http://localhost:8090/health

     The endpoint checks the connections from the |http-service| to the
     :ref:`mms-application-database` and the
     :ref:`mms-backup-blockstore-database`. A successful response returns
     the following:

     .. code-block:: sh

        {
          "mms_db": "OK",
          "backup_db": "OK"
        }

  Backup Daemon
  -------------

  .. describe:: 8091

     Provides a web page with debug information. You can access the page
     at:

     .. code-block:: sh

        http://<backup-daemon-server>:8091

  .. describe:: 27500-27503

     The Backup Daemon uses this port range on the localhost interface to
     run the :program:`mongod` instances that keep local copies of the
     backed-up databases. The daemon applies oplog entries to maintain the
     local backups.

...
