title: "Login to |cloud|."
stepnum: 1
ref: login
edition:
  - cloud
---
title: "Login to |onprem|."
stepnum: 1
ref: login
edition:
  - onprem
---
title: "Begin or Manage a Deployment"
stepnum: 2
ref: begin-deployment
content: |

  When you reach the :guilabel:`Install an Automation Agent on each server`
  page, each server is listed.

  a. Click on the :guilabel:`Install Agent` menu of the first MongoDB server.

  b. Select :guilabel:`Windows - MSI`.
---
title: "Install the Automation Agent"
stepnum: 3
ref: install-automation-agent
content: |
  a. The :guilabel:`Automation Agent Installation Instructions` box displays
     the following information:

     - Base URL (Required for either binding to a project or adding the
       server to a server pool)

     - Project ID (Required for binding to a project)

     - :guilabel:`+ Generate Key` button to generate an Agent API Key (Required for binding to a project).

       .. include:: /includes/extracts/agent-api-key-generate-note.rst

       .. include:: /includes/extracts/agent-api-key-reuse.rst

       .. include:: /includes/extracts/agent-api-key-admonition.rst

     Some or all of these values are required in a later step, so keep
     this box open.

  #. After the MSI downloads, double-click the 
     :file:`mongodb-mms-automation-agent-<version>.windows_x86_64.msi`

  #. If a security warning appears, click :guilabel:`Run`.

  #. At the :guilabel:`Configuration/Log Folder` step, provide the directory
     into which these files are saved.
   
  #. At the :guilabel:`Key Type` Step, select :guilabel:`Agent API Key`
     to either bind to a specific project or select :guilabel:`Server Pool
     Key` to add the server to a server pool.
  
  #. Enter the appropriate keys.
  
     - If you selected :guilabel:`Agent API Key`, at the :guilabel:`Ops
       Manager Base URL and Agent API Key` step, enter the Base URL and Agent API Key.

     \- or \-

     - If you selected :guilabel:`Server Pool Key`, :guilabel:`Ops
       Manager Base URL and Server API Key` step, enter the 
       base url value from the dialog box and enter the Server Pool Key.

       .. include:: /includes/extracts/server-pool-key-location.rst
     
  f. Specify the Log and Backup directories.

  g. Click :guilabel:`Finish` once setup is complete.
---
title: "Verify the Automation Agent is running."
stepnum: 4
ref: verify-automation-agent
content: |

  The Automation Agent starts automatically after installation. This
  step verifies that it is running and can communicate with |mms|.
---
title: "(Optional) Change the location of the Automation Agent binaries and configuration backup files."
stepnum: 5
ref: change-binary-directory
content: |

   By default, the Automation Agent binaries and |mms| configuration
   backup file are located in ``%SystemDrive%\MMSAutomation\versions``.

   .. note::
      Windows sets the ``%SystemDrive%`` environment variable to ``C:`` by
      default. To find your ``%SystemDrive%``, issue with following command
      from a `PowerShell <https://msdn.microsoft.com/en-us/powershell/>`_
      prompt:

      .. code-block:: ps1

         get-childitem env:SystemDrive

   If you want to store these files in a different directory, follow
   these procedures:

   **To change the location of the Automation Agent Binaries:**

   a. Click :guilabel:`Deployment`; :guilabel:`Agents`; and then
      :guilabel:`Downloads & Settings`.

   b. Below the :guilabel:`Download Directory` heading, click the
      pencil icon to the right of the path shown in
      :guilabel:`Download Directory (Windows)`.

   c. Change the path to the new path you want.

   d. Click :guilabel:`Save`.

   e. Create the new directory you specified on each host that runs an
      Automation Agent. You can do this using Windows Explorer or issue the
      following command from a 
      `PowerShell <https://msdn.microsoft.com/en-us/powershell/>`_ prompt:

      .. code-block:: ps1

           md \<newPath>

      .. important::
         Make sure the system user that runs the Automation Agent can
         write to this new directory. This is usually the ``SYSTEM``
         user, which requires no additional configuration unless you
         changed the user.

   **To change the location of the Automation Agent configuration backup:**

   a. Open the :ref:`Automation Agent configuration file 
      <automation-agent-config-file-location>` in your preferred text
      editor.

   b. Change the :asetting:`mmsConfigBackup` setting to the new path for the
      configuration backup file. Replace ``X`` with the drive letter on which
      your backup is stored.

      .. code-block: ini

         mmsConfigBackup=X:\<newPath>\mms-cluster-config-backup.json

   c. Save the Automation Agent configuration file.

   d. Move the configuration backup file to the new directory.
      You can do this using Windows Explorer or issue the
      following command from a 
      `PowerShell <https://msdn.microsoft.com/en-us/powershell/>`_ prompt:
      
      .. code-block:: ps1

         move %SystemDrive%\MMSAutomation\versions\mms-cluster-config-backup.json \<newPath>

---
title: "Repeat installation procedure for each MongoDB server."
stepnum: 6
ref: repeat
...
