.. _mcli-quick-start:

===========
Quick Start
===========

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

{+mcli+} provides a command-line interface for managing your 
|service-fullname|, |cloud|, and |mms-full| projects and clusters. 
This tutorial demonstrates how to: 

- Download, install, and  configure {+mcli+}
- Create clusters in your |service|, |cloud-short|, or |mms| project
- Create a whitelist and MongoDB user for your |service| cluster
- Retrieve details about the new cluster 

The reference pages for the commands mentioned in this tutorial are  
available in the :ref:`mcli-reference` section.

.. _quick-start-reqs:

Prerequisites 
-------------

This tutorial requires the following: 

- A `MongoDB account <https://docs.mongodb.com/guides/cloud/account>`_ 
- An :atlas:`Atlas </organizations-projects/>`, 
  :cloudmgr:`Cloud Manager </organizations-projects/>`, or 
  :opsmgr:`Ops Manager </organizations-projects/>` organization and project

.. _quick-start-install:

Download and  Install {+mcli+}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

See :ref:`mcli-install` for information on downloading and installing 
{+mcli+}. After installing {+mcli+}, run the following command to 
verify installation:

.. code-block:: sh

   mongocli help


.. _quick-start-config-access-keys:

Generate Programmatic Access Keys 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

{+mcli+} uses Programmatic Access Keys to access the |service|, |cloud-short|, 
or |mms| projects. Your |svc-api-key| must have the ``project owner`` 
role and it must be whitelisted for your IP address or |cidr| range. 
To learn more about generating the |svc-api-key|, see: 

- :atlas:`Atlas API Access </configure-api-access>`
- :cloudmgr:`Cloud Manager API Access </tutorial/configure-public-api-access>`
- :opsmgr:`Ops Manager API Acess </tutorial/configure-public-api-access>`

.. note:: 

   The following sections are organized by MongoDB service. Select 
   the tab for your MongoDB service to proceed. 

.. tabs:: 

   .. tab:: Atlas 
      :tabid: atlas

      Configure the {+mcli+}
      ----------------------

      .. include:: /includes/quick-start-intro.rst

      .. include:: /includes/steps/quick-start-atlas-config-mcli.rst

      .. _quick-start-atlas-create-cluster:

      Create a Cluster 
      ----------------

      Use the :ref:`mcli-atlas-cluster-create-command` command to create
      a cluster in |service|.

      .. include:: /includes/admonitions/note-atlas-api-free-tier-limits.rst
      
      The following command creates a sample paid-tier cluster with the following settings: 

      - Cluster name: ``getStarted``
      - Service provider: ``AWS`` 
      - Provider region: ``US_EAST-1`` 
      - Cluster tier: ``M10``
      - Disk size: ``2`` GB
      - MongoDB version: ``4.2`` 
      - Replica set members: ``3``

      .. example::

         .. code-block:: text 

            mongocli atlas cluster create getStarted --provider AWS --region US_EAST_1 --tier M10 --diskSizeGB 10 --mdbVersion {+mdbVersion+} --members 3

      .. _quick-start-whitelist:

      Whitelist Your IP Address
      -------------------------

      |service| only allows incoming connections to the cluster from
      entries in the projectâ€™s whitelist. You can add individual IP
      addresses or |cidr| blocks to the project IP whitelist. 
      
      |service| supports specifying private IP addresses with VPC peered
      connections. For more information, see :ref:`vpc-peering`.
      
      Run the following command to add entries to your whitelist.
      Replace the IP address with your connection IP address. 

      .. code-block:: sh 
         
         mongocli atlas whitelist create <your-IP-address> --type ipAddress

      .. _quick-start-create-mdb-user:

      Create a MongoDB User 
      ---------------------

      If the |service| project does not yet have a MongoDB database user
      configured, create one using the
      :ref:`mcli-atlas-dbuser-create-command` command. The MongoDB user
      can access the database hosted in |service|. Run the following
      command to add a MongoDB user. 
      
      The command creates a MongoDB user with the following attributes: 

      - Username: ``User1`` 
      - Password: ``ChangeThisPasswordToSomethingSecure``

        .. note:: 

           The tutorial uses the password ``ChangeThisPasswordToSomethingSecure``. Replace this
           password with a strong password.

      - Role: |service| admin

      .. code-block:: sh 
         
         mongocli atlas dbuser create --username User1 --password ChangeThisPasswordToSomethingSecure --role atlasAdmin@admin

      .. _quick-start-atlas-retrieve-cluster:

      Retrieve Your Cluster 
      ---------------------

      To check your cluster's deployment status, issue the
      :ref:`mcli-atlas-cluster-describe-command` command.

      .. code-block:: sh 

         mongocli atlas cluster describe getStarted

      Your command output should look similar to the following:

      .. code-block:: json
         :copyable: false 

         {
	       "autoScaling": {
		     "diskGBEnabled": false
	       },
	       "backupEnabled": false,
	       "biConnector": {
		     "enabled": false,
		     "readPreference": "secondary"
	       },
	       "clusterType": "REPLICASET",
	       "diskSizeGB": 10,
	       "encryptionAtRestProvider": "NONE",
	       "id": "5e29cf4e7a3e5a3f46554bde",
	       "groupId": "<project-ID>",
	       "mongoDBVersion": "4.2.3",
	       "mongoDBMajorVersion": "4.2",
	       "mongoURI": "mongodb://getstarted.mongodb.example.net:27017,getstarted.mongodb.example.net:27017,getstarted.mongodb.example.net:27017",
	       "name": "getStarted",
	       "numShards": 1,
	       "paused": false,
	       "providerBackupEnabled": false,
	       "providerSettings": {
		     "backingProviderName": "AWS",
		     "instanceSizeName": "M10",
		     "providerName": "TENANT",
		     "regionName": "US_EAST_1"
	       },
	       "replicationFactor": 3,
	       "replicationSpec": {
		      "US_EAST_1": {
			    "analyticsNodes": 0,
			    "electableNodes": 3,
			    "priority": 7,
			    "readOnlyNodes": 0
		      }
	       },
	       "replicationSpecs": [
		     {
			    "id": "5e29cf3cf10fab4e2677c9f9",
			    "numShards": 1,
			    "zoneName": "Zone 1",
			    "regionsConfig": {
				  "US_EAST_1": {
					"analyticsNodes": 0,
					"electableNodes": 3,
					"priority": 7,
					"readOnlyNodes": 0
				  }
			  }
		     }
	       ],
	       "srvAddress": "mongodb+srv://getstarted.mongodb.example.net",
	       "stateName": "IDLE"
         }

      Summary 
      -------

      .. include:: /includes/quick-start-summary.rst

      You can also connect to your cluster using the ``mongoURI``. For
      example, run the following command to connect using the
      ``mongoURI``. Replace ``mongoURI`` with the value of ``mongoURI``
      in your ``cluster describe`` command output.

      .. code-block:: sh 

         mongo <mongoURI>

   .. tab:: Cloud Manager
      :tabid: cloud-manager 

      Configure the {+mcli+}
      ----------------------

      .. include:: /includes/quick-start-intro.rst

      .. include:: /includes/steps/quick-start-cm-config-mcli.rst

      Create a Cluster 
      ----------------

      You can create a cluster on |cloud-short| using the {+mcli+}.

      .. include:: /includes/quick-start-cm-om-create-cluster-intro.rst
      .. include:: /includes/steps/quick-start-cm-cluster-create.rst

      Retrieve the Cluster 
      --------------------

      You can check whether your cluster was successfully created by
      retrieving the cluster details using the
      :ref:`mcli-cm-cluster-describe-command` command.

      .. code-block:: sh 

         mongocli cloud-manager cluster describe getStarted

      Your command output should look similar to the following:

      .. code-block:: json
         :copyable: false 

         {
	        "mongoURI": "mongodb://host1:29010,host2:29020,host3:29030",
	        "name": "getStarted",
	        "processes": [
		      {
			     "buildIndexes": true,
			     "db_path": "/data/cluster/rs1",
			     "featureCompatibilityVersion": "4.2",
			     "hostname": "host1",
			     "log_path": "/data/cluster/rs1/mongodb.log",
			     "name": "getStartedCluster",
			     "port": 29010,
			     "priority": 1,
			     "process_type": "mongod",
			     "slave_delay": 0,
			     "version": "4.2.2",
			     "votes": 1,
			     "arbiter_only": false,
			     "disabled": false,
			     "hidden": false
		      },
		      {
			     "buildIndexes": true,
			     "db_path": "/data/cluster/rs2",
			     "featureCompatibilityVersion": "4.2",
			     "hostname": "host2",
			     "log_path": "/data/cluster/rs2/mongodb.log",
			     "name": "getStartedCluster",
			     "port": 29020,
			     "priority": 1,
			     "process_type": "mongod",
			     "slave_delay": 0,
			     "version": "4.2.2",
			     "votes": 1,
			     "arbiter_only": false,
			     "disabled": false,
			     "hidden": false
		      },
		      {
			     "buildIndexes": true,
			     "db_path": "/data/cluster/rs3",
			     "featureCompatibilityVersion": "4.2",
			     "hostname": "host3",
			     "log_path": "/data/cluster/rs3/mongodb.log",
			     "name": "getStartedCluster",
			     "port": 29030,
			     "priority": 1,
			     "process_type": "mongod",
			     "slave_delay": 0,
			     "version": "4.2.2",
			     "votes": 1,
			     "arbiter_only": false,
			     "disabled": false,
			     "hidden": false
		      }
	       ]
         }

      Summary 
      -------

      .. include:: /includes/quick-start-summary.rst

   .. tab:: Ops Manager
      :tabid: ops-manager 

      Configure the {+mcli+}
      ----------------------

      .. include:: /includes/quick-start-intro.rst

      .. include:: /includes/steps/quick-start-om-config-mcli.rst

      .. _quick-start-om-create-cluster:

      Create a Cluster 
      ----------------

      You can create a cluster on |mms| using the {+mcli+}.

      .. include:: /includes/quick-start-cm-om-create-cluster-intro.rst
      .. include:: /includes/steps/quick-start-om-cluster-create.rst

      .. _quick-start-om-retrieve-cluster:

      Retrieve the Cluster 
      --------------------

      You can check whether your cluster was successfully created by
      retrieving the cluster details using the
      :ref:`mcli-om-cluster-describe-command` command.

      .. code-block:: sh 

         mongocli ops-manager cluster describe getStarted

      Your command output should look similar to the following:

      .. code-block:: json
         :copyable: false 

         {
	        "mongoURI": "mongodb://host1:29010,host2:29020,host3:29030",
	        "name": "getStarted",
	        "processes": [
		      {
			     "buildIndexes": true,
			     "db_path": "/data/cluster/rs1",
			     "featureCompatibilityVersion": "4.2",
		        "hostname": "host1",
			     "log_path": "/data/cluster/rs1/mongodb.log",
			     "name": "getStartedCluster",
			     "port": 29010,
			     "priority": 1,
			     "process_type": "mongod",
			     "slave_delay": 0,
			     "version": "4.2.2",
			     "votes": 1,
			     "arbiter_only": false,
			     "disabled": false,
			     "hidden": false
		      },
		      {
			     "buildIndexes": true,
			     "db_path": "/data/cluster/rs2",
			     "featureCompatibilityVersion": "4.2",
			     "hostname": "host2",
			     "log_path": "/data/cluster/rs2/mongodb.log",
			     "name": "getStartedCluster",
			     "port": 29020,
			     "priority": 1,
			     "process_type": "mongod",
			     "slave_delay": 0,
			     "version": "4.2.2",
			     "votes": 1,
			     "arbiter_only": false,
			     "disabled": false,
			     "hidden": false
		      },
		      {
			     "buildIndexes": true,
			     "db_path": "/data/cluster/rs3",
			     "featureCompatibilityVersion": "4.2",
			     "hostname": "host3",
			     "log_path": "/data/cluster/rs3/mongodb.log",
			     "name": "getStartedCluster",
			     "port": 29030,
			     "priority": 1,
			     "process_type": "mongod",
			     "slave_delay": 0,
			     "version": "4.2.2",
			     "votes": 1,
			     "arbiter_only": false,
			     "disabled": false,
			     "hidden": false
		      }
	        ]
         }

      Summary 
      -------

      .. include:: /includes/quick-start-summary.rst
