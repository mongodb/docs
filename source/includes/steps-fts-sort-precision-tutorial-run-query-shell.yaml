ref: fts-sort-precision-tutorial-step1
level: 4
stepnum: 1
inherit:
  file: steps-fts-tutorial-run-query.yaml
  ref: connect-to-database-deployment-fts
---
ref: fts-sort-precision-tutorial-step2
level: 4
stepnum: 2
inherit:
  file: steps-fts-tutorial-run-query.yaml
  ref: use-sample-mflix
---
ref: fts-sort-precision-tutorial-step3
level: 4
stepnum: 3
title: "Run an |fts| query against the indexed field and sort for precision."
content: |
  .. include:: /includes/extracts/fts-sort-for-precision-desc.rst
        
  .. include:: /includes/extracts/fts-sort-for-precision-stage.rst

  .. io-code-block::
     :copyable: true

     .. input::
        :language: js
        :linenos:

        db.movies.aggregate([
          { 
            $search: { 
              compound: {
                "should": [{
                  "wildcard": {
                    "query": ["Prance*"],
                    "path": "title",
                    "score": {
                      "constant": {
                        "value": 99
                      }
                    },
                    "allowAnalyzedField": true
                  }
                },
                {
                  "wildcard": {
                    "query": ["Prince*"],
                    "path": "title",
                    "score": {
                      "constant": {
                        "value": 95
                      }
                    }
                  }
                }]
              },
            }
          },
          { 
            $limit: 5
          },
          {
            $project: {
              "_id": 0,
              "title": 1,
              "score": { "$meta": "searchScore" }
            }
          }
        ])

     .. output::
        :language: json

        {
          title: 'Prancer',
          score: 99
        },
        {
          title: 'Prancer Returns',
          score: 99
        },
        {
          title: 'Prince of Foxes',
          score: 95
        },
        {
          title: 'Prince of the City',
          score: 95
        },
        {
          title: 'Prince of Darkness',
          score: 95
        }

  .. include:: /includes/extracts/fts-sort-for-precision-results.rst
...
