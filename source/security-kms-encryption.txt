.. _security-kms-encryption:

============================================
Encryption at Rest Using Your Key Management
============================================

.. default-domain:: mongodb

.. meta::
   :keywords: encryption

.. admonition:: ``M10`` and Greater Clusters Only
   :class: note

   This feature is only available for |service| ``M10`` or greater
   clusters deployed on AWS, Azure, and Google Cloud Platform (GCP).

|service| encrypts all cluster storage and snapshot volumes,
ensuring the security of all cluster data at rest (Encryption at Rest).
|service| :authrole:`Project Owners <project Owner>` can configure
an additional layer of encryption on their data at rest using the
MongoDB
:manual:`Encrypted Storage Engine </core/security-encryption-at-rest>`
and their |service|-compatible Encryption at Rest provider.

Configuring Encryption at Rest using your Key Management incurs
additional charges for the |service| project. To learn more, see
:ref:`advanced-security`.

..
  consider adding image here of Encryption at Rest on top of storage
  level encryption to drive the point home.

|service| :authrole:`Project Owners <Project Owner>` can
use one or more of the following Encryption at Rest providers
when configuring Encryption at Rest for the |service| project:

- :ref:`Amazon Web Services Key Management Service <security-aws-kms>`
- :ref:`Azure Key Vault <security-azure-kms>`
- :ref:`Google Cloud Platform <security-gcp-kms>`

After configuring at least one Encryption at Rest provider for the
|service| project, :authrole:`Project Owners <Project Owner>` can enable
Encryption at Rest for each |service| cluster for which they require
encryption. The Encryption at Rest provider does *not* have to match the
cluster cloud service provider.

|service| does not automatically rotate user-managed encryption
keys. Defer to your preferred Encryption at Rest provider's
documentation and guidance for best practices on key rotation.
|service| automatically creates a
:ref:`90-day key rotation alert <alert-conditions-encryption-at-rest>`
when you configure Encryption at Rest using your Key Management
in an |service| project.

Encrypted Backups
-----------------

|service| encrypts all snapshot volumes, ensuring the security of
cluster data at rest (Encryption at Rest). For projects and clusters
using :ref:`security-kms-encryption`, |service| applies an additional
layer of encryption to your snapshot storage volumes using the
Encryption at Rest provider configured for the cluster.

For each cluster with encryption at rest and
cloud provider snapshots enabled, |service| uses the
project encryption key at the time of the snapshot to encrypt
the snapshot data files.

|service| can only restore an encrypted snapshot if the
project encryption key used to encrypt the snapshot is
enabled and accessible through the configured KMS service for the
|service| project.

|service| does not support enabling :ref:`backup-continuous` for
clusters using encryption at rest.

To learn more about encrypted cloud provider snapshots, see
:ref:`encrypted-cloud-provider-snapshot` and
:ref:`restore-encrypted-snapshot`.

.. class:: hidden

   .. toctree::
      :titlesonly:

      /security-aws-kms
      /security-azure-kms
      /security-gcp-kms
