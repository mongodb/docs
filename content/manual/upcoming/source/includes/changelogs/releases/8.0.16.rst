.. _8.0.16-changelog:

8.0.16 Changelog
----------------

Sharding
~~~~~~~~

:issue:`SERVER-75278` Consider sleeping only if there are more to fetch
in ReshardingOplogFetcher

Query
~~~~~

- :issue:`SERVER-95374` Compound wildcard indexes can incorrectly push
  down predicates during union or planning
- :issue:`SERVER-102267` 7.0 -- Coverity analysis defect 169954:
  Dereference after null check

Storage
~~~~~~~


WiredTiger
``````````

- :issue:`WT-8969` Several eviction statistics misleading, they imply
  success, when they mean attempt
- :issue:`WT-9575` Pages with updates newer to the oldest txn id are not
  queued for eviction
- :issue:`WT-13627` Assertion failed: ``ts == 1 || ts == 0``. out-of-order
  timestamp update detected
- :issue:`WT-14273` Report a stat for how long it's been since a page
  was last queued for eviction
- :issue:`WT-14648` Fix log subsystem returning ``EBUSY`` from
  ``conn->close()``
- :issue:`WT-15210` Change eviction to scrub eviction when the cache
  usage is less than eviction target
- :issue:`WT-15225` Fix newly created table and ``drop()`` ``EBUSY``
  issue
- :issue:`WT-15477` Track eviction max stats per database run
- :issue:`WT-15563` Investigate making cache tolerant to change app
  step-wise eviction to incremental eviction
- :issue:`WT-15736` Split "maximum page size seen at eviction" to 3
  seperate statistics

Internals
~~~~~~~~~

- :issue:`SERVER-55068` Max incoming connections currently set to 80% of
  max open files, but each connection consumes 2 file descriptors
- :issue:`SERVER-82688` mongod crash, bug fix when connections >
  wiredtiger's ``session_max``
- :issue:`SERVER-86278` Investigate discrepancy between ShardLocal and
  ShardRemote aggregations
- :issue:`SERVER-89870` Rate limit ``JWKManager::getValidator``
- :issue:`SERVER-91045` Load JWKs immediately at startup regardless of
  JWKSMinimumQuiescePeriodSecs
- :issue:`SERVER-91503` Improve NoSuchTransaction error message for
  transactions
- :issue:`SERVER-92911` Sharded collStats may incorrectly aggregate some
  time-series metrics
- :issue:`SERVER-92978` Make sure resharding recipients can restore
  'approxDocumentsToCopy' and 'approxBytesToCopy' metrics after failover
- :issue:`SERVER-93154` Emit abortIndexBuild change event
- :issue:`SERVER-93265` Support Windows resource file generation (.rc
  files) in Bazel
- :issue:`SERVER-94593` Exclude
  timeseries_insert_idle_bucket_expiration.js from
  ConcurrencyShardedInitialSync suite
- :issue:`SERVER-94681` Move sampling to the oplog cap maintainer thread
- :issue:`SERVER-95650` Time-series inserts can use invalid string
  comparator
- :issue:`SERVER-95816` [v8.0] Backport core property-based tests to
  v8.0
- :issue:`SERVER-96103` Fix argument quoting in Windows shell
  ProgramRunner
- :issue:`SERVER-97615` Provide visibility into which ServerStatus
  section threw in FTDC thread
- :issue:`SERVER-99765` Committing timeseries buckets can fail due to
  missing buckets collection
- :issue:`SERVER-100264` Resharding Natural Order Pipeline Does Not
  Respect reshardingCollectionClonerBatchSizeInBytes
- :issue:`SERVER-100759` Mock replication coordinator may not update
  committed snapshot correctly
- :issue:`SERVER-101456` timeseries_write_ops_internal has a potential
  use-after-free
- :issue:`SERVER-101491` Quiesce in JWKFetcherImpl when remote returns
  5xx error
- :issue:`SERVER-101671` Create feature flag
- :issue:`SERVER-101672` Remove async sampling feature flag
- :issue:`SERVER-101939` Temporarily disable
  change_streams_pre_image_removal_job.js
- :issue:`SERVER-102457` Make resharding retry on
  ShardingStateNotInitialized
- :issue:`SERVER-102481` Unset disallowSingleWriteShardCommit when
  resetting transaction router state
- :issue:`SERVER-102693` Query filter with multiple _id fields are not
  handled correctly
- :issue:`SERVER-102927` evergreen/failed_unittests_gather.sh misses
  .debug symbol file due to earlier error in the script
- :issue:`SERVER-103930` delete scons from 8.0
- :issue:`SERVER-103932` Make ReshardingCoordinatorCommitMonitor account
  for replication lag on recipients
- :issue:`SERVER-103960` Impose a proper check on the field path to
  ensure the number of parts not exceeding 255
- :issue:`SERVER-104325` [v8.0] DDL lock acquisition can hang
  indefinitely on secondaries
- :issue:`SERVER-104388` Make
  remainingReshardingOperationTimeThresholdMillis configurable while
  resharding is in progress
- :issue:`SERVER-104810` Support PS256 JWS Signing Algorithms for OIDC
- :issue:`SERVER-105090` [v8.0] Improve the error message displayed by
  the moveCollection command when FCV is lower than 8.0
- :issue:`SERVER-105696` Update searchCoordinator Role to have
  privileges only on __mdb_internal_search
- :issue:`SERVER-105708` [trySbeEngine only] $lookup+$unwind pushdown
  does not track QSN Node Ids correctly
- :issue:`SERVER-106010` Relax replication lag check in
  resharding_commit_monitor_repl_lag.js
- :issue:`SERVER-106162` [test-only] Reevaluate ignoring write concern
  errors in drop FSM state
- :issue:`SERVER-106194` CheckMetadataConsistency is not reading chunks
  with snapshot read concern
- :issue:`SERVER-106210` Create server parameter to disable the
  asynchronous behaviour
- :issue:`SERVER-106211` Add metrics/logging to increase visibility into
  the oplog sampling process
- :issue:`SERVER-106310` Add more logging to invariant failure when
  trying to set commit timestamp for transaction
- :issue:`SERVER-106314` Handle parallel marker creation
- :issue:`SERVER-106315` Functional correctness testing of async oplog
  sampling
- :issue:`SERVER-106360` Disable stacktrace symbolization for resmoke
  tasks by default
- :issue:`SERVER-106422` Skip starting LogicalSessionCache threads if
  running in queryableBackupMode
- :issue:`SERVER-106451` numActiveBuckets can be negative
- :issue:`SERVER-106644` Unnecessary error log message in the FTDC
  ServerStatus collector
- :issue:`SERVER-106778` RSA_PSS_SALTLEN_DIGEST not supported in older
  OpenSSL
- :issue:`SERVER-106811` Fix version check in
  speculative_read_transaction.js and
  transactions_wait_for_write_concern.js
- :issue:`SERVER-107032` remove multiversion testing against v5.0
- :issue:`SERVER-107100` Handle initial marker creation asynchronously
- :issue:`SERVER-107304` Make ``Pipeline::dispose()`` idempotent
- :issue:`SERVER-107924` Make ``RateLimitIsValidAfterQueueing`` test
  resilient to slow machines
- :issue:`SERVER-108124` ``_shardsvrReshardingOperationTime`` can fail the
  idl validation due to negative value
- :issue:`SERVER-108219` Increase size of the Amazon 2023 ARM compile
- :issue:`SERVER-108366` Prepared Transactions with apiVersion
- :issue:`SERVER-108544` Update Coverity build to use Coverity's new
  Bazel integration method
- :issue:`SERVER-108724` turn off index cache on some ubsan variants.
- :issue:`SERVER-109003` Mark write_without_shard_key_with_moveChunk.js
  and timeseries_list_catalog.js with 'requires_getmore'
- :issue:`SERVER-109207` Fix bug in oplog cap maintainer thread run
- :issue:`SERVER-109345` [8.0] disable non unittest dynamic ppc and 390x
  release builds
- :issue:`SERVER-109493` Disable "uncaught exception in noexcept"
  Coverity check
- :issue:`SERVER-110083` Remove the ``change_stream_serverless_fuzzer``
  tasks
- :issue:`SERVER-110252` Add delays in
  audit_remote_local_intermediate.js
- :issue:`SERVER-110254` Support swapping ``$match`` before "complex
  renames" when a flag says there are no arrays
- :issue:`SERVER-110306` [v8.0] Update remove_shard_with_unsharded.js to
  ignore ShardNotFound error on the last removeShard
- :issue:`SERVER-110378` Increase ``maxTimeMS`` in flaky
  ``explain_shell_helpers.js`` test
- :issue:`SERVER-110425` Develop and add an Evergreen task to upload
  SBOM to Kondukto using SilkBomb for master, v7.0, v8.0, v8.1, v8.2
- :issue:`SERVER-110511` [v8.0] Add ``awaitLastOpCommitted()`` call to
  ``update_lookup_before_ddl.js``
- :issue:`SERVER-110628`
  ``ReshardingCoordinator::_setCriticalSectionTimeoutCallback`` triggers
  segfault when accessing status with error
- :issue:`SERVER-110649` Move maintainer thread to start/stop storage
  controls
- :issue:`SERVER-110845` Use ``deleteMany`` instead of ``drop`` in
  ``index_key_expression.js``
- :issue:`SERVER-110890` Coverity analysis defect 175049: Logically dead
  code
- :issue:`SERVER-111084` [v8.0] Prepare SPM-4168 8.0 branch for release
- :issue:`SERVER-111116` Add missing ``clock_source_mock`` deps
- :issue:`SERVER-111135` Retry configureFailPoint in ``rollback_test.js``
- :issue:`SERVER-111349` Rewrite ``RateLimitIsValidAfterQueueing`` unit test
- :issue:`SERVER-111427` Load SASL before locking code pages
- :issue:`SERVER-111460` Pin code pages for mongos
- :issue:`SERVER-111512` Exempt SERVER-98676 from multiversion test
- :issue:`SERVER-111610` Add delays in
  ``ocsf_audit_remote_local_intermediate.js``
- :issue:`SERVER-111784` Limit ``$rank`` sort key changes to ``$rankFusion``
  contexts on 8.0
- :issue:`SERVER-111785` Ban ``$rankFusion`` in subpipelines on 8.0
- :issue:`SERVER-112016` make bazel retry on OOM in CI
- :issue:`SERVER-112035` Downgrade proxy protocol disconnected to INFO
- :issue:`SERVER-112117` Make oplog sampling yield and lock-free
- :issue:`SERVER-112119` Fix
  ``check_async_oplog_sampling_truncates_new_writes.js`` to hang during
  initial sampling, not after
- :issue:`SERVER-112120` Test that async oplog sampling doesn't block
  operations after startup
- :issue:`SERVER-112121` Test that async oplog sampling doesn't block
  rollback-to-stable
- :issue:`SERVER-112122` Test that async oplog sampling doesn't block
  FCBIS
- :issue:`SERVER-112123` Test that async oplog sampling doesn't block
  replica set initialization and reconfiguration
- :issue:`SERVER-112124` Test that async oplog sampling doesn't block
  shutdown
- :issue:`SERVER-112182` Create a testing server parameter to simulate
  oplog slowness
- :issue:`SERVER-112183` Start async oplog sampling towards the end of
  startup
- :issue:`SERVER-112467` Track and report the number of pending proxy
  connections
- :issue:`SERVER-112520` Failure to write to geo index when inserting a
  document to timeseries existing bucket
- :issue:`SERVER-112541` Show throughput in oplog sampling/scanning logs
- :issue:`SERVER-112846` Change in repl set reconfigure test
- :issue:`SERVER-112921` fix gperf defines on v8.0
- :issue:`SERVER-112966` fix public release config position on 8.0

