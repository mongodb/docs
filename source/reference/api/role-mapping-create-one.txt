=======================
Create One Role Mapping
=======================

.. default-domain:: mongodb

.. meta::
   :canonical: https://www.mongodb.com/docs/atlas/reference/api-resources-spec/#tag/Federated-Authentication

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

The ``federationSettings`` resource allows you to add one 
:ref:`role mapping <atlas-manage-fed-auth-roles>` 
to the specified organization in the specified federation.

.. include:: /includes/api-requirements.rst

.. include:: /includes/api-base-url-new.rst

Required Roles
--------------

You must have the :authrole:`Organization Owner` role to call this 
endpoint.

Resource
--------

.. code-block:: http
   :copyable: false

   POST /federationSettings/{FEDERATION-SETTINGS-ID}/connectedOrgConfigs/{ORG-ID}/roleMappings

Request Path Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :widths: 20 20 60
   :header-rows: 1

   * - Name
     - Type
     - Description

   * - ``FEDERATION-SETTINGS-ID``
     - string
     - Unique 24-hexadecimal digit string that identifies your federation.

   * - ``ORG-ID``
     - string
     - Unique 24-hexadecimal digit string that identifies the organization that contains your projects.

Request Query Parameters
~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/api/no-query-single-parameters.rst

Request Body Parameters
~~~~~~~~~~~~~~~~~~~~~~~

.. list-table::
   :widths: 25 15 45 15
   :header-rows: 1

   * - Name
     - Type
     - Description
     - Required

   * - ``externalGroupName``
     - string
     - Unique human-readable label that identifies the identity provider group to which this role mapping applies.
     - Required

   * - ``roleAssignments``
     - array
     - |service| roles and the unique identifiers of the groups and 
       organizations associated with each role.

       .. code-block:: json
          :caption: roleAssignments.groupId Example
          :copyable: false
          :linenos: 

          {
            "externalGroupName": "<someIdpGroupName>",
            "roleAssignments": [
              {
                "role": "GROUP_OWNER",
                "groupId": "<GROUP-ID>"
              }
            ]
          }

       .. code-block:: json
          :caption: roleAssignments.orgId Example
          :copyable: false
          :linenos: 

          {
            "externalGroupName": "<someIdpGroupName>",
            "roleAssignments": [
              {
                "role": "ORG_OWNER",
                "orgId": "<ORG-ID>"
              }
            ]
          }

     - Required

Response
--------

.. list-table::
   :header-rows: 1
   :stub-columns: 1
   :widths: 10 10 80

   * - Name
     - Type
     - Description

   * - ``externalGroupName``
     - string
     - Unique human-readable label that identifies the identity provider group to which this role mapping applies.

   * - ``id``
     - string
     - Unique 24-hexadecimal digit string that identifies this role mapping.

   * - ``roleAssignments``
     - array
     - |service| roles and the unique identifiers of the groups and 
       organizations associated with each role.

       .. code-block:: json
          :caption: roleAssignments.groupId Example
          :copyable: false
          :linenos: 

          {
            "externalGroupName": "<someIdpGroupName>",
            "roleAssignments": [
              {
                "role": "GROUP_OWNER",
                "groupId": "<GROUP-ID>"
              }
            ]
          }

       .. code-block:: language
          :caption: roleAssignments.orgId Example
          :copyable: false
          :linenos: 

          {
            "externalGroupName": "<someIdpGroupName>",
            "roleAssignments": [
              {
                "role": "ORG_OWNER",
                "orgId": "<ORG-ID>"
              }
            ]
          }

Example Request
---------------

.. code-block:: sh

   curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" --digest \
        --header "Accept: application/json" \
        --header "Content-Type: application/json" \
        --include \
        --request POST "https://cloud.mongodb.com/api/atlas/v1.0/federationSettings/{FEDERATION-SETTINGS-ID}/connectedOrgConfigs/{ORG-ID}/roleMappings" 
        --data {
                "externalGroupName": "myGroup",
                "roleAssignments": [
                    {
                      "groupId": null,
                      "orgId": "5df7a168f10fab3a149357fb",
                      "role": "ORG_OWNER"
                    }
                  ]
                }

Example Response
----------------

.. code-block:: json
   :copyable: false

    {
    "externalGroupName": "myGroup",
    "id": "9b43a5b329223c3a1591a678",
    "roleAssignments": [
        {
          "groupId": null,
          "orgId": "5df7a168f10fab3a149357fb",
          "role": "ORG_OWNER"
        }
      ]
    }
