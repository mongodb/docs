.. index:: hosts-tab

============
Manage Hosts
============

.. default-domain:: mongodb

.. _creating-host-aliases:
.. index:: aliases; host labels
   single: host aliases

.. index:: host labels

Host Labels
-----------

You can label hosts to narrow the list of hosts in the MMS display. This helps
if you monitor a large number of hosts and want to access a more limited set of
hosts. Hosts may belong to none, one, or multiple labels.

Labels also are useful as aliases if your machines have existing hostnames that do
not sufficiently describe the system in the context of MMS.
In most cases, hosts are automatically aliased during auto-discovery.

Add or Edit Labels
~~~~~~~~~~~~~~~~~~

To add or edit a host label:

1. Click the :guilabel:`Hosts`, :guilabel:`Mongos`, or :guilabel:`Configs`
   tabs.

#. Click the :guilabel:`all hosts` link directly above the :guilabel:`Last
   Ping` column heading.

#. Select :guilabel:`Edit Labels` from the drop down lists. The :guilabel:`Host
   Labels` interface appears.

#. To edit or delete an existing host label, click the pencil icon or trash icon.

#. To add a new host label, type the name and click the :guilabel:`Add Label`
   button.

.. note::

   When you add or update a Host Label value, all previous hostname aliases are
   reset.

Associate Labels with Hosts
~~~~~~~~~~~~~~~~~~~~~~~~~~~

To add or tag a host with a label:

1. Click the :guilabel:`Hosts`, :guilabel:`Mongos`, or :guilabel:`Configs`
   tabs.

#. To the right of any Host, click the gear icon in the far right column of the
   hosts table. Select :guilabel:`Edit Host`.

#. The :guilabel:`Edit Host` interface appears. Click the :guilabel:`Host
   Labels` tab.

#. Click to select one or more labels to assign to the host.

Display Hosts by Label
~~~~~~~~~~~~~~~~~~~~~~

To display hosts by their host label:

1. Click the :guilabel:`Hosts`, :guilabel:`Mongos`, or :guilabel:`Configs`
   tabs.

#. Click the :guilabel:`all hosts` link directly above the :guilabel:`Last
   Ping` column heading.

#. Select the appropriate host label. The list of hosts will display only hosts
   tagged with the selected label.

.. index:: agent timeout
   single: agent; timeout
   single: timeout

.. index:: reactivate hosts
.. index:: procedure; reactivate hosts
.. _reactivate-hosts:

Reactivate Hosts that Have been Deactivated
-------------------------------------------

If the Monitoring Agent cannot collect information from a MongoDB instance
for a specified period of time, MMS deactivates the instance in the
Monitoring Agent and in the console. MMS deactivates a :program:`mongos`
that is unreachable for 24 hours and a :program:`mongod` that is
unreachable for 7 days.

When the system deactivates an instance, the corresponding MMS
:guilabel:`Monitoring` page marks the deactivated instance with an ``x``
in the :guilabel:`LAST PING` column. If the instance is a
:program:`mongod`, MMS displays a caution icon at the top of each
:guilabel:`Monitoring` page.

You can reactivate a deactivated instance whether or not it is running.
When you reactivate a host, the Monitoring Agent has an hour to
reestablish contact and provide a ping to MMS. If a host is running and
reachable, it appears marked with a green circle in the :guilabel:`LAST
PING` column. If it is down or out of contact, it appears marked with a
red square. If it remains unreachable for an hour, MMS deactivates it
again.

You can optionally remove a host that is no longer in use, but when you do
it is permanently hidden from MMS. For more information, see
:ref:`removing-hosts`.

To reactivate hosts that have been deactivated:

.. include:: /includes/steps/reactivate-host.rst

.. index:: removing hosts
.. index:: procedure; removing hosts
.. _removing-hosts:

Remove Hosts
------------

You can remove hosts that you no longer use, but when you do they are
hidden permanently. If you run the instance again, MMS will not discover
it. If you choose to :doc:`add </tutorial/add-hosts-to-monitoring>` the
host again, MMS will **not** display it.

.. only:: saas

   Only `MMS Support <https://mms.mongodb.com/links/support>`_ can
   undelete it.

.. only:: hosted

   Only a global administrator can undelete the host so that it will again
   display if added. The administrator can add the host back through the
   :guilabel:`Deleted Hosts` tab on the MMS :guilabel:`Admin` interface.

Instead of removing a host, you can optionally disable alerts for the
host, which does not remove it from the monitoring pages. See
:ref:`manage-host-alerts`.

To remove a host from MMS:

.. include:: /includes/steps/remove-host.rst

.. _manage-host-alerts:

Manage Host Alerts
------------------

.. include:: /includes/steps/alerts-edit-host.rst

.. index:: database profiling
.. _db-profiling-section:

.. @tychoish I've left the heading levels as is below, even though
   "Profile Databases" does not logically nest under Alerts. A different
   pull request (278) changes the heading levels.

Profile Databases
~~~~~~~~~~~~~~~~~

|monitoring| can collect data from MongoDB's profiler to provide statistics
about performance and database operations. A link at the bottom of the Host
Statistics page that displays the profile levels.

Be aware of these issues:

- Profile data can include sensitive information, including the content of
  database queries. Ensure that exposing this data to |monitoring| is consistent
  with your information security practices.

- The profiler can consume resources which may adversely affect MongoDB
  performance. Consider the implications before enabling profiling.

To allow |monitoring| to collect profile data for a specific host:

.. include:: /includes/steps/profiling-enable.rst

.. note::

   The Monitoring agent attempts to minimize its effect on the
   monitored systems. If resource intensive operations, like polling
   profile data, begins to impact the performance of the database,
   |monitoring| will throttle the frequency that it collects data. See
   :ref:`db-stats-warning` for more information about the agent's
   throttling process.

   When enabled, |monitoring| samples profiling data from monitored
   instances: the agent only sends the most recent 20 entries from last
   minute.

When profiling is on, all configuration changes made in MMS can
take up to 2 minutes to propagate to the agent and another minute before
profiling data appears in the MMS interface.

If you have profiling data, and wish to delete it from the system,
there is a button on the bottom of the Profile Data tab, that says
Delete Profile Data. When you click on this button, MMS
raises a confirmation dialogue. When you confirm, |monitoring| will
begin removing stored profile data from this server's record.

.. note::

   If |monitoring| is storing a large amount of profile data for your
   instance, the removal process will not be instantaneous.
