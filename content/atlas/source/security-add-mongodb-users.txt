.. _mongodb-users:

========================
Configure Database Users
========================

.. default-domain:: mongodb

.. meta::
   :keywords: x509, atlas api, atlas cli, atlas ui
   :description: Create and manage database users in Atlas, specifying roles and authentication methods, and learn how to view, modify, or delete users.

.. facet::
   :name: genre
   :values: tutorial

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Create database users to provide clients access to the {+database-deployments+} in your
project. 

A database user's access is determined by the roles assigned
to the user. When you create a database user, any of the :ref:`built-in roles <atlas-user-privileges>` 
add the user to all {+database-deployments+} in your |service| project. 
To specify which resources a database user can access in your project, you 
can select the option :guilabel:`Restrict Access to Specific Clusters` in the {+atlas-ui+}
or set :ref:`specific privileges <atlas-specific-privileges>`
and :ref:`custom roles <mongodb-roles>`.

Database users are separate from |service| users. Database users have
access to MongoDB databases, while |service| users have access to the
|service| application itself. |service| supports creating temporary
database users that automatically expire within a user-configurable
7-day period.

|service| audits the creation, deletion, and updates of both temporary
and non-temporary database users in the project's :ref:`Activity Feed
<project-activity-feed>`.

.. note:: Self-Managed Deployments

   The information on this page applies only to deployments hosted in
   |service|. To learn how to create database users on self-managed
   deployments, see :ref:`create-users`.

Limitations
-----------

The following limitations apply only to deployments hosted in
|service-fullname|. If any of these limits present a problem for your
organization, contact :atlas:`Atlas support </support>`.

- You must use the :atlas:`Atlas CLI
  </cli/stable/command/atlas-dbusers-create>`, :atlas:`Atlas
  Administration API
  </reference/api-resources-spec/v2/#tag/Database-Users>`, Atlas UI, or
  a supported :atlas:`integration
  </partner-integrations/#std-label-partner-integrations>` to manage
  database users on |service| clusters. Otherwise, |service| rolls back
  any user modifications.

- The available |service| :ref:`built-in roles <built-in-roles>` and
  :atlas:`specific privileges
  </security-add-mongodb-users/#std-label-atlas-specific-privileges>`
  support a subset of MongoDB commands. For more information, see
  :atlas:`Unsupported Commands in M10+ Clusters
  </unsupported-commands/#std-label-paid-tier-command-limitations>` for
  more information.

- You can create a maximum of 100 database users per |service| project.

Database User Authentication
----------------------------

|service| offers the following forms of authentication for database
users:

.. include:: /includes/atlas-auth-methods.rst

Add Database Users
------------------

A project can have users with different authentication methods.

You cannot change a user's authentication method after creating that
user. To use an alternative authentication method, you must create a
new user.

.. tabs::

   .. tab:: {+atlas-cli+}
      :tabid: atlascli

      The {+atlas-cli+} uses the following commands to create new database users and X.509 certificates. The options you specify determine the authentication method.

      .. include:: /includes/extracts/atlas-dbusers-create-and-certs-create.rst

   .. tab:: {+atlas-admin-api+}
      :tabid: api

      You can add database users through the {+atlas-admin-api+}. The 
      options you specify determine the authentication method. To learn 
      more, see :oas-atlas-op:`Create One Database User 
      </createDatabaseUser>`.

   .. tab:: {+atlas-ui+}
      :tabid: ui

      Select an authentication mechanism and follow the steps to create
      a new database user using the {+atlas-ui+}.

      .. include:: /includes/create-db-user-ui.rst

.. _view-mongodb-users:

View Database Users and Certificates
------------------------------------

.. tabs::

   .. tab:: {+atlas-cli+}
      :tabid: atlascli

      View Database Users
      ~~~~~~~~~~~~~~~~~~~

      .. include:: /includes/extracts/atlas-dbusers-describe-and-list.rst

      View X.509 Certificates for a Database User
      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      .. include:: /includes/extracts/atlas-dbusers-certs-list.rst

   .. tab:: {+atlas-admin-api+}
      :tabid: api

      To view |service| database users using the 
      {+atlas-admin-api+}, see :oas-atlas-op:`Get All
      </listDatabaseUsers>`. 

   .. tab:: {+atlas-ui+}
      :tabid: ui

      To view |service| database users and X.509 certificates in the 
      {+atlas-ui+}:

      .. procedure::
         :style: normal

         .. include:: /includes/nav/steps-db-access.rst

         .. step:: View |service| database users.
      
            a. If it's not already displayed, click the 
               :guilabel:`Database Users` tab.

            #. Click :icon-fa4:`pencil` :guilabel:`Edit` for the user 
               to view their privileges, authentication details, and 
               X.509 certificates.

.. _modify-mongodb-users:
.. _add-mongodb-users:
.. _delete-mongodb-users:

.. composable-tutorial::
   :options: interface-default-atlas-cli, auth-method
   :defaults: atlas-ui, password


   .. selected-content::
      :selections: atlas-ui, password

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-ui-password.rst

   .. selected-content::
      :selections: atlas-ui, x509

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-ui-x509.rst

   .. selected-content::
      :selections: atlas-ui, ldap

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-ui-ldap.rst

   .. selected-content::
      :selections: atlas-ui, oidc

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-ui-oidc.rst

   .. selected-content::
      :selections: atlas-ui, aws-iam

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-ui-aws-iam.rst

   .. selected-content::
      :selections: atlas-cli, password

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-cli-password.rst

   .. selected-content::
      :selections: atlas-cli, ldap

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-cli-ldap.rst

   .. selected-content::
      :selections: atlas-cli, x509

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-cli-x509.rst

   .. selected-content::
      :selections: atlas-cli, oidc

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-cli-oidc.rst

   .. selected-content::
      :selections: atlas-cli, aws-iam

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-cli-aws-iam.rst

   .. selected-content::
      :selections: admin-api, password

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-admin-api-password.rst

   .. selected-content::
      :selections: admin-api, x509

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-admin-api-x509.rst
 
   .. selected-content::
      :selections: admin-api, ldap

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-admin-api-ldap.rst

   .. selected-content::
      :selections: admin-api, oidc

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-admin-api-oidc.rst

   .. selected-content::
      :selections: admin-api, aws-iam

      .. include:: /includes/composable-includes/security-add-mongodb-users/atlas-admin-api-aws-iam.rst
