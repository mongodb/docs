.. _backup-cloud-provider:

====================================
Back Up Your {+Database-Deployment+}
====================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. include:: /includes/fact-atlas-free-tier-only-limits.rst

|service| {+Cloud-Backup+}s provide localized backup storage using the
native snapshot functionality of the cluster's cloud service provider.

|service| supports {+cloud-backup+} for clusters served on:

- :ref:`Microsoft Azure <microsoft-azure>`
- :ref:`Amazon Web Services (AWS) <amazon-aws>`
- :ref:`Google Cloud Platform (GCP) <google-gcp>`

You can enable {+cloud-backup+} during the
:doc:`cluster creation </tutorial/create-new-cluster>` or during the
:doc:`modification of an existing cluster </scale-cluster>`.
From the cluster configuration modal, toggle
:guilabel:`Turn on Cloud Backup` to :guilabel:`Yes`.

If you have strict data protection requirements, 
you can :ref:`enable a {+bcp+} <backup-compliance-policy>` to protect 
your backup data.

{+Cloud-Backup+}s inherit the snapshot redundancy native to your cluster's 
cloud provider. As such, {+Cloud-Backup+}s have at least the following 
redundancies depending on the cloud provider:

- {+aws+} stores objects on multiple devices across a minimum of three 
  Availability Zones in an {+aws+} Region.
- {+azure+} uses locally redundant storage (LRS) which replicates your 
  data three times within a single data center in the selected region.
- {+gcp+} spreads your data across multiple physical machines within 
  the zone of the backup region.

To ensure greater redundancy for your {+Cloud-Backup+}s, you can 
also enable :ref:`Multi-Region Snapshot Distribution <snapshot-distribution>` 
in |service|. This automatically creates copies of your snapshots and oplogs 
and stores them in other |service| regions. With snapshots distributed 
across multiple regions, you can still restore your cluster if the primary 
region goes down.

If you need to retain any {+old-backup+} snapshots for archival
purposes, download them before you switch to {+Cloud-Backup+} from
{+old-backup+}s. To learn how to download a snapshot, see
:doc:`/backup/legacy-backup/restore`.

When you change from {+Old-Backup+}s to {+Cloud-Backup+}s, |service| retains
your {+Old-Backup+} snapshots in accordance with your
:ref:`legacy backup retention policy <retention-policy>`.

.. include:: /includes/atlas-roles/backup-restore.rst

Limitations of {+Cloud-Backup+}
-------------------------------

{+Cloud-Backup+}s can support sharded {+clusters+} running MongoDB 
version 4.0 or later.

You cannot restore an existing snapshot to a {+cluster+} after you add 
or remove a shard from it. You may restore an existing snapshot to 
another {+cluster+} with a matching topology.

With databases running |fcv-link| 4.0 or earlier, {+Cloud-Backup+}
automatically disables the balancer if it is running in order to
take a snapshot. When the snapshot completes, {+Cloud-Backup+} 
returns the balancer to its previous state.

.. toctree::
   :titlesonly:

   /backup/cloud-backup/dedicated-cluster-backup
   /backup/cloud-backup/shared-cluster-backup
   /backup/cloud-backup/serverless-backup
   /backup/cloud-backup/scheduling
   /backup/cloud-backup/backup-compliance-policy
