title: "Enable DNS hostnames and DNS resolution in AWS."
content: |

   Enabling :guilabel:`DNS hostnames` and :guilabel:`DNS
   resolution` can result in faster :ref:`VPC <security-vpc>` peering.

   .. tip ::

      AWS VPC resolves hostnames in an |service| cluster to their 
      private IP addresses when you enable :guilabel:`DNS resolution`.
      You can use these DNS entries to connect to hosts in your
      |service| cluster from the peered VPC since AWS handles
      resolving the peered hostnames automatically.
   
   1. Log in to your :abbr:`AWS (Amazon Web Services)` account.
   
   #. Go to the `VPC dashboard <https://console.aws.amazon.com/vpc>`_.
   
   #. Open your list of VPC resources.
   
   #. Select the VPC you want to peer with.
   
   #. Enable :guilabel:`DNS hostnames` and :guilabel:`DNS
      resolution`. See `Updating DNS Support for Your VPC
      <http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpc-dns.html#vpc-dns-updating>`_ 
      for further documentation on how to enable these options.
   
level: 4
ref: enable-dns
optional: true
---
title: "Go to VPC Peering view."
content: |
   From the :guilabel:`Clusters` view, select the :guilabel:`Security`
   tab, then :guilabel:`Peering`.

   Click :guilabel:`New Peering Connection`.
   
level: 4
ref: go-ip-whitelist-view
---
title: "Enter required information in the Peering Connection Dialog."
level: 4
ref: enter-ip-address
content: |

   To create the VPC Peering connection, fill in the requested
   information:
      
   .. list-table::
      :header-rows: 1
      :widths: 35 65
      
      * - Field
        - Notes

      * - :guilabel:`AWS Account ID`

        - AWS Account ID of the owner of the peer VPC. Refer to the
          dialog for instructions on finding your :guilabel:`AWS
          Account ID`.

      * - :guilabel:`VPC ID`

        - The ID of the peer VPC. Refer to the dialog
          for instructions on finding your :guilabel:`VPC ID`.
          
          The VPC must be in the same region as the |service| VPC.

      * - :guilabel:`Region`

        - Region for the |service| VPC and peer VPC.
          
          The VPC associated with the :guilabel:`VPC ID` must be in the same
          region as the |service| VPC.

          Otherwise, select the region for the |service| VPC and the
          peer VPC. A VPC will be created for the |service| project in
          this region if no ``M10+`` clusters or VPC peering connections
          exist for the selected :guilabel:`Region`.

      * - :guilabel:`VPC CIDR`

        - The peer VPC CIDR block or subset. Must not overlap with your
          |service| VPC CIDR block or any other peering connection
          :guilabel:`VPC CIDR`.

          The CIDR block must in one of the following 
          `private networks <https://tools.ietf.org/html/rfc1918#section-3>`_:

          - ``10.0.0.0`` - ``10.255.255.255``  (10/8 prefix)

          - ``172.16.0.0`` - ``172.31.255.255``  (172.16/12 prefix)

          - ``192.168.0.0`` - ``192.168.255.255`` (192.168/16 prefix)

          You can choose to add the VPC CIDR block address (or a
          subset) to the whitelist. For VPC peering connections, you
          can also add the Security Group associated with the peer VPC
          instead of the CIDR block. See :ref:`add-to-whitelist`.

          See `RFC 4632 <https://tools.ietf.org/html/rfc4632>`_ for more
          information about CIDR blocks.

      * - :guilabel:`Atlas CIDR Block`

        - The peer VPC CIDR block. Must not overlap with the
          :guilabel:`VPC CIDR` block.
          
          .. include:: /includes/fact-vpc-cidr-block.rst
          

---
title: "Click :guilabel:`Initiate Peering`."
level: 4
ref: save
content: ""
---
title: Wait for approval of peering connection request.
level: 4
ref: wait
content: |
   The owner of the peer VPC must approve the VPC peering connection
   request. Ensure that the owner approves the request.

   |service| provides instructions for approving the connection request.

   .. important:: Requests expire after 7 days.

---
title: Add to route table.
level: 4
ref: route-table
content: |
   In the AWS Console under the :guilabel:`Route Table` for your VPC, select
   the :guilabel:`Routes` tab. Click :guilabel:`Add another rule`, add the
   |service| VPC's CIDR block, and save the entry.
...
