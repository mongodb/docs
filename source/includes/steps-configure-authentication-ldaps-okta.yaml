level: 4
ref: login-okta
source:
  file: steps-configure-authentication-ldaps.yaml
  ref: login
stepnum: 1
---
level: 4
ref: click-security-ldap-okta
source: 
   file: steps-configure-authentication-ldaps.yaml
   ref: click-security-advanced
stepnum: 2
---
level: 4
ref: toggle-on-okta
source: 
   file: steps-configure-authentication-ldaps.yaml
   ref: toggle-on
stepnum: 3
---
level: 4
ref: configure-ldap-server-okta
source:
   file: steps-configure-authentication-ldaps.yaml
   ref: configure-ldap-server
stepnum: 4
content: |

  - :guilabel:`Server Hostname`:

    .. code-block:: sh

       <okta_instance_id>.ldap.okta.com

  - :guilabel:`Server Port`: ``636``

  - :guilabel:`Bind Username`: 

    .. code-block:: sh
    
       uid=<bind-user-email>,ou=users,dc=<okta-instance-id>,dc=okta,dc=com

---
level: 4
title: Add a User to DN Mapping.
optional: true
ref: user-dn-mapping-okta
stepnum: 5
content: |

  Add a User to DN mapping similar to the following example to allow 
  clients to provide their email addresses instead of full DNs when they
  connect to |service| databases:

  .. code-block:: sh

     [
        {
            "match": "(.+)",
            "substitution": "uid={0},ou=users,dc=<okta_instance_id>,dc=okta,dc=com"
        }
     ]

---
level: 4
ref: copy-ssl-certificate-okta
source:
   file: steps-configure-authentication-ldaps.yaml
   ref: copy-ssl-certificate
stepnum: 6
---
level: 4
ref: verify-and-save-okta
source:
  file: steps-configure-authentication-ldaps.yaml
  ref: verify-and-save
stepnum: 7
---
level: 4
title: "Add |ldap| users to |service|."
ref: atlas-ldap-auth-users-okta
stepnum: 8
content: |

  .. note::

     :ref:`Skip this step <configure-okta-authz>` if you want to enable
     LDAP authorization.

  Add users managed in the Okta |ldap| to |service|.

  a. In the :guilabel:`Security` section of the left navigation, click
     :guilabel:`Database Access`.
  #. Click :icon-fa5:`plus` :guilabel:`Add New Database User`.
  #. Click :guilabel:`LDAP User`.
  #. Perform one of the following:

     i. If you have not entered a :guilabel:`User to DN Mapping`, enter 
        the full DN of the |ldap| user. Follow this template:

        .. code-block:: sh
        
           uid=<user-name>,ou=users,dc=<okta-instance-id>,dc=okta,dc=com

        For example, if your ``<user-name>`` is ``jane@example.com`` and 
        your ``<okta-instance-id>`` is ``mdb-example``, your user's 
        DN is:

        .. code-block:: sh
           :copyable: false
        
           uid=jane@example.com,ou=users,dc=mdb-example,dc=okta,dc=com
          
     #. If you entered a :guilabel:`User to DN Mapping`,
        enter the username or email address that your mapping requires.
        
  #. Select the database access level to grant to the user.
  #. Click :guilabel:`Add User`.

...
