:noprevnext:

.. _secure-x509-auth:

=======================================
Secure Client Authentication with X.509
=======================================

.. include:: /includes/styles/corrections.rst

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

The |k8s-op-full| can use X.509 certificates to authenticate your
client applications to your MongoDB deployments.

This guide instructs you on how to configure:

- X.509 authentication from clients to your MongoDB instances.
- |tls| to encrypt connections between MongoDB hosts in a replica set
  or sharded cluster.
- |tls| to encrypt connections client applications and MongoDB
  deployments.

.. include:: /includes/admonitions/cannot-secure-standalone.rst

To secure your deployment using |tls| and client X.509 authentication,
you may use |k8s|\'s |certauth| or your own |certauth|:

.. tabs::

   .. tab:: Kubernetes CA
      :tabid: kubeca

   .. tab:: Own CA
      :tabid: customca


General Prerequisites
---------------------

Before you secure your MongoDB deployment using |tls| encryption,
complete the following:

.. include:: /includes/prereqs/secure-resource.rst

.. include:: /includes/prereqs-secure-resource-x509.rst

Configure X.509 Client Authentication for a Replica Set
-------------------------------------------------------

Prerequisites
~~~~~~~~~~~~~

Before you secure your replica set using |tls| encryption, complete the
following:

.. tabs::
   :hidden:

   .. tab:: Kubernetes CA
      :tabid: kubeca

      - :doc:`Deploy the Replica Set </tutorial/deploy-replica-set>`
        that you want to secure

   .. tab:: Own CA
      :tabid: customca

      - :doc:`Deploy the Replica Set </tutorial/deploy-replica-set>`
        that you want to secure

      .. include:: /includes/prereqs/custom-ca-prereqs-rs-tls-only.rst

Procedure
~~~~~~~~~

.. tabs::
   :hidden:

   .. tab:: Kubernetes CA
      :tabid: kubeca

      .. include:: /includes/steps/deploy-k8s-replica-set-x509.rst

   .. tab:: Own CA
      :tabid: customca

      .. include:: /includes/steps/deploy-k8s-replica-set-x509-custom.rst


Configure X.509 Client Authentication for a Sharded Cluster
-----------------------------------------------------------

Prerequisites
~~~~~~~~~~~~~

Before you secure your replica set using |tls| encryption, complete the
following:

.. tabs::
   :hidden:

   .. tab:: Kubernetes CA
      :tabid: kubeca

      - :doc:`Deploy the Sharded Cluster </tutorial/deploy-sharded-cluster>`
        that you want to secure

      .. include:: /includes/prereqs/custom-ca-prereqs-sc-tls-only.rst

   .. tab:: Own CA
      :tabid: customca

      - :doc:`Deploy the Sharded Cluster </tutorial/deploy-sharded-cluster>`
        that you want to secure

      .. include:: /includes/prereqs/custom-ca-prereqs-sc-tls-only.rst

Procedure
~~~~~~~~~

.. tabs::
   :hidden:

   .. tab:: Kubernetes CA
      :tabid: kubeca

      .. include:: /includes/steps/deploy-k8s-sharded-cluster-x509.rst

   .. tab:: Own CA
      :tabid: customca

      .. include:: /includes/steps/deploy-k8s-sharded-cluster-x509-custom.rst



