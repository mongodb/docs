.. _upgrade-major-MongoDB-version:

===========================================
Upgrade Major MongoDB Version for a Cluster
===========================================

.. default-domain:: mongodb

.. facet::
   :name: genre
   :values: tutorial

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

|service| enables you to upgrade the major version of an |service|
cluster at any time by 
:ref:`modifying the cluster <scale-cluster-version>`.

This procedure guides you through creating a staging cluster for
the purpose of testing your applications against the new 
MongoDB version. While optional, we strongly recommend
using this procedure to ensure your production application experiences
the smoothest possible transition to the new MongoDB version.

Considerations
--------------

There are a few things to be aware of before starting the upgrade
procedure:

- Your cluster must be in a healthy state before upgrading.

- You can only upgrade your |service| cluster one major version at a
  time. You cannot skip any major versions when upgrading your
  cluster.

- Each major version contains some features which may not be
  backward-compatible with previous versions. When upgrading to a new
  major version, check the :manual:`Release Notes </release-notes>` for
  changes which may affect your applications.

- After upgrading the MongoDB major version, you will not be able to 
  downgrade to previous versions.

- Starting in MongoDB 6.0, the ``$$SEARCH_META`` 
  aggregation variable can't be used in any subsequent stage after a 
  :pipeline:`$searchMeta` stage. 

  If you want to upgrade to MongoDB 6.0 from a previous 
  version and use the ``$$SEARCH_META`` aggregation variable in your
  |fts| :pipeline:`$searchMeta` queries, review them before you upgrade your 
  {+cluster+} to avoid errors.

Required Access
---------------

To upgrade a cluster, you must have :authrole:`Project Owner` access or higher
to the project. 

Procedure
---------

.. include:: /includes/steps/change-major-version.rst

.. _major-version-upgrade-support:

Support for Major Version Upgrades
----------------------------------

If you have any questions regarding migration support beyond what is covered
in this documentation, or if you encounter an error during migration,
file a support ticket through the |service| user interface.

To file a support ticket:

#. Click :guilabel:`Support` in the left-hand navigation.

#. For :guilabel:`Atlas Issue Category`, select ``Other``.

#. For :guilabel:`Priority`, select ``Medium Priority``. If the issue
   affects your production cluster, select ``High Priority``.

#. For :guilabel:`Request Summary`, include ``Major Version Upgrade``
   in the summary.

#. For :guilabel:`More details`, include any other relevant details to
   your question or major version upgrade error.
