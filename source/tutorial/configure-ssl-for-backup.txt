.. _backup-ssl:

==================================================
Configure Backup to Connect with MongoDB using SSL
==================================================

.. default-domain:: mongodb

|backup| can backup MongoDB instances running with SSL. 

Prerequisite
------------

The MongoDB instance must use SSL. To use SSL with a ``mongod`` and
``mongos`` instance, you must enable it at compile time, or use `MongoDB
Enterprise <https://www.mongodb.com/products/downloads/mongodb-enterprise>`_.

Procedures
----------

Configure the Backup Agent with the Trusted CA Certificate
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Configure the Backup Agent with the trusted CA certificates used to sign
the certificates used by any MongoDB instances running with SSL.

Edit the Backup Agent's ``local.config`` file, located in the agent
install directory, to set ``sslTrustedServerCertificates`` to the path of
a file containing one or more certificates in PEM format.

By default, the Backup Agent only connects to MongoDB instances with a
trusted certificate. For testing purposes, you can set the
``sslRequireValidServerCertificates`` setting to ``False`` to bypass this
check. This configuration is NOT recommended for production use as it
makes the connection insecure.

For reference information on both settings, see :ref:`ssl-settings-backup`.

Activate SSL for the Backup Agent Connection with MongoDB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/steps/backup-configure-agent-ssl.rst
