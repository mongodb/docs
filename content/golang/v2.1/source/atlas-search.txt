.. _golang-atlas-search:

=========================
Run an Atlas Search Query
=========================

.. facet::
   :name: genre
   :values: reference

.. meta::
   :keywords: full text, text analyzer, meta, pipeline, scoring, Lucene
   :description: Learn about how to use Atlas Search in the {+driver-long+}.

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Overview
--------

In this guide, you can learn how to use the {+driver-short+} to
run :atlas:`Atlas Search </atlas-search/>` queries on a collection.
Atlas Search enables you to perform full-text searches on collections
hosted on MongoDB Atlas. Atlas Search indexes specify the behavior of the
search and which fields to index.

Sample Data
~~~~~~~~~~~

The example in this guide uses the ``movies`` collection in the ``sample_mflix``
database from the :atlas:`Atlas sample datasets </sample-data>`. To learn how to
create a free MongoDB Atlas cluster and load the sample datasets, see the
:atlas:`Get Started with Atlas </getting-started>` guide.

Run an Atlas Search Query
-------------------------

This section shows how to create an aggregation pipeline to run an
Atlas Search query on a collection. 

To run an Atlas Search query, you must create an Atlas Search index on your
collection. To learn how to programmatically create 
an Atlas Search index, see the :ref:`golang-atlas-search-indexes` section of the 
Indexes guide.

After you create an Atlas Search index, add the ``$search`` stage in your array 
of pipeline stages to specify the search criteria. Then, call
the ``Aggregate()`` method and pass your pipeline array as a parameter.

.. tip:: 

   To learn more about aggregation operations, see the :ref:`golang-aggregation`
   guide. 

Atlas Search Example
~~~~~~~~~~~~~~~~~~~~

This example runs an Atlas Search query by performing the
following actions:

- Creates a ``$search`` stage that instructs the driver
  to query for documents in which the ``title`` field contains
  the word ``"Alabama"``

- Creates a ``$project`` stage that instructs the driver to
  include the ``title`` field in the query results

- Passes the pipeline stages to the ``Aggregate()`` method and
  prints the results

.. io-code-block::
   :copyable:
    
   .. input:: /includes/fundamentals/code-snippets/indexes/atlasSearch.go
      :start-after: begin-atlas-search
      :end-before: end-atlas-search
      :language: go
      :dedent:

   .. output:: 
      :language: console
      :visible: false

      {
        _id: new ObjectId('...'),
        title: 'Alabama Moon'
      }
      {
        _id: new ObjectId('...'),
        title: 'Crazy in Alabama'
      }
      {
        _id: new ObjectId('...'),
        title: 'Sweet Home Alabama'
      }

Additional Information
----------------------

To learn more about Atlas Search, see the :atlas:`Atlas Search </atlas-search/>`
guides and the :atlas:`$search </atlas-search/aggregation-stages/search/>` pipeline 
stage reference in the Atlas documentation.

API Documentation
~~~~~~~~~~~~~~~~~

To learn more about the ``Aggregate()`` method, see the
`API documentation <{+api+}/mongo#Collection.Aggregate>`__.
