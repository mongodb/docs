.. _disk-io-util:

===============
Fix IOPS Issues
===============

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

``Disk I/O % Utilization`` alerts indicate that percentage of time
during which issued requests reaches a specified threshold. You set
this threshold when you create the alert.

.. note::

   The utilization measurements for the following alerts include
   requests from all processes, not just MongoDB processes.

Alert Conditions
----------------

:ref:`Disk I/O % utilization on Data Partition
<system-disk-alerts>`
occurs if the percentage of time during which requests are being
issued to any partition that contains the MongoDB :term:`collection`
data meets or exceeds the threshold.

:ref:`Disk I/O % utilization on Index Partition
<system-disk-alerts>`
occurs if the percentage of time during which requests are being
issued to any partition that contains the MongoDB :term:`index`
data meets or exceeds the threshold.

:ref:`Disk I/O % utilization on Journal Partition
<system-disk-alerts>`
occurs if the percentage of time during which requests are being
issued to the partition that contains the MongoDB
:term:`journal` meets or exceeds the threshold.

Common Triggers
---------------

A few common events may lead to high Disk I/O % Utilization and trigger
these alerts:

- :manual:`Unoptimized queries </core/query-optimization/>`

- A one-time event that spikes disk utilization, such as an
  :manual:`index build </core/index-creation/>`.

Fix the Immediate Problem
-------------------------

Consider the following resolutions to resolve ``Disk I/O %
Utilization`` alerts:

- :manual:`Optimize your queries </core/query-optimization/>`.

- Use the |service| :doc:`Performance Advisor
  </tutorial/performance-advisor/>` to view slow queries and suggested
  :manual:`indexes </indexes>`.

Implement a Long-Term Solution
------------------------------

- Review :manual:`Indexing Strategies </applications/indexes/>` for
  possible further indexing improvements.

  .. note::

     A temporary spike in disk utilization may result when creating new
     indexes.

- :manual:`Analyze Query Performance </tutorial/analyze-query-plan/>`
  to review how your queries are using your indexes.

- Use a faster disk drive with more hardware resources.

- Move operations from disks with large workloads to different disks.

Monitor Your Progress
---------------------

To observe a high percentage of Disk I/O utilization, open the
:guilabel:`Hardware Metrics` section of the :guilabel:`Metrics` tab and 
find the following metrics:

.. list-table::
   :widths: 40 60
   :header-rows: 1
   :stub-columns: 1

   * - Graph
     - Indicator
   * - Util%
     - High value
   * - Disk IOPS
     - |iops| value greater than the provisioned |iops| value
   * - Normalized System CPU
     - High :guilabel:`IOWait` curve

       IOWait measures the percentage of time the CPU runs idle waiting
       for an I/O operation to complete.

To learn more, see 
:ref:`View Deployment Metrics <monitor-cluster-metrics>`.
