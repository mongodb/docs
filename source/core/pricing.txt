=======
Pricing
=======

.. default-domain:: mongodb

Overview
--------

Pricing for Automation is based on the number of servers
you have. Pricing for Backup is based on the size of your backed-up
snapshots and on your settings for :ref:`snapshot frequency and retention
<snapshot-frequency-and-retention>`. For information on how Backup
determines snapshot size, see :ref:`backup-pricing` further down on this
page.

.. _pricing-information:

View Pricing Information
------------------------

Do one of the following:

.. list-table::
   :widths: 40 60

   * - If you are *logged in* to |mms|

     - Click the :guilabel:`Settings` tab, then
       :guilabel:`Billing/Subscriptions`, and then
       :guilabel:`Understanding Your Bill`.

   * - If you are *not logged in* to |mms|

     - Go to `https://mongodb.com/cloud <https://mongodb.com/cloud>`_.
       This link does not work if you are logged into |mms|.

.. _view-your-costs:

View Your Current Costs
-----------------------

Click the :guilabel:`Settings` tab and
then click :guilabel:`Billing/Subscriptions`. You can view the following
information:

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - View

     - Action

   * - Current costs

     - Scroll to the :guilabel:`Billing and Usage Summary` section.

   * - Details about current costs, including the price charged per
       unit

     - Click the :guilabel:`Usage Details` link.

   * - Estimate of your monthly bill

     - Click :guilabel:`Understanding Your Bill` and scroll to the
       :guilabel:`Monthly Estimates` section.

.. _edit-billing-info:

Edit Billing Information
------------------------

Click the :guilabel:`Settings` tab and then click
:guilabel:`Billing/Subscriptions`. You can edit the following:

.. list-table::
   :widths: 40 60
   :header-rows: 1

   * - Edit

     - Action

   * - Billing email address

     - Click the pencil icon for the :guilabel:`Billing Email Address` and
       enter the address. Click :guilabel:`Set`.

   * - Credit card

     - In the :guilabel:`Payment Methods` list, click the pencil icon for
       the credit card and enter your card information. Click
       :guilabel:`Save Changes`.

.. _view-past-charges:

View Your Past Charges
----------------------

To view past charges, click the :guilabel:`Settings` tab and then
click :guilabel:`Payment History`. Click a date to view charges and
payments for that period.

.. _retry-failed-payment:

Retry a Failed Payment
----------------------

If you receive notification of a failed payment, check that your credit
card is up-to-date on the :guilabel:`Settings` tab's
:guilabel:`Billing/Subscriptions` page. To retry the payment:

1. Click the :guilabel:`Settings` tab and then click
   :guilabel:`Payment History`.

2. On the line for the failed payment, click :guilabel:`Retry`.

.. _reopen-after-lock-out:

Reopen an Account that is Locked Out
------------------------------------

If you have received a message that your account is locked for failure
to pay, please update your credit card information on the
:guilabel:`Settings` tab's :guilabel:`Billing/Subscriptions` page.

.. _unmanage-all:

Unmanage All Deployments
------------------------

If you choose to stop using |mms| Automation, you can unmanage all your
MongoDB deployments at once. |mms| continues to monitor your deployments
but tracks metrics at a less granular level and stores metrics for a
shorter period. To unmanage all your deployments:

1. Click the :guilabel:`Deployment` tab, and then the :guilabel:`Deployment` page.

2. Click the ellipsis icon and select :guilabel:`Unmanage All`.

For more information, see :doc:`/tutorial/unmanage-deployment`.

.. _backup-pricing:

Determine Backup Costs
----------------------

Backup costs are affected by snapshot size and by your settings for
snapshot frequency and retention.

Snapshot Size
+++++++++++++

The per-gigabyte charge for Backup is applied to the size of your most
recent snapshot. A snapshot is roughly equivalent to the size of all
documents and all indexes for all the databases backed up.

To retrieve the size of the documents and indexes in a given database,
issue the :manual:`dbStats </reference/command/dbStats>` command and sum
the ``dataSize`` and ``indexSize`` fields. In the following example output
of a :manual:`dbStats </reference/command/dbStats>` command that was
issued to return gigabytes, the size of the database's documents and
indexes is roughly 79.07GB, as found by adding the ``dataSize`` and
``indexSize`` fields:

.. code-block:: javascript

   {
       "db" : "mmsdbconfig",
       "collections" : 88,
       "objects" : 115153078,
       "avgObjSize" : 551.9170146368124,
       "dataSize" : 59.1901531778276,
       "storageSize" : 64.05994385480881,
       "numExtents" : 553,
       "indexes" : 235,
       "indexSize" : 19.876188188791275,
       "fileSize" : 89.89453125,
       "nsSizeMB" : 16,
       "extentFreeList" : {
           "num" : 19,
           "totalSize" : 0
       },
       "dataFileVersion" : {
           "major" : 4,
           "minor" : 22
       },
       "ok" : 1
   }

Settings for Frequency and Retention
++++++++++++++++++++++++++++++++++++

The cost per gigabyte on the :ref:`pricing information
<pricing-information>` page assumes an installation that uses the default
settings for :ref:`snapshot frequency and retention
<snapshot-frequency-and-retention>`. Lowering snapshot frequency or
retaining fewer snapshots lowers the rate. Retaining an increased number
of snapshots increases the rate.

To view your rate, click the
:guilabel:`Usage Details` link on the :guilabel:`Billing/Subscriptions`
page.

You can change a backed-up deployment's schedule through its :guilabel:`Edit
Snapshot Schedule` menu option, available through the :guilabel:`Backup` tab.
Administrators can change frequency and retention through the
:doc:`snapshotSchedule resource </reference/api/snapshot-schedule>` in the
API. Lowering snapshot frequency increases how long it takes to build a
point-in-time restore.
