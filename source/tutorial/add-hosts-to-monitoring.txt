.. _tutorial-monitoring:

===========================
Add Hosts to MMS Monitoring
===========================

.. default-domain:: mongodb

The Monitoring Agent automatically discovers MongoDB processes based on
existing cluster configuration. You'll have to manually seed at
least one of these hosts from the MMS console.

.. index:: adding hosts
   single: hosts; adding

Procedure
---------

To add a host to |monitoring|:

.. include:: /includes/steps/add-host.rst

If the host is accessible only by specific hostname or IP address, or
you need to specify the hostname to use for servers with multiple aliases, set up a
preferred hostname. See the :ref:`Preferred Hostnames
<group-settings-preferred-hostnames>` section for details.

.. index:: host discovery
   single: hosts; discovery

Host Discovery
--------------

Once the Monitoring Agent has a seed host it discovers all other nodes
in the replica set or sharded cluster. These clusters, and their resppective
seed hosts, include:

- Master databases, after adding slave databases.

- Shard clusters, after adding ``mongos`` instances.

- Replica sets, after adding any member of the set.

Once you add these seed nodes, the Monitoring Agent will fetch this
information *from* the MMS servers. Thus, when configuring the
monitoring environment, you may need to wait for several update cycles
(e.g. 5-10 minutes) to complete the auto-discovery process and host
identification. During this period, you may see duplicate hosts in the
MMS web console. This is normal.

The Monitoring Agent fetches configuration and reports to |monitoring| every
minute, so, again, there may be a delay of several minutes before data
and host information propagate to the MMS console.

You can find immediate evidence of a working installation in the agent output
or logs.

To view the Monitoring Agent log, select the :guilabel:`Monitoring` tab
and then select `:guilabel:`Monitoring Agent Log`.

To view diagnostic information for a host, select the
:guilabel:`Monitoring` tab, then select `:guilabel:`Deployment`, and
then click the host. Click :guilabel:`Last Ping` and :guilabel:`Daily Pings`.
Once |monitoring| has data, you can view and begin using the statistics.

Additional Information
----------------------

:doc:`/tutorial/manage-hosts`
