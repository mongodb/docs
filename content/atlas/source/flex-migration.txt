.. _flex-migration:

===========================================================================================================
Migrate your Programmatic Tools from M2, M5, or {+Serverless-Instances+} to {+Flex-Clusters+}
===========================================================================================================

.. default-domain:: mongodb

.. facet::
   :name: genre
   :values: tutorial

.. meta::
   :keywords: migrate to flex cluster

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. include:: /includes/shared-to-atlas-flex-migration.rst

All of the tools support {+Flex-clusters+}. Update your code and replace
all references to deprecated instance types with references to {+Flex-Clusters+}.

.. note::

   If your workloads require :ref:`Private Endpoints
   <private-endpoint-overview>` or
   :ref:`Continuous Backup and Point-in-Time Restore <pit-restore>`, use
   {+Dedicated-clusters+}.

.. _flex-migration-api:

Migrating API Configuration
---------------------------

The :oas-bump-atlas-tag:`Cluster <clusters>` API endpoints listed in the table in this
section were compatible with ``M2``/``M5`` {+clusters+}.
As of January 2025, these endpoints managed {+Flex-clusters+}. These API endpoints
reached End of Life (EOL) on January 22, 2026.

As of January 2025, API endpoints for Serverless Instances
managed {+Flex-clusters+}. As of March 2025, {+Serverless-instances+} 
are no longer supported. All existing {+Serverless-instances+} were migrated 
to {+Free-clusters+}, {+Flex-clusters+}, or {+Dedicated-clusters+}, according 
to usage. If your {+Serverless-instance+} was migrated to a {+Free-cluster+} 
or {+Dedicated-cluster+}, use the :oas-bump-atlas-tag:`Cluster <clusters>` 
API endpoint instead.

Support for creating ``M2`` and ``M5`` {+clusters+} using the :oas-bump-atlas-op:`<creategroupcluster>` and
{+Serverless-instances+} using the :oas-bump-atlas-op:`<creategroupserverlessinstance>` endpoints
ended on January 22, 2026. These endpoints now only support {+Flex-clusters+}.

The following changes also apply to the listed API endpoints:

.. list-table::
   :widths: 30 70
   :header-rows: 1

   * - Endpoint
     - Impact

   * - :oas-bump-atlas-op:`<listgroupprivateendpointserverlessinstanceendpoint>`
     - Deprecated. Returns an error because {+Serverless-instances+} are no 
       longer supported (as of May 2025).

   * - :oas-bump-atlas-op:`<upgradegroupclustertenantupgrade>`
     - When used on {+Flex-clusters+}, ``upgradeSharedCluster`` takes the
       value set by the user, but doesn't toggle Continuous Backup because
       Continuous Backup is not available for {+Flex-clusters+}.

   * - :oas-bump-atlas-op:`<creategroupserverlessinstance>`
     - When used on {+Flex-clusters+}, ``createServerlessInstance`` takes the
       value set by the user, but doesn't toggle Continuous Backup because
       Continuous Backup is not available for {+Flex-clusters+}.

   * - :oas-bump-atlas-op:`<updategroupserverlessinstance>`
     - When used on {+Flex-clusters+}, ``updateServerlessInstance`` takes the 
       value set by the user, but doesn't toggle Continuous Backup because 
       Continuous Backup is not available for {+Flex-clusters+}.

   * - :oas-bump-atlas-op:`<setgroupserverlessperformanceadvisorautoindexing>`
     - When used on {+Flex-clusters+}, ``setServerlessAutoIndexing`` takes the 
       value set by the user, but doesn't toggle Auto-Indexing because 
       Auto-Indexing is not available for {+Flex-clusters+}.

   * - :oas-bump-atlas-op:`<getgroupserverlessperformanceadvisorautoindexing>`
     - When used on {+Flex-clusters+}, ``getServerlessAutoIndexing`` takes the 
       value set by the user, but doesn't toggle Auto-Indexing because 
       Auto-Indexing is not available for {+Flex-clusters+}.

.. _flex-migration-terraform:

Terraform Atlas Provider Migration
--------------------------------------

The `HashiCorp Terraform Provider <https://registry.terraform.io/providers/mongodb/mongodbatlas/latest/docs/resources/flex_cluster>`__
supports {+Flex-clusters+}. General Terraform support for ``M2``/``M5``
{+clusters+} and {+Serverless-instances+} ended on January 22, 2026.

Update your Terraform configurations to operate on {+Flex-clusters+}.

.. _flex-migration-go-sdk:

Go SDK Migration
----------------

The {+atlas-go-sdk+} supports {+Flex-clusters+}. General SDK 
support for ``M2``/``M5`` {+clusters+} and {+Serverless-instances+} 
ended on January 22, 2026.

Update your SDK scripts to operate on {+Flex-clusters+}.

.. _flex-migration-cli:

{+atlas-cli+} Migration
------------------------

The {+atlas-cli+} supports {+Flex-clusters+}. To learn more, 
see :atlascli:`command reference </command/atlas/>` and select the latest 
{+atlas-cli+} version from the dropdown.

As of January 2025, {+pit-restore+} is no longer supported on 
{+Serverless-instances+}. If you used {+pit-restore+} on any of your 
{+Serverless-instances+}, remove {+Serverless-Instance+} {+pit-restore+} 
from your {+atlas-cli+} workflows.

General {+atlas-cli+} support for ``M2``/``M5`` {+clusters+} and
{+Serverless-instances+} ended on January 22, 2026.
Remove all ``M2``/``M5`` and {+Serverless-Instance+} commands
from your {+atlas-cli+} workflows.

.. _flex-migration-ak8so:

{+ak8so+} Migration
----------------------------------------

The :ak8so:`{+ak8so+} </>` supports {+Flex-clusters+}.

To manage {+Flex-clusters+}, you must use {+ak8so+} 2.12.0 or later. This version is free of serverless dependencies.

- You can create and manage {+Flex-clusters+} using the ``AtlasDeployment``
  Custom Resources. To learn more, see
  the :ak8so:`AtlasDeployment </current/atlasdeployment-custom-resource/>` custom
  resource in the {+ak8so+} documentation.

- Use ``spec.flexSpec`` in the ``AtlasDeployment`` Custom Resource 
  to configure {+Flex-clusters+}.

- ``M2``/``M5`` {+clusters+} and {+Serverless-instances+} are no longer 
  supported. All existing instances have been migrated to {+Flex-clusters+} 
  or other cluster types. 

.. _flex-migration-cfn-cdk:

{+service+} CloudFormation Migration
------------------------------------

{+service+} CloudFormation and Cloud Development Kit (CDK) support {+Flex-clusters+}.
General support for ``M2``/``M5`` {+clusters+} ended on January 22, 2026.

Support for :github:`Serverless Private Endpoints
<mongodb/mongodbatlas-cloudformation-resources/tree/master/cfn-resources/serverless-private-endpoint>`
and the ``Properties.ContinuousBackupEnabled`` parameter of the
:github:`Serverless Instance
<mongodb/mongodbatlas-cloudformation-resources/tree/master/cfn-resources/serverless-instance/docs#mongodbatlasserverlessinstance>`
resource ended when {+service+} CloudFormation introduced {+Flex-cluster+}
support. These resources are no longer available in CloudFormation or CDK.
Remove all ``M2``/``M5`` and {+Serverless-instance+} features from your {+service+}
CloudFormation and CDK resources.

.. important::

   Use the ``MongoDB::Atlas::Cluster`` resource in CloudFormation or the ``CfnCluster`` resource in CDK
   instead of the ``MongoDB::Atlas::FlexCluster`` resource in CloudFormation or the ``CfnFlexCluster`` resource in CDK
   to create and manage {+Flex-clusters+}. ``MongoDB::Atlas::Cluster`` and ``CfnCluster`` support
   {+Flex-clusters+}, and future upgrades will be available only through these resources.
   CloudFormation and CDK do not yet support migration between {+Flex-clusters+} and other cluster types,
   but support will be added in the future.

For more information, see:

- :github:`CloudFormation Flex Cluster README
  <mongodb/mongodbatlas-cloudformation-resources/blob/master/cfn-resources/flex-cluster/README.md>`
- :github:`CloudFormation Cluster README
  <mongodb/mongodbatlas-cloudformation-resources/blob/master/cfn-resources/cluster/README.md>`
- :github:`CDK Flex Cluster README
  <mongodb/awscdk-resources-mongodbatlas/blob/main/src/l1-resources/flex-cluster/README.md>`
- :github:`CDK Cluster README
  <mongodb/awscdk-resources-mongodbatlas/blob/main/src/l1-resources/cluster/README.md>`
